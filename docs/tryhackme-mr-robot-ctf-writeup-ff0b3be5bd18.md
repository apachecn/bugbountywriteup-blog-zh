# æœºå™¨äºº CTF å…ˆç”Ÿâ€”â€”æŠ¥é“

> åŸæ–‡ï¼š<https://infosecwriteups.com/tryhackme-mr-robot-ctf-writeup-ff0b3be5bd18?source=collection_archive---------0----------------------->

*TryHackMe ä¸­ä¸€ä¸ªåä¸º* [*æœºå™¨äººå…ˆç”Ÿ*](https://tryhackme.com/room/mrrobot) *çš„æˆ¿é—´çš„ç‰¹å†™ã€‚*

![](img/8ac49facc4bd13f908161d685ea266d3.png)

## å…³äº TryHackMe

[TryHackMe](http://tryhackme.com) æ˜¯ä¸€ä¸ªå­¦ä¹ ç½‘ç»œå®‰å…¨çš„ç¥å¥‡å¹³å°ï¼Œå¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼Œè¿™å°†æ˜¯ä¸€ç¬”æƒŠäººçš„è´¢å¯Œã€‚ä»–ä»¬æœ‰è¿™äº›æˆ¿é—´ï¼ŒåŸºæœ¬ä¸Šæ˜¯è„†å¼±çš„æœºå™¨ï¼Œä½ å¯ä»¥éƒ¨ç½²å’Œç»ƒä¹ ä½ çš„æŠ€èƒ½ã€‚TryHackMe æœ€æ£’çš„åœ°æ–¹åœ¨äºå®ƒéå¸¸å®ç”¨ã€‚å¦‚æœæ‚¨æ˜¯å®‰å…¨æ€§æ–°æ‰‹ï¼Œè¯·åŠ¡å¿…å°è¯•ä¸€ä¸‹ã€‚

å› æ­¤ï¼Œåœ¨ TryHackMe é—¨æˆ·ä¸Šéƒ¨ç½²è¯¥æœºå™¨åï¼Œæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªè®¿é—®è¯¥æœºå™¨çš„ IPã€‚æ¯æ¬¡éƒ¨ç½²æ—¶éƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥æ‚¨çš„`ROOM-IP` å¯èƒ½ä¸æˆ‘çš„ä¸åŒã€‚

## nmap æ‰«æ:

æˆ‘ä»¬éœ€è¦çŸ¥é“å“ªäº›æœåŠ¡åœ¨å¹•åè¿è¡Œï¼Œå“ªäº›ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå«åš **nmap çš„å·¥å…·ã€‚**

![](img/c5bc2c82bc0a622a7dcd6832b1442ae1.png)

æ‹¥æœ‰ç«¯å£ 80 å’Œ 443 è¡¨æ˜æˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘ç«™åœ¨è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šæ‰“å¼€`http://10.10.71.122`å’Œ`https://10.10.71.122`ã€‚

![](img/a320502e68def95a494c0189f9656b31.png)

è¯¥ç½‘ç«™æ˜¯æœºå™¨äººå…ˆç”Ÿä¸»é¢˜ç½‘ç«™ã€‚è¿è¡Œå›¾ç‰‡ä¸­æåˆ°çš„å‘½ä»¤åªæ˜¯é‡å®šå‘åˆ°å…¶ä»–é¡µé¢ï¼Œè¿™äº›é¡µé¢æœ‰æœºå™¨äººå…ˆç”Ÿç”µè§†èŠ‚ç›®çš„å›¾åƒå’Œè§†é¢‘ã€‚

å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œæˆ‘ä»¬æƒ³åˆ—ä¸¾ç½‘ç«™çš„ç›®å½•ï¼Œçœ‹çœ‹åƒç™»å½•é¡µé¢ï¼Œç®¡ç†é—¨æˆ·ç­‰å­˜åœ¨ä¸å¦ã€‚

**gobuster æ‰«æ:**

å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º **gobuster** çš„å·¥å…·ï¼Œå®ƒä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„å¯èƒ½çš„å¸¸ç”¨ç›®å½•åç§°çš„å•è¯åˆ—è¡¨ï¼Œå¹¶å°è¯•åŠ è½½è¯¥å•è¯åˆ—è¡¨ä¸­çš„æ¯ä¸ªç›®å½•åç§°ï¼Œç„¶åæŸ¥çœ‹çŠ¶æ€ä»£ç ã€‚(å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Kali æˆ– ParrotOSï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨`/usr/share/wordlists/dirbuster`æ‰¾åˆ°è¿™äº›è¯æ±‡è¡¨)

![](img/e21d35f5fd402f1f8224af4501a2733c.png)

è¾“å‡ºä¿å­˜åœ¨`**directories.txt**`æ–‡ä»¶ä¸­

![](img/a2baf14190e6b537cbcdecb8fac2916f.png)

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹çŠ¶æ€ä»£ç ä¸º 200 çš„ç›®å½•

![](img/faf13f43dbf24d52c5c4b3e071c070d4.png)

/è‡ªè¿°æ–‡ä»¶

![](img/8709e31aacb857030157ea4ab38ed20d.png)

/è®¸å¯è¯

![](img/9411aff243c08d07a7fbc0ebf06c0ac9.png)

/è‡ªè¿°æ–‡ä»¶

![](img/67d3a1bc830d7e0005851bafdd9e5124.png)

/rdf(æœ‰æ„æ€..ï¼Ÿ)

![](img/4419e2d4b047c019f4597843e37cd252.png)

/wp-login(çœ‹èµ·æ¥åƒç®¡ç†å‘˜ç™»å½•é¡µé¢)

![](img/f987815f5b03869760a7a8acad93d00a.png)

/æœºå™¨äºº

å¤´å¥–ã€‚æ‰“å¼€`10.10.71.122/key-1â€“of-3.txt`

![](img/7dfe71cb1dbc3da89869642233af04dd.png)

è¿™æ˜¯æˆ‘ä»¬çš„è°ƒå· 1/3ã€‚

**å…³é”®ä¸€:è¢«ä¿˜ï¼**

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ fsociety.dic

![](img/393ebf0c703008a8bfe88b996582d1c8.png)

å®ƒçœ‹èµ·æ¥åƒä¸€æœ¬å­—å…¸ã€‚

è®©æˆ‘ä»¬ç”¨è¿™ä¸ªå­—å…¸å¯¹å‰é¢çœ‹åˆ°çš„ç™»å½•é¡µé¢è¿›è¡Œå­—å…¸æ”»å‡»ã€‚

![](img/b6c6b2e2ccb945d35b283f336b3d5871.png)

æˆ‘ä»¬å¾—åˆ°é”™è¯¯:**æ— æ•ˆçš„ç”¨æˆ·åã€‚**

è®©æˆ‘ä»¬è¯•è¯• admin:admin ç™»å½•:

ä½¿ç”¨ BurpSuite æ‹¦æˆªç™»å½•è¯·æ±‚æ•°æ®åŒ…ã€‚

![](img/ee38767aa22a5baefbc20be925fd69c0.png)

ç”¨æˆ·åå’Œå¯†ç å­—æ®µåˆ†åˆ«ç”±`log`å’Œ`pwd`è¡¨ç¤ºã€‚

## ä½¿ç”¨ Hydra æ‰§è¡Œå­—å…¸æ”»å‡»

å­—å…¸åº”è¯¥æ˜¯`fsocity.dic`ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»ä»–ä»¬é‚£é‡Œæ”¶åˆ°äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå°è¯•ä½¿ç”¨ comman ç”¨æˆ·åå’Œå¯†ç ã€‚ä½ å¯ä»¥åœ¨ https://github.com/danielmiessler/SecLists æ‰¾åˆ°è¿™äº›ä»¥åŠæ‰€æœ‰å…¶ä»–çš„æ¸…å•ã€‚

å› æ­¤ï¼Œé¦–å…ˆæˆ‘ä»¬å°†å°è¯•æ‰¾åˆ°ä»¥å¯†ç ä¸ºå¸¸é‡çš„ç”¨æˆ·åï¼Œç„¶åæˆ‘ä»¬å°†ä½¿ç”¨æ‰¾åˆ°çš„ç”¨æˆ·åæ¥è·å–å¯†ç ã€‚

**ç”¨æˆ·åæ”¹å˜ï¼Œå¯†ç ä¸å˜**

![](img/38ac5ca7de7a6babffc502f59a0e552f.png)

æˆ‘ä»¬å¾—åˆ°çš„ç”¨æˆ·åæ˜¯åŸƒåˆ©å¥¥ç‰¹ã€‚

è®©æˆ‘ä»¬å°è¯•ç”¨ Elliot:test ç™»å½•

![](img/732de34f9be6330e0d51e8f5b697efa9.png)

æˆ‘ä»¬å¾—åˆ°é”™è¯¯:**æ‚¨ä¸ºç”¨æˆ·å Elliot è¾“å…¥çš„å¯†ç ä¸æ­£ç¡®ã€‚**

**ç”¨æˆ·åä¸å˜ï¼Œå¯†ç æ›´æ”¹**

![](img/51fa86c21985a20dcd34b39f50cab489.png)

æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ª 9 ä½æ•°çš„å¯†ç :********

ä½¿ç”¨`Elliot:*********`ç™»å½•:

![](img/5def75e4fcffbb5df8c548f1462ed69b.png)

ç½‘ç«™è¿è¡Œçš„æ˜¯ WordPress 4.3.1ã€‚

ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰“å¼€ä¸€ä¸ªåå‘å¤–å£³ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¯•ç€æ‰“å¼€ä¸€ä¸ª`php-reverse-shell`ã€‚å¡è‰å’Œå¸•ç½—æ‰˜æ–¯å·²ç»æ‹¿åˆ°äº†ã€‚ä½ æ‰€è¦åšçš„å°±æ˜¯`locate`å®ƒã€‚

![](img/a637c79401cb98cb7d52472edd5d8ea4.png)

å¦‚æœä½ æ²¡æœ‰å¡åˆ©æˆ– ParrotOSï¼Œä½ å¯ä»¥ç®€å•åœ°è°·æ­Œä¸€ä¸‹ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°å®ƒã€‚

## **å¼€å€Ÿå£³**

åœ¨ wp-admin ä¸­ï¼Œè½¬åˆ°å·¦ä¾§å¯¼èˆªæ ï¼Œé€‰æ‹©`Appearance â†’ Editor`ï¼Œç„¶åé€‰æ‹©å³ä¾§çš„`Archives (archive.php)`

![](img/268f578b60a4190b8138730f22eb736e.png)

ä¸€æ¬¡ï¼Œæ¡£æ¡ˆå¼€æ”¾ã€‚åœ¨ç¼–è¾‘éƒ¨åˆ†ç²˜è´´`php-reverse-shell.php`

![](img/1bcfb533720a2d04178bbe337c9544a2.png)

ç°åœ¨æˆ‘ä»¬å¿…é¡»ç¼–è¾‘å˜é‡`IP`çš„å€¼ã€‚æˆ‘ä»¬å¿…é¡»å°†å®ƒè®¾ç½®ä¸ºæˆ‘ä»¬çš„ IPï¼Œè¿™æ ·å½“åå‘å¤–å£³æ‰“å¼€æ—¶ï¼Œå®ƒå°±çŸ¥é“è¦è¿æ¥åˆ°å“ªä¸ª IPã€‚

![](img/0a2789445ca33ad1e696a5e03739b68c.png)

è¿è¡Œ **ifconfig** å‘½ä»¤

![](img/954f5da2f4e73e89bcd0a9e212283503.png)

ç¼–è¾‘åçš„ php-reverse-shell.php æ–‡ä»¶çš„å¤–è§‚ç‰‡æ®µ

å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æ”¹å˜ç«¯å£ï¼Œåªè¦è®°ä½ä½ æ”¹å˜çš„ç«¯å£ã€‚

ç‚¹å‡»æ›´æ–°ï¼Œæˆ‘ä»¬æ‰“å¼€ netcat å¬ä¸€ä¸‹`port 1234`ã€‚

ç°åœ¨æˆ‘ä»¬æ¥å¼€`archive.php`ã€‚æ£€æŸ¥å®ƒæ­£åœ¨è¿è¡Œä»€ä¹ˆä¸»é¢˜ï¼Œå¹¶æ‰“å¼€å¦‚ä¸‹æ‰€ç¤ºçš„ä¸»é¢˜ã€‚

![](img/a38313fb5aafa904dde4fe22b3aa61b9.png)

æ‰“å¼€**http://10 . 10 . 162 . 7/WP-content/themes/twenty fifth/archive . PHP**

![](img/d654b4d640d4718502aadee8c607875e.png)

æˆ‘ä»¬æ‰“å¼€äº†ä¸€ä¸ªåå‘å¤–å£³â€¦è€¶ï¼

![](img/12417f6a11aea6c1761c1975010eae35.png)![](img/4fd1777b22d4186abf7396352aa7209b.png)

æˆ‘ä»¬æ— æ³•è¯»å– key-2-of-3.txt

æˆ‘ä»¬éœ€è¦ç”¨æˆ·`robot`æ¥è¯»å–`key-2-of-3.txt`ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥è¯»å– password.raw-md5ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

![](img/6edecfe9191160f9360a5171c2240524.png)

è®©æˆ‘ä»¬ç”¨**å¼€è†›æ‰‹çº¦ç¿°**æ¥ç ´è§£è¿™ä¸ª MD5 æ•£åˆ—

![](img/4a1e34c00c1dacefb6ad31596d42c657.png)

## åˆ‡æ¢åˆ°ç”¨æˆ·æœºå™¨äºº

![](img/5a9e033d7ba6e49a617baeed643e7c9c.png)

è¦åˆ‡æ¢ç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç»ˆç«¯ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ **/bin/sh -i** æ‰“å¼€ç»ˆç«¯

![](img/ad03eea7e1d2c11181a6243c002becd3.png)

æ‰€ä»¥æˆ‘ä»¬ç”¨è¿™ç§æ–¹æ³•æ‰“å¼€ç»ˆç«¯

![](img/0f8a712765b0ba82a2f29e6793b0f301.png)

æ‰“å¼€ **key-2-of-3.txt**

**å…³é”®äºŒ:è¢«ä¿˜ï¼**

ç°åœ¨ï¼Œä¸ºäº†æ•è·ç¬¬ä¸‰ä¸ªæ ‡å¿—ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ° root ç”¨æˆ·ï¼Œå› æ­¤æˆ‘ä»¬å°†æ‰§è¡Œæƒé™æå‡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾å‡ºå“ªäº›ç¨‹åºçš„ SUID è‡³å°‘ä¸º 4000

![](img/9a2c5fd23b644d47291a28d3937d9d47.png)

æˆ‘ä»¬åœ¨è¿™é‡Œæ‰¾åˆ°äº†**nmap**

## ä½¿ç”¨ nmap çš„æƒé™æå‡

> Nmap è®¾ç½®äº† SUID ä½ã€‚å¾ˆå¤šæ—¶å€™ï¼Œç®¡ç†å‘˜å°† SUID ä½è®¾ç½®ä¸º nmapï¼Œä»¥ä¾¿å®ƒå¯ä»¥ç”¨æ¥æœ‰æ•ˆåœ°æ‰«æç½‘ç»œï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ root æƒé™è¿è¡Œå®ƒï¼Œæ‰€æœ‰çš„ nmap æ‰«ææŠ€æœ¯éƒ½ä¸èµ·ä½œç”¨ã€‚
> 
> ä½†æ˜¯ï¼Œnmap æ—§ç‰ˆæœ¬ä¸­æœ‰ä¸€é¡¹åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥åœ¨äº¤äº’æ¨¡å¼ä¸‹è¿è¡Œ nmapï¼Œè¯¥åŠŸèƒ½å…è®¸æ‚¨åˆ‡æ¢åˆ° shellã€‚å¦‚æœ nmap è®¾ç½®äº† SUID ä½ï¼Œå®ƒå°†ä»¥ root æƒé™è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒçš„äº¤äº’æ¨¡å¼è®¿é—®â€œrootâ€å¤–å£³ã€‚

![](img/c36f3fc332932ee8d973629c93b535d7.png)

**å…³é”®ä¸‰:è¢«ä¿˜ï¼**

æˆ‘åœ¨è¿™ä¸ªæˆ¿é—´é‡Œåº¦è¿‡äº†ä¸€æ®µç¾å¥½çš„æ—¶å…‰ï¼Œå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚TryHackMe æœ‰å¾ˆå¤šå…¶ä»–çš„æˆ¿é—´ï¼Œæ¯ä¸ªæˆ¿é—´éƒ½ä¸åŒï¼Œè¿™ä¹Ÿæä¾›äº†ä¸€ä¸ªå·¨å¤§çš„å­¦ä¹ æœºä¼šã€‚æˆ‘ä¼šè¯•ç€ä¸Šä¼ æˆ‘æ„Ÿå…´è¶£çš„æˆ¿é—´çš„æŠ¥é“ã€‚å½“ç„¶ï¼Œæˆ‘å¸Œæœ›ä½ ä¹Ÿèƒ½ä»è¿™ç¯‡æ–‡ç« ä¸­å­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚å¹²æ¯ï¼ğŸº

# ç°åœ¨ï¼Œè®©æˆ‘æ— è€»åœ°è¦æ±‚ä½ 

åœ¨ [Github](https://github.com/harshitm98) ã€ [Twitter](https://twitter.com/fake_batman_) ä¸Šå…³æ³¨æˆ‘ï¼Œåœ¨ [LinkedIn](https://linkedin.com/in/harshitm98) ä¸Šè¿æ¥ã€‚

# å‚è€ƒèµ„æ–™:

1.  æ‰“å¼€ PHP-reverse-shell for WordPress([https://pentarot . com/exploit-WordPress-back door-theme-pages/](https://pentaroot.com/exploit-wordpress-backdoor-theme-pages/))
2.  ä½¿ç”¨ Python æ‰“å¼€ç»ˆç«¯([https://blog . ROP nop . com/upgrading-simple-shell-to-full-interactive-ttys/](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/))
3.  ä½¿ç”¨ nmap([https://payatu.com/guide-linux-privilege-escalation](https://payatu.com/guide-linux-privilege-escalation))çš„æƒé™æå‡