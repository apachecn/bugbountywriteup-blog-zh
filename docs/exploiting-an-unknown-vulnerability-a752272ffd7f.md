# åˆ©ç”¨æœªçŸ¥æ¼æ´

> åŸæ–‡ï¼š<https://infosecwriteups.com/exploiting-an-unknown-vulnerability-a752272ffd7f?source=collection_archive---------0----------------------->

å¤§çº¦ 2 ä¸ªæœˆå‰ï¼Œæˆ‘åœ¨ä¸€ä¸ªå’¨è¯¢åº”ç”¨ç¨‹åºä¸­å‘ç°äº†è¿™ä¸ªæ¼æ´ã€‚ä»–ä»¬çš„å®‰å…¨å›¢é˜Ÿå‘Šè¯‰æˆ‘ï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºå·²ç»è¿‡æµ‹è¯•ï¼Œå¦‚æœæˆ‘èƒ½æ‰¾åˆ°ä¸€ä¸ªæ¼æ´ï¼Œä»–ä»¬å°†å¥–åŠ±å¥–é‡‘ã€‚å¯¹äºæ–°çš„ç›®æ ‡ï¼Œæˆ‘é¦–å…ˆåˆ†æåº”ç”¨ç¨‹åºå¹¶åˆ¶ä½œå…¶åŠŸèƒ½çš„æ•°æ®æµå›¾ï¼Œç„¶åå¼€å§‹å¯»æ‰¾æ¼æ´ã€‚æˆ‘å¹¿æ³›åœ°æµ‹è¯•é€»è¾‘æ¼æ´ï¼Œå› ä¸ºä»æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œæˆ‘çŸ¥é“ä¼šæœ‰ä¸€äº›å…³é”®çš„è½¬æ¢å¯èƒ½è¢«åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æˆ–æµ‹è¯•äººå‘˜é—æ¼ã€‚

æˆ‘æŠŠå®ƒå‘½åä¸ºâ€œæœªçŸ¥â€æ¼æ´ï¼Œå› ä¸ºæˆ‘æƒ³æŠŠå®ƒä½œä¸ºä¸€ä¸ªç»ƒä¹ å’Œè®°å½•ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰åœ¨æ ‡é¢˜ä¸­å†™ç»†èŠ‚ã€‚

æœ‰ä¸¤ç§ç±»å‹çš„ç”¨æˆ·è§’è‰²:ç›®æ ‡åº”ç”¨ç¨‹åºä¸­çš„é¡¾é—®å’Œå®¢æˆ·ã€‚è¯¥åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ä¸ºå„ç§å®¢æˆ·æä¾›å’¨è¯¢æœåŠ¡ã€‚

*   é¡¾é—®ä»¬ä»¥ç¡¬å¸å½¢å¼æ”¶å–æœåŠ¡è´¹ã€‚

```
**#** **consultant request**POST /set/fee/{"value": 5, "timing":2}
```

*   å®¢æˆ·è®¿é—®é¡¾é—®çš„æ—¶é—´è¡¨ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ—¶é—´æ®µå¹¶é¢„è®¢è¯¥æ—¶é—´ï¼Œç¡¬å¸å°†æ ¹æ®æ—¶é—´è¡¨ä¸­æ˜¾ç¤ºçš„ç›¸åº”æ—¶é—´æ®µçš„è´¹ç”¨ä»å®¢æˆ·çš„å¸æˆ·ä¸­æ‰£é™¤ã€‚

```
**#** **client request**POST /consultant_username/book{"timing":2}
```

åœ¨è¿›ä¸€æ­¥é˜…è¯»ä¹‹å‰ï¼Œæˆ‘å»ºè®®ä½ ä»¬å†™ä¸‹è‡ªå·±çš„æµ‹è¯•ç”¨ä¾‹æˆ–è€…å¼€å‘ä¸Šè¿°åŠŸèƒ½çš„æ–¹æ³•ã€‚ç¥æ‚¨å¥½è¿ğŸ‘

![](img/19d1f770b6d81353db72ed50cbc15764.png)

æˆ‘æƒ³å‡ºäº†ä»¥ä¸‹æµ‹è¯•æ¡ˆä¾‹ğŸ¤”ã€‚

1.  Sqliã€å‘½ä»¤æ³¨å…¥ç­‰æ³¨å…¥æ¼æ´
2.  ä¿®æ”¹å†…å®¹ç±»å‹å¹¶å°†æ•°æ®è¯·æ±‚åˆ° xml ä»¥æµ‹è¯• XML æ³¨å…¥
3.  ç”¨æ›´å°‘çš„ç¡¬å¸é¢„è®¢é¡¾é—®çš„æ›´é«˜ä»·å€¼çš„æ—¶é—´æ®µ
4.  ä»**é¡¾é—®è¯·æ±‚**ä¸­æ³¨å…¥**å€¼**å‚æ•°ï¼Œå¹¶åœ¨**å®¢æˆ·è¯·æ±‚**ä¸­ä½¿ç”¨
5.  å‚æ•°æ±¡æŸ“é€šè¿‡æ³¨å…¥ä¸¤ä¸ª**å®šæ—¶**å€¼åœ¨**å®¢æˆ·ç«¯**è¯·æ±‚**ä¸­**
6.  ä½¿ç”¨**å®¢æˆ·ç«¯** **è¯·æ±‚**ä¸­çš„**è®¡æ—¶**å€¼è¿›è¡ŒåŸºäºæ•°ç»„çš„æ³¨å…¥ï¼Œå³{"timing[0]":2}
7.  é€šè¿‡å°† POST æ”¹ä¸º PUT ç¯¡æ”¹ HTTP æ–¹æ³•
8.  é€šè¿‡æ’­æ”¾å¤šçº¿ç¨‹**å®¢æˆ·ç«¯** **è¯·æ±‚**é¢„çº¦åŒä¸€ä¸ªé¡¾é—®çš„ä¸¤ä¸ªæˆ–å¤šä¸ªæ—¶é—´æ®µ(ç«äº‰æ¡ä»¶)
9.  é€šè¿‡æ’­æ”¾å¤šçº¿ç¨‹**å®¢æˆ·ç«¯**è¯·æ±‚**è¯·æ±‚**é¢„çº¦ä¸¤ä¸ªä¸åŒçš„é¡¾é—®æ—¶é—´æ®µ(ç«äº‰æ¡ä»¶)

æˆ‘æ•¢è‚¯å®šï¼Œä½ å¯èƒ½å·²ç»æƒ³å‡ºäº†ä¸åŒçš„æµ‹è¯•æ¡ˆä¾‹ï¼Œæ‰€ä»¥è¯·åœ¨ä¸‹é¢è¯„è®ºä½ çš„æµ‹è¯•æ¡ˆä¾‹ã€‚

ä¸å¹¸çš„æ˜¯ï¼Œä¸Šè¿°æµ‹è¯•æ¡ˆä¾‹éƒ½ä¸é€‚åˆæˆ‘ğŸ˜¥ã€‚å¯èƒ½æ˜¯ä»–ä»¬çš„å®‰å…¨å›¢é˜Ÿç¼“è§£äº†è¿™äº›æ¼æ´ï¼Œæˆ–è€…æ˜¯æœ‰ç»éªŒçš„å¼€å‘äººå‘˜æ„å»ºäº†åº”ç”¨ç¨‹åºã€‚

ç¬¬äºŒå¤©ï¼Œæˆ‘å†æ¬¡æŸ¥çœ‹ï¼Œè¿™æ¬¡æˆ‘çš„æ³¨æ„åŠ›æ›´å¤šåœ°é›†ä¸­åœ¨é¢„è®¢è¯·æ±‚ä¸Šï¼Œå› ä¸ºè¯·æ±‚ä¸­æ²¡æœ‰ä¼ é€’ç¡¬å¸ï¼Œåœ¨æäº¤**å®¢æˆ·è¯·æ±‚**åï¼Œç¡¬å¸ä¼šè‡ªåŠ¨ä»å®¢æˆ·çš„è´¦æˆ·ä¸­æ‰£é™¤ã€‚

```
POST /consultant_username/book{"timing":2}
```

**å¦‚æœé¡¾é—®åœ¨å®¢æˆ·é¢„å®šæ—¶é—´æ®µ**ä¹‹å‰å°†è´¹ç”¨è°ƒé«˜ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚æˆ‘å¾ˆå…´å¥‹ğŸ¤©æˆ‘è®¤ä¸ºè¿™åº”è¯¥è¡Œå¾—é€šï¼Œä½†å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯è¡Œä¸é€šã€‚å› ä¸ºå®ƒæ˜¾ç¤ºäº†â€œè¿™ä¸ªä½ç½®çš„é¡¾é—®è´¹æ˜¯ 10 è‹±é•‘â€çš„ä¿¡æ¯ã€‚

![](img/bec71aeb4960da36ab474cfb4d22d215.png)

æˆ‘æœ¬æ¥æ‰“ç®—æ”¾å¼ƒï¼Œä½†æ˜¯**ç«äº‰æ¡ä»¶**çš„æƒ³æ³•å‡ºç°åœ¨æˆ‘çš„è„‘æµ·ä¸­ï¼Œä¸ºäº†æµ‹è¯•å®ƒï¼Œæˆ‘å‘ web æœåŠ¡å™¨å‘é€äº†å¤šçº¿ç¨‹è¯·æ±‚ï¼Œæ¯æ¬¡åœ¨å››ä¸ªä¸åŒçš„è¯·æ±‚ä¸­æœ‰å››ä¸ªä¸åŒçš„å’¨è¯¢è´¹(5ï¼Œ15ï¼Œ15ï¼Œ5)ï¼Œå¹¶å°†è¿™äº›è¯·æ±‚æ”¾åœ¨ä¸€ä¸ªå¾ªç¯ä¸­åŠå°æ—¶ã€‚å½“å®¢æˆ·åœ¨æ­¤æœŸé—´è®¿é—®é¡¾é—®æ—¶é—´çº¿æ—¶ï¼Œæœ‰ 50%çš„æœºä¼šå®¢æˆ·å°†æœ€ç»ˆæ”¯ä»˜æ›´é«˜çš„è´¹ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘æˆåŠŸåœ°åˆ©ç”¨äº†ğŸ˜„è¿™ç§æ¼æ´é€šè¿‡å¿«é€Ÿæ”¹å˜å’¨è¯¢ä»·æ ¼ã€‚åº”ç”¨ç¨‹åºä¹Ÿæœ‰ä¸€ä¸ªæä¾›åŠŸèƒ½ï¼Œå…¶ä¸­é¡¾é—®å¯ä»¥è®¾ç½®ä¸€å®šæ—¶æœŸçš„æŠ˜æ‰£ã€‚

# **æ”»å‡»æµ**

1.  é¡¾é—®ä¸ºä»»ä½•æ—¶é—´æ®µâ€œxâ€è®¾ç½® 5 ä¸ªç¡¬å¸çš„è´¹ç”¨ã€‚
2.  é¡¾é—®è®¾å®šæŠ¥ä»·å‘¨æœŸï¼Œå³ä¸€å¤© 30-60 åˆ†é’Ÿã€‚
3.  å®¢æˆ·åœ¨æŠ¥ä»·æœŸé—´è®¿é—®é¡¾é—®æ—¶é—´è¡¨ã€‚
4.  é¡¾é—®é€šè¿‡å¾ªç¯æ’­æ”¾å¤šçº¿ç¨‹**é¡¾é—®è¯·æ±‚**å¿«é€Ÿæ”¹å˜å’¨è¯¢ä»·æ ¼ï¼Œå¹¶å‘é€ç»™æœåŠ¡å™¨ã€‚
5.  å®¢æˆ·é€šè¿‡å‘æœåŠ¡å™¨å‘é€é¢„è®¢è¯·æ±‚æ¥æ”¯ä»˜è´¹ç”¨ã€‚
6.  é¢å¤–çš„ç¡¬å¸ä¼šä»å®¢æˆ·è´¦æˆ·ä¸­æ‰£é™¤ã€‚

# **å½±å“**

é¡¾é—®å¯ä»¥æ¬ºéª—å®¢æˆ·æ”¯ä»˜æ¯”ä»–ä»¬çš„æœåŠ¡æ—¶é—´è¡¨ä¸­æ˜¾ç¤ºçš„æ›´é«˜çš„é‡‘é¢ã€‚

# **å¤–å–**

ä½œä¸ºç»´æŠ¤è€…ï¼Œåˆ¶ä½œä¸€ä¸ªæ¼æ´æ¸…å•ï¼Œå¹¶å¯¹åº”ç”¨ç¨‹åºä¸­å®ç°çš„æ¯ä¸ªåŠŸèƒ½è¿›è¡Œæµ‹è¯•ã€‚åº”è¯¥å®ç°åŸºäºé€Ÿç‡é™åˆ¶å’Œç«äº‰æ¡ä»¶çš„é”å®šç³»ç»Ÿæ¥é˜²æ­¢è¿™ç§ç±»å‹çš„æ¼æ´ã€‚

éšç€åº”ç”¨ç¨‹åºåŠŸèƒ½çš„å¢é•¿ï¼Œå…¶å¤æ‚æ€§å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„è®¾è®¡ã€å¼€å‘æˆ–å®‰å…¨æµ‹è¯•é˜¶æ®µé”™è¿‡ä¸€äº›æµ‹è¯•ç”¨ä¾‹çš„æœºä¼šä¹Ÿè¶Šæ¥è¶Šå¤šã€‚é€šè¿‡åå¤æŸ¥çœ‹è¯·æ±‚å†å²æ¥åˆ†æåº”ç”¨ç¨‹åºåŠŸèƒ½ï¼Œäº†è§£åº”ç”¨ç¨‹åºä¸­çš„æ•°æ®æµç­‰ã€‚å°†ä½ çš„ç²¾åŠ›å’Œæ—¶é—´èŠ±åœ¨æ„å»ºæ›´æ™ºèƒ½çš„æµ‹è¯•ç”¨ä¾‹ä¸Šï¼Œä»¥æ‰“ç ´åº”ç”¨ç¨‹åºçš„ç”¨ä¾‹ã€‚

éå¸¸æ„Ÿè°¢ï¼

å­¦ä¹ ã€æ„å»ºå’Œçªç ´ï¼

> æœ€åˆå‘å¸ƒäº:[https://abhibundela . com/2018/09/25/exploining-an-unknown-vulnerability/](https://abhibundela.com/2018/09/25/exploiting-an-unknown-vulnerability/)