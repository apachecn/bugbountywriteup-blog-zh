# å­¦é™¢:é»‘å®¢ç›’å­æ¼”ç»ƒ

> åŸæ–‡ï¼š<https://infosecwriteups.com/academy-hackthebox-walkthrough-9102c5d79dee?source=collection_archive---------0----------------------->

## æè¿°

![](img/6b69bde9c682359c9df2b42c1d029fee.png)

å¦ä¸€ä¸ªæ¥è‡ª [**çš„æ˜“ VM å¦‚ä»–ä»¬æ‰€è¯´çš„ HackTheBox**](https://app.hackthebox.eu/machines/297) ã€‚æˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶åƒäº†ç‚¹è‹¦å¤´ï¼Œå¹¶è®¤ä¸ºå®ƒæœ‰ç‚¹éš¾ï¼Œä½†æˆ‘å­¦åˆ°äº†ä¸€äº›æ–°ä¸œè¥¿ã€‚å…¨æ‹œ[*egre 55*](https://app.hackthebox.eu/users/1190)&&[*mrb3n*](https://app.hackthebox.eu/users/2984)æ‰€èµã€‚åƒå¾€å¸¸ä¸€æ ·ï¼Œåœ¨/etc/hosts æ–‡ä»¶ä¸­æ·»åŠ  academy.htbï¼Œå°±å¯ä»¥å¼€å§‹äº†ã€‚

> è·å¾—çš„çŸ¥è¯†

1.  åˆ—ä¸¾
2.  ä½¿ç”¨æ‰“å—åˆ†ææŠ¥å¤´
3.  ä½¿ç”¨ Metasploit è·å¾—ç«‹è¶³ç‚¹
4.  é€šè¿‡ composer æå‡æƒé™

> ç«¯å£æ‰«æ

è¿è¡Œ Nmap æ‰«æä»¥äº†è§£ç”¨äºæšä¸¾çš„å¼€æ”¾ç«¯å£ã€‚

![](img/19ad9a9553b7d9db31868b7478f1ddf5.png)

> ç½‘ç»œä¾¦å¯Ÿ

æ‰€ä»¥æˆ‘ä»¬å…ˆåˆ—ä¸¾ä¸€ä¸‹ 80 ç«¯å£ã€‚æˆ‘å†³å®šå¯åŠ¨ä¸€ä¸ª gobuster æ‰«æï¼Œå¾—åˆ°äº†ä¸€äº›æœ‰ç”¨çš„ä¸œè¥¿ã€‚

![](img/9411a1b20dfc82d5fc85104e1cfcf29b.png)

è¿™ä¹ˆå¤šã€‚php é¡µé¢ã€‚å…ˆåœ¨å¹³å°ä¸Šæ³¨å†Œå§ã€‚æ³¨å†Œåï¼Œæˆ‘ä»¬è¢«é‡å®šå‘åˆ°ä¸€ä¸ª login.phpã€‚è¾“å…¥å‡­æ®ï¼Œæˆ‘ä»¬æˆåŠŸç™»å½•ã€‚å¹³å°é‡Œæ²¡ä»€ä¹ˆå¥½ç©çš„ã€‚

ç„¶åæˆ‘å†³å®šæ‹¦æˆªæ•°æ®ï¼Œå½“æˆ‘ä»¬åœ¨å¹³å°ä¸Šæ³¨å†Œæ—¶ï¼Œé‡åˆ°äº†æ–°çš„ä¸œè¥¿" **roleid =0** "ã€‚

![](img/45335c08a910d45044f1a4695b308fa8.png)

è¿™ä¸€æ¬¡ï¼Œæˆ‘å°†å€¼æ›´æ”¹ä¸ºâ€œ1â€å¹¶è½¬å‘æ•°æ®ï¼Œä½†æˆ‘å†æ¬¡è¢«é‡å®šå‘åˆ° login.phpã€‚

ç°åœ¨æˆ‘é‡å¤äº†åŒæ ·çš„è¿‡ç¨‹ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰å» login.phpï¼Œè€Œæ˜¯å»äº† admin.phpï¼Œç„¶åæˆ‘ä»¬å°±æœ‰äº†ä¸€äº›ç«‹è¶³ç‚¹ã€‚

![](img/9269bde636f3dc12d40a68302dddfcb1.png)

å°†è¿™ä¸ª[subdomin].academy.htb æ·»åŠ åˆ°/etc/hosts æ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­è®¿é—®å®ƒã€‚

ç¯é¡¾é¡µé¢ï¼Œæˆ‘å¾—åˆ°äº†ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚ APP_NAME=Laravel å’Œ APP_KEY=â€¦â€¦â€¦â€¦â€¦â€¦

åœ¨ç½‘ä¸Šæœç´¢æ—¶ï¼Œæˆ‘å‘ç°äº†æ˜“å— **RCE æ”»å‡»çš„ [**Laravel æ¼æ´**](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/http/laravel_token_unserialize_exec.rb) ã€‚**æ‰“å¼€åå°å­ Metasploitï¼Œæœç´¢ Laravel æ¼æ´ã€‚è®¾ç½®é€‰é¡¹ã€‚

![](img/f7e941d7bd80aeaa9bee258b876147db.png)

ç„¶ååˆ©ç”¨æ¼æ´ï¼Œç„¶åæˆ‘ä»¬å¾—åˆ°äº†ä½çº§ç‰¹æƒã€‚

![](img/b2a968087eecaf6c2face4a3e4337b47.png)

> **æ¨ªå‘æƒé™æå‡**

åˆ—å‡ºä¸»ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆå¤šç”¨æˆ·ã€‚æˆ‘æµªè´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œç„¶åæ„è¯†åˆ° [**å›¾åƒ**](https://cdn-images-1.medium.com/max/1000/1*DiKwRKATuVuBY4XNFWwUQQ.png) æåˆ°äº†ç”¨æˆ· cry0I1t3ã€‚å› æ­¤ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å°†æˆ‘ä»¬çš„æƒé™æ¨ªå‘æå‡åˆ°ç”¨æˆ· cry..t3ã€‚è€—å°½äº†æˆ‘çš„å¤§è„‘ï¼Œç„¶åæˆ‘æœç´¢äº† Laravel [**é‡è¦æ–‡ä»¶**](https://www.tutorialspoint.com/laravel/laravel_configuration.htm) **ã€‚**æ‰“å¼€æ–‡ä»¶ç»™æˆ‘ç”¨æˆ·cry0I1t3 çš„å¯†ç ã€‚

ç°åœ¨åˆ‡æ¢åˆ°ç”¨æˆ· cry0I1t3ï¼Œæ£€æŸ¥ä»–æ˜¯å¦æœ‰ä»»ä½• sudo ç‰¹æƒã€‚

![](img/6d86f4817701891964ef3d6119c4caf1.png)

å› ä¸ºè¿™ä¸ªç”¨æˆ·ä¸åœ¨ sudoers åˆ—è¡¨ä¸­ï¼Œæ‰€ä»¥æˆ‘å†³å®šæŸ¥æ‰¾ä¸ç”¨æˆ· mrb3n ç›¸å…³çš„æ–‡ä»¶ã€‚

**æ³¨æ„:-** é€šè¿‡ SSH ç™»å½•ç”¨æˆ· cry0I1t3ï¼Œä½“éªŒæ›´ä½³ã€‚

åœ¨æœç´¢æ–‡ä»¶åï¼Œæˆ‘å†³å®šæŸ¥çœ‹è¿™ä¸ªç”¨æˆ·çš„â€œç»„â€ä¿¡æ¯ï¼Œæˆ‘å‘ç°è¿™ä¸ªç”¨æˆ·åœ¨â€œadmâ€ç»„ä¸­ã€‚è½¬åˆ°/var/log/audit å¹¶æœç´¢ mrb3n å‡­æ®ã€‚(æç¤º-ä½¿ç”¨ grep)

ç°åœ¨åˆ‡æ¢åˆ°ç”¨æˆ· mrb3nâ€¦

![](img/403c065c34f977bf0334009eb839f396.png)

â€¦å¹¶æ£€æŸ¥ä»–/å¥¹æ‹¥æœ‰ä»€ä¹ˆ sudo æƒé™ã€‚

![](img/1ed966bfadd57f7cde364fc666ce53b3.png)

> **å‚ç›´æƒé™æå‡**

å› æ­¤ï¼Œè¯¥ç”¨æˆ·å¯ä»¥è¿è¡Œâ€œcomposerâ€å‘½ä»¤ã€‚è®¿é—® [**GTFobins**](https://gtfobins.github.io/#composer) è¿›è¡Œæƒé™å‡çº§ã€‚

![](img/e8dd48eff150494f989697879c806b09.png)

å˜£æˆ‘ä»¬åœ¨ **r** ğŸ¤ ğŸ¥³ **t.**

**æ³¨æ„:-** æ‰€ä»¥ï¼Œåœ¨å¾—åˆ°æ ¹å“ˆå¸Œä¹‹åï¼Œæˆ‘æµè§ˆäº†æ‰€æœ‰åŠ å¯†çš„æ–‡ç« ï¼Œå¹¶ä¸”å­¦åˆ°äº†ä¸€äº›æ–°çš„ä¸œè¥¿ã€‚

ä½¿ç”¨ ssh-keygen ç”Ÿæˆä¸€å¯¹ SSH å¯†é’¥ã€‚ç°åœ¨å¤åˆ¶å…¬é’¥(id_rsa.pub)å¹¶åƒè¿™æ ·ç²˜è´´ğŸ‘‡(x â†’ SSH)

![](img/5fbfe6b96e9c5a9458e2c5d3209d462b.png)

ç°åœ¨è¿è¡Œ composerï¼Œå®ƒä¼šå°†å¯†é’¥æ·»åŠ åˆ°/root/ã€‚ssh/authorized _ keyã€‚

![](img/5f46aed8eb9cd84501cb934486fe9aa5.png)

ç°åœ¨å°†å…¬é’¥(id_rsa)çš„æƒé™æ›´æ”¹ä¸º 600ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å†…å®¹ğŸ‘‡ä»¥è·å¾— root è®¿é—®æƒé™ã€‚**è®¿é—®æ‰€æœ‰æ ‡å¿—**ã€‚

![](img/9e4ffe5cde437fd76863226e59b57f22.png)

å¦‚éœ€æ›´å¤šæ¼”ç»ƒï¼Œè¯·ç»§ç»­å…³æ³¨â€¦

# åœ¨ä½ èµ°ä¹‹å‰

è®¿é—®æˆ‘çš„ Funbox ç³»åˆ—æ¼«æ¸¸çš„:-

[](https://shubham-singh.medium.com/doctor-htb-walkthrough-70bcb9eedefd) [## åŒ»ç”Ÿ:HTB æ¼”ç»ƒ

### æè¿°

shubham-singh.medium.com](https://shubham-singh.medium.com/doctor-htb-walkthrough-70bcb9eedefd) [](https://github.com/Mr-Lazzy/Vulnhub_Walkthrough) [## æ‡’äººå…ˆç”Ÿ/Vulnhub _ æ¼”ç»ƒ

### åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªå¸æˆ·ï¼Œä¸º Mr-lazy/Vulnhub _ walk through å¼€å‘åšè´¡çŒ®ã€‚

github.com](https://github.com/Mr-Lazzy/Vulnhub_Walkthrough)