# â—ï¸Capture ä»¥å¤ªâ—ï¸â€”ä»£å¸é”€å”®[éš¾åº¦=ä¸­ä½]

> åŸæ–‡ï¼š<https://infosecwriteups.com/%EF%B8%8Fcapture-the-ether-%EF%B8%8F-token-sale-difficulty-low-medium-adc2928bbcc9?source=collection_archive---------5----------------------->

[æ³¨æ„] â€”å¦‚æœä½ ç›´æ¥é˜…è¯»è¿™ç¯‡åšå®¢ï¼Œè€Œæ²¡æœ‰å®é™…å‚ä¸è¿™ä¸ªæŒ‘æˆ˜ï¼Œå®ƒå¯¹ä½ æ²¡æœ‰å¸®åŠ©ã€‚æˆ‘è¯·æ±‚ä½ å°½æœ€å¤§åŠªåŠ›ï¼Œå¦‚æœä½ é¢ä¸´ä»»ä½•å›°éš¾ï¼Œå°±å›æ¥ã€‚

> **ç®€ä»‹**:

ä½ å¥½ï¼ŒHackersğŸ¥°ï¼Œæ¬¢è¿å›åˆ°æˆ‘ä»¬çš„ Web3 å®‰å…¨ä¸–ç•Œã€‚ä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºâ€œæ•°å­¦éƒ¨åˆ†â€çš„ç¬¬ä¸€ä¸ªæŒ‘æˆ˜â€”â€”ä»£å¸é”€å”®ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ä¸ªæŒ‘æˆ˜å±äºä¸­ä½çº§åˆ«ã€‚ä½†æ˜¯ï¼Œå¯èƒ½å› äººè€Œå¼‚ã€‚

![](img/b4c6b8586c498f930fff3186ce15f9e4.png)

> **åœ¨å°è¯•è¿™ä¸ªæŒ‘æˆ˜ä¹‹å‰ï¼Œä½ éœ€è¦çŸ¥é“äº›ä»€ä¹ˆï¼Ÿ**

æˆ‘çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€é‡è¦çš„å»ºè®®æ˜¯æµè§ˆâ€œæ™ºèƒ½åˆåŒç¨‹åºå‘˜â€çš„è§†é¢‘ï¼Œä»–è¯¦ç»†è§£é‡Šäº†â€œæº¢å‡ºå’Œä¸‹æº¢â€æ¼æ´ã€‚

> **ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æˆ‘ä»¬çš„æŒ‘æˆ˜:**

é—®é¢˜è¯´ï¼Œâ€œè¿™ä¸ªä»£å¸åˆçº¦å…è®¸ä½ ä»¥æ¯ä»¥å¤ª 1 ä»£å¸çš„å¹³å‡æ±‡ç‡ä¹°å–ä»£å¸ã€‚

åˆåŒå¼€å§‹æ—¶ä½™é¢ä¸º 1 ä»¥å¤ªã€‚çœ‹çœ‹ä½ èƒ½ä¸èƒ½å¸¦èµ°ä¸€äº›ã€‚"

ç®€å•æ¥è¯´ï¼Œ**è¿™æ˜¯ä¸€ä»½äº¤æ¢åˆåŒï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§æŸç§ç‰¹å®šçš„æ¯”ä¾‹(1:1)** ä¹°å–ä»£å¸ã€‚

*   æ¯”å¦‚**å¦‚æœæˆ‘æƒ³ä¹° 10 ä¸ªä»£å¸ï¼Œæˆ‘éœ€è¦å‘äº¤æ˜“æ‰€ç¼´çº³ 10 ä¸ª ETHã€‚åŒæ ·çš„ï¼Œå¦‚æœæˆ‘æŒæœ‰ 100 æšä»£å¸ï¼Œå–æ‰åï¼Œæˆ‘çš„è´¦æˆ·é‡Œä¼šæœ‰ 100 æšä»£å¸ã€‚**
*   æœ€åˆåˆåŒæŒæœ‰ 1 ETHï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿åˆåŒä½™é¢å°‘äº 1 ETHã€‚

![](img/a578835836ea84227d66a203a5d2e83f.png)

**å®åˆ©^0.8.0 æ–‡ä»¶**

â€œå¦‚æœä½ æ¸…æ¥šåœ°è§‚å¯Ÿç¬¬ä¸€è¡Œï¼Œå®ƒè¯´ï¼Œå¯¹äº uint32ï¼Œå®ƒèƒ½å®¹çº³çš„æœ€å¤§å€¼æ˜¯ 2-1ã€‚â€

*   å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªå€¼å¢åŠ  1 å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå®ƒå½’é›¶ã€‚

> **åˆåŒè¯„å®¡:**

```
pragma solidity ^0.4.21;

contract TokenSaleChallenge {
    mapping(address => uint256) public balanceOf;
    uint256 constant PRICE_PER_TOKEN = 1 ether;

    function TokenSaleChallenge(address _player) public payable {
        require(msg.value == 1 ether);
    }

    function isComplete() public view returns (bool) {
        return address(this).balance < 1 ether;
    }

    function buy(uint256 numTokens) public payable {
        require(msg.value == numTokens * PRICE_PER_TOKEN);

        balanceOf[msg.sender] += numTokens;
    }

    function sell(uint256 numTokens) public {
        require(balanceOf[msg.sender] >= numTokens);

        balanceOf[msg.sender] -= numTokens;
        msg.sender.transfer(numTokens * PRICE_PER_TOKEN);
    }
}
```

*   é¦–å…ˆï¼Œæœ‰ 3 ä¸ªå‡½æ•°(ä¸åŒ…æ‹¬æ„é€ å‡½æ•°)ï¼Œå³â€œisComplete()ã€buy()ã€sell()â€ã€‚å¦‚æœæŸ¥çœ‹çŠ¶æ€å˜é‡ï¼Œä¼šå‘ç°æœ‰ä¸€ä¸ªæ˜ å°„ï¼Œå…¶ä¸­å­˜å‚¨äº†æ¯ä¸ªåœ°å€æŒæœ‰çš„ä»¤ç‰Œæ•°ã€‚å’Œè®¾ç½®ä¸º 1 çš„å¸¸é‡å˜é‡ã€‚
*   å¦‚æœä½ æ“…é•¿ç¨³å¥ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ°â€œæ²¡æœ‰å¯é‡å…¥æ€§æ¼æ´çš„ç—•è¿¹â€ã€‚**ä½ åº”è¯¥è®°ä½â€œ0.8.0 ä¹‹å‰çš„æ‰€æœ‰ç‰ˆæœ¬éƒ½å®¹æ˜“å‡ºç°ä¸Šæº¢/ä¸‹æº¢é—®é¢˜ï¼Œé™¤éå®ƒä»¬ä½¿ç”¨æ•°å­¦åº“ã€‚â€**
*   åœ¨ buy()å‡½æ•°ä¸­ï¼Œå®ƒçš„è¾“å…¥æ˜¯â€œuint256 â€,è¿™æ„å‘³ç€å®ƒèƒ½å®¹çº³çš„æœ€å¤§å€¼æ˜¯(2 âµâ¶ â€” 1)ã€‚å¦‚ä½ æ‰€çŸ¥ï¼ŒåˆåŒæ˜¯ 1:1 çš„æ¯”ä¾‹ï¼Œæˆ‘ä»¬ä¸èƒ½é€é‚£ä¹ˆå¤šä¹™é†šã€‚

[æ³¨æ„] â€” EVM(ä»¥å¤ªåŠè™šæ‹Ÿæœº)å°†ä»»ä½•å€¼è½¬æ¢ä¸ºå…¶ä½çº§å€¼ï¼Œè¿™æ„å‘³ç€â€œ1 eth è½¬æ¢ä¸º 10 â¸çš„ä½çº§å€¼â€

*   ç°åœ¨è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„å£°æ˜ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸èƒ½å‘é€ uint256 å€¼ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬å‘é€è¿™ä¸ªå‘¢ï¼Ÿ**ã€è§£é‡Šåˆ°åº•ã€‘**

**:2âµâ¶â€”1/10â¸**:t0ã€‘

åœ¨ buy()å‡½æ•°ä¸Šä¼ é€’è¿™ä¸ªå€¼æ—¶ï¼Œå®ƒå†æ¬¡ä¹˜ä»¥ 10 â¸ï¼Œè¿™å¯¼è‡´æº¢å‡ºé—®é¢˜ã€‚ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦åœ¨ wei ä¸­å‘é€ç¡®åˆ‡çš„ eth æ•°é‡ï¼Œä»¥ä½¿è¿™ä¸ªæ“ä½œæˆåŠŸï¼Œä¹Ÿå°±æ˜¯`415992086870360064 wei(0.4 eth)`

> **åˆ©ç”¨æ—¶é—´:**

*   è°ƒç”¨ buy()å‡½æ•°ï¼Œå–å€¼ä¸º`**115792089237316195423570985008687907853269984665640564039459**` ï¼Œå‘é€ msg.value ä¸º`415992086870360064 wei`ã€‚
*   ç°åœ¨ï¼Œå¦‚æœæ‚¨æ£€æŸ¥æ‚¨çš„ä½™é¢ï¼Œç»“æœæ˜¯æœ€å¤§çš„æ•°å­—(uint256 å€¼)ã€‚
*   è¦å®Œæˆæœ¬éƒ¨åˆ†ï¼Œå–å‡º 1 ä¸ª ETHï¼Œæœ€ç»ˆä½¿åˆçº¦æŒæœ‰é‡å°‘äº 1 ä¸ª ETHã€‚

> **æœ‰ä»€ä¹ˆå…·ä½“åŸå› å—ï¼Ÿ**

ä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä¼ é€’ç²¾ç¡®çš„å€¼ã€‚ä½ æ˜¯æ€ä¹ˆå¾—åˆ°è¿™ä¸ªç‰¹å®šå€¼çš„ï¼Ÿä¸ºä»€ä¹ˆå³ä½¿ä½ ç»™å‡ºä¸€ä¸ªå°äº 1 çš„æ•°ä¹Ÿä¸èµ·ä½œç”¨ï¼Ÿâ€”è¿™æ˜¯ç­”æ¡ˆ

> "**ä¸€ä¸ª *uint256* å˜é‡çš„æœ€å¤§å€¼ä¸º 2 * * 256â€“1ã€‚æ‰€ä»¥ä¸ºäº†è®© *msg.value* æº¢å‡ºï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ *numTokens* ä¹˜ä»¥ 10**18 å¤§äº 2 * * 256â€“1ã€‚ä¸ºäº†å¾—åˆ°è¯¥å€¼ï¼Œæˆ‘ä»¬å°† 2 * * 256â€“1 é™¤ä»¥ 10**18ï¼Œå¾—åˆ°:11579208923731619542357098500868790785326998465640564039458(èˆå…¥å€¼)**
> 
> â€œæˆ‘ä»¬éœ€è¦è®¡ç®—å‡º *msg.value* æº¢å‡ºçš„é‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨å‘¼å«ä¸­å‘é€æ­£ç¡®çš„ä¹™é†šé‡ã€‚è¦è®¡ç®—æº¢å‡ºçš„æ•°é‡ï¼Œä»æˆ‘ä»¬åˆšåˆšè®¡ç®—å‡ºçš„å·¨å¤§æ•°å­—ä¸­å‡å» 2 * * 256â€“1ã€‚è¿™æ ·æˆ‘ä»¬å°±å‰©ä¸‹ 415992086870360064 é­ï¼Œè¿™æ˜¯æˆ‘ä»¬è°ƒç”¨ *buy()* æ—¶éœ€è¦å‘é€çš„é­æ•°ã€‚

> æˆ‘ä»€ä¹ˆæ—¶å€™èƒ½å†è§åˆ°ä½ ï¼Ÿ

å—¯ï¼Œæœ€æœ‰å¯èƒ½çš„æ˜¯æˆ‘ä¼šåŠªåŠ›ä¿æŒä¸€è‡´ï¼Œä½†æˆ‘ä¸èƒ½ä¿è¯ï¼Œå› ä¸ºæˆ‘çš„è‘£äº‹ä¼šè€ƒè¯•çœŸçš„å¾ˆè¿‘ã€‚æˆ‘ä¼šç­‰å¾…ä½ çš„çˆ±å’Œæ”¯æŒï¼Œè®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ å’Œæˆé•¿:)

***ã€éšæ—¶è”ç³»æˆ‘ã€‘~***

*   insta gramâ€”[gow tham _ pon nana](https://instagram.com/Gowtham_Ponnana)
*   Twitterâ€”[gow tham _ pon nana](https://twitter.com/Gowtham_Ponnana)
*   LinkedInâ€”[gow tham-Ponnana](https://www.linkedin.com/in/gowtham-ponnana/)
*   é‚®ä»¶â€”gowtham.official45@gmail.com

![](img/9c295b4ff45df4882a29d51236b282e2.png)

## æ¥è‡ª Infosec çš„æŠ¥é“:Infosec æ¯å¤©éƒ½æœ‰å¾ˆå¤šå†…å®¹ï¼Œå¾ˆéš¾è·Ÿä¸Šã€‚[åŠ å…¥æˆ‘ä»¬çš„æ¯å‘¨ç®€è®¯](https://weekly.infosecwriteups.com/)ä»¥ 5 ç¯‡æ–‡ç« ã€4 æ¡çº¿ç´¢ã€3 ä¸ªè§†é¢‘ã€2 ä¸ª GitHub Repos å’Œå·¥å…·ä»¥åŠ 1 ä¸ªå·¥ä½œæé†’çš„å½¢å¼å…è´¹è·å–æ‰€æœ‰æœ€æ–°çš„ Infosec è¶‹åŠ¿ï¼