# TLDRÂ·CTF æ’°æ–‡:Vulnversity/TryHackMe

> åŸæ–‡ï¼š<https://infosecwriteups.com/tldr-ctf-write-up-vulnversity-tryhackme-ab814501b1ef?source=collection_archive---------5----------------------->

## CTF å†™ä¸‹ä½ åœ¨è¿›å…¥æˆ¿é—´å‰åº”è¯¥é˜…è¯»çš„å†…å®¹

![](img/a9698e2905ab37ac78dc0663485cc6a5.png)

æ¥è‡ª tryhackme.com çš„ç…§ç‰‡

# ç³»åˆ—ç®€ä»‹

ybersecurity ä¸€ç›´æ˜¯æˆ‘æƒ³æ¶‰è¶³çš„é¢†åŸŸï¼Œæˆ–è€…è‡³å°‘æ˜¯å°†æˆ‘çš„æ•°æ®ç§‘å­¦æŠ€èƒ½åº”ç”¨åˆ°å…¶ä¸­ã€‚ä¸æ˜¯å› ä¸ºâ€œæœºå™¨äººå…ˆç”Ÿâ€å¼çš„å¥½è±åé»‘å®¢åœºæ™¯ï¼Œä¸æ˜¯é‚£ä¸ªã€‚ç›¸åï¼Œæˆ‘è¢«å®ƒå¸å¼•æ˜¯å› ä¸ºå®ƒä½“ç°äº†å¥½å¥‡å¿ƒã€å¯¹çŸ¥è¯†çš„æ¸´æœ›ã€è§£å†³é—®é¢˜çš„èƒ½åŠ›ä»¥åŠæ€»æ˜¯ä¿®ä¿®è¡¥è¡¥çš„å¿ƒæ€ã€‚

è¿›å…¥ [TryHackMe](https://tryhackme.com/) ï¼Œè¿™æ˜¯ä¸€ä¸ªæµè¡Œçš„åœ¨çº¿å¹³å°ï¼Œè®©ä½ é€šè¿‡è®¸å¤šç®€çŸ­çš„æ¸¸æˆåŒ–å®éªŒå®¤(å…·æœ‰ç‰¹å®šç›®çš„å’Œé…ç½®çš„è™šæ‹Ÿæœº)å­¦ä¹ ç½‘ç»œå®‰å…¨ã€‚å®ƒä¹Ÿéå¸¸é€‚åˆåˆå­¦è€…ã€‚æ‚¨ä¸å¿…æ„å»ºè‡ªå·±çš„å®¶åº­å®éªŒå®¤å¹¶å¤„ç†é‚£äº›è™šæ‹Ÿæœºé…ç½®ã€‚å®ƒä»¬å·²ç»æ˜¯ç°æˆçš„ï¼Œéšæ—¶å¯ä»¥è¢«åˆ©ç”¨ã€‚å®ƒå¯ä»¥è®©ä½ æ¥è§¦åˆ°å…¶ä»–äººçš„æ™ºæ…§(ç”±å…¶ä»–ä¸“å®¶æˆ–åŒè¡Œå¼€å‘çš„ CTF å®¤)ï¼Œè€Œå¦‚æœä½ å»ºç«‹è‡ªå·±çš„å®¶åº­å®éªŒå®¤ï¼Œä½ å°±æ— æ³•è·å¾—è¿™äº›æ™ºæ…§ã€‚è¿™ä¸€ç³»åˆ—æ–‡ç« å°†è®°å½•æˆ‘å¯¹æŒ‘æˆ˜çš„æ„Ÿå—ä»¥åŠæˆ‘ä»æŒ‘æˆ˜ä¸­å­¦åˆ°çš„ä¸œè¥¿ï¼Œæœ‰ç‚¹åƒ TLDR çš„é£æ ¼ã€‚

# å¯¹ TLDRÂ·CTF çš„æŠ¥é“æœ‰ä»€ä¹ˆæœŸå¾…

![](img/cb3150ab9fd1d4c2719000e63dd9002c.png)

æ¥è‡ª tryhackme.com çš„ç…§ç‰‡

**å¯èƒ½ä¼šæœ‰å¸®åŠ©ï¼Œå¦‚æœä½ :**

âœ”ï¸æƒ³è¦ä» 20ï¼Œ000 è‹±å°ºçš„é«˜åº¦äº†è§£è¿™ä¸ªæˆ¿é—´çš„æƒ…å†µ
âœ”ï¸æƒ³è¦æ‰€æœ‰çº¿ç´¢æ¥å¸®åŠ©æ‚¨å®Œæˆæ•´ä¸ªæ—…ç¨‹ï¼Œä½†ä»æƒ³è‡ªå·±è§£å†³é—®é¢˜
âœ”ï¸å®Œæˆäº†æˆ¿é—´çš„å¸ƒç½®ï¼Œä½†ä»æƒ³çœ‹çœ‹æœ‰å“ªäº›å¥½çš„æ”¶è·

**å¦‚æœæ‚¨éœ€è¦:**ï¼Œæ‚¨å¯èƒ½éœ€è¦æŸ¥çœ‹å…¶ä»–è¯„è®º

ğŸ”¶æƒ³è¦ä¸€ä¸ªè¯¦ç»†çš„é€æ­¥è®°å½•æ¥æŒ‡å¯¼ä½ é€šè¿‡æŒ‘æˆ˜
ä¸ºæ­¤ï¼Œæˆ‘æ¨èè¿™ä¸ª[è®°å½•](https://0xa94.medium.com/tryhackme-vulnversity-ca0bdcc73386)ã€‚

# æ€»ä½“æ„Ÿè§‰

åˆ°æˆ‘ä»¬ä»Šå¤©è¦è®¨è®ºçš„æˆ¿é—´:TryHackMe: Vulnversityã€‚å¦‚æœé€‰æ‹©[è¿›æ”»è¯•æ¢](https://tryhackme.com/paths)è·¯å¾„å°±æ˜¯ç¬¬ä¸€ä¸ªå®æˆ¿(ç¬¬ä¸€ä¸ª*å…¥é—¨*å’Œ*æ•™ç¨‹*å¤ªå®¹æ˜“æ•°äº†)ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæˆ¿é—´è®¾è®¡å¾—å¾ˆå¥½ã€‚å®ƒéœ€è¦ä¸€äº› Linux å‘½ä»¤è¡ŒçŸ¥è¯†ï¼Œä½†ä¸éœ€è¦å¤ªå¤æ‚ã€‚å®ƒå°†æ•´ä¸ªä»»åŠ¡åˆ†è§£æˆå°å—ï¼Œå› æ­¤æ²¡æœ‰ä¸€ä¸ªå­ä»»åŠ¡å¤ªéš¾å¤„ç†ã€‚å®ƒå°†ä¾¦å¯Ÿã€åˆ©ç”¨ã€åˆ©ç”¨åçš„å…¸å‹é»‘å®¢æ”»å‡»è¿‡ç¨‹æµ“ç¼©åˆ°è¿™äº›ç®€å•çš„ä»»åŠ¡ä¸­ï¼Œå‘æ‚¨ä»‹ç»å·¥å…·ï¼Œå¹¶å¼•å¯¼æ‚¨å®Œæˆæ€è€ƒè¿‡ç¨‹ã€‚æ³¨æ„ï¼Œä½ ä»ç„¶éœ€è¦è‡ªå·±åšä¸€äº›ç ”ç©¶ã€‚è¿™ä¸ªæˆ¿é—´ä¸ä¼šä»€ä¹ˆéƒ½å–‚ä½ ã€‚ä½†è¿™æ­£æ˜¯ä¹è¶£æ‰€åœ¨ï¼Œå¯¹å—ï¼Ÿ

# å°è¯•è¿™ä¸ªæˆ¿é—´çš„ç†ç”±

> 1.å­¦ä¹ åŸºæœ¬çš„é»‘å®¢æµç¨‹(ä¾¦æŸ¥->åˆ©ç”¨->åˆ©ç”¨å)
> 2ã€‚ç†Ÿæ‚‰ä¸€äº›éå¸¸å¿…è¦çš„é»‘å®¢å·¥å…·( **nmap** ã€ **GoBusterã€**BurpSuiteã€ **systemctl** ç­‰)ã€‚)
> 3ã€‚ä½“éªŒä¸€ä¸‹ç‰¹æƒå‡çº§å’Œåå‘å¤–å£³ã€‚

# ä½¿ç”¨çš„æˆ˜ç•¥/æˆ˜æœ¯

â¡ï¸ä½¿ç”¨ **Nmap** è·å–å¼€æ”¾ç«¯å£å’ŒæœåŠ¡çš„ä¿¡æ¯- >å‘ç° 80 ç«¯å£å¼€æ”¾ï¼Œ
ç½‘ç«™ä½¿ç”¨ **GoBuster** æœç´¢ web æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å¤¹- >åœ¨**å†…éƒ¨**æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ä¸Šä¼ è¡¨å•
â¡ï¸ä½¿ç”¨ **BurpSuite** æ‹¦æˆªè¯·æ±‚å¹¶æ‰¾å‡ºæ”¯æŒçš„ä¸Šä¼ æ ¼å¼- > **PHP:** å¦ï¼› **phtml:** æ˜¯çš„ï¼
â¡ï¸ä¸Šä¼ æ‰©å±•åä¸º`. phtml 'çš„åå‘å¤–å£³æœ‰æ•ˆè½½è·ç»•è¿‡è¿‡æ»¤:åœ¨åå‘å¤–å£³å†…è·å¾—ä¸€ä¸ªåå‘å¤–å£³
â¡ï¸ï¼Œä½¿ç”¨ **find** æœç´¢å¯ç”¨äºæƒé™æå‡çš„ SUID æ–‡ä»¶->find**/bin/system CTL**
â¡ï¸åˆ›å»ºä¸€ä¸ª **SystemD** æœåŠ¡æ–‡ä»¶ï¼Œä½¿ç”¨ **/bin/systemctl** å¯ç”¨å¹¶è¿è¡Œå®ƒï¼Œè·å¾— root è®¿é—®æƒé™ï¼èµ¢äº†ï¼

# ä½¿ç”¨çš„å·¥å…·/å‘½ä»¤

## Nmap

![](img/bc71f51e0f86abe1c1f99eae298c3856.png)

å›¾ç‰‡æ¥è‡ª[Linux ç˜¾å›å­](https://www.linuxadictos.com/)

Nmap åœ¨ä¾¦å¯Ÿè¿‡ç¨‹ä¸­æ˜¯å¦‚æ­¤é‡è¦ï¼Œè¿™ä¸ªä»»åŠ¡åªæ˜¯çš®æ¯›ã€‚ä½¿ç”¨çš„ä¸€äº›é€‰é¡¹:

**-sV** :å°è¯•ç¡®å®šè¿è¡Œ
**çš„æœåŠ¡ç‰ˆæœ¬:-p xxx æˆ–-p-** :ç«¯å£æ‰«æç«¯å£ xxx æˆ–æ‰«ææ‰€æœ‰ç«¯å£
**-A:** å¯ç”¨æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬æ£€æµ‹ï¼Œæ‰§è¡Œå†…ç½®è„šæœ¬ä»¥è¿›ä¸€æ­¥æšä¸¾

## GoBuster

[GoBuster](https://github.com/OJ/gobuster) æ˜¯ä¸€æ¬¾ URIs/DNS å­åŸŸæš´åŠ›ç ´è§£å·¥å…·ã€‚å®ƒæ˜¯åœ¨ Go ä¸­å¼€å‘çš„ï¼Œå°†æšä¸¾ä½ ç»™å®ƒçš„ä¸»æœºåï¼Œå¹¶åå‡ºç›®å½•å’Œæ–‡ä»¶å¤¹ã€‚å¦‚æœæœ‰ä¸€ä¸ªé¢„å…ˆæ„å»ºçš„å•è¯è¡¨ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚å®éªŒå®¤ä¸­ä½¿ç”¨çš„å‘½ä»¤æ˜¯:

```
 gobuster dir -u http://<ip>:3333 -w <word list location> 
```

å¦‚æœä½ ä½¿ç”¨ Kali Linuxï¼Œå•è¯åˆ—è¡¨å¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¾åœ¨ */usr/share/wordlists* ä¸‹ã€‚æœ‰äººæåˆ° [dirsearch](https://github.com/maurosoria/dirsearch) åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªå¯è¡Œçš„æ›¿ä»£æ–¹æ¡ˆã€‚ä½¿ç”¨è¯¥å·¥å…·ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª**ä¸Šä¼ **æ–‡ä»¶å¤¹ï¼Œæ‚¨å¯ä»¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°ç½‘ç»œæœåŠ¡å™¨ä¸Šã€‚

## BurpSuit

![](img/a1f9159b25ea4417b858253b836f7416.png)

ç…§ç‰‡æ¥è‡ª [PortSwigger](https://portswigger.net/burp)

å°è¯•ä¸Šä¼ ä¸€äº›æ–‡ä»¶ï¼Œä½ ä¼šå‘ç°å¤§å¤šæ•°æ‰©å±•åè¢«é˜»æ­¢ã€‚å¦‚ä½•è¿›è¡Œï¼Ÿè¿›å…¥ [BurpSuite](https://portswigger.net/burp) ï¼Œæ® [Arch Wiki](https://wiki.archlinux.org/title/Burp_suite) ä»‹ç»ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºæ‰§è¡Œ web åº”ç”¨å®‰å…¨æµ‹è¯•çš„â€œ*é›†æˆå¹³å°ã€‚å—¯ï¼Œæˆ‘ä»¬åªæ˜¯ç”¨å®ƒæ¥æ‹¦æˆªä¸€äº›ç½‘ç»œè¯·æ±‚ï¼Œå¹¶å°è¯•ä¸åŒçš„æ–‡ä»¶æ‰©å±•åï¼Œçœ‹çœ‹å“ªä¸ªå®é™…ä¸Šæ²¡æœ‰è¢«é˜»æ­¢ã€‚
å®ƒçš„ä¸»æ—¨æ˜¯å°è¯•ä¸Šä¼ ä¸€äº›ä¸œè¥¿ï¼Œä½¿ç”¨ *BurpSuite* æ‹¦æˆªå®ƒï¼Œç„¶åç”¨é¢„å…ˆåŠ è½½çš„å„ç§æ–‡ä»¶æ‰©å±•åçš„å•è¯è¡¨(ä¾‹å¦‚ *phpã€php5ã€phtml* ç­‰)æ›´æ”¹æ–‡ä»¶æ‰©å±•åéƒ¨åˆ†ã€‚)æ¥æµ‹è¯•å“ªä¸€ä¸ªå®é™…ä¸Šå¯ä»¥ç»•è¿‡ç½‘ç»œæœåŠ¡å™¨è¿‡æ»¤å™¨ã€‚
ä¸€æ—¦å‘ç°( *phtml* )ï¼Œåªè¦ä¸Šä¼ ä¸€ä¸ªåå‘ shell çš„ PHP è„šæœ¬å¹¶ä¸Šä¼ åˆ° webserverï¼Œåœ¨æµè§ˆå™¨ä¸ŠåŠ è½½ï¼Œé‚£ä¹ˆä½ çš„ç›‘å¬ **nc -lvnp 1234** ä¼šè¯å°±ä¼šå¾—åˆ°åå‘ shellã€‚*

## ç³»ç»Ÿ ctl

![](img/62d268765862bc2ac59a58293a6bc9bf.png)

å›¾ç‰‡æ¥è‡ª[https://brand.systemd.io/](https://brand.systemd.io/)

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†åå‘å¤–å£³ï¼Œæœ€åçš„äº‹æƒ…å°†æ˜¯ç‰¹æƒå‡çº§ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ SUID æƒé™æœç´¢å¯æ‰§è¡Œæ–‡ä»¶ã€‚æˆ‘ä»¬ç”¨*æŸ¥æ‰¾*æ¥å®Œæˆ:

```
 find / -user root -perm -4000 -exec ls -ldb {} \; 
```

åœ¨è¿”å›çš„ç»“æœä¸­ï¼Œ */bin/systemctl* è„±é¢–è€Œå‡ºã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€äº›æœåŠ¡æ–‡ä»¶(ä¾‹å¦‚ *root.service* )å¹¶è®© *systemctl* å¼€å§‹è·å–ç‰¹æƒ:

```
TF=â€root.serviceâ€
echo â€˜[Service]
Type=oneshot
ExecStart=/bin/sh -c â€œcat /root/root.txt > /tmp/flag.txtâ€
[Install]
WantedBy=multi-user.targetâ€™ > $TF
```

æ³¨æ„è¿™é‡Œä½ ä¸èƒ½åœ¨è¿œç¨‹ shell ä¸­ä½¿ç”¨åƒ **vim** æˆ– **nano** è¿™æ ·çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåªéœ€ echo åˆ°æ–‡ä»¶ä¸­å³å¯ã€‚ä¸æ˜¯æœ€ç†æƒ³çš„ï¼Œä½†èƒ½å®Œæˆä»»åŠ¡ã€‚ä¸€æ—¦æœ‰äº† *root.service* æ–‡ä»¶ï¼Œè¿è¡Œ *systemctl* æ¥å¯ç”¨/å¯åŠ¨å®ƒ:

```
/bin/systemctl enable /tmp/output/root.service
/bin/systemctl start /tmp/output/root.service
```

æœåŠ¡æ­£å¸¸å¯åŠ¨åï¼Œä¸€ä¸ªç®€å•çš„ *cat /temp/flag.txt* ä¼šç»™æˆ‘ä»¬æƒ³è¦é€šè¿‡æˆ¿é—´çš„æ ‡å¿—ã€‚

# å‚è€ƒ

*   TryHackMe
*   TryHackMe: Vulnversity
*   [nmap](https://nmap.org)
*   [æ‰é¬¼æ•¢æ­»é˜Ÿ](https://github.com/OJ/gobuster)
*   [ç›®å½•æœç´¢](https://github.com/maurosoria/dirsearch)
*   [æ³¡æ²«å¡‘æ–™](https://portswigger.net/burp)
*   [php åå‘å¤–å£³](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php)
*   [SUID escalation](https://gtfobins.github.io/gtfobins/systemctl/#suid)