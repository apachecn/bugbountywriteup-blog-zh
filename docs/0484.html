<html>
<head>
<title>Writing a Bootloader</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç¼–å†™å¼•å¯¼åŠ è½½ç¨‹åº</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/writing-a-bootloader-931da062f25b?source=collection_archive---------0-----------------------#2020-01-30">https://infosecwriteups.com/writing-a-bootloader-931da062f25b?source=collection_archive---------0-----------------------#2020-01-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="67da" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">ä»€ä¹ˆæ˜¯å¼•å¯¼åŠ è½½ç¨‹åºï¼Ÿ</h1><p id="b14b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi lm translated"><span class="l ln lo lp bm lq lr ls lt lu di"/>boot loaderæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç¨‹åºï¼Œåœ¨å¼€æœºæˆ–å¤ä½æœŸé—´ï¼Œæ¯æ¬¡è®¡ç®—æœºåˆå§‹åŒ–å¯å¼•å¯¼è®¾å¤‡æ—¶éƒ½ä¼šæ‰§è¡Œè¯¥ç¨‹åºï¼Œå°†å†…æ ¸æ˜ åƒåŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºéå¸¸æ¥è¿‘ç¡¬ä»¶å’ŒCPUçš„æ¶æ„ã€‚æ‰€æœ‰x86ç”µè„‘éƒ½ä»¥å®æ¨¡å¼å¯åŠ¨ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ‚¨åªæœ‰16ä½æŒ‡ä»¤ã€‚æˆ‘ä»¬çš„å¼•å¯¼ç¨‹åºè¿è¡Œåœ¨å®æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬çš„å¼•å¯¼ç¨‹åºæ˜¯ä¸€ä¸ª16ä½ç¨‹åºã€‚</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/3629033d2a85e67ccdc55b79a03cc164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*XLayt5zmspJjR-NJ.png"/></div></figure><h1 id="bf58" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h1><p id="bf2c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi lm translated"><span class="l ln lo lp bm lq lr ls lt lu di"> W </span>å½“ä½ æ‰“å¼€ç”µè„‘æ—¶ï¼ŒBIOSæƒ³è¦å¯åŠ¨ä¸€ä¸ªå¿…é¡»åœ¨ç¡¬ç›˜ã€è½¯ç›˜ã€å…‰ç›˜ç­‰åœ°æ–¹æ‰¾åˆ°çš„æ“ä½œç³»ç»Ÿã€‚BIOSæœç´¢æ“ä½œç³»ç»Ÿçš„é¡ºåºæ˜¯ç”¨æˆ·å¯é…ç½®çš„ã€‚æ¥ä¸‹æ¥ï¼ŒBIOSè¯»å–å¯å¼•å¯¼ç£ç›˜çš„ç¬¬ä¸€ä¸ª512å­—èŠ‚æ‰‡åŒºã€‚é€šå¸¸ï¼Œä¸€ä¸ªæ‰‡åŒºçš„å¤§å°æ˜¯512å­—èŠ‚ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ä¸»å¼•å¯¼è®°å½•(MBR)ã€‚BIOSåªæ˜¯å°†MBRçš„å†…å®¹åŠ è½½åˆ°å†…å­˜ä½ç½®â€œ0x7c00 â€,å¹¶è·³è½¬åˆ°è¯¥ä½ç½®å¼€å§‹æ‰§è¡ŒMBRä¸­çš„ä»»ä½•ä»£ç ã€‚æˆ‘ä»¬çš„å¼•å¯¼ç¨‹åºå¤§å°ä¹Ÿåº”è¯¥æ˜¯512å­—èŠ‚ã€‚</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi md"><img src="../Images/7593d846f27e0ab365b7eefca9c96bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/0*NL0pV_atzxPA1Iz8.png"/></div></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div class="gh gi me"><img src="../Images/ddd35d1e8550d118a59e57a1fc5078d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*JP5aekAUGAX0RHZ7xJhOIQ.png"/></div></figure><p id="d933" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä»£ç 440å­—èŠ‚ç£ç›˜ç­¾å4å­—èŠ‚Null2å­—èŠ‚åˆ†åŒºè¡¨64å­—èŠ‚MBRç­¾å2å­—èŠ‚esTotal512å­—èŠ‚</p><p id="aac6" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">å¼•å¯¼è¿‡ç¨‹æ˜¯:</p><ul class=""><li id="9beb" class="mk ml it kq b kr mf kv mg kz mm ld mn lh mo ll mp mq mr ms bi translated">æ‰“å¼€ç”µè„‘ï¼ŒBIOSå¼€å§‹è¿è¡Œ</li><li id="d24b" class="mk ml it kq b kr mt kv mu kz mv ld mw lh mx ll mp mq mr ms bi translated">BIOSæŒ‰ç…§ç”¨æˆ·å¯é…ç½®çš„å¼•å¯¼é¡ºåºå¯»æ‰¾MBRã€‚</li><li id="3838" class="mk ml it kq b kr mt kv mu kz mv ld mw lh mx ll mp mq mr ms bi translated">BIOSä»æŒ‡å®šçš„ä»‹è´¨å°†ä¸€ä¸ª512å­—èŠ‚çš„å¼•å¯¼æ‰‡åŒºåŠ è½½åˆ°å†…å­˜ä½ç½®â€œ0x7c00 â€,å¹¶å¼€å§‹æ‰§è¡Œå®ƒã€‚</li><li id="392c" class="mk ml it kq b kr mt kv mu kz mv ld mw lh mx ll mp mq mr ms bi translated">è¿™512ä¸ªå­—èŠ‚ç„¶åç»§ç»­åŠ è½½æ“ä½œç³»ç»Ÿæœ¬èº«æˆ–æ›´å¤æ‚çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚</li></ul><h1 id="e0a4" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">BIOSä¸­æ–­</h1><p id="b655" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi lm translated">è¿™äº›ä¸­æ–­å¸®åŠ©æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºè°ƒç”¨BIOSçš„åŠŸèƒ½ã€‚è¿™æ˜¯åœ¨å¼•å¯¼åŠ è½½ç¨‹åºä¹‹å‰åŠ è½½çš„ï¼Œåœ¨ä¸I/Oé€šä¿¡æ—¶éå¸¸æœ‰ç”¨ã€‚ç”±äºæˆ‘ä»¬æ²¡æœ‰æ“ä½œç³»ç»Ÿçº§ä¸­æ–­ï¼Œè¿™æ˜¯å”¯ä¸€æœ‰ç”¨çš„é€‰é¡¹ã€‚</p><p id="7ae9" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä¾‹å¦‚ä½¿ç”¨BIOSä¸­æ–­è°ƒç”¨å°†å­—ç¬¦æ‰“å°åˆ°å±å¹•ä¸Šã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="322b" class="nd jr it mz b gy ne nf l ng nh">mov ah, 0x0e    ; function number = 0Eh : Display Character<br/>mov al, 'O'     ; AL = code of character to display<br/>int 0x10        ; call INT 10h, BIOS video service</span></pre><p id="0e2d" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">è¿™æ˜¯ä¸€ä¸ªç”¨ç¾å›½ç”µè¯ç”µæŠ¥å…¬å¸è¯­æ³•ç¼–å†™çš„ç®€å•çš„å¼•å¯¼åŠ è½½ç¨‹åºã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="79b4" class="nd jr it mz b gy ne nf l ng nh">/*<br/> * Title: A Simple Bootloader in AT&amp;T Assembly<br/> * Author: Osanda Malith Jayathissa (<a class="ae ni" href="http://twitter.com/OsandaMalith" rel="noopener ugc nofollow" target="_blank">@OsandaMalith</a>)<br/> * Website: <a class="ae ni" href="http://OsandaMalith.wordpress.com" rel="noopener ugc nofollow" target="_blank">http://OsandaMalith.wordpress.com</a><br/> */ <br/> .code16<br/> .section .text<br/> .global main<br/>main:</span><span id="76b4" class="nd jr it mz b gy nj nf l ng nh">/* <br/> Disk description table, to make it a valid floppy<br/> FAT12 file system format<br/>*/<br/> jmp _start<br/> .byte 144 #NOP <br/> .ascii â€œOsandaOSâ€ #OEMLabel <br/> .word 512 #BytesPerSector <br/> .byte 1 #SectorsPerCluster <br/> .word 1 #ReservedForBoot <br/> .byte 2 #NumberOfFats <br/> .word 224 #RootDirEntries (224 * 32 = 7168 = 14 sectors to read) <br/> .word 2880 #LogicalSectors <br/> .byte 0xf0 #MediumByte <br/> .word 9 #SectorsPerFat <br/> .word 18 #SectorsPerTrack <br/> .word 2 #Sides <br/> .long 0 #HiddenSectors <br/> .byte 0 #LargeSectors <br/> .byte 0 #DriveNo <br/> .byte 0x29 #Signature (41 for Floppy)<br/> .long 0x12345678 #VolumeID<br/> .ascii â€œMy First OSâ€ #VolumeLabel<br/> .ascii â€œFAT12 â€œ #FileSystem</span><span id="f19e" class="nd jr it mz b gy nj nf l ng nh">_start:<br/> movw $0, %ax<br/> movw %ax, %ss<br/> movw %ax, %ds<br/> movw %ax, %es<br/> movw $string, %si<br/>loop:<br/> movb $0xe, %ah<br/> movb (%si), %al<br/> cmpb $0, %al<br/> je done<br/> int $0x10<br/> addw $1, %si<br/> jmp loop<br/>done:<br/> jmp done #infinite loop</span><span id="785c" class="nd jr it mz b gy nj nf l ng nh">string:<br/> .ascii â€œWelcome to <a class="ae ni" href="http://twitter.com/OsandaMalith" rel="noopener ugc nofollow" target="_blank">@OsandaMalith</a>â€™s First OS :)â€<br/> .byte 0<br/> .fill 0x1fe â€” (. â€” main) ,1,0 #Pad remainder of boot sector with 0s<br/> .word 0xaa55 #The standard PC boot signature</span></pre><p id="2e6e" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated"><a class="ae ni" href="https://github.com/OsandaMalith/bootloader/blob/master/loader.S" rel="noopener ugc nofollow" target="_blank">https://github . com/OsandaMalith/boot loader/blob/master/loaderã€‚S </a> <br/>æ±‡ç¼–é“¾æ¥ä»£ç ã€‚æˆ‘å·²ç»æ˜ç¡®æŒ‡å®šåœ¨0x7c00åŠ è½½æ–‡æœ¬éƒ¨åˆ†ï¼Œå®ƒå°†è®¡ç®—ç»å¯¹å¯»å€ã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="724e" class="nd jr it mz b gy ne nf l ng nh">as --32 -o loader.o loader.S</span><span id="3b58" class="nd jr it mz b gy nj nf l ng nh">ld -m elf_i386 loader.o --oformat=binary -o loader.bin  -Ttext 0x7c00</span></pre><p id="37a6" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">åœ¨NASMä½¿ç”¨è‹±ç‰¹å°”è¯­æ³•ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="7c26" class="nd jr it mz b gy ne nf l ng nh">%if 0; <br/> * Title: A Simple Bootloader in NASM<br/> * Author: Osanda Malith Jayathissa (<a class="ae ni" href="http://twitter.com/OsandaMalith" rel="noopener ugc nofollow" target="_blank">@OsandaMalith</a>)<br/> * Website: <a class="ae ni" href="http://OsandaMalith.wordpress.com" rel="noopener ugc nofollow" target="_blank">http://OsandaMalith.wordpress.com</a><br/>%endif;</span><span id="b89e" class="nd jr it mz b gy nj nf l ng nh">BITS 16</span><span id="d496" class="nd jr it mz b gy nj nf l ng nh">jmp short _start ; Jump past disk description section<br/> nop <br/> <br/>; Disk description table, to make it a valid floppy<br/>OEMLabel db â€œOsandaOSâ€ ; Disk label<br/>BytesPerSector dw 512 ; Bytes per sector<br/>SectorsPerCluster db 1 ; Sectors per cluster<br/>ReservedForBoot dw 1 ; Reserved sectors for boot record<br/>NumberOfFats db 2 ; Number of copies of the FAT<br/>RootDirEntries dw 224 <br/>LogicalSectors dw 2880 ; Number of logical sectors<br/>MediumByte db 0F0h ; Medium descriptor byte<br/>SectorsPerFat dw 9 ; Sectors per FAT<br/>SectorsPerTrack dw 18 ; Sectors per track (36/cylinder)<br/>Sides dw 2 ; Number of sides/heads<br/>HiddenSectors dd 0 ; Number of hidden sectors<br/>LargeSectors dd 0 ; Number of LBA sectors<br/>DriveNo dw 0 ; Drive No: 0<br/>Signature db 41 ; Drive signature: 41 for floppy<br/>VolumeID dd 12345678h ; Volume ID: any number<br/>VolumeLabel db â€œMy First OSâ€; Volume Label: any 11 chars<br/>FileSystem db â€œFAT12 â€œ ; File system type: donâ€™t change!</span><span id="1624" class="nd jr it mz b gy nj nf l ng nh">_start:<br/> mov ax, 07C0h ; move 0x7c00 into ax<br/> mov ds, ax ; set data segment to where weâ€™re loaded</span><span id="906b" class="nd jr it mz b gy nj nf l ng nh">mov si, string ; Put string position into SI<br/> call print_string ; Call our string-printing routine</span><span id="1d02" class="nd jr it mz b gy nj nf l ng nh">jmp $ ; infinite loop!</span><span id="8654" class="nd jr it mz b gy nj nf l ng nh">string db â€œWelcome to <a class="ae ni" href="http://twitter.com/OsandaMalith" rel="noopener ugc nofollow" target="_blank">@OsandaMalith</a>â€™s First OS :)â€, 0<br/>print_string: <br/> mov ah, 0Eh ; int 10h â€˜print charâ€™ function<br/>.loop:<br/> lodsb ; load string byte to al<br/> cmp al, 0 ; cmp al with 0<br/> je .done ; if char is zero, ret<br/> int 10h ; else, print<br/> jmp .loop<br/>.done:<br/> ret<br/> times 510-($-$$) db 0 ; Pad remainder of boot sector with 0s<br/> dw 0xAA55 ; The standard PC boot signature</span></pre><p id="7667" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated"><a class="ae ni" href="https://github.com/OsandaMalith/bootloader/blob/master/loader.nasm" rel="noopener ugc nofollow" target="_blank">https://github . com/OsandaMalith/boot loader/blob/master/loader . nasm</a><br/>ä»¥äºŒè¿›åˆ¶ä¸ºæ ¼å¼æ±‡ç¼–æ–‡ä»¶ã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="316d" class="nd jr it mz b gy ne nf l ng nh">nasm -f bin -o loader.bin loader.nasm</span></pre><p id="0415" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">å¦‚æœä½ ä½¿ç”¨æ–‡ä»¶å·¥å…·ï¼Œä½ ä¼šçœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªåˆæ³•çš„1.4å…†è½¯ç›˜å’Œ32ä½å¼•å¯¼æ‰‡åŒºã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="568a" class="nd jr it mz b gy ne nf l ng nh">$ file loader.bin <br/>loader.bin: DOS floppy 1440k, x86 hard disk boot sector</span></pre><p id="5e1b" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">å¦‚æœä½ åœ¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸­æ‰“å¼€æˆ‘ä»¬çš„å¼•å¯¼ç¨‹åºï¼Œä½ ä¼šçœ‹åˆ°æˆ‘ä»¬çš„512å¤§å°çš„ç¨‹åºï¼Œæœ€ååº”è¯¥ä¼šæœ‰æˆ‘ä»¬çš„å¼•å¯¼ç­¾å0xaa55ã€‚</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nk"><img src="../Images/fe95373cff8c3b1453b5b57b79bfc1b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*O5p2DfzBCJPQKG8a.png"/></div></div></figure><p id="78b9" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä¹‹åï¼Œå°†äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢æˆè½¯ç›˜æ˜ åƒã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="1ddf" class="nd jr it mz b gy ne nf l ng nh">dd status=noxfer conv=notrunc if= loader.bin of=floppy.flp</span></pre><p id="364f" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">æ‚¨è¿˜å¯ä»¥ä½¿ç”¨UltraISOç­‰å·¥å…·å°†äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸ºISOæ–‡ä»¶ã€‚ä½ å¯ä»¥åˆ»å½•å¹¶åœ¨ä½ çš„ç”µè„‘ä¸Šå°è¯•ï¼Œè€Œä¸æ˜¯æ¨¡ä»¿ã€‚ä½¿ç”¨Qemuæ¥æµ‹è¯•æˆ‘ä»¬æ–°åˆ›å»ºçš„å¼•å¯¼ç¨‹åºğŸ™‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="2595" class="nd jr it mz b gy ne nf l ng nh">qemu-system-i386 -fda floppy.flp</span></pre><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi np"><img src="../Images/8d98ba16ff8440b67daa9e7092771452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eky8tCkYkcSwxuu1.png"/></div></div></figure><p id="99f7" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä½ å¯ä»¥å¼€å‘å‡ºè¿™æ ·çš„ä¸œè¥¿ğŸ™‚</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi gj"><img src="../Images/fd922daafd72020ede600983e4bb2529.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vPjrt-8fZax4iQZY.png"/></div></div></figure><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nq"><img src="../Images/5e60c07951903254a66dfbb6c5964c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MO1TvL-ruKEZK9OW.jpg"/></div></div></figure><h1 id="3573" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Cä¸­çš„å¼•å¯¼ç¨‹åº</h1><p id="d2e7" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi lm translated"><span class="l ln lo lp bm lq lr ls lt lu di">æˆ‘ä»¬</span>å¯ä»¥ç”¨Cä½¿ç”¨å†…è”æ±‡ç¼–å†™ä¸€ä¸ªç®€å•çš„bootloaderã€‚æˆ‘å°†å±•ç¤ºä¸€ä¸ªæ‰“å°â€œHelloâ€çš„ç®€å•ç¤ºä¾‹ã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="bc1b" class="nd jr it mz b gy ne nf l ng nh">__asm__(â€œ.code16\nâ€);<br/>__asm__(â€œjmpl $0x0000, $main\nâ€);<br/> <br/>void main() {<br/> __asm__ __volatile__(â€œmovb $â€™Hâ€™ , %al\nâ€);<br/> __asm__ __volatile__(â€œmovb $0x0e, %ah\nâ€);<br/> __asm__ __volatile__(â€œint $0x10\nâ€);<br/> <br/> __asm__ __volatile__(â€œmovb $â€™eâ€™ , %al\nâ€);<br/> __asm__ __volatile__(â€œmovb $0x0e, %ah\nâ€);<br/> __asm__ __volatile__(â€œint $0x10\nâ€);<br/> <br/> __asm__ __volatile__(â€œmovb $â€™lâ€™ , %al\nâ€);<br/> __asm__ __volatile__(â€œmovb $0x0e, %ah\nâ€);<br/> __asm__ __volatile__(â€œint $0x10\nâ€);<br/> <br/> __asm__ __volatile__(â€œmovb $â€™lâ€™ , %al\nâ€);<br/> __asm__ __volatile__(â€œmovb $0x0e, %ah\nâ€);<br/> __asm__ __volatile__(â€œint $0x10\nâ€);<br/> <br/> __asm__ __volatile__(â€œmovb $â€™oâ€™ , %al\nâ€);<br/> __asm__ __volatile__(â€œmovb $0x0e, %ah\nâ€);<br/> __asm__ __volatile__(â€œint $0x10\nâ€);<br/> <br/>}<br/></span></pre><p id="7061" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated"><a class="ae ni" href="https://github.com/OsandaMalith/bootloader/blob/master/loader.c" rel="noopener ugc nofollow" target="_blank">https://github . com/OsandaMalith/boot loader/blob/master/loader . c</a>T5ã€‘è¿™å°†æ˜¯é“¾æ¥å™¨ä¸­æŒ‡å®šä¸ºâ€œtest.ldâ€çš„é“¾æ¥å™¨è„šæœ¬</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="995f" class="nd jr it mz b gy ne nf l ng nh"><br/>.ENTRY(main);<br/>SECTIONS<br/>{<br/> . = 0x7C00;<br/> .text : AT(0x7C00){ *(.text); }<br/> .sig : AT(0x7DFE) { SHORT(0xaa55); }<br/>}</span></pre><p id="53d1" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">https://github . com/OsandaMalith/boot loader/blob/master/test . LD<br/>ç„¶åä½¿ç”¨GCCç¼–è¯‘ï¼Œæˆ‘ä»¬åªç”Ÿæˆä¸€ä¸ªç›®æ ‡æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨æŒ‡å®šé“¾æ¥å™¨è„šæœ¬çš„é“¾æ¥å™¨æ‰‹åŠ¨é“¾æ¥ã€‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="4629" class="nd jr it mz b gy ne nf l ng nh">gcc -m32 -c -Os -march=i686 -ffreestanding -Wall -Werror -o loader.o loader.c<br/>ld -m elf_i386 -static -Ttest.ld -nostdlib â€” nmagic -o test.elf test.o<br/>objcopy -O binary loader.elf loader.bin<br/>dd status=noxfer conv=notrunc if=loader.bin of=floppy.flp</span></pre><p id="9b50" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä¹‹åï¼Œä½¿ç”¨Qemuå¼•å¯¼æˆ‘ä»¬çš„æ˜ åƒğŸ™‚</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="6ee8" class="nd jr it mz b gy ne nf l ng nh">qemu-system-i386 -fda floppy.flp</span></pre><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="gh gi nr"><img src="../Images/7b47abf19e679ac8e1591232d36fef4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L-3Vf-wcrcxtUsDc.png"/></div></div></figure><p id="e35c" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated">ä½¿ç”¨BIOSä¸­æ–­ï¼Œä½ å¯ä»¥ç¼–å†™æ¼‚äº®çš„ç¨‹åºåˆ°ä½ çš„ç”µè„‘çš„å¼•å¯¼åŒºğŸ™‚</p><h1 id="4da3" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">å‚è€ƒ</h1><p id="b3ce" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><a class="ae ni" href="http://duartes.org/gustavo/blog/post/how-computers-boot-up/" rel="noopener ugc nofollow" target="_blank">http://duartes.org/gustavo/blog/post/how-computers-boot-up/</a><br/><a class="ae ni" href="http://wiki.osdev.org/" rel="noopener ugc nofollow" target="_blank">http://wiki.osdev.org</a><br/><a class="ae ni" href="http://mikeos.sourceforge.net/" rel="noopener ugc nofollow" target="_blank">http://mikeos.sourceforge.net/</a><br/>T18ã€‘https://en.wikipedia.org/wiki/BIOS_interrupt_call</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="9c1e" class="pw-post-body-paragraph ko kp it kq b kr mf kt ku kv mg kx ky kz mh lb lc ld mi lf lg lh mj lj lk ll im bi translated"><em class="nz">å…³æ³¨</em> <a class="ae ni" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="nz"> InfosecæŠ¥é“</em> </a> <em class="nz">è·å–æ›´å¤šæ­¤ç±»ç²¾å½©æŠ¥é“ã€‚</em></p><div class="oa ob gp gr oc od"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">ä¿¡æ¯å®‰å…¨æŠ¥é“</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">æ”¶é›†äº†ä¸–ç•Œä¸Šæœ€å¥½çš„é»‘å®¢çš„æ–‡ç« ï¼Œä¸»é¢˜ä»bugå¥–é‡‘å’ŒCTFåˆ°vulnhubâ€¦</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or mb od"/></div></div></a></div></div></div>    
</body>
</html>