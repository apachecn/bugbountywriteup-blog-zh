# ç°ä»£äºŒè¿›åˆ¶å¼€å‘æ–‡ç« -0x02

> åŸæ–‡ï¼š<https://infosecwriteups.com/modern-binary-exploitation-writeups-ii-62c092f7f389?source=collection_archive---------0----------------------->

è¿™æ˜¯**ç°ä»£äºŒè¿›åˆ¶å¼€å‘**è¯¾ç¨‹çš„å­éƒ¨åˆ† [RPISEC](https://rpis.ec/) çš„**å·¥å…·å’ŒåŸºæœ¬é€†å‘å·¥ç¨‹**çš„ç¬¬äºŒç¯‡ç»¼è¿°ã€‚

è®²åº§é“¾æ¥:-[http://security.cs.rpi.edu/courses/binexp-spring2015/](http://security.cs.rpi.edu/courses/binexp-spring2015/)

æ‰€æœ‰çš„è¯¾å ‚ææ–™å’Œå…¶ä»–å¿…è¦çš„æ–‡ä»¶éƒ½å¯ä»¥åœ¨ä¸Šé¢çš„é“¾æ¥ä¸­æ‰¾åˆ°ã€‚

[â¬…ï¸](https://medium.com/bugbountywriteup/binary-exploitation-5fe810db3ed4) **ä¸Šä¸€ç¯‡æŠ¥é“**_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _**ä¸‹ä¸€ç¯‡æŠ¥é“** [â¡ï¸](https://medium.com/bugbountywriteup/binary-writeup-0x03-9a9546711ef2)

# crackme0x00b

**ä½¿ç”¨*æ–‡ä»¶*å‘½ä»¤**æ”¶é›†ä¿¡æ¯

```
$file crackme0x00b
```

![](img/d98711222dce92eefe5cb7bf20aa6246.png)

æ–‡ä»¶ä¿¡æ¯

ä½¿ç”¨ *rabin2* å·¥å…·æ”¶é›†ä¿¡æ¯ã€‚

```
$rabin2 -I crackme0x00b
```

![](img/e32bf88013a91fef2530df0f8803b097.png)

man rabin2

![](img/29e8ec956ae349a61fcdf7e8e1b8776f.png)

æ–‡ä»¶ä¿¡æ¯

ç»™å®šçš„ç ´è§£æˆ‘æ˜¯ 32 ä½å’Œå°ç«¯ï¼Œè®°ä¸‹è¿™ä¸€ç‚¹ï¼Œè¿™å°†æœ‰åŠ©äºæ‰¾åˆ°ç ´è§£çš„æ–¹æ³•ã€‚

**ä½¿ç”¨å­—ç¬¦ä¸²ç ´è§£æ–‡ä»¶**

```
$strings -e L crackme0x00b
```

![](img/782b667e5158b1f6c26cc7ee963cf6ca.png)

ç”·å­å¼¦ä¹

![](img/1c1204c156a3819b66a5a348e1d7c6cb.png)![](img/850b70c58d60e612390c4368c9c49365.png)

**ä½¿ç”¨ xxd ç ´è§£æ–‡ä»¶**

```
$xxd crackme0x0b
```

![](img/5b525865d8606c6a47b1a41e5127af83.png)

ç”·äºº xxd

![](img/dbdf39710c3b36b909735d21c43e150b.png)![](img/850b70c58d60e612390c4368c9c49365.png)

**ä½¿ç”¨ rabin2 ç ´è§£æ–‡ä»¶**

```
$rabin2 -z crackme0x00b
```

![](img/20ec44360caf2b6acb8df5cc4d665d53.png)

man rabin2

![](img/f61b64cbf3db5e967c9d6bcbd252f97b.png)![](img/850b70c58d60e612390c4368c9c49365.png)

**ä½¿ç”¨ radare2 ç ´è§£æ–‡ä»¶**

```
$radare2 crackme0x00a
 [0x080483e0]> aaa
 [0x080483e0]> pdf @ main
```

*   aa:-å…¨éƒ¨åˆ†æã€‚
*   aaa:-ç”¨æ›´å¤šä¿¡æ¯åˆ†ææ‰€æœ‰å†…å®¹ã€‚
*   pdf:-æ‰“å°åæ±‡ç¼–åŠŸèƒ½ã€‚

![](img/3de079fafb3c5e49d87d18e0ac1dc221.png)

é›·è¾¾ 2

*wcscmp()* ä½¿ç”¨*s1 å’Œ*s2 å˜é‡ s1 æ˜¯æŒ‡å‘ **w0wgreat** å’Œ s2 æ˜¯è¾“å…¥å­—ç¬¦ä¸²ã€‚

![](img/6bc6bc08ca176002a31798d8b0bf0ae0.png)![](img/850b70c58d60e612390c4368c9c49365.png)

**ä½¿ç”¨ gdb-peda ç ´è§£æ–‡ä»¶**

gdb-peda å°±åƒæ˜¯ gdb çš„ä¸€ä¸ªæ’ä»¶ï¼Œä½ å¯ä»¥ä» [GitHub](https://github.com/longld/peda) å®‰è£…ã€‚

```
$gdb crackme0x00a
>gdb-peda$ disassemble main
```

åæ±‡ç¼– main å°†æ˜¾ç¤ºäºŒè¿›åˆ¶çš„ä¸»è¦åŠŸèƒ½ã€‚

```
gdb-peda$ break *0x080484ce
```

![](img/d330c4164e1860ed46f0fa56d337ce1d.png)

```
gdb-peda$ run
```

![](img/f1e4b50e3d874118473ac40911a072f0.png)

```
gdb-peda$ ni
```

*ni æˆ– nexti* â€”ä½œä¸ºä¸€æ¡æŒ‡ä»¤æ‰§è¡Œè°ƒç”¨ã€‚

![](img/c24e318a8adeaa2a58d4d7ababef78f7.png)

```
gdb-peda$ telescope $edx
```

telescope è§†å›¾æ˜¾ç¤ºå †æ ˆå€¼ï¼Œå¹¶è¯•å›¾å–æ¶ˆå †æ ˆå¯èƒ½æŒ‡å‘çš„æŒ‡é’ˆçš„å¼•ç”¨ã€‚

![](img/d88956b5e1741f83c18743f0de8a0d01.png)

è¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åšä¸Šé¢äº‹æƒ…

```
gdb-peda$ x/25s $edx
```

*x/ :-æ˜¾ç¤ºå­—èŠ‚*

*25:-æˆ‘ä»¬è¦æ˜¾ç¤ºå¤šå°‘ä¸ª*

*s:â€”â€”ä½œä¸ºä¸€æ ¹ç´å¼¦*

$edx:-è¿™æ˜¯æŒ‡å¯„å­˜å™¨

![](img/bcca23016a8bd9bd4d51193fb4750db2.png)![](img/850b70c58d60e612390c4368c9c49365.png)

*æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œè¯·ç‚¹å‡»**ğŸ‘ ***æŒ‰é’®ï¼Œåˆ†äº«*** *å¸®åŠ©åˆ«äººï¼æ¬¢è¿ç•™è¨€è¯„è®º*ğŸ’¬*ä¸‹å›¾ã€‚æœ‰åé¦ˆï¼Ÿä¸‹é¢æˆ‘ä»¬è¿çº¿ä¸Š* [*æ¨ç‰¹*](https://twitter.com/yashanand155) *ã€‚**

## *[å¯¸å®½](https://twitter.com/yashanand155)*