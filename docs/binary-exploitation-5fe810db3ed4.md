# ç°ä»£äºŒè¿›åˆ¶å¼€å‘æ–‡ç«  0x01

> åŸæ–‡ï¼š<https://infosecwriteups.com/binary-exploitation-5fe810db3ed4?source=collection_archive---------0----------------------->

è¿™æ˜¯ [RPISEC](https://rpis.ec/) çš„**å·¥å…·å’ŒåŸºæœ¬é€†å‘å·¥ç¨‹**çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå®ƒæ˜¯**ç°ä»£äºŒè¿›åˆ¶å¼€å‘**è¯¾ç¨‹çš„ä¸€ä¸ªå­éƒ¨åˆ†ã€‚

è®²åº§é“¾æ¥:-[http://security.cs.rpi.edu/courses/binexp-spring2015/](http://security.cs.rpi.edu/courses/binexp-spring2015/)

æ‰€æœ‰çš„è¯¾å ‚ææ–™å’Œå…¶ä»–å¿…è¦çš„æ–‡ä»¶éƒ½å¯ä»¥åœ¨ä¸Šé¢çš„é“¾æ¥ä¸­æ‰¾åˆ°ã€‚

_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _**ä¸‹ä¸€ç¯‡ç‰¹å†™** [â¡ï¸](https://medium.com/bugbountywriteup/modern-binary-exploitation-writeups-ii-62c092f7f389)

# crackme0x00a

**ä½¿ç”¨*æ–‡ä»¶*å‘½ä»¤**æ”¶é›†ä¿¡æ¯

```
$file crackme0x00a
```

![](img/02c092d0d1a9d0d7bb353b3fe457b59a.png)

32 ä½ LSB å¯æ‰§è¡Œæ–‡ä»¶

*   è¯¥æ–‡ä»¶ä¸º 32 ä½ï¼Œ **LSB** å¯æ‰§è¡Œ*(æœ€ä½æœ‰æ•ˆå­—èŠ‚)ã€‚*
*   è¿™æ„å‘³ç€æ–‡ä»¶æ˜¯å°ç«¯çš„ã€‚

![](img/4d584d9a4f335793b1068e9a81685729.png)

ä½¿ç”¨ *rabin2* å·¥å…·æ”¶é›†ä¿¡æ¯ã€‚

```
$rabin2 -I crackme0x00a
```

![](img/48d17be14a3772b55a74c4c6c0ea25e6.png)

man rabin2

![](img/fc7d9f71e9e3afb234fb290df3df5833.png)

æ‹‰å®¾ 2

**ä½¿ç”¨å­—ç¬¦ä¸²ç ´è§£æ–‡ä»¶**

```
$strings crackme00x0a
```

![](img/7a2f73885bb310f041286580ddf26826.png)![](img/ae0c821b859d98972935e57d21cc2fde.png)![](img/dc2c22fe0d0cc9b8a20ea69e19ce2011.png)

**ä½¿ç”¨ xxd ç ´è§£æ–‡ä»¶**

![](img/20340b50c4ed76e26e557147fc9fae11.png)

```
$xxd crackme0x00a
```

![](img/7f45b79b4109263451a956516a25d1ad.png)![](img/dc2c22fe0d0cc9b8a20ea69e19ce2011.png)

**ä½¿ç”¨ rabin2 ç ´è§£æ–‡ä»¶**

![](img/30db6868397a1f24d321eae6b5711a68.png)

man rabin2

![](img/8b47bb6a4650d10a165161e44fa8dc28.png)![](img/dc2c22fe0d0cc9b8a20ea69e19ce2011.png)

**ä½¿ç”¨ ltracre ç ´è§£æ–‡ä»¶**

```
$ltrace ./crackme0x00a
```

![](img/53503981e5a03f62686712390ea73586.png)

ç”·å­è·‘é“

ltrace åŸºæœ¬ä¸Šæˆªå–å¹¶æ‰“å°ç¨‹åºæ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ã€‚

![](img/b15597e1fcc293cce3437c09a8009bd3.png)

ltrace

**ä½¿ç”¨ strace ç ´è§£æ–‡ä»¶:(**

```
strace ./crackme0x00a
```

![](img/7bb851dcf69c3db0a62522036107b1c4.png)

man strace

strace ç”¨äºè·Ÿè¸ªç³»ç»Ÿè°ƒç”¨ã€‚å®ƒä¸ä¼šè·Ÿè¸ªåƒ strncmp è¿™æ ·çš„å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä»»ä½•ç³»ç»Ÿè°ƒç”¨ã€‚

**ä½¿ç”¨ radare2 ç ´è§£æ–‡ä»¶**

```
$radare2 crackme0x00a
 [0x08048430]> aaa
 [0x08048430]> pdf @ main
```

*   aa:-å…¨éƒ¨åˆ†æã€‚
*   aaa:-ç”¨æ›´å¤šä¿¡æ¯åˆ†ææ‰€æœ‰å†…å®¹ã€‚
*   pdf:-æ‰“å°åæ±‡ç¼–åŠŸèƒ½ã€‚

![](img/6b56b7d24c518d8ad6e050efcbce7f79.png)![](img/0411b67a8a2b143d4f77a785a738f685.png)

radare2 ç»™å‡ºäº†ä»£ç çš„è§†å›¾ã€‚

*   æœ‰ä¸€ä¸ª*s2 å­—ç¬¦å‹æŒ‡é’ˆï¼Œå®ƒæŒ‡å‘ä¸€äº›å­—ç¬¦ä¸²ï¼Œå³æˆ‘ä»¬çš„è¾“å…¥(å¯†ç )ã€‚*s1 æ˜¯â€œg00dJ0Bï¼â€åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œä½¿ç”¨ strcmp å¯¹ä¸¤è€…è¿›è¡Œæ¯”è¾ƒã€‚

![](img/dc2c22fe0d0cc9b8a20ea69e19ce2011.png)

**ä½¿ç”¨ gdb-peda ç ´è§£æ–‡ä»¶**

gdb-peda å°±åƒæ˜¯ gdb çš„ä¸€ä¸ªæ’ä»¶ï¼Œä½ å¯ä»¥ä» [GitHub](https://github.com/longld/peda) å®‰è£…ã€‚

```
$gdb crackme0x00a
>gdb-peda$ disassemble main
```

***åæ±‡ç¼–ä¸»*** å°†æ˜¾ç¤ºäºŒè¿›åˆ¶çš„ä¸»åŠŸèƒ½ã€‚

![](img/7e52489f6ebffd3cd9e7de5d204e61f4.png)

ä¸»è¦åŠŸèƒ½

åœ¨ä¸Šæœ‰ä¸€ä¸ª strcmp æŒ‡ä»¤ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åœ¨è¿™ä¸ªä½ç½®è®¾ç½®æ–­ç‚¹å¹¶è¿è¡Œç¨‹åºã€‚

```
 gdb-peda$ break *0x0804852a
gdb-peda$ run
```

è¾“å…¥å¯†ç æ¥æµ‹è¯•ç¨‹åºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘è¾“å…¥ ***åŒ–å*** ä½œä¸ºå¯†ç ã€‚

![](img/07c55165177f7708ff40f1104e878bf0.png)![](img/81c2f493c71c8b1db5b53155998b8f65.png)

ã€Šå¾®æœç§è®¿ã€‹æ˜¯å’Œã€Šg00dj0Bã€‹ç›¸æ¯”è¾ƒçš„ï¼ï¼Œgdb-peda ä¹Ÿå±•ç¤ºäº†ä¸€äº›çŒœæµ‹è®ºç‚¹ã€‚

![](img/dc2c22fe0d0cc9b8a20ea69e19ce2011.png)

*æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ä¸ªæ•…äº‹ï¼Œè¯·* ***ç‚¹å‡»*** ğŸ‘ ***æŒ‰é’®ï¼Œåˆ†äº«*** *å®ƒæ¥å¸®åŠ©åˆ«äººï¼æ¬¢è¿å‘è¡¨è¯„è®º*ğŸ’¬*ä¸‹å›¾ã€‚æœ‰åé¦ˆï¼Ÿä¸‹é¢æˆ‘ä»¬è¿çº¿ä¸Š* [*æ¨ç‰¹*](https://twitter.com/yashanand155) *ã€‚*

## â¤ï¸ç”±[å¢åŠ åˆ°](https://twitter.com/yashanand155)